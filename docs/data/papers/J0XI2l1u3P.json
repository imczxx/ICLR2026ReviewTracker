{"id": "J0XI2l1u3P", "number": 4182, "cdate": 1757624960092, "mdate": 1763140030092, "content": {"title": "Scaling the Prior: Size-Consistent Geometric Diffusion for 3D Molecular Generation", "abstract": "Diffusion models usually operate in fixed-dimensional metric spaces. In contrast, geometric molecular data naturally vary in dimensionality as molecules have different sizes (numbers of atoms). As a simple adaptation, existing diffusion models for geometric molecular generation employ network architectures that can handle variable-sized inputs, such as graph neural networks and transformers. **However, these approaches overlook the fact that the molecular size also determines the spatial scale of the atomic coordinates, which in turn induces inconsistent behaviors in the generative trajectories across different molecular sizes.** The generative process of geometric diffusion for 3D molecular generation can be viewed as first establishing a coarse structural target, followed by progressively refining the precise atomic positions. In particular, larger molecules tend to establish coarse structures earlier than smaller molecules due to their larger spatial scales relative to that of the noise. As a result, the reverse process becomes inconsistent across molecular sizes, with the denoising trajectories relying heavily on molecular sizes rather than on a unified generative pattern. In this work, we are the first to identify and analyze this size-induced inconsistency through a decomposition of the denoising dynamics, which reveals how spatial scale affects the progression of molecular formation, in both 3D structures and atom types. Building on this insight, we propose Scaling the Prior (StP), a simple yet effective approach that normalizes the learning and generative process across molecular sizes by rescaling the prior distribution based on molecular sizes. This adjustment harmonizes the denoising trajectories, enabling the model to learn a unified generative pattern and produce consistently high-quality molecules.", "tldr": "", "keywords": ["3D Molecular Generation", "Geometric Diffusion"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/b0cdf2229b48f1bf71a2753b391fd8ba1de9daca.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper identifies a size-dependent inconsistency in diffusion-based molecular generation, where smaller molecules converge structurally slower than larger ones during both training and sampling. To address this, the authors propose StP, a simple modification that rescales the Gaussian prior variance based on molecular size, harmonizing the denoising trajectories across different molecular scales. This approach improves the consistency and quality of generated molecules from the experiments on QM9 and GEOM-Drugs, and could potentially extend to larger biomolecular systems such as proteins."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. This paper provides interesting observations on the relation between molecule sizes and proximal structural convergence speed. \n2. Experimental results show that StP works on some baseline diffusion models."}, "weaknesses": {"value": "1. The paper’s notion of “convergence” is heuristic rather than principled. The proposed $\\gamma_t$ and $\\beta_t$ only measure correlations between predicted clean samples and final outputs, which depend on model training and not on intrinsic diffusion dynamics. Thus, the claim that smaller molecules “converge slower” lacks a rigorous statistical or theoretical foundation.\n2. The use of convex hull–based scaling lacks physical justification and statistical robustness; it is an arbitrary geometric proxy for molecular size rather than a chemically meaningful measure.\n3. While I appreicate authors' effort on observations and experiments, the reported gains are marginal on QM9 and GEOM-Drug generation."}, "questions": {"value": "See Weakness"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "None."}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "xHgjLnEJG5", "forum": "J0XI2l1u3P", "replyto": "J0XI2l1u3P", "signatures": ["ICLR.cc/2026/Conference/Submission4182/Reviewer_5mF6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4182/Reviewer_5mF6"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission4182/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761311311285, "cdate": 1761311311285, "tmdate": 1762917218212, "mdate": 1762917218212, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper identifies that using a fixed Gaussian prior in 3D molecular diffusion models causes size-dependent inconsistencies—larger molecules experience weaker relative noise and thus stabilize earlier, yielding seemingly higher quality. To correct this, the authors propose Scaling the Prior (StP), which rescales the prior noise variance according to molecular size rather than normalizing coordinates (which would distort bond lengths). This adjustment aligns denoising dynamics across molecules of different sizes, improving validity and stability on QM9 and GEOM-Drugs datasets."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The authors tackle the issue of size-dependent inconsistencies from the perspective of diffusion model variance, which is highly innovative.\n- The proposed StP method is remarkably simple and elegant, and it can be applied to all types of diffusion models.\n- The paper is very well written, and the figures are clear and illustrative."}, "weaknesses": {"value": "- First, the paper’s conclusion — “at the same noise scale, larger molecules are more stable” — has already been observed in MOLCRAFT [1]. Therefore, the authors should further validate the effectiveness of the StP method on structure-based drug design (SBDD) tasks, such as CrossDocked2020 [2] and GenBench3D [3].\n- The baselines used in this paper are relatively outdated. With the emergence of Flow Matching and Mean Flow methods, molecular generation has become both faster and higher in quality. The authors are encouraged to include more flow-based baselines for comparison, such as FlowMol3 [4], SemlaFlow [5], and others.\n- In the visualization experiments, the authors did not show per-size visualizations for multiple metrics such as Validity, Uniqueness, and Validity × Uniqueness; nor did they provide speed curves broken down by molecular size.\n- In Figure 1, the upper-right element should be an arrow, and in several figures, the axis ticks point outward, whereas they should point inward.\n\n  [1] MolCRAFT: Structure-Based Drug Design in Continuous Parameter Space\n  [2] CrossDocked2020: A publicly available dataset for binding pose and affinity prediction\n  [3] Benchmarking structure-based three-dimensional molecular generative models using GenBench3D: ligand conformation quality matters\n  [4] FlowMol3: Flow Matching for 3D De Novo Small-Molecule Generation\n  [5] SemlaFlow -- Efficient 3D Molecular Generation with Latent Attention and Equivariant Flow Matching"}, "questions": {"value": "See weaknesses"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "BpHlbxlezk", "forum": "J0XI2l1u3P", "replyto": "J0XI2l1u3P", "signatures": ["ICLR.cc/2026/Conference/Submission4182/Reviewer_3M1W"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4182/Reviewer_3M1W"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission4182/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761639932977, "cdate": 1761639932977, "tmdate": 1762917217939, "mdate": 1762917217939, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper studies the problem of varying molecular size in diffusion generative models. It shows that molecules with different size (number of atoms) can have different performance, where larger molecules usually have better stability than smaller molecules. The paper also proposes a simple method to solve this phenomenon by introducing a way to normalize the Gaussian distribution based on molecular size. The authors evaluate their method on QM9 and GEOM-drugs molecular datasets, with multiple models from the literature (EDM, RADM , and GeoLDM)."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "* The paper shows a good evaluation on how molecular size can have an effect on the perfromance of the generated molecules, with a trend that molecules with a larger number of atoms can have better performance than molecules with a smaller number of atoms.\n* The paper proposes a simple method to deal with this phenomenon, where they can scale the Gaussian prior distribution in the forward process based on molecular size.  The authors empirically show that this normalization can  be applied to different architectures and improve the performance of generated molecules on QM9 and GEOM-drugs datasets."}, "weaknesses": {"value": "- The paper could benefit from more theoretical analysis and why the scaled prior is effective. Also,  as mentioned by the authors,  one direct approach is to apply size normalization/ normalize the 3D coordiates. So, more discussuion on that is required and  how their method is different from that.\n\n- The scaled prior parameters depend on the averages over the training subset. I think this might have some limitations if test molecules have different size distribution. The paper doesn’t show evaluation on how this might affect the performance, for e.g., molecules that have a different number of atoms from the training data."}, "questions": {"value": "How does the distribution of the size of the generated molecules vs performance change, after applying the scaling parameter, eg, as in Figure 2?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "y84ilYlSP4", "forum": "J0XI2l1u3P", "replyto": "J0XI2l1u3P", "signatures": ["ICLR.cc/2026/Conference/Submission4182/Reviewer_VNm8"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4182/Reviewer_VNm8"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission4182/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761905178169, "cdate": 1761905178169, "tmdate": 1762917217711, "mdate": 1762917217711, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper identifies an inconsistency in molecular generation trajectories of varying sizes when applying traditional diffusion methods to molecular generation. To address this issue, the authors propose a normalization technique called Scaling the Prior (StP), which resolves the inconsistency by rescaling the prior distribution."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The issue raised by the authors, the inconsistent convergence rates across molecules of different scales, is a noteworthy problem that deserves attention.  \n2. The authors propose a simple yet effective method to address this issue."}, "weaknesses": {"value": "1. Although the spatial-scale intervention accelerates the convergence of molecular structures, it may compromise the diversity of the generative model. The authors should include comparisons of the Novelty metric across different methods in their experiments.\n\n2. The paper only presents a comparison between molecular size and stability trends observed in the training set, but does not provide a similar analysis for the generated molecules—specifically, how molecular size correlates with stability in the generated samples.\n\n3. The SoTA method compared in the paper, GeoLDM, was published in 2023. Methods introduced recently should also be included in the comparison to ensure the evaluation reflects the current state of the field."}, "questions": {"value": "1. Why does Table 1 show that the performance improvement on the smaller-scale dataset QM9 is less compared to larger-scale dataset GEOM-Drugs?\n\n2. Molecular size in generation is typically sampled from the size distribution of the training set. Does a training set containing larger molecules inherently offer an advantage over one with smaller molecules? Have the authors conducted any comparative experiments to investigate this?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "nTEIVOelWh", "forum": "J0XI2l1u3P", "replyto": "J0XI2l1u3P", "signatures": ["ICLR.cc/2026/Conference/Submission4182/Reviewer_AKKr"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4182/Reviewer_AKKr"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission4182/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762162753198, "cdate": 1762162753198, "tmdate": 1762917217477, "mdate": 1762917217477, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}