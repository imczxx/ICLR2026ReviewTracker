{"id": "HjLv1tCGPD", "number": 8227, "cdate": 1758075072376, "mdate": 1759897797977, "content": {"title": "Soft Metropolis-Hastings Correction for Generative Model Sampling", "abstract": "Molecular diffusion models suffer from systematic sampling biases that prevent\noptimal structure formation, resulting in chemically suboptimal molecules with\nincomplete hydrogen bonding networks and metastable conformations trapped in\nlocal energy minima. We introduce Metropolis-Hastings correction to molecular\ndiffusion models for the first time, providing a principled framework to address\nthese systematic sampling biases. However, traditional hard accept-reject deci-\nsions create discontinuous trajectories incompatible with the continuous nature\nof molecular potential energy surfaces, disrupting proper structure assembly. To\naddress this, we develop soft Metropolis-Hastings correction that replaces binary\nacceptance with continuous interpolation weighted by acceptance probabilities,\nmaintaining smooth navigation of chemical space while providing principled bias\ncorrection. We design three molecular-specific variants: global correction pre-\nserving geometric equivariance (E(3)/SE(3)), local adaptive correction account-\ning for heterogeneous atomic environments, and distribution matching operating\nin whitened space to decouple structural correlations. Extensive experiments on\nsmall molecules, Drugs conformations, and therapeutic antibody CDR-H3 loops\ndemonstrate consistent improvements in chemical validity, structural stability, and\nconformational quality across diverse molecular families. Our method establishes\nMH correction as a powerful component for molecular generation.", "tldr": "", "keywords": ["Generative Model", "Markov Process", "Efficiency"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/d08326ce90f388d56a13e2dcb023e85b1515fa2d.pdf", "supplementary_material": "/attachment/cd888b451e1f35e4e14bddcf9674643dae62ba87.zip"}, "replies": [{"content": {"summary": {"value": "This paper improves generative sampling process for molecular diffusion models, by replacing the traditional accept-reject MH steps with continuous interpolation weighted by acceptance probability, preserving smoothness in sampling trajectories while enforcing probabilistic correctness (with approximation).\n\nIn specific, three complementary soft MH variants are introduced: \n* Linear Soft MH (global scalar acceptance weight)\n* Local Adaptive Soft MH (per-coordinate acceptance weight to accomodate local geometric variations)\n* Distribution Matching Soft MH (operates in a whitened latent space for decorrelated updates)\n\nThe framework guarantees approximate detailed balance, ensuring asymptotic convergence to the correct molecular distribution while maintaining trajectory continuity.\nThe method is evaluated on molecular diffusion processes for different biomolecular systems (small molecules, peptides, and antibody CDR loops)."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "* The authors establishe an MH-based correction mechanism that enforces approximated detailed balance in diffusion sampling, which can avoids discontinuous trajectories inherent in hard MH, enabling smoother conformational transitions critical for molecular systems.\n\n* They propose three flexible solutions, global, local, or distributional, and can be integrated to different diffusion models (GeoLDM, EDM, RFantibody), etc.\n\n* The paper provides theoretical guarantees of approximate detailed balance and convergence under small time-step assumptions."}, "weaknesses": {"value": "A key limitation of this work is that the evaluation metrics across molecular, peptide, and antibody generation tasks are already near saturation. For example, validity, stability, and uniqueness often approach 100%, making the reported improvements marginal and likely not statistically significant. This ceiling effect obscures whether the proposed soft MH correction truly enhances generative quality or merely matches baseline performance. \n\nIn both peptide and antibody design benchmarks, the reported gains remain minimal. Combined with the absence of variance analysis or statistical testing, the results, while consistent with the theory, are empirically less convincing.\n\nThe proposed method is not evaluated on typical hard MH accept–reject process."}, "questions": {"value": "Could you please elaborate on the motivation behind evaluating the proposed soft Metropolis–Hastings correction on molecular diffusion processes? The primary motivation of the paper centers on addressing discontinuities caused by the hard MH accept–reject mechanism, yet diffusion-based generative sampling is not a typical MH process and already produces continuous updates at each step."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "ESjMKaiz4t", "forum": "HjLv1tCGPD", "replyto": "HjLv1tCGPD", "signatures": ["ICLR.cc/2026/Conference/Submission8227/Reviewer_JVFX"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8227/Reviewer_JVFX"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission8227/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760617090813, "cdate": 1760617090813, "tmdate": 1762920175241, "mdate": 1762920175241, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces Soft Metropolis–Hastings (Soft-MH), a continuous relaxation of the traditional Metropolis–Hastings acceptance–rejection mechanism, designed to be compatible with diffusion-based generative models. Instead of discrete accept/reject decisions, the method employs a differentiable “soft acceptance” step parameterized by a temperature tau, which interpolates between the current and proposed states. The authors argue that this modification preserves detailed balance up to a second-order discretization error and propose three complementary variants to address different levels of structural heterogeneity in molecular systems. Experiments on molecular conformer generation demonstrate improved smoothness and diversity of sampled trajectories."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper presents an interesting and creative idea of softening the MH correction to make it compatible with diffusion samplers. The idea could have broad impact for generative models that must respect physical constraints or detailed balance.\n\n2. The paper is well organized overall (except the problem statement), with theoretical analysis and practical variants systematically presented."}, "weaknesses": {"value": "1. Unclear problem statement for general readers. The title and introduction may mislead readers into thinking this paper studies generic MCMC improvements, while in fact it targets diffusion-based generation. The authors should make this clear from the title and the very beginning of the introduction.\n\n2. In Eq. (3.3) and Appendix A.3, the log-acceptance ratio omits the target-density ratio \\pi_{k-1}(x_{k-1})/\\pi_k(x_k). The “Remark on Target Distribution Ratio” claims this term ≈ 1 when Δt is small, but this argument is unconvincing. When Δt is small, r itself is also small, and thus ignoring this ratio could introduce systematic bias. Some quantitative analysis or controlled experiments would strengthen this claim.\n\n3. The experiments only compare with baseline diffusion samplers, not with existing correction methods for diffusion models. Without such baselines, it is hard to assess whether the improvements come from the soft correction or other factors.\n\n4. The authors state that hard MH may cause discontinuous jumps or incorrect molecular topology, but no evidence or quantitative analysis is provided. It would be helpful to clarify whether such issues were observed in practice or are only theoretical concerns."}, "questions": {"value": "1. Could the authors provide an ablation or sensitivity study showing how the results depend on tau and Delta t?\n\n2. Could the authors justify or empirically validate the approximation \\approx 1?\n\n3. Would a hard MH correction applied to diffusion proposals truly lead to topology-breaking transitions? A direct experimental comparison would make the motivation for the “soft” version more convincing."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "Aj8qfsk15H", "forum": "HjLv1tCGPD", "replyto": "HjLv1tCGPD", "signatures": ["ICLR.cc/2026/Conference/Submission8227/Reviewer_qyP8"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8227/Reviewer_qyP8"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission8227/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761930168081, "cdate": 1761930168081, "tmdate": 1762920174667, "mdate": 1762920174667, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper addresses sampling biases in molecular diffusion models, which often produce chemically suboptimal structures. The core problem identified is that traditional Metropolis-Hastings (MH) correction, while principled, uses a hard accept-reject step that creates discontinuous trajectories, harming molecular structure formation. The authors propose Soft Metropolis-Hastings correction, which replaces the binary decision with a continuous interpolation: $x_{k-1} = \\alpha x^{\\text{prop}}_{k-1} + (1 - \\alpha)x_k$. The interpolation weight $\\alpha = \\min(1, \\exp(r/\\tau))$ is derived from an approximate MH acceptance ratio $r$, which is based on score function alignment. The paper introduces three variants: (1) Linear (a global $\\alpha$), (2) Local Adaptive (a per-coordinate $\\alpha$), and (3) Distribution Matching (a different mechanism based on statistical distance in whitened space). Experiments across QM9, GEOM-Drugs, and antibody CDR loops show that this method consistently improves chemical validity and structural quality metrics over baseline diffusion models."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "The core idea of using soft interpolation to solve the trajectory discontinuity problem of hard MH is intuitive and well-motivated for molecular generation.\n\nExperimentally, the method is applied to standard models (EDM, GeoLDM, RFAntibody) across diverse molecular datasets, showing consistent improvements in validity and structural quality metrics (e.g., RMSD, pLDDT).\n\nThe paper is well-written, clearly explaining the core concept and differentiating the three variants.\n\nA practical advantage is that the method is a plug-and-play sampler enhancement requiring no model retraining."}, "weaknesses": {"value": "1.  The paper's claim of <1.5% computational overhead in Appendix L appears incorrect. Algorithm 2 requires two score function evaluations per step, doubling the cost (~100% increase) compared to the baseline's single evaluation. This makes the comparison to the baseline unfair, as the quality gain may just be from 2x computation. Consequently, the paper omits comparisons to other standard high-quality samplers that also use multiple evaluations, like Predictor-Corrector (PC) methods or higher-order ODE/SDE solvers (e.g., DPM-Solver).\n\n2.  The methodological foundation is questionable. The soft method is more of a trajectory smoothing heuristic than a principled MH correction. Blending a good state $x_k$ with a bad proposal $x_{prop}$ is physically questionable in molecular systems and does not carry the statistical weight of a proper MH rejection. This is compounded by the circular logic of using the same imperfect score function $s_{\\theta}$ that causes the bias to then calculate the correction ratio $r$.\n\n3.  The analysis lacks rigor and contains internal contradictions. The key temperature parameter $\\tau=0.8$ is only justified on a simple 2D Gaussian Mixture Model, with no sensitivity analysis on the main molecular tasks (QM9, GEOM, etc.). Additionally, the paper's guidelines (Appendix H) are contradicted by its own results (Table 5), where the Linear variant, not Local, performs best on peptides. This suggests the variant choice is not well-understood.\n\n4.  The proposed variants have unaddressed theoretical and practical issues. The Local Adaptive variant explicitly breaks E(3)-equivariance, a fundamental property of the models it aims to improve. The Distribution Matching method is also confusingly grouped under the MH framework despite not using the MH ratio $r$, and its reliance on a full covariance matrix raises unaddressed scalability concerns. \n\n5. The paper also contains typos (e.g., repeated text at Lines 464-466) and mis-citations."}, "questions": {"value": "1.  Can you clarify the cost? Algorithm 2 implies two score function evaluations per step, doubling the sampling time. How does this compare to a baseline sampler run for 2x the steps?\n\n2.  Missing Baselines: Why were comparisons to other high-quality samplers like PC methods or high-order solvers omitted?\n\n3.  Temperature Ablation: Can you provide a sensitivity analysis for $\\tau$ on the main molecular datasets, not just the GMM?\n\n4.  Can you comment on why the Linear variant outperforms Local on peptides (Table 5), contradicting the guidance in Appendix H?\n\n5.  Why is the Distribution Matching method, which does not use the MH ratio $r$, grouped under the MH framework? How does it scale given its reliance on a full covariance matrix?\n\nIf all concerns are addressed, I am willing to raise my score."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "3uACsJwpTg", "forum": "HjLv1tCGPD", "replyto": "HjLv1tCGPD", "signatures": ["ICLR.cc/2026/Conference/Submission8227/Reviewer_tVvT"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8227/Reviewer_tVvT"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission8227/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761980762120, "cdate": 1761980762120, "tmdate": 1762920174060, "mdate": 1762920174060, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces soft Metropolis-Hastings (MH) correction for molecular diffusion models to address systematic sampling biases that lead to chemically suboptimal structures. The key innovation is replacing hard binary accept-reject decisions with continuous interpolation weighted by acceptance probabilities, maintaining trajectory smoothness while providing principled bias correction. Three variants are proposed: Linear (global scalar), Local Adaptive (per-dimension weights), and Distribution Matching (whitened space)."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The soft acceptance mechanism is theoretically grounded and addresses a real problem - traditional hard MH creates discontinuous trajectories incompatible with molecular potential energy surfaces.\n2. The paper provides rigorous theoretical justification.\n3. The design of three variants addressing different molecular scenarios shows thoughtful engineering. And the experiments are extensive, spans multiple scales and complexities."}, "weaknesses": {"value": "1.  The method introduces computational costs, particularly for the Distribution Matching variant, which requires computing and storing the full covariance matrix. The scalability discussion is limited, especially for large biomolecular systems with thousands of atoms. While Appendix L provides some overhead analysis, it lacks depth regarding practical limitations for production-scale applications.\n2. The performance gains, while consistent, are often incremental. More concerning, some configurations show marginal benefits or even degradation (e.g. Table 8 GeoLDM + GUIDE w/ Dist. Match). The trade-off between computational cost and performance gain needs clearer characterization.\n3. Missing comparisons with predictor-corrector methods and recent advanced samplers (DPM-Solver++, EDM sampler variants). Hard MH baseline only appears in Table 2."}, "questions": {"value": "1. Can Tables 3-4 include Hard MH? And can the authors add predictor-corrector, and DPM-Solver++ baselines for comprehensive comparison?\n2. When does each variant's computational cost justify its benefits?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "Ntjky5FQDk", "forum": "HjLv1tCGPD", "replyto": "HjLv1tCGPD", "signatures": ["ICLR.cc/2026/Conference/Submission8227/Reviewer_nkJK"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8227/Reviewer_nkJK"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission8227/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762114706543, "cdate": 1762114706543, "tmdate": 1762920173692, "mdate": 1762920173692, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}