{"id": "uOZRWcbiZl", "number": 13569, "cdate": 1758219304699, "mdate": 1759897427976, "content": {"title": "CREPE: Controlling diffusion with REPlica Exchange", "abstract": "Inference-time control of diffusion models aims to steer model outputs to satisfy new constraints without retraining.\nPrevious approaches have mostly relied on heuristic guidance or have been coupled with Sequential Monte Carlo (SMC) for bias correction.\nIn this paper, we propose a flexible alternative based on replica exchange, an algorithm designed initially for sampling problems.\nWe refer to this method as the CREPE (Controlling with REPlica Exchange). Unlike SMC, CREPE:\n(i) generates particles sequentially, (ii) maintains high diversity in the generated samples after a burn-in period,\nand\n(iii) enables online refinement or early termination.\nWe demonstrate its versatility across various tasks, including temperature annealing, reward tilting, model composition and classifier-free guidance debiasing, with competitive performance compared to prior SMC methods.", "tldr": "", "keywords": ["parallel tempering", "diffusion model", "inference-time control", "replica exchange"], "primary_area": "probabilistic methods (Bayesian methods, variational inference, sampling, UQ, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/5adfde903b1bf2037ad1599228f784ad9dea750e.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper introduces CREPE (Controlling Diffusion with Replica Exchange), a framework for inference-time control of diffusion models via replica exchange (parallel tempering). The method adapts ideas from nonequilibrium statistical mechanics to generative inference by allowing multiple diffusion chains, each at different noise levels, to exchange information using accelerated parallel tempering (APT).\n\nThe authors derive swap acceptance ratios through Radon–Nikodym estimators between forward and backward path distributions, ensuring theoretically consistent swaps. Empirical evaluations on image and molecular generation tasks demonstrate that CREPE achieves comparable or slightly improved performance to SMC-based debiasing methods while enhancing sample diversity and supporting online refinement."}, "soundness": {"value": 1}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. Applying replica exchange to diffusion inference is novel. It draws a meaningful connection between thermodynamic sampling methods and modern generative modeling.\n\n2. The experiments cover several relevant applications—tempering, reward-tilting, model composition, and discrete diffusion.\n\n3. Replica exchange could improve performance and sample diversity, which is well-studied in the MCMC area.\n\n4. The paper is generally well-written, with clear motivation and good presentation."}, "weaknesses": {"value": "My main concerns revolve around the practical overhead and complexity inherent in the Replica Exchange framework when applied to generative tasks, despite the theoretical benefits.\n\n1. In my opinion, the advantages of replica exchange/parallel tempering are (1) potential performance improvement in some metrics and (2) increased sample diversity. However, the disadvantage of this method is also very clear: each sampling step requires a larger Number of Function Evaluations (NFEs). For instance, if you consider N chains, a standard step requires N steps + additional swap calculations (N+ NFEs), whereas a single-chain method only requires 1 NFE. While I understand that some replica exchange design in MCMC try to improve efficiency by optimizing chain swap rates and tuning various hyperparameters to outperform single-chain methods under the same NFEs, the problem remains significant: (1) You have a large number of hyperparameters that require fine-tuning, such as the temperature and step size for each chain, and the hyperparameters related to the swap design. This complexity is very challenging in generative tasks. I am not questioning the contribution of this paper, but rather, I do not believe that the replica exchange approach can be broadly effective in generative models. Although this method provides an elegant analytical framework, I do not believe it can both significantly improve performance and be simple to use for generative tasks.\n\n2. MCMC-based sampling methods like CREPE necessitate a warm-up (burn-in samples) phase to achieve the target distribution, which requires potentially hundreds or even thousands of NFEs to reach low FIDs. This contrasts sharply with recent advancements in image generation, where distilled diffusion models [1-3] achieve competitive performance (e.g., FID below 2) on larger-resolution images using only a few NFEs or even one NFE. This fundamental requirement for a long burn-in period and high NFEs limits the applicability and competitive efficiency of MCMC sampling schemes like CREPE in real-time or resource-constrained engineering domains.\n\n3. There is no discussion on the related work of replica exchange / parallel tempering. Since these techniques have been thoroughly studied in MCMC, it would strengthen the paper to discuss which insights from the MCMC community could transfer to generative settings (e.g., ladder design, replica spacing, or swap design).\n\n\n4. The paper would benefit from diversity metrics (entropy, coverage, or mode count) to support this claim quantitatively, related to Figure 7 (replica exchange benefits sample diversity).\n\n5. Too frequent swaps can hinder exploitation in low-temperature chains. The paper mentions the use of non-reversible even/odd communication but provides no statistics (e.g., acceptance rate, cycle time from the lowest to the highest temperature). \n\n6. The swap acceptance rule appears to rely on exact energy or log-probability evaluations. It is unclear how this is handled under mini-batch training or high-dimensional data, where computing full log-likelihoods may be infeasible. Some clarification or approximation discussion would be valuable.\n\n**References:**\n\n[1] One-step Diffusion with Distribution Matching Distillation. CVPR 2024\n\n[2] Consistency Trajectory Models: Learning Probability Flow ODE Trajectory of Diffusion. ICLR 2024\n\n[3] Consistency Models Made Easy. ICLR 2025"}, "questions": {"value": "1. How sensitive is CREPE’s performance to the number of replicas and swap frequency? \n\n2. What is the observed swap acceptance rate and average traversal time for a full temperature cycle in your experiments?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "None"}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "g5s2RAnEkE", "forum": "uOZRWcbiZl", "replyto": "uOZRWcbiZl", "signatures": ["ICLR.cc/2026/Conference/Submission13569/Reviewer_AFgB"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission13569/Reviewer_AFgB"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission13569/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761959802058, "cdate": 1761959802058, "tmdate": 1762924166815, "mdate": 1762924166815, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces CREPE, a new inference-time control method for diffusion models. Unlike common approaches based on Sequential Monte Carlo (SMC), CREPE sequentially generates samples using accelerated parallel tempering (APT; Zhang et al. 2025), a variant of parallel tempering MCMC that runs parallel chains at different diffusion timesteps and swaps samples between adjacent levels. The proposed method is empirically shown to approximate the target distribution more accurately and exhibits higher sample diversity compared to SMC-steering."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The paper is clearly written and easy to follow. Their derivations are mathematically rigorous.\n2. The proposed algorithm is versatile and has broad practical potential for any application requiring inference-time control of diffusion models.\n3. The experiments are promising and directly compare against strong SMC baselines. The results show that CREPE achieves competitive performance while maintaining higher sample diversity."}, "weaknesses": {"value": "1. A major concern is that this work doesn't seem to provide methodological improvement over accelerated parallel tempering (APT). To me, it seems a direct application of APT to inference-time control with pretrained diffusion (with an assumption that the pretrained model perfectly models the time-reversal of a noising process). An algorithmic difference with APT, or an explanation on why applying APT to inference-time control is not trivial, would be helpful to understand the contribution.\n2. Some details in the experiments section are missing, e.g., the number of random seeds used for each experiment, and the standard deviation for Table 2, runtime compared to SMC, etc. Also, the source code is not included.\n\nI'm open to raising my score if those two points are resolved.\n\n(Minor)  \n3. References need to be added in the appendix A.2., since some of them are studied in previous works.  \n4. Analysis of the acceptance probability would be valuable (e.g., how the choice of proposals affects the acceptance rates)  \n5. Typo, Line 198, the arrow for the backward process Markov  \n6. Type, Line 1088,\"For the CREPE communication step.\" needs to be removed"}, "questions": {"value": "1. Line 96, \"without explicit target densities\": What does this mean? This claim does not seem valid for a reward-tilted setting.\n2. How robust is the algorithm to the initialization, particularly when the number of iterations is limited?\n3. Do SMC baselines use the same proposals as in Appendix A.2?\n4. Do SMC baselines use standard techniques, like adaptive resampling (resampling when ESS below a certain threshold) and systematic sampling [1]?\n5. Line 1040, \"we run 50 batches of size 1000\": Does this mean running SMC with 50,000 particles?\n\n---\n\n### References\n[1] Douc, Randal, and Olivier Cappé. \"Comparison of resampling schemes for particle filtering.\" ISPA 2005. Proceedings of the 4th International Symposium on Image and Signal Processing and Analysis, 2005. IEEE, 2005.\n\n---\n\n### LLM usage disclosure\nI used LLM only to check grammar."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "ukTBhzjjCv", "forum": "uOZRWcbiZl", "replyto": "uOZRWcbiZl", "signatures": ["ICLR.cc/2026/Conference/Submission13569/Reviewer_2CNP"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission13569/Reviewer_2CNP"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission13569/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761996505333, "cdate": 1761996505333, "tmdate": 1762924166558, "mdate": 1762924166558, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper focuses on inference-time control of diffusion models. It proposes a method based on parallel tempering as an alternative to guidance and Sequential Monte Carlo (SMC) methods. The method is applied across annealing, reward tilting, model composition, and classifier-free guidance debiasing tasks."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper investigates a new direction of applying Parallel Tempering (PT; Replica Exchange MCMC), a widely used sampling algorithm, as an alternative to SMC for inference-time control of diffusion models.\n2. The paper proposes a concrete algorithm tailored for diffusion models that can directly benefit from the properties of PT.\n3. Experiments are conducted across diverse domains, including molecule sampling, image generation, and navigation, to demonstrate its effectiveness and versatility."}, "weaknesses": {"value": "1. The limitations of SMC-based inference-time control methods, which are the key motivation of this paper, aren't convincing enough. It should be supported by more concrete statements or additional experiments. SMC is currently the most widely used method for inference-time control, and I hope the authors can provide more evidence on why the community should explore directions using PT. (See Question 1, 2, 3, 4)\n2. The motivation of why PT is a promising alternative is not presented thoroughly in the introduction, and the explanation of why it could increase sample diversity isn't presented throughout the paper (or at least in the introduction or Section 3.3, where it should be).\n3. Introduction claims that derivation of PT swap rates is their key contribution, but it's not presented in the main text.\n4. It would be more interesting and convincing if there were applications of CREPE for more modern pre-trained models, such as the Stable Diffusion model family."}, "questions": {"value": "1. Regarding Limitation 2 of SMC: It's confusing whether 'sample diversity' in line 77 refers to particle diversity during or at the end of SMC, or diversity of the sample distribution generated via SMC. In either case, it would be worth justifying the reason why it happens. Also, if the authors are referring to the first, one can run separate SMC samplers multiple times to sample diverse samples.\n2. Related to Question 1, the claim that SMC requires a large batch of particles (Section 3.3, line 353-354) doesn't seem to hold for SMC-based inference-time control of diffusion, as recent works ([1], [2]) show that few as 4 particles are enough to sample high-quality samples. That said, running separate SMC samplers multiple times seems like a (computationally) viable strategy. Superiority of PT over SMC would be more convincing if the authors included this as a baseline.\n3. Regarding Limitation 1 of SMC: SMC is memory-intensive due to saving particles. However, isn't CREPE also (perhaps even more) memory-intensive due to saving all timesteps? (This relates to the claim that SMC requires a large batch of particles in Question 2)\n4. Regarding Limitation 3 of SMC: Indeed, basic SMC can't refine samples, but it can be naturally extended via Nested SMC where the outer sampling adds noise and denoise back, like how recent works ([3], [4]) do.\n\n[1] Singhal, Raghav, et al. \"A General Framework for Inference-time Scaling and Steering of Diffusion Models.\" Forty-second International Conference on Machine Learning.\n[2] Kim, Sunwoo, Minkyu Kim, and Dongmin Park. \"Test-time Alignment of Diffusion Models without Reward Over-optimization.\" The Thirteenth International Conference on Learning Representations.\n[3] Uehara, Masatoshi, et al. \"Reward-Guided Iterative Refinement in Diffusion Models at Test-Time with Applications to Protein and DNA Design.\" arXiv preprint arXiv:2502.14944 (2025).\n[4] Ma, Nanye, et al. \"Inference-time scaling for diffusion models beyond scaling denoising steps.\" arXiv preprint arXiv:2501.09732 (2025)."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "DHsEd0VtYG", "forum": "uOZRWcbiZl", "replyto": "uOZRWcbiZl", "signatures": ["ICLR.cc/2026/Conference/Submission13569/Reviewer_LYC3"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission13569/Reviewer_LYC3"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission13569/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761997789153, "cdate": 1761997789153, "tmdate": 1762924166183, "mdate": 1762924166183, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes CREPE, an inference-time control framework for diffusion models based on replica exchange (accelerated parallel tempering), offering an alternative to SMC. Across molecules, images (ImageNet-64/512), and trajectory stitching, CREPE achieves competitive or better quality and diversity than SMC with similar NFE cost, while supporting online refinement and anytime sampling."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- Principled and general formulation.\n- Practical advantages over SMC: better sample diversity after burn-in, lower memory (no large particle batches), online refinement and early stopping; compute parity analysis clarifies similar NFE cost.\n- Broad, convincing experiments across modalities and tasks showing improved metrics (e.g., FID/IR, TICA diversity) and flexible compositions (e.g., CFG debiasing + reward tilting, trajectory stitching)."}, "weaknesses": {"value": "Novelty\n- Important recent related works are missing [1,2,3]. Especially, DAS [1] avoids reward over-optimization by the tempering technique, thereby maintaining output diversity, and also deals with online reward optimization, which significantly affects the novelty of this work. The author should contrast how their proposed APT are better than DAS in terms of design.\n- Some of the work uses sequential particle generation, rather than solely using parallel generation [3]\n\n\nExperiment Setup\n- Guidance results with recent T2I backbones (stable diffusions) are missing, which are widely used to compare the efficacy of inference-time guidance methods for diffusion [1,2,3].\n\n\n---\n\n[1] Test-time alignment of diffusion models without reward over-optimization, ICLR, 2025\n\n[2] Inference-time scaling for diffusion models beyond scaling denoising steps, CVPR, 2025\n\n[3] Inference-time Scaling of Diffusion Models through Classical Search, ArXiv, 2025"}, "questions": {"value": "- Why is generating particles sequentially better than generating them in parallel? Can you provide any theoretic background of this?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "jnH4soqHSe", "forum": "uOZRWcbiZl", "replyto": "uOZRWcbiZl", "signatures": ["ICLR.cc/2026/Conference/Submission13569/Reviewer_MkR6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission13569/Reviewer_MkR6"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission13569/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762244090721, "cdate": 1762244090721, "tmdate": 1762924165940, "mdate": 1762924165940, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}