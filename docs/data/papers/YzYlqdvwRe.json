{"id": "YzYlqdvwRe", "number": 14535, "cdate": 1758238292139, "mdate": 1759897364280, "content": {"title": "Approximate Quantum State Preparation with Tree-Based Bayesian Optimization Surrogates", "abstract": "We study the problem of approximate state preparation on near-term quantum computers, where the goal is to construct a parameterized circuit that reproduces the output distribution of a target quantum state while minimizing resource overhead. This task is especially relevant for near-term algorithms where distributional matching suffices, but it is challenging due to stochastic outputs, limited circuit depth, and a high-dimensional, non-smooth parameter space. We propose CircuitTree, a surrogate-guided optimization framework based on Bayesian Optimization with tree-based models, which avoids the scalability and smoothness assumptions of Gaussian Process surrogates. Our framework introduces a structured layerwise decomposition strategy that partitions parameters into blocks aligned with variational circuit architecture, enabling distributed and sample-efficient optimization with theoretical convergence guarantees. Empirical evaluations on synthetic benchmarks and variational tasks validate our theoretical insights, showing that CircuitTree achieves low total variation distance and high fidelity while requiring significantly shallower circuits than existing approaches.", "tldr": "CircuitTree is a layerwise tree-based optimization strategy to enable distributed and sample-efficient approximate state preparation with theoretical convergence guarantees.", "keywords": ["Quantum Computing", "Bayesian Optimization", "Approximate State Preparation", "Tree-based Surrogates"], "primary_area": "other topics in machine learning (i.e., none of the above)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/e38be02dce05c3fb8b3a132771e354932f0fad5a.pdf", "supplementary_material": "/attachment/e01d0545349feddc07fdcb9e4ec500b07bab90db.zip"}, "replies": [{"content": {"summary": {"value": "This work presents a method named CircuitTree to find appropriate parameters for a layer-stacked quantum circuit that approximates the probability distribution of a target quantum state. It employs gradient boosted regression trees (GBRTs) as a surrogate for the original state-preparation objective and uses it to guide the updates of circuit parameters. Besides the theoretical guarantee on convergence, experiments on three classes of states demonstrate the effectiveness of the proposed method."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The manuscript is well-organized.\n\n- The work is supported by both theoretical analysis and numerical results.\n\n- The experiments cover multiple applications and comparisons with multiple existing methods."}, "weaknesses": {"value": "The manuscript lacks an analysis of the effect of shot number on the convergence and final fidelity for a varying number of qubits, since the estimation of fidelity will be inaccurate for large-scale systems with finite measurements."}, "questions": {"value": "- What is the number of qubits for the target states in the experiments?\n\n- Why were GBRTs chosen as the surrogate model? Can other tree-based models also work well?\n\n- How is the required circuit depth determined for achieving a certain fidelity? Could you compare the proposed method with circuit architecture search methods, instead of only parameter optimization methods?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "jyEn0FDjD4", "forum": "YzYlqdvwRe", "replyto": "YzYlqdvwRe", "signatures": ["ICLR.cc/2026/Conference/Submission14535/Reviewer_qhX3"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14535/Reviewer_qhX3"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission14535/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761900684811, "cdate": 1761900684811, "tmdate": 1762924927342, "mdate": 1762924927342, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This submission presents a quantum algorithm for approximate quantum state preparation, i.e., generating a state whose measurement outcome follows a similar probability distribution as the target state. The algorithm starts with a parameterized circuit and uses a surrogate model to minimize the distance between the measurement distribution and the target distribution. Numerical evaluations show that this approach requires shallower circuits than existing methods."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "The main result (Theorem 4.7) is backed by rigorous proofs and numerical experiments."}, "weaknesses": {"value": "My main concern with this work is the motivation for studying this problem. Note that the goal of this algorithm is NOT to prepare an approximation of the target state. Instead, the authors are trying to prepare a state (which can be very far from the target state) whose measurement outcomes follow closely (in terms of the TV distance) the distribution of measuring the target state.\n\nIf two states are close in terms of the 2-norm, the TV distance of their measurement outcome distributions is small, but not vice versa. This algorithm certainly cannot be used as a general state preparation subroutine required by many quantum algorithms. So, I cannot think of any promising application of this algorithm where one needs to reproduce the distribution rather than the state itself. Maybe this algorithm can be used to shorten the depth of some quantum optimization or sampling algorithms where the goal is actually producing a distribution, but more work is needed on top of the current submission to justify these types of applications.\n\nIn summary, I don't agree with the first sentence of this submission, \"Approximate state preparation is a core problem in quantum algorithm design...\" I don't think this is a \"core\" problem.\n\nOn top of this, I have additional questions regarding the details of the algorithm. In Definition 2.1, a target $U^\\*$ is given. How is it given? Is it given as a circuit description? In Line 89 on page 2, and in Line 2 of Algorithm 1, how is the TV distance evaluated? From what I understood, we need to at least run $U^\\*$ to get the target state, but if we can run $U^\\*$, what's the point of doing the additional work to come up with another circuit to prepare a different state? Just to shorten the depth?"}, "questions": {"value": "See my concerns in the Weaknesses section."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "d7QGE6GWva", "forum": "YzYlqdvwRe", "replyto": "YzYlqdvwRe", "signatures": ["ICLR.cc/2026/Conference/Submission14535/Reviewer_YvMQ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14535/Reviewer_YvMQ"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission14535/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761966058919, "cdate": 1761966058919, "tmdate": 1762924926743, "mdate": 1762924926743, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper formulates the (approximate) quantum state preparation problem as a black-box optimization task and applies a Bayesian optimization framework to construct efficient quantum circuits that generate the target state. In particular, the authors employ Gradient Boosted Regression Trees (GBRT) as a surrogate model and propose a structured, layerwise training method for approximating the ground-truth loss function (total variation distance, TVD) used for quantum state preparation. The paper also provides a theoretical convergence guarantee and presents experimental results obtained on real quantum hardware."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- The proposed method is supported by a complete theoretical convergence guarantee and does not rely on any assumptions specific to a given quantum hardware platform.\n\n- Extensive experiments are conducted on real quantum devices, demonstrating the practical advantages and feasibility of the approach."}, "weaknesses": {"value": "- The theoretical analysis, while sound, appears fairly standard and does not introduce much novelty. It would be more compelling if the analysis incorporated domain-specific insights or stronger connections to quantum computing and quantum information theory.\n\n- However, there is a **critical conceptual flaw in this work**: the choice of total variation distance (TVD) as the loss measure. The standard figure-of-merit for quantum state preparation is (in)fidelity, as it properly accounts for both amplitude and phase information. In contrast, TVD, computed from measurement outcomes in a fixed basis (here, the computational basis), ignores phase information and is therefore not a valid metric on the quantum state space. Two quantum states may have zero TVD yet exhibit a large fidelity or trace distance gap; in extreme cases, a highly entangled state and a fully classical (separable) state could even yield TVD = 0. The appropriate quantum analogue of TVD is the trace distance, which is a proper metric on the space of quantum states.\n\n- Hence, although TVD can serve as a practical diagnostic for hardware (as it avoids the need for full quantum state tomography) and may be meaningful for evaluating classical outcomes of quantum computations (where outputs are distributions over bit strings), it is not an appropriate loss for quantum state preparation. In particular, for VQE benchmarks, TVD fails to capture the true closeness between the state prepared by CircuitTree and the (potentially highly entangled) target state."}, "questions": {"value": "Can the analysis be extended to the infidelity loss or trace distance loss, and could such an extension yield non-trivial insights by leveraging the structure of quantum operations (e.g., unitarity or CPTP maps)?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "KFNlDqwL9R", "forum": "YzYlqdvwRe", "replyto": "YzYlqdvwRe", "signatures": ["ICLR.cc/2026/Conference/Submission14535/Reviewer_XFiK"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14535/Reviewer_XFiK"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission14535/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761973115890, "cdate": 1761973115890, "tmdate": 1762924926328, "mdate": 1762924926328, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes CircuitTree, a surrogate-guided framework for approximate quantum state preparation on NISQ devices. It formulates state preparation as a black-box optimization problem over the total-variation distance between the circuit’s output distribution and a target state. The authors proposed to use tree-based (GBRT) Bayesian optimization that better handles high-dimensional, non-smooth, and stochastic quantum objectives. Experiments on random circuits, QSP, and VQE tasks show lower TVD, shallower circuits, and more stable convergence than standard synthesis tools."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1.\tThe paper provides rigorous theoretical guarantees for the convergence of the surrogate-based optimization algorithm under realistic noise and structural assumptions.\n2.\tThe authors conduct large-scale experiments to validate the effectiveness of the proposed approach."}, "weaknesses": {"value": "1.\tIn Assumption 4.2, it appears that the expectation of $y_t$ is not an unbiased estimator of $f(\\theta_t)$, since the expectation and the absolute value operation in the total variation distance (TVD) are not interchangeable. Therefore, it is not justified to assume $\\mathbb{E}[\\xi_t] =0$. This assumption should be revisited or rigorously justified.\n2.\tThe statement of Theorem 7 does not specify with respect to which variables the expectation is taken. \n3.\tIn Line 261, the authors claim that “the structured updates also mitigate barren plateaus by focusing optimization on local spaces.” This statement seems inaccurate, as layer-wise training alone does not alter the intrinsic random nature of the quantum circuit nor fundamentally increase the gradient magnitudes of the parameters. A more precise justification or empirical evidence is needed.\n4.\tThe authors employ the total variation distance (TVD) as the loss function. However, accurately estimating the TVD requires evaluating probabilities over all computational basis states x \\in  { 0,1 }^n, leading to an exponential measurement cost. This significantly limits the scalability of the proposed approach.\n5.\tThe experimental evaluation only includes a comparison with a single baseline model. This makes it difficult to convincingly assess the advantage of the proposed method. The authors are encouraged to compare their approach against other advanced quantum state preparation techniques, such as those proposed in Refs. [1]–[3], to provide a more comprehensive and persuasive evaluation.\n\n[1] Rudolph, Manuel S., et al. \"Synergistic pretraining of parametrized quantum circuits via tensor networks.\" Nature Communications 14.1 (2023): 8367.\n\n[2] Rudolph, Manuel S., et al. \"Decomposition of matrix product states into shallow quantum circuits.\" Quantum Science and Technology 9.1 (2023): 015012.\n\n[3] Shirakawa, Tomonori, Hiroshi Ueda, and Seiji Yunoki. \"Automatic quantum circuit encoding of a given arbitrary quantum state.\" Physical Review Research 6.4 (2024): 043008."}, "questions": {"value": "The questions are included in Weakness."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "v49qsnVTdq", "forum": "YzYlqdvwRe", "replyto": "YzYlqdvwRe", "signatures": ["ICLR.cc/2026/Conference/Submission14535/Reviewer_yGP5"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14535/Reviewer_yGP5"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission14535/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761996198886, "cdate": 1761996198886, "tmdate": 1762924925706, "mdate": 1762924925706, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}