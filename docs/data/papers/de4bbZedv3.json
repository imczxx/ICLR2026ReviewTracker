{"id": "de4bbZedv3", "number": 18123, "cdate": 1758284143674, "mdate": 1759897131525, "content": {"title": "InertialAR: Autoregressive 3D Molecule Generation with Inertial Frames", "abstract": "Transformer-based autoregressive models have emerged as a unifying paradigm across modalities such as text and images, but their extension to 3D molecule generation remains underexplored. The gap stems from two fundamental challenges: (1) tokenizing molecules into a canonical 1D sequence of tokens that is invariant to both SE(3) transformations and atom index permutations, and (2) designing an architecture capable of modeling hybrid atom-based tokens that couple discrete atom types with continuous 3D coordinates. To address these challenges, we introduce InertialAR. InertialAR devises a canonical tokenization that aligns molecules to their inertial frames and reorders atoms to ensure SE(3) and permutation invariance. Moreover, InertialAR equips the attention mechanism with geometric awareness via geometric rotary positional encoding (GeoRoPE). In addition, it utilizes a hierarchical autoregressive paradigm to predict the next atom-based token, predicting the atom type first and then its 3D coordinates via Diffusion loss. Experimentally, InertialAR achieves state-of-the-art performance on 7 of the 10 evaluation metrics for unconditional molecule generation across QM9, Geom-Drug, and B3LYP. Moreover, it significantly outperforms strong baselines in controllable generation for targeted chemical functionality, attaining state-of- the-art results across all 5 metrics.", "tldr": "", "keywords": ["Autoregressive Models; SE(3) Symmetry; 3D Molecule Generation; Controllable Generation;"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/42ee4e8c93d0e61f243b0c6f2f4d44cdec0a8696.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper proposes InertialAR, a transformer-based autoregressive model for 3D molecule generation. The key innovations are a canonicalization of the atom positions (via inertial frames) and atom indices (via RDKit), in order to generate a 1D sequence of tokens, using a novel 3D geometry-aware positional encoding. Experiments show that InertialAR performs well on QM9, GEOM-DRUGS and the large B3LYP dataset for unconditional generation, and can further be conditioned on molecule class reasonably well."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "The appeal of canonicalization of 3D geometry in order to apply well-known techniques from 1D sequence modelling makes sense to me. The new GeoRoPE mechanism builds upon RoPE-3D by adding the pairwise distance using the Nyström low-rank approximation method, and should be useful in other 3D modelling contexts."}, "weaknesses": {"value": "The canonicalization of the atom indices is unclear and needs to be explained better. How are the identifiers computed? To the best of my knowledge, there is no ‘smooth’ way to canonicalize atom indices. Some additional experiments with the canonicalization would be helpful to understand when it breaks; for example, do you find that similar molecules have very different canonicalization orders?"}, "questions": {"value": "* Is your denoising network also a transformer?\n* How does your model decide when to stop generation?\n* Does your model support beginning from a random molecule fragment, since the canonicalization of atom indices in the fragment might be very different from the full molecule?\n* Do you have any experiments where you prompt the model to generate longer molecules than seen during training?\n* Are the training splits the same for all methods on QM9?\n* How important is the GeoRoPE mechanism? Do you have experiments with simple RoPE-3D for comparison?\n* Can you explain the canonicalization procedures (both positions and indices) for a symmetric planar molecule such as benzene?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "R7g9xWtGXm", "forum": "de4bbZedv3", "replyto": "de4bbZedv3", "signatures": ["ICLR.cc/2026/Conference/Submission18123/Reviewer_BzTP"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18123/Reviewer_BzTP"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission18123/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761655573348, "cdate": 1761655573348, "tmdate": 1762927886838, "mdate": 1762927886838, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "InertialAR is a transformer-based, autoregressive framework for 3D molecule generation by (i) canonical tokenization: aligning molecules to an inertial frame and applying a deterministic atom reordering for SE(3) and permutation invariance; (ii) GeoRoPE: a geometry-aware attention that blends rotary embeddings of relative orientation with pairwise distance features; it achieves strong or SOTA stability/validity on QM9 and on the large B3LYP-1M set."}, "soundness": {"value": 2}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "1. The two-step canonicalization: aligning each molecule to an inertial frame with a deterministic sign convention, then applying a deterministic atom reordering removes SE(3) and permutation ambiguities without specialized equivariant networks.\n2. It achieves SOTA or near-SOTA validity/stability on QM9 and GEOM-DRUG and shows big gains on the large B3LYP benchmark"}, "weaknesses": {"value": "1. To pick axis signs, the authors choose a “fourth node” (the atom farthest from the origin) and require it to lie in the first quadrant of the xy plane; this rule unambiguously fixes signs but could flip when the farthest atom changes under small perturbations, i.e., the frame is not continuous [2]. Same situations will happen when principal moments tie, small geometric changes can swap frames and thus token order\n2. The authors does not situate this design within prior work on PCA-based pose selection, graph canonical labeling or alternative symmetry-handling strategies [1][2][3][4].\n3. **Appendix D–F are incomplete**. Appendix E still contains a placeholder like “Will extend this to a more formal way.”, and Appendix F includes unresolved “??” figure references; Appendix D also contains informal notes in the text. Please finalize these sections by replacing placeholders with complete derivations, figures, and cross-references, or move unfinished material to a clearly labeled supplemental.\n\n[1] Frame Averaging for Invariant and Equivariant Network Design. Omri Puny, Matan Atzmon, Heli Ben-Hamu, Ishan Misra, Aditya Grover, Edward J. Smith, Yaron Lipman.\n\n[2] Equivariant Frames and the Impossibility of Continuous Canonicalization. Nadav Dym, Hannah Lawrence, Jonathan W. Siegel.\n\n[3] Equivariance via Minimal Frame Averaging for More Symmetries and Efficiency. Yuchao Lin, Jacob Helwig, Shurui Gui, Shuiwang Ji.\n\n[4] A Canonicalization Perspective on Invariant and Equivariant Learning. George Ma, Yifei Wang, Derek Lim, Stefanie Jegelka, Yisen Wang."}, "questions": {"value": "See weaknesses."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "id9yjFtwEM", "forum": "de4bbZedv3", "replyto": "de4bbZedv3", "signatures": ["ICLR.cc/2026/Conference/Submission18123/Reviewer_woPK"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18123/Reviewer_woPK"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission18123/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761764274874, "cdate": 1761764274874, "tmdate": 1762927886499, "mdate": 1762927886499, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces InertialAR, an autoregressive (AR) model for 3D molecule generation. It addresses two key challenges:\n1. Tokenization: It creates a canonical 1D sequence of atoms by aligning the molecule to its inertial frame (for $SE(3)$ invariance) and then applying a canonical reordering (for permutation invariance).\n2. Hybrid Prediction: It models the hybrid (discrete type, continuous 3D coordinate) token using a hierarchical AR paradigm.vThis involves a new Geometric Rotary Positional Encoding (GeoROPE) to make the attention mechanism geometry-aware and predicts coordinates using a Diffusion Loss, which was found to be superior to direct regression.\n\nThe model achieves state-of-the-art performance on unconditional generation (QM9, Geom-Drug, B3LYP) and significantly outperforms baselines in controllable generation of specific functional groups."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "**Technical Quality**: The GeoROPE architecture is a creative and effective way to inject geometric information into the attention mechanism, combining relative positions (RoPE-3D) and pairwise distances (Nyström) into a single attention score.\n\n**Significance & Performance**: The model demonstrates exceptional performance, not just on standard benchmarks but also on a large-scale dataset (B3LYP) and a highly practical controllable generation task, showing SOTA results across all metrics for the latter."}, "weaknesses": {"value": "**Originality**: The use of a molecule's inertial frame as a canonical reference is a common solution to the $SE(3)$ invariance problem.\n\n**Robustness Not Addressed**: The paper does not discuss the stability of the inertial frame canonicalization. For symmetric molecules (degenerate eigenvalues) or flexible molecules (where small conformational changes could flip the axes), the token sequence could become unstable, which is a significant problem for an AR model.\n\n**Missing Ablation Studies**: The paper proposes several new components (Inertial Frame, RoPE-3D, Nyström, Diffusion Loss) but lacks ablations to test their individual contributions. \n\n**Reproducibility**: Key implementation details are missing, most notably how the Nyström approximation anchor points ($m$ points) are selected, which is critical for implementing GeoROPE."}, "questions": {"value": "1. How do you ensure the inertial frame tokenization is robust? What happens if a small conformational change or molecular symmetry causes the principal axes to flip, resulting in a different canonical sequence?\n2. Could you please quantify the \"poor performance\" of using a simple L2 loss for coordinates? What were the key metrics when the Diffusion Loss was replaced with direct regression? \n3. What are the implementation details for the Nyström anchor points? How many are used ($m$), and how are they selected (e.g., fixed, per-molecule, or sampled)?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "LHDwVct4Yi", "forum": "de4bbZedv3", "replyto": "de4bbZedv3", "signatures": ["ICLR.cc/2026/Conference/Submission18123/Reviewer_kwKk"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18123/Reviewer_kwKk"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission18123/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761962650348, "cdate": 1761962650348, "tmdate": 1762927886004, "mdate": 1762927886004, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes a novel autoregressive generation framework InertinalAR for 3D molecules. Multiple contributions are presented including canonical atom ordering, coordinate mapping with inertial frames, geometric rotary positional encoding in conditional feature extration network. Experiments on unconditional and class-conditional 3D molecule generation show that the performance of InertinalAR is promising."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- This paper proposes a novel 3D molecule generation framework. Some contributions like atom canonical ordering and keep SE(3) invariance by inertial frame based coordinate projection is very useful.\n- Generally the experimental results are good and promising.\n- The writing of this paper is good and clear."}, "weaknesses": {"value": "- Some details need clarification. What is the ordering of eigenvalues in line 186? How ordering by the refined identifiers is done in line 213?\n- A major novelty contribution of this paper is the use of geometric rotary positional encoding (GeoRoPE) together with a transformer architecture as the backbone network. However, no ablation study of this architecture is conducted so it is unclear what is the impact of this architecture on performance. Could we just use a 3D graph neural network or graph transformer model and keep everything else the same? More ablation studies are needed to make this work more solid."}, "questions": {"value": "No additional questions."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "C2E0xbI3Pf", "forum": "de4bbZedv3", "replyto": "de4bbZedv3", "signatures": ["ICLR.cc/2026/Conference/Submission18123/Reviewer_xZB2"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18123/Reviewer_xZB2"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission18123/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761963106172, "cdate": 1761963106172, "tmdate": 1762927885320, "mdate": 1762927885320, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}