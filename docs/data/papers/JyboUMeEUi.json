{"id": "JyboUMeEUi", "number": 6147, "cdate": 1757954614317, "mdate": 1759897932943, "content": {"title": "CardioComposer: Leveraging Differentiable Geometry for Compositional Control of Anatomical Diffusion Models", "abstract": "Generative models of 3D cardiovascular anatomy can synthesize informative structures for clinical research and medical device evaluation, but face a trade-off between geometric controllability and realism. We propose CardioComposer: a programmable, inference-time framework for generating multi-class anatomical label maps based on interpretable ellipsoidal primitives. These primitives represent geometric attributes such as the size, shape, and position of discrete substructures. We specifically develop differentiable measurement functions based on voxel-wise geometric moments, enabling loss-based gradient guidance during diffusion model sampling. We demonstrate that these losses can constrain individual geometric attributes in a disentangled manner and provide compositional control over multiple substructures. Finally, we show that our method is compatible with non-convex substructures, including those with branching or curved features.", "tldr": "We present a novel energy-based guidance framework for imposing a variety of geometric constraints on diffusion models that generate multi-component anatomical structures.", "keywords": ["Diffusion Models", "Computational Geometry", "Anatomy", "Digital Twins", "Diffusion Guidance"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/c0dffa7bbe7a4e42f8626c4b5d14330337780d7d.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper presents a novel framework for imposing geometric constraints models without model retraining. This is achieved by introducing a differentiable geometric loss during inference. The loss aims to match the geometric moments (size, position, and shape) between the predictions and targets. The framework was evaluated on the Totalsegmentator dataset and compared to several baseline methods that integrate the geometric information either explicitly or implicitly."}, "soundness": {"value": 4}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper presents a novel framework for anatomical structure generation that enables flexible control over geometric attributes during inference without requiring retraining, a notable advantage over conventional conditional generative approaches.\n2. The proposed geometric loss formulation is both interpretable and modular, leveraging moment-based constraints to disentangle control over size, shape, and position. The method further supports compositional multi-part control and demonstrates utility in simulation-based downstream tasks.\n3. The authors have shown model's robustness against hyperparameters and non-convex shapes."}, "weaknesses": {"value": "The method introduces a novel formulation in Eq. (4) to define and normalize geometric moments, offering a clear way to separate size, shape, and orientation characteristics. However, the overall idea of combining a Latent Diffusion Model with test-time constraints has been explored in prior works, so the main novelty lies in the specific geometric moment formulation rather than the general framework."}, "questions": {"value": "Good paper with clear practical relevance and a well-motivated clinical application. While it does not introduce major technical innovations, it effectively addresses a real-world problem and demonstrates solid empirical value in the medical field."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "tnhNphuDWs", "forum": "JyboUMeEUi", "replyto": "JyboUMeEUi", "signatures": ["ICLR.cc/2026/Conference/Submission6147/Reviewer_gDx6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6147/Reviewer_gDx6"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission6147/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761925034451, "cdate": 1761925034451, "tmdate": 1762918501809, "mdate": 1762918501809, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes CardioComposer, a 3D method enabling differentiable, geometry-aware control of anatomical diffusion models. The main contribution is to introduce geometric moment-based losses that are differentiable, which can guide sampling to produce anatomically realistic and geometrically controllable multi-class label maps of the heart."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. Using geometric moments as differentiable constraints for guiding diffusion models of anatomy is novel.\n2. The paper presents clear mathematical formulation of 0th, 1st and 2nd order geometric moments.\n3. The paper includes baselines such as explicit and implicit concatenation, cross-attention.\n4. The paper evaluates different combinations of proposed loss as the ablation study."}, "weaknesses": {"value": "1. The experiment is focusing on cardiac structures with limited samples (less than 600 in total). The generalizability and scalability remain concerns.\n2. Are the unconditional latent diffusion models (3D VAE and 3D UNet) trained from scratch?\n3. In the Figure 7, for unconditional generation, why does the implicit fail but the proposed one seems to be able to generate a much more realistic map? Further explanation or more visualization would strengthen this observation."}, "questions": {"value": "Will the code be released to the public?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "lx6jrlqxFx", "forum": "JyboUMeEUi", "replyto": "JyboUMeEUi", "signatures": ["ICLR.cc/2026/Conference/Submission6147/Reviewer_WPU8"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6147/Reviewer_WPU8"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission6147/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761953307277, "cdate": 1761953307277, "tmdate": 1762918501346, "mdate": 1762918501346, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces \"CardioComposer,\" a novel inference-time guidance framework designed to control unconditional diffusion models for the generation of 3D multi-class anatomical segmentations. The primary problem it addresses is the trade-off between geometric controllability and realism in generative models for cardiovascular anatomy, which is a critical component for clinical research and in silico medical device evaluation.\n\nThe core contribution is the development of differentiable measurement functions based on voxel-wise geometric moments. These functions compute interpretable geometric attributes—specifically size (from zeroth-order moments), position (from first-order moments), and shape (from scale-normalized second-order moments)—from the generated label maps. The gradients from a loss function comparing these measured moments to target moments are then used to guide the diffusion sampling process at inference time."}, "soundness": {"value": 4}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1) The core contribution—a flexible, inference-time guidance mechanism based on differentiable geometric moments for 3D multi-class segmentations—is somewhat novel. This method directly tackles a significant bottleneck in the use of generative models for scientific simulations, where interpretable control over specific geometric properties is paramount. The ability to generate \"digital siblings\" for counterfactual simulations is interesting.\n\n2) The paper is well-structured and clearly written. Figures are informative (outstanding), though some are dense. The related work section is comprehensive. The writing is precise.\n\n3) Extensive evaluation: 200 samples per method, 5+ baselines, 3 metric families (morphological, pointcloud, conditional fidelity). Strong ablations: disentanglement, compositional control, guidance weight tuning. Real-world validation: Used to edit patient anatomy for biophysical simulation (RV volume vs. wall displacement), showing causal form-function modeling.\n\n4) The method is technically sound, with a clear formulation of the geometric moment losses (size, position, and scale-normalized shape). The experimental validation is rigorous."}, "weaknesses": {"value": "The authors are commendable for their transparent limitations section. Some weaknesses:\n\n1) The framework relies on weights $\\lambda_i$ for the aggregate loss and a guidance weight $w$. The paper notes $\\lambda_i$ require \"experimental tuning\" and provides the final values in the appendix37. However, the sensitivity to these weights is not explored. How robust is the method to changes in these hyperparameters?\n\n2) The authors rightly admit that the underlying diffusion model can generate topologically incorrect anatomies, which is a critical failure for biophysical simulations. The proposed solution is post-hoc filtering. It is unclear if the proposed geometric guidance affects the rate of these topological errors\n\n3) While framed as general, all experiments are on cardiac data.\n\n4) In Figure 4, while the proposed method  generally maintains high-quality metrics, there appears to be a slight degradation in realism at high guidance weights ($w > 1.5$)"}, "questions": {"value": "1) How sensitive is the method to VAE reconstruction error?\n\n2) Can you control orientation independently of shape?\n\n3) What happens under extreme geometric targets (e.g., 10× mass)?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "b5QQmDk2yZ", "forum": "JyboUMeEUi", "replyto": "JyboUMeEUi", "signatures": ["ICLR.cc/2026/Conference/Submission6147/Reviewer_aon8"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6147/Reviewer_aon8"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission6147/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761979933405, "cdate": 1761979933405, "tmdate": 1762918499905, "mdate": 1762918499905, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "CardioComposer adds a geometric control mechanism to an unconditional diffusion model at inference time, using differentiable moments—volume (0th), centroid (1st), and scale-normalized covariance (2nd)—to control the size, position, and shape of cardiac parts.\nNo retraining is required: each denoising step decodes a segmentation, measures geometry, computes a loss to target values, and backpropagates its gradient to adjust the latent, enabling disentangled and composable control.\nTrained on 596 multi-label cardiac segmentations, the method achieves stable single- and multi-part control, geometric inpainting, and biomechanical simulation compatibility."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1. **Clinical Significance**\nThe paper addresses a clinically relevant issue—how to create anatomically realistic yet controllable 3D cardiac models. \n\n2. **Flexible Post-training Optimization**\nThe proposed inference-time optimization framework is elegant and practical. By introducing differentiable geometric moments as guidance losses, the method allows users to customize geometric targets on demand without retraining or modifying network weights. This design provides an interpretable and lightweight mechanism for controllable shape generation.\n\n3. **Comprehensive Experimental Validation**\nThe experiments are thorough and convincing. They demonstrate geometric controllability across multiple substructures, evaluate both single- and multi-part guidance, and further validate the realism of generated shapes using distributional metrics and biomechanical simulations. Together, these results strongly support the effectiveness and robustness of the proposed approach.\n\n4. **Clarity and Completeness of Presentation**\nThe paper is clearly written and technically detailed."}, "weaknesses": {"value": "1. **Lack of comparison with existing conditional shape generation methods.**\n\nWhile the paper clearly articulates the benefits of inference-time guidance, it does not compare against established conditional generative models trained for geometric control (e.g., de Wilde et al., 2025 (https://arxiv.org/abs/2504.03313); Kadry et al., 2025 (https://www.nature.com/articles/s41746-024-01332-0), A-SDF (https://arxiv.org/abs/2104.07645). Including such baselines would better quantify the extent to which performance or controllability is improved by the proposed guidance relative to conditional training.\n\n2. **Absence of simulated validation data.**\n\nAlthough the authors compute geometric attributes (mass, centroid, covariance) from real cardiac segmentations, the evaluation relies solely on real anatomies. A complementary experiment on simulated or procedurally generated geometries—with known ground-truth attributes—would allow denser and more diverse target sampling, providing clearer evidence of control accuracy, disentanglement, and robustness.\n\n3. **Limited explanation for Figures 6 and 8.**\n\nThe pair-plot visualizations are intriguing but under-explained: it remains unclear which visual trends (e.g., sharper peaks, denser clusters) indicate successful guidance.\n\n\n4. **Code is not available**"}, "questions": {"value": "1. The generation quality appears to depend on the amount of training data available. How large a dataset is required for the diffusion model to achieve stable and realistic shape synthesis?\n\n2. Apart from the 0th- and 1st-order moments, are there other geometric features that could serve as control signals?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "AiLx7GHAhb", "forum": "JyboUMeEUi", "replyto": "JyboUMeEUi", "signatures": ["ICLR.cc/2026/Conference/Submission6147/Reviewer_fX4P"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6147/Reviewer_fX4P"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission6147/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762054221451, "cdate": 1762054221451, "tmdate": 1762918499444, "mdate": 1762918499444, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}