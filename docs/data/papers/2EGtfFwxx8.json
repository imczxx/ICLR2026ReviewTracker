{"id": "2EGtfFwxx8", "number": 18209, "cdate": 1758285175217, "mdate": 1759897119365, "content": {"title": "Differentiable Simulation of Hard Contacts with Soft Gradients for Learning and Control", "abstract": "Contact forces introduce discontinuities into robot dynamics that severely limit the use of simulators for gradient-based optimization. Penalty-based simulators such as MuJoCo, soften contact resolution to enable gradient computation. However, realistically simulating hard contacts requires stiff solver settings, which leads to incorrect simulator gradients when using automatic differentiation. Contrarily, using non-stiff settings strongly increases the sim-to-real gap. We analyze penalty-based simulators to pinpoint why gradients degrade under hard contacts. Building on these insights, we propose DiffMJX, which couples adaptive time integration with penalty-based simulation to substantially improve gradient accuracy. A second challenge is that contact gradients vanish when bodies separate. To address this, we introduce contacts from distance (CFD) which combines penalty-based simulation with straight-through estimation. By applying CFD exclusively in the backward pass, we obtain informative pre-contact gradients while retaining physical realism.", "tldr": "Improve gradients of penalty-based simulators to enable efficient gradient-based optimization with contact-rich robotic systems.", "keywords": ["differentiable simulation", "contact forces", "musculoskeletal control"], "primary_area": "applications to robotics, autonomy, planning", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/6886af2a9f60cc79b6d79a9dff880fc4c0623619.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper attempts to address efficient differentiable simulation under hard contacts, which is beneficial for accelerated learning and control. Traditional MuJoCo’s penalty-based contact resolution methods either (1) provide inaccurate gradients under hard contacts or (2) require excessively small $\\Delta t$ for more accurate gradient estimates, leading to unacceptably slow simulation runtime. Another issue with penalty-based contact resolution methods is uninformative gradients ($\\nabla = 0$), which does not provide any feedback in unrealized contacts (e.g. to steer away from / toward collision).\n\nThe paper proposes two core contributions: (1) combine adaptive time stepping and differentiable collision detection to provide more accurate gradients under hard contacts while keeping simulation efficiency; (2) CFD: simple modification of $d(r)$ and $h(r)$ for small non-zero artificial contact forces in unrealized contact scenarios. Implementation-wise, CFD is applied backward pass only via straight through tricks to maintain forward physics realism. The experiments are comprehensive and validate the main claims in the paper."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1. The problem is interesting with potentially high, practical impacts on accelerated differentiable learning and control, as hard contacts are involved in almost all control problems.\n2. The proposal of adaptive time stepping is well-motivated and novel in the context of accelerated learning and control. Experiments sufficiently show that it helps improve gradient estimate accuracy under hard contacts while maintaining the simulator's computational efficiency. Although CFD is simple, it is well-motivated, has strong empirical performance, and is well-executed with straight through tricks. \n3. The experiments are comprehensive with diverse control tasks (controlled toy setups, on real cube-toss parameter identification, and gradient-based MPC on complex musculoskeletal systems). Comprehensive and through ablation studies on failure modes were included in the appendix."}, "weaknesses": {"value": "1. Limited theoretical analysis of several claims. For example, while empirical results show that adaptive integration improves gradient accuracy, it lacks rigorous theoretical analysis of when and why this approach guarantees correct gradients. The authors can provide theoretical bounds on gradient error as a function of integration tolerance, or at minimum, a more rigorous analysis of when adaptive integration helps.\n2. Many explanations remain at the high level of intuition instead of formal theoretical analysis (e.g. the discussion of Optimize-then-Discretize benefits in gradient convergence). Thorough theoretical analysis of such cases would make the paper stronger."}, "questions": {"value": "1. How sensitive are results to CFD parameters ($w_c$, $d_c$, etc.)? Can you provide ablation studies or guidelines for setting these?\n2. Can you characterize more precisely when CFD helps vs hurts? The paper shows CFD works for directional pushing (billiard, tennis racket deflection) but acknowledges it fails for grasping. What about intermediate manipulation tasks such as pivoting or reorienting objects on a surface?\n3. You mentioned that you smooth the collision detection to make it differentiable in discrete case distinctions. Although some details were provided in the appendix, including some brief formal formulation or implementation details in the main text would be helpful for the readers."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "N/A"}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "R0luHvZ93v", "forum": "2EGtfFwxx8", "replyto": "2EGtfFwxx8", "signatures": ["ICLR.cc/2026/Conference/Submission18209/Reviewer_7rxB"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18209/Reviewer_7rxB"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission18209/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761973790102, "cdate": 1761973790102, "tmdate": 1762927953182, "mdate": 1762927953182, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper addresses one of the core challenges in differentiable physics: producing stable, accurate gradients through intermittent hard contacts such as impacts, frictional sticking, and restitution.\nThe authors first analyze why automatic differentiation in penalty-based engines (e.g., MuJoCo, Brax) produces pathological gradients near contact discontinuities. Together these techniques yield physically faithful forward dynamics and smooth, informative gradients for policy optimization and parameter identification. Experiments include gradient diagnostics on rigid-body impacts, inverse parameter identification, and manipulation policy learning, showing consistent improvements in convergence speed and stability."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The paper addresses a real and unsolved bottleneck—gradient instability under hard contacts.\n\n- The integration with MuJoCo-XLA makes the method directly applicable to a widely used robotics stack.\n\n- The numerical experiments (bouncing-ball, simple manipulator) clearly illustrate gradient discontinuities and the partial improvement achieved by DiffMJX."}, "weaknesses": {"value": "**1.Relation to prior “force-from-distance” work.**\nThe proposed “Contacts From Distance (CFD)” estimator appears conceptually related to earlier “force-from-distance” smoothing used in quasi-dynamic contact models, such as Pang et al. (Global Planning for Contact-Rich Manipulation via Local Smoothing of Quasi-Dynamic Contact Models, arXiv:2206.10787). That paper also introduces continuous, distance-based contact forces that activate before penetration to improve numerical stability.\n\nHowever, it should be clarified whether the current work’s CFD mechanism differs in how gradients are propagated. The cited prior work modifies the forward dynamics to include soft forces, whereas this paper claims a backward-pass estimator that injects pre-contact gradients without changing the forward model. If that is indeed the novelty, it needs to be explicitly contrasted both conceptually and empirically.\n\n**2. CFD stability under multi-contact scenarios unclear.**\nCould the authors elaborate on whether CFD can handle overlapping distance fields or multiple contact pairs? What do you see as a new contribution here by CFD?\n\n**3. More realistic contact-rich scenarios will add value.** It will be great if the authors could showcase multi-fingered robotic in-hand reorientation, or a toy version of this task (see the 2D two-finger task in [1]). Could the authors discuss the advantages and limitations in applying CFD for trajectory optimizations of these tasks?\n\n[1] Pang et al., Global planning for contact-rich manipulation via local smoothing of quasi-dynamic contact models, 2023."}, "questions": {"value": "Please see the weaknesses sections. Thanks!"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "PmTKGipaML", "forum": "2EGtfFwxx8", "replyto": "2EGtfFwxx8", "signatures": ["ICLR.cc/2026/Conference/Submission18209/Reviewer_S6dm"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18209/Reviewer_S6dm"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission18209/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762145533590, "cdate": 1762145533590, "tmdate": 1762927952760, "mdate": 1762927952760, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper addresses issues that exist in using simulator gradients for robot learning. More specifically, it tackles two major issues: (a) the time quantization and discontinuities that happen at contact cause erroneous gradients; and (b) objects that are not in contact have no gradients (even when very close), thus making learning more difficult. For the first problem, this work presents an adaptive-timestep integration method that uses the disagreement between two numeric integrators of different orders to determine whether the step size needs to be reduced. The second issue of no gradients outside of contact is addressed by adding contacts from a distance, but this is avoided in the simulation, as it would yield unrealistic behaviour. Finally, they validate on some toy examples with a bouncing cube and some more realistic applications involving a tendon-driven arm and a ball (with MPC)."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The work addresses very relevant problems in simulators for robotics, and especially for using differentiable simulation to improve training.\n\n- There is a lot of engineering effort under the hood for both the simulator integration and the robot experiments.\n\n- The technical details in the paper are well presented and easy to follow."}, "weaknesses": {"value": "- The variable step size on demand (i.e., during collisions) is a very poorly scaling option. It works well in the very specific cases of dropped objects or a single robot in contact with a ball that the authors present. However, in most applications of RL with multiple (1000s) parallel environments, the number of contacts would cause the simulator to continuously operate at a minimal step size, thereby bogging it down indefinitely.\n\n- The contacts from a distance approach introduced by the authors has been done under various forms as part of loss functions in RL (e.g., for dextrous manipulation [a]), where rewards are given based on distance and not contacts to avoid the discretization problem. The paper itself notes that the gradients are not used in the forward step but only in the backward pass to maintain realism. How these yet-to-be-done contacts are modelled on the gradient side is more of a task-level issue rather than the simulator providing gradients for a non-real physical effect.\n\n[a] Wang, Ruicheng, et al. \"Dexgraspnet: A large-scale robotic dexterous grasp dataset for general objects based on simulation.\" arXiv preprint arXiv:2210.02697 (2022)."}, "questions": {"value": "- In Appendix D, the authors mention that one could reduce the tolerance, but then does this not simply result in the current setup of choosing a fixed step size that is a compromise between accuracy and time? Besides MPC and small-scale applications, where do you foresee the most uses in practice of the variable integration step size?\n\n- How hard is it to tune the gradient computation method for contacts from a distance? And how is this comparable to different loss formulations that exist, where these far-away contacts are added to the MPC/RL problem itself?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "lbgfMUSYzM", "forum": "2EGtfFwxx8", "replyto": "2EGtfFwxx8", "signatures": ["ICLR.cc/2026/Conference/Submission18209/Reviewer_SE5u"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18209/Reviewer_SE5u"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission18209/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762521523840, "cdate": 1762521523840, "tmdate": 1762927952345, "mdate": 1762927952345, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}