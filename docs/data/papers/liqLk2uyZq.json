{"id": "liqLk2uyZq", "number": 11588, "cdate": 1758202195424, "mdate": 1763577030722, "content": {"title": "FlexiFlow: decomposable flow matching for generation of flexible molecular ensemble", "abstract": "Sampling useful three-dimensional molecular structures along with their most favorable conformations is a key challenge in drug discovery. Current state-of-the-art 3D de-novo design flow matching or diffusion-based models are limited to generating a single conformation. However, the conformational landscape of a molecule determines its observable properties and how tightly it is able to bind to a given protein target. By generating a representative set of low-energy conformers, we can more directly assess these properties and potentially improve the ability to generate molecules with desired thermodynamic observables. Towards this aim, we propose \\textit{FlexiFlow}, a novel architecture that extends flow-matching models, allowing for the joint sampling of molecules along with multiple conformations while preserving both equivariance and permutation invariance. We demonstrate the effectiveness of our approach on the QM9 and GEOM Drugs datasets, achieving state-of-the-art results in molecular generation tasks. Our results show that FlexiFlow can generate valid, unstrained, unique, and novel molecules with high fidelity to the training data distribution, while also capturing the conformational diversity of molecules. Moreover, we show that our model can generate conformational ensembles that provide similar coverage to state-of-the-art physics-based methods at a fraction of the inference time. Finally, FlexiFlow can be successfully transferred to the protein-conditioned ligand generation task, even when the dataset contains only static pockets without accompanying conformations.", "tldr": "", "keywords": ["drug discovery", "de novo generation", "flow matching"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/44270f99e7ade8ed48703a5f07e69e265c019581.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This work focuses on the de novo molecular generation task, addressing the limitation of previous methods that generate only a single conformation (i.e., atomic positions) for a generated molecular graph (defined by atom types and bond connectivity). To overcome this limitation, the authors propose jointly sampling a representative conformation for a generated molecular graph—forming a basic 3D molecular structure—together with its corresponding low-energy conformation ensemble, which introduces novelty to the field. The main contribution lies in decomposing the flow to simultaneously handle both a single conformation and a conformation set. The experimental results demonstrate strong performance."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1. The motivation—to generate 3D molecular structures with a representative conformation and its corresponding conformation ensemble—shows a degree of novelty.  \n2. The flow decomposition is clearly presented and supported by solid theoretical reasoning.  \n3. The work preserves equivariance and provides detailed theoretical derivations to substantiate this property.  \n4. The model performs well on both the QM9 and Drugs datasets; however, the validity on Drugs appears relatively low and may warrant further discussion."}, "weaknesses": {"value": "1. Contribution 1, described as “leveraging conditional independence to decompose the flow-matching objective and enabling the simultaneous generation of **a graph** and **representative conformers**,” is somewhat confusing. The purpose of this decomposition is to generate both a single conformation $x$ and a set $S$, but the generated graph itself is derived from generated nodes and edges. Typically, we refer to the 2D topological structure as a molecular graph, which does not include the 3D positional coordinates $x$.\n1. The *Inference* section and *Algorithm 1* should be improved. The current version does not seem to be well aligned with the density defined in Eq. (2), $p_t(x, S)$, which represents the generation of a representative conformation $x$ for a molecular graph and a conformation ensemble $S = \\{y_i\\}_{i=1}^m$. However,  *Algorithm 1* only formulates $p_t(x, y)$. Providing more detailed descriptions and algorithmic formulations that distinguish between “different molecular graphs with their conformations” and “the same molecular graph with multiple conformations” would help improve clarity.\n1. No analysis or comparison of inference efficiency is provided. The number of function evaluations (NFE) does not seem sufficient to demonstrate good inference speed, especially if the forward process is computationally expensive."}, "questions": {"value": "1. Why is the conformation closest to the average structure chosen as the representative conformation, $x \\in S$? Does this choice have any chemical significance? Would alternative definitions, such as selecting the lowest-energy structure within $S$, be more meaningful? \n2. In Tables 1 and 2, it is unclear which specific conformation is chosen for evaluation — the representative one ($x$) or one of the conformations in the ensemble ($y \\in S$)?\n3. During sampling, how is the number of atoms determined?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "RC0C5JmAvu", "forum": "liqLk2uyZq", "replyto": "liqLk2uyZq", "signatures": ["ICLR.cc/2026/Conference/Submission11588/Reviewer_saME"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11588/Reviewer_saME"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission11588/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761738882553, "cdate": 1761738882553, "tmdate": 1762922671607, "mdate": 1762922671607, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents FlexiFlow, a flow-matching molecular generation algorithm aimed at addressing a current gap in 3D molecular generation algorithms, namely that they do not produce multiple relevant conformers of the generated molecule, which is critical for applications like protein docking and optimizing protein binding affinity. Here, the authors leverages the conditional independence of the flow matching objective to handle two sets of coordinates, one for the molecule itself and one for its conformers, preserving equivariance. By defining a global flow as a composition of independent flows, each of which represent a plausible molecular conformation, FlexiFlow is able to use these independent flows to simultaneously generate a set of independent low-energy conformers. The authors demonstrate that FlexiFlow achieves SOTA performance on the QM9 dataset across all four properties, and for all properties but essentially validity on the GEOM Drugs dataset. The paper dives into the energy distribution of the generated conformers, showing that the generated conformers are in fact diverse, even after minimization. Authors also show that generated conformers cover the space of high-quality low energy conformers with roughly the same efficacy as standard methods like RDKit."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "The method presented, FlexiFlow, is an innovative variant of standard flow matching methods, and exploits an interesting conditional independence of the flow matching objective to augment the model in a meaningful way. The theory behind the method, as well as the theoretical claims, are established well by the authors. It is promising to see this model achieve SOTA accuracy on QM9 and for several properties of GEOM-Drugs, and the exploration of the quality and diversity of the generated conformers was thorough."}, "weaknesses": {"value": "The paper lacks a bit of clarity around it's motivation. The authors claim that generation with conformers is an open problem to address, however there isn't a clear benefit to FlexiFlow over another molecular generation method followed sequentially by a conformer generation algorithm. If there is a significant advantage here, please do elaborate why the concurrent generation is particularly beneficial. The clarity of presentation of some of the results could also be improved."}, "questions": {"value": "Do we have a sense for why the FlexiFlow validity score for GeomDrugs is low?\n\nI unfortunately struggled to understand the Figures 3B and C and Figure 4 given the accompanying text. Please clarify exactly what the figures demonstrate and how the results should be interpreted.\n\nThe conditional molecular generation result for protein binding is interesting, but again, the clarity of the description of that result could be improved.\n\nAlso, the sentence \"However, current models typically produce only a single conformer\" repeats the phrase \"limiting conformational diversity critical for drug discovery.\""}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "zTfrYB5cKg", "forum": "liqLk2uyZq", "replyto": "liqLk2uyZq", "signatures": ["ICLR.cc/2026/Conference/Submission11588/Reviewer_wjsT"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11588/Reviewer_wjsT"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission11588/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761869405384, "cdate": 1761869405384, "tmdate": 1762922671083, "mdate": 1762922671083, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes FlexiFlow, a flow matching model designed to reconstruct three-dimensional molecular conformations from two-dimensional molecular graphs. Existing methods are often limited to generating a single conformation, a constraint that FlexiFlow overcomes through two key innovations: (1) It leverages conditional independence to factorize the flow matching objective, enabling the generation of diverse conformation sets; (2) It concurrently processes the coordinate information of both a representative conformation and other conformations while preserving equivariance during their interaction.\nExperimental results demonstrate that FlexiFlow achieves superior overall performance on the QM9 and GEOM Drugs datasets compared to several baseline models, including SemlaFlow. Furthermore, the model generates molecular conformations with a high degree of novelty."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. The model innovatively employs conditional independence to factorize the flow matching objective, allowing it to generate multiple conformations per molecule and directly addressing the limitation of single-conformation output in existing methods.\n2. The architecture effectively manages the interaction between a representative conformation and other conformations while maintaining equivariance, a design that adheres to the physical constraints of molecular systems.\n3. The model's performance is rigorously validated on multiple standard benchmarks, with additional evidence demonstrating its ability to generate novel conformations.\n4. This work provides a more flexible and comprehensive generative framework, offering significant potential for applications in drug design."}, "weaknesses": {"value": "1. The related work section lacks depth. It primarily emphasizes the motivation for FlexiFlow but fails to detail the core challenges and specific innovations of the proposed model, such as the use of conditional independence for objective factorization.\n2. The model diagram is inadequately presented. The separation of the architecture across Figures 1 and 2 creates a disjointed narrative. Moreover, Figure 2 does not clearly illustrate the key differences between FlexiFlow and the baseline model it improves upon.\n3. The methodology section is poorly organized. The content is not partitioned accurately according to the model's components, and as a result, the core innovations are not clearly highlighted."}, "questions": {"value": "1. The \"Related Work\" section should be expanded to more precisely articulate the core challenges in multi-conformation generation and to explicitly delineate how FlexiFlow's design, particularly its factorization of the flow matching objective, addresses these challenges.\n2. To enhance clarity, Figures 1 and 2 should be merged into a unified model diagram. Furthermore, Figure 2 should use visual cues like color coding or dashed boxes to explicitly distinguish the architectural improvements of FlexiFlow from the baseline model, SemlaFlow.\n3. The \"Method\" section should be reorganized to align with the key components of the FlexiFlow architecture. Greater emphasis and detail should be placed on the descriptions of the novel aspects of the model."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "Ug90CULrWv", "forum": "liqLk2uyZq", "replyto": "liqLk2uyZq", "signatures": ["ICLR.cc/2026/Conference/Submission11588/Reviewer_LbWw"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11588/Reviewer_LbWw"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission11588/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761877542359, "cdate": 1761877542359, "tmdate": 1762922670619, "mdate": 1762922670619, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper propose to train a flow-matching model to sample multiple conformations, preserving equivariance and permutation invaraince. Experiments are validate on Qm9 and GEOM Drugs dataset for molecule generation, along with ligand pose generation."}, "soundness": {"value": 2}, "presentation": {"value": 1}, "contribution": {"value": 1}, "strengths": {"value": "1. Molecule generation (Significance)\n\nFlexiFlow shows competitive performance than prior works, shown in Table 1 and Table 2.\n\n2. Ligand pose generation (Significance)\n\nQualitative results on ligand pose generation shows better performance than the given data. A performance table along with figure 5 would strengthen the paper more."}, "weaknesses": {"value": "1. Other data modality \n    \nWhile the application of other data modalities, such as images, is mentioned in the introduction, it does not appear in the main paper and the appendix only. It would have been better if there was a short result also in the main paper. Alternatively, the authors could highlight the protein conditioning experiments in the introduction.\n    \n2. Methodology - training on a set of vectors\n\nThe main purpose of this method is to generate diverse conformers given a molecule. It seems similar to the line of research related to Boltzmann generators [1], but not considering the Boltzmann distribution in the sampling process. Could the authors clarify this point?\n\n3. Diverse conformer generation (Section 5.2)\n\nThe authors claim the RMSD between conformers after energy minimization indicates that the conformers tend to locate in different energy minima. However, I think it is a bit of a rush to conclude this from Figure 3. The authors should also give the RMSD between conformers from the dataset, i.e., the threshold RMSD for saying that the conformers are really different conformers.\n\nFurthermore, a qualitative evaluation with visualization would be great to support the claim, along with figures 10-12 in the appendix. For example, in the line of research generating the Boltzmann distribution [1], the molecule Alanine Dipeptide, consisting of 22 molecules, is commonly used as a synthetic example. On top of a TICA plot, plotting the conformers' location would show whether the method actually generates diverse conformations.\n\n4. Normalized energy (Section 5.2)\n\nI am confused about what this section is trying to claim. Since the x-axis in plots are the top-$k$ molecules ranked by energy, the observation that the low-energy conformers within the top 30% seems obvious (please tell me what I am missing). Again, I think the authors should give a threshold on the mean energy to say it is low, and reference for it. Is it simply considered stable if the mean energy is negative?\nAlso, the results on mean energy according to the NFE (number of inference steps) seem interesting. As more inference steps are done, the mean energy of molecules is improved for some molecules while downgrading others. Could the authors provide more details on this?\n\n[1] [Boltzmann generators: Sampling equilibrium states of many-body systems with deep learning](https://www.science.org/doi/abs/10.1126/science.aaw1147)\n\nMinor \n\n- Overall, the parentheses for reference and authors are not consistent\n- row 51 - “limiting conformation diversity critical for drug discovery” repeated twice\n- Figure 1 - not referenced in the main paper\n- row 100 - add definition of x\n- row 185 - atom and charge → atom and charge types\n- row 186 n → m?\n- row 292 wrong citation for EDM, should be “Hoogebom et al, 2022” Equivariant Diffusion for Molecule Generation in 3D. Other citations on EDM seem right.\n- Table 1 caption: NFE definition missing, only in Table 2\n- Table 1, Table 2: adding a column for the bonds inferred source might be better, along with the explanation in the caption\n- row 374 - sentences sound a bit odd, Tables 1 and 2 are noticeable → Tables 1 and 2, it is noticeable\n- row 402 - figure caption missing"}, "questions": {"value": "1. Training loss (Section 4.2.1)\n\nWhile I understood the conditional flow matching for diverse conformers in equation 9, I am confused with the training loss introduced in line 268. So far, I understood that the model is trained with loss computed between the generated samples and ground truth data, without flow matching loss for computing the conditional vector field. Or is the two loss used together? Then, for every training data, the model produces a molecule structure generation and compare with the ground truth? In this case, does it use tricks to jump form the prior distribution to the conformer generation for efficiency?\n\n2. Training epochs\n\nOnly a minor epochs of 4 were used on GEOM-Drugs, does this really improve the model performance? Is there any metrics to compare after finishing QM9 training and additionally training on the GEOM-Drugs?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "he7YosCjrf", "forum": "liqLk2uyZq", "replyto": "liqLk2uyZq", "signatures": ["ICLR.cc/2026/Conference/Submission11588/Reviewer_czdL"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11588/Reviewer_czdL"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission11588/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761878194696, "cdate": 1761878194696, "tmdate": 1762922669858, "mdate": 1762922669858, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}