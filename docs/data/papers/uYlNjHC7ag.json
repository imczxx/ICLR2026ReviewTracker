{"id": "uYlNjHC7ag", "number": 4771, "cdate": 1757763470718, "mdate": 1759898014508, "content": {"title": "Hierarchical Multi-Scale Molecular Conformer Generation with Structural Awareness", "abstract": "Molecular conformer generation is a fundamental task for drug discovery and material design. Although deep generative models have progressed in this area, existing methods often overlook the hierarchical structural organization inherent to molecules, leading to poor-quality generated conformers. To address this challenge, we demonstrate that capturing the spatial arrangement of key substructures, such as scaffolds, is essential, as they serve as anchors that define the overall molecular distribution. In this paper, we propose a hierarchical multi-scale molecular conformer generation framework (MSGEN), designed to enhance key substructure awareness by leveraging spatially informed guidance. Our framework initiates the generation process from coarse-grained key substructures, progressively refining the conformer by utilizing these coarser-scale structures as conditional guidance for subsequent finer-scale stages. To bridge scale discrepancies between stages, we introduce a molecular upsampling technique that aligns the structural scales, ensuring smooth propagation of geometric guidance. Extensive experiments on standard benchmarks demonstrate that our framework integrates seamlessly with a wide range of existing molecular generative models and consistently generates more stable and chemically plausible molecular conformers.", "tldr": "", "keywords": ["Molecular conformer generation", "Generative models"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/3955e33cb7e5facb4b5bea1705e19fd7a172ad8a.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper introduces MSGEN, a hierarchical multi-stage framework for molecular conformer generation. The core idea is to generate molecular structures in a coarse-to-fine manner—first producing coarse substructures such as rigid scaffolds or heavy-atom backbones, and then refining them into full-atom conformations. Each stage is trained independently using a diffusion-based model, and the coarse-level geometry is passed to the next stage via an upsampling-based conditioning module.\n\nThe authors claim that this hierarchical design improves structural awareness, stabilizes generation, and produces more chemically valid conformers across standard benchmarks (GEOM-QM9 and GEOM-Drugs). Extensive experiments are presented across multiple backbone models (GeoDiff, ConfGF, ET-Flow, EBD), showing quantitative improvements in coverage (COV) and RMSD (MAT) metrics, as well as minor gains in ensemble property prediction.\n\nOverall, the paper proposes a conceptually clear extension of existing diffusion-based conformer generation frameworks by introducing multi-stage conditioning, with an aim to better preserve molecular substructures and enhance geometric fidelity."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 1}, "strengths": {"value": "- **Clear Motivation and Formulation:**\n    \n    The motivation to introduce hierarchical structure into conformer generation is logical and clearly explained. The paper provides an organized mathematical formulation and schematic overview (Fig. 2) that makes the proposed pipeline easy to follow.\n    \n- **Compatibility with Existing Diffusion Models:**\n    \n    MSGEN is implemented as a general plug-in framework that can be attached to various diffusion or flow-based backbones (e.g., GeoDiff, ConfGF, ET-Flow). This design flexibility increases the practical usability of the method.\n    \n- **Comprehensive Experimental Coverage:**\n    \n    The authors evaluate their approach on multiple datasets (GEOM-QM9, GEOM-Drugs) and across different base architectures. \n    \n- **Empirical Consistency Across Models:**\n    \n    The hierarchical conditioning leads to modest but consistent improvements over several backbones, suggesting that the framework is stable and reproducible."}, "weaknesses": {"value": "**Point 1. Ambiguity in Stage-1 Scaffold Arrangement**\n\nThe first stage determines the spatial arrangement of isolated scaffolds (Figure 2) without knowledge of the full molecular context (e.g., linker length or flexibility). This arrangement may dominate the final conformation but cannot adapt once the subsequent stages add connecting atoms.\n\nConsequently, the hierarchical formulation appears somewhat unsmooth, and it remains unclear whether this early arrangement can be corrected or whether it meaningfully affects overall generation quality.\n\n**Point 2. Unfair Comparison and Step-Dependent Behavior**\n\nThe reported improvements may partially stem from the increased number of diffusion steps rather than from the hierarchical design itself. While the appendix (Table 13) includes equal-total-steps results, the main text does not, preventing fair comparison.\n\nMoreover, GeoDiff + MSGEN with 5 k steps outperforms the 10 k-step version in recall (comparing Table 5 and Table 13), suggesting inconsistent behavior that is neither analyzed nor explained.\n\n**Point 3. Limited Informativeness of the Upsampling Scheme**\n\nThe upsampling process simply places new atoms randomly around their topological neighbors. Since these coordinates are only used as conditioning input, it is unclear what meaningful geometric information they (newly added atoms) provide. If the network must relearn local geometry from scratch, the added step contributes little beyond stochastic initialization.\n\n**Point 4. Limited Generality and Lack of Conceptual Novelty**\n\nThe hierarchical coarse-to-fine paradigm is well-established in biomolecular modeling. Diffusion-based protein generators (e.g., RFdiffusion, Chroma) already generate backbones first and refine them via side-chain packing or relaxation, while hydrogens are routinely added in post-processing. Therefore, separating hydrogens or rigid scaffolds into multiple stages offers little conceptual advancement. The independence of stage-wise training is also not unique—it parallels conventional coarse-to-fine pipelines widely used in structural biology.\n\n**Point 5. Unconvincing Energy-Based Evaluation**\n\nThe task of conformer generation is to recover physically valid ensembles, not to discover novel coordinates. Hence, energetic fidelity is central to evaluation. Yet the proposed method shows larger energy errors than comparable add-on methods (such as Woo et al. [1]), which operates on the same dataset. Although ET-Flow uses a different dataset, its much lower energy errors (0.18 / 0.02 kcal/mol) highlight the expected accuracy. Overall, MSGEN does not convincingly improve energetic realism relative to recent baselines.\n\n[1] Woo, J., Kim, S., Kim, J. H., & Kim, W. Y. (2024). Riemannian Denoising Score Matching for Molecular Structure Optimization with Accurate Energy. arXiv preprint arXiv:2411.19769."}, "questions": {"value": "**Point 1. Scaffold Arrangement Correction:**\n\nHow is the relative arrangement of scaffolds in stage 1 adjusted once the full molecular context becomes available? Is there any mechanism allowing later stages to reposition or re-orient scaffolds when linkers are longer or more flexible than expected?\n\n**Point 2. Fair Comparison and Step Allocation:**\n\nCould you provide all main results under the *equal-total-steps* setting? Also, how were the diffusion steps allocated between stages, and why does the 5 k-step version yield higher recall than 10 k?\n\n**Point 3. Information Content of Upsampling:**\n\nWhat specific geometric information do the upsampled atom positions convey? Have you tested simpler or physically guided alternatives (e.g., random initialization, distance-geometry placement, or short MM relaxation) to quantify their effect?\n\n**Point 4. Novelty Beyond Coarse-to-Fine Tradition:**\n\nIn what sense does MSGEN offer conceptual or methodological advances beyond existing hierarchical generation schemes widely used in protein modeling? Is there any plan to automate hierarchy discovery or to demonstrate benefits in domains where coarse-to-fine design is already standard?\n\n**Point 5. Energy-Based Evaluation:**\n\nHow were energy metrics in Table 3 computed, and can you include a direct comparison with SOTA models under identical settings?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "LhNbcBVO7T", "forum": "uYlNjHC7ag", "replyto": "uYlNjHC7ag", "signatures": ["ICLR.cc/2026/Conference/Submission4771/Reviewer_HeM6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4771/Reviewer_HeM6"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission4771/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761742114080, "cdate": 1761742114080, "tmdate": 1762917563441, "mdate": 1762917563441, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This work introduces MSGEN, a hierarchical multi-stage diffusion framework for molecular conformer generation that explicitly models chemical geometry across multiple spatial resolutions. MSGEN decomposes the molecular generation process into a coarse-grained diffusion stage and a fine-grained diffusion stage conditioned on the former, allowing for better-informed generation conditioned on structural geometry. Empirical evaluations demonstrate that this hierarchical approach significantly improves geometric accuracy, structural validity, and diversity over single-scale baselines, and that MSGEN represents a flexible extension for improving existing diffusion models."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The work additionally provides a motivating study evaluating the performance gains achieved via geometric structural conditioning in conformer generation. \n2. The approach outperforms all baselines on conformer generation metrics, and the authors further demonstrate that the method outperforms GeoDiff alone using the same number of total diffusion steps, positioning MSGEN as a flexible extension for existing diffusion-based conformer generators. GeoDiff + MSGEN is also faster at sampling time than GeoDiff alone.\n3. The authors justify novel developments and implementation details, including conditional augmentation, molecular upsampling, and 2-stage step allocation with rigorous ablations."}, "weaknesses": {"value": "1. The model requires different parameter sets for each stage in the molecular generation, meaning that model size scales linearly with the number of stages. For a more meaningful comparison, it may be best to scale the benchmark models to a proportional parameter count increase.\n2. Regarding the 2-stage framework adopted in the work's main experimental results, the use of anchor-based upsampling to place hydrogens given the heavy-atom backbone seems somewhat unnecessary. Wouldn't inferring their positions instead using any generic toolkit (e.g. RDKit, and perhaps adding some Gaussian perturbation) provide a stronger prior for the second stage?"}, "questions": {"value": "1. In table 5, are all methods also performed with the same total number of steps?\n2. Would it be possible to train on all stages with a shared backbone that receives the stage $k$ as additional conditioning information? Would this hurt performance significantly?\n3. The structural conditioning enabled by a 2-step generation process, starting with the backbone, seems to play a role somewhat similar to self-conditioning (see reference for implementation example), where the model conditions on its own ground-truth predictions. Do any of the baselines implement a similar ground-truth prediction conditioning mechanism? If not, it may be worthwhile to compare MSGEN to a baseline equipped with it.\n\nWatson, J.L., Juergens, D., Bennett, N.R. et al. De novo design of protein structure and function with RFdiffusion. Nature 620, 1089–1100 (2023). https://doi.org/10.1038/s41586-023-06415-8"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "412s0XJYGf", "forum": "uYlNjHC7ag", "replyto": "uYlNjHC7ag", "signatures": ["ICLR.cc/2026/Conference/Submission4771/Reviewer_P6Zq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4771/Reviewer_P6Zq"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission4771/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761788251877, "cdate": 1761788251877, "tmdate": 1762917563054, "mdate": 1762917563054, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces MSGEN, a novel hierarchical multi-scale framework for 3D molecular conformer generation. The authors posit that existing deep generative models often fail by overlooking the inherent hierarchical structure of molecules, where key substructures like scaffolds act as anchors for the overall geometry. MSGEN addresses this by generating conformers in a coarse-to-fine process, first generating a coarse-grained structure and then using it as conditional guidance for subsequent, finer-scale stages. The authors demonstrate that this framework can be integrated with a wide range of existing generative models, consistently enhancing their ability to produce more stable, accurate, and chemically plausible conformers, especially for complex drug-like molecules."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. **Chemically-Grounded Motivation:** The paper's premise is strongly rooted in chemical principles. The preliminary study (Section 3) provides excellent justification by showing that a model provided with ground-truth geometric guidance (the heavy-atom backbone) dramatically outperforms other methods, confirming that substructure awareness is critical.\n\n2. **Novel and Necessary Technical Contributions:** The framework introduces two clever solutions to problems specific to this domain, e.g., Molecular Upsampling and Conditional Augmentation, which I find to be novel and reasonable.\n\n\n3. **8Thorough and Rigorous Experimentation**: The paper is supported by a comprehensive set of evaluations: Geometric and Chemical Evaluation, Generalization, Scalability. The evaluation is not limited to geometric metrics: The authors show that MSGEN-enhanced models produce conformers with lower (better) mean absolute errors on calculated chemical properties like energy and the HOMO-LUMO gap, indicating the generated structures are more physically realistic."}, "weaknesses": {"value": "1. **Potential for Error Propagation:** As with any hierarchical system, errors from the initial coarse stage can be passed on and potentially amplified by the subsequent fine-grained stages. The paper's failure case analysis (Appendix G.3) acknowledges this, suggesting that for highly flexible molecules, small deviations in positional guidance may lead to misaligned ring orientations. Though they argue that this may be raised by GeoDiff, empirical evidence with other backbone models are not provided."}, "questions": {"value": "1. Can you show that MSGEN combined with other backbone models can solve (to some extent) Weakness 1?\n\n2. Did you examine different design choices of molecule upsampling? Current design could be heuristic."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "mAWclhsCH1", "forum": "uYlNjHC7ag", "replyto": "uYlNjHC7ag", "signatures": ["ICLR.cc/2026/Conference/Submission4771/Reviewer_iJvk"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4771/Reviewer_iJvk"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission4771/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761917134939, "cdate": 1761917134939, "tmdate": 1762917562627, "mdate": 1762917562627, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This work propose a hierarchy molecule generation method. It first generate scaffold, than intermediate structure, and final full molecules. Each stages generations is upsampled and guide the generation of the next stage. Experiments and ablation studies on drug dataset reveals the effectiveness of the method."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. Clear illustration of the method. Figure 1 shows 3 stages in the hierarchy. Figure 2 shows generation process in each stage and upsampling process between stages. Notations are also clearly defined in Section 3, 4.\n2. Strong experimental results. Table 2,3,4 shows significantly better score than previous generative models. Table 5 further shows that the hierarchical generation strategy can improve performance of different basemodels."}, "weaknesses": {"value": "1. Missing related work. Similar to this work, which split the whole generation process into different stages, [1] also propose a hierarchical method. It first generate global representation, and then use the global representation as guidance to generate the full molecule. It also achieves good performance on Drug dataset. Therefore, it is necessary to compare hierarchy design and experimental performane between this work and [1].\n2. 3 stages needs 3 times inference time and parameters compared to vanilla 1 stage model with the same model size and diffusion inference strategy. Is the comparison with baseline conducted under fair setting? I think the experiments should keep the whole model size, total training time (controlled by training steps), and total inference time (controlled by diffusion steps) similar to the strongest baseline. \n\n\n[1] Zian Li, Cai Zhou, Xiyuan Wang, Xingang Peng, Muhan Zhang, Geometric Representation Condition Improves Equivariant Molecule Generation, ICML 2025."}, "questions": {"value": "1. The three stage design are largely by heuristic rather than theoretical justification. Therefore, more empirical results should be provided to justify the reason for the hierarchy. Can we design finer hierarchy with more stages? Is there any alternative hierarchy tried?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "6Fy03C1J82", "forum": "uYlNjHC7ag", "replyto": "uYlNjHC7ag", "signatures": ["ICLR.cc/2026/Conference/Submission4771/Reviewer_6BnT"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission4771/Reviewer_6BnT"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission4771/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761991897021, "cdate": 1761991897021, "tmdate": 1762917562284, "mdate": 1762917562284, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}