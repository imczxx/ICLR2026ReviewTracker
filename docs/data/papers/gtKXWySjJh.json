{"id": "gtKXWySjJh", "number": 3084, "cdate": 1757329936493, "mdate": 1763644721447, "content": {"title": "ExMAG: Learning of Maximally Ancestral Graphs", "abstract": "In mixed graphs, there are both directed and undirected edges. An extension of acyclicity to this mixed-graph setting is known as maximally ancestral graphs. This extension is of considerable interest in causal learning in the presence of confounders. There, directed edges represent a clear direction of causality, while undirected edges represent confounding.\n\nWe propose a score-based branch-and-cut algorithm for learning maximally ancestral graphs. The algorithm produces more accurate results than state-of-the-art methods, while being faster to run on small and medium-sized synthetic instances.", "tldr": "A novel score-based learning algorithm for learning maximally ancestral graphs outperforms the state of the art on modest instances (up to 25 vertices).", "keywords": ["causal models; maximally ancestral graphs"], "primary_area": "causal reasoning", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/eb4adee3f81c37781e0dd7a0014f61823b0e2690.pdf", "supplementary_material": "/attachment/542a8b5c37d25ef18c396c263c224cf042ab2d2c.zip"}, "replies": [{"content": {"summary": {"value": "The paper proposes a score-based causal discovery algorithm for learning maximal ancestral graphs (MAGs) based on mixed integer quadratic programming, which relies on a penalized least squares loss assuming linear dependencies. To ensure that the learned graph is a MAG, separation routines are used that detect (almost) directed cycles and inducing paths. It is claimed that the proposed methods yield favorable results on synthetic data sets compared to other methods."}, "soundness": {"value": 1}, "presentation": {"value": 1}, "contribution": {"value": 1}, "strengths": {"value": "Score-based causal discovery is an important topic and in particular for learning of MAGs it is underexplored (even though exact and heuristic algorithms exist). The paper tackles the problem with quadratic programming by assuming linear dependencies and working with a least squares based loss function, which is a novel idea in this specific setting."}, "weaknesses": {"value": "The core weaknesses of the paper are its missing rigor and the overall poor presentation.\n\n**Missing rigor in the score function:**\nAs far as I can tell, the score function (4) is proposed ad hoc and without any clear derivation or reason why the graph optimizing this function should (asymptotically) coincide with the underlying causal structure. Even more, the proposed score is based on the least squares loss, which in the context of DAG learning has been observed to be consistent only under an equal variance assumption and is generally susceptible to variable scaling. The paper should also emphasize earlier in the paper that linear dependencies are assumed (unless I missed something, this is not mentioned before page 5).\n\n**Presentation:**\nThe presentation of the paper is lacking in many regards. Apart from typos, there are questionable statements, which at the very least confuse the reader:\n- Directly in the abstract: \"In mixed graphs, there are both directed and undirected edges. An extensions [...] to this setting is known as maximally ancestral graphs. [...] the undirected edges represent confounding.\", only later it is clarified that the undirected edges refer to bidirected edges\n- In the first paragraph \"Dynamic Bayesian networks (DBN) are a popular model where a DAG represents causal relationships. The key challenge in learning DBNs is confounding.\", with large parts of the paper then talking about DAGs and MAGs without the time series setting that DBNs address.\n- On the second page \"MAGs can represent feedback loops\", which is simply a false statement.\n\nThe introduction to MAGs in section 2 lacks rigor and is also hard-to-follow for readers not already familiar with the topic. As an example consider the treatment of inducing paths, which are (i) defined incorrectly with regard to some conditioning set Z (ii) based on being \"blocked by conditioning on Z\", a notion that is never introduced anywhere (the expert reader of course still can infer what is likely meant) and (iii) are used in the algorithm to certify that a graph is a MAG without any discussion how induced paths are related to MAGs (indeed condition (i) in line 161 corresponds to no induced path existing between nonadjacent nodes, which is however not mentioned). Similar gaps exist in many places in the paper.\n\n**Novelty:**\nSeparation routines that ensure the absence of almost directed paths are not novel and were also discussed in Chen et al. (2021). The routine for identifying inducing paths may be novel in the context of learning MAGs with an integer programming formulation, but detecting inducing paths has been generally discussed before in the literature, see for example (Wienöbst et al., A new constructive criterion for Markov equivalence of MAGs, Section 7) remarking that detecting inducing path takes time O(n^2 * m) for graphs with n variables and m edges. More generally, using quadratic programming for causal discovery with linear dependencies and a least-squares loss, while novel for MAGs, has been proposed in earlier work (Rytir et al. 2024) and this paper is an iterative extension of that framework.\n\n**Simulations:**\nThe paper compares the proposed algorithm against other methods such as FCI using the SHD as metric. It is not mentioned how this is done fairly, with the FCI algorithm returning a PAG (a different graph type) and ExMAG returning a MAG. After looking at the code, it appears that for comparison the evaluation script only takes the directed and bidirected edges of the PAG into account, simply dropping all other edges. Hence, the simulation results need to be fundamentally questioned."}, "questions": {"value": "**Questions**\n\n1. Can you connect the score function (4) to the models proposed in equation (2) and (3)? Are there theoretical guarantees that the score function (asymptotically) identifies the MAG of the underlying causal structure?\n\n2. In Figure 1 you show that ExMAG returns the graph G <-> A. Indeed, from a theoretical standpoint, both G <-> A and G -> A (as well as G <- A) are Markov equivalent and thus all explain the data equally well. Can you clarify why G <-> A is preferred by the algorithm here and what assumptions justify this?\n\n3. SHD comparing the PAG returned by FCI with the MAG returned by ExMAG:\nHow do you do the comparison between the two graph types? The code below suggests that all but the directed or bidirected edges are dropped. Can you clarify whether that is the case?\n```\n    W_est = np.zeros((n, n))\n    Wbi = np.zeros((n, n))\n    for i in range(n):\n        for j in range(n):\n            if i == j:\n                continue\n            # i --> j\n            if graph.graph[j,i] == 1 and graph.graph[i,j] == -1:\n                W_est[i,j] = 1\n            elif graph.graph[j,i] == 1 and graph.graph[i,j] == 1:\n                Wbi[i,j] = 1\n\n    return W_est, Wbi\n```\n\n\n\n**Suggestions:**\n\n1. Please ensure a consistent citation style (quite often the parentheses are missing, such as \"...causal learning Schölkopf & von Kügelgen (2022)\" in line 023).\n\n2. In line 393, it sounds like bow-free graphs are a subset of MAGs. All MAGs are bow-free. \n\n3. Please check carefully for typos. Here are just a few I stumbled over:\n- line 049: no space before \"(Bühlmann...)\"\n- line 088: \"Dissertation Hu (2023)\"?\n- line 113: \"in *the* supplementary materials\"\n- line 131: \"ancestorsof\"\n- line 150: \"if *it* is contained\" (also note here that non-overlapping path may not be a well-known term and that the \"mathematical form\" describes not a single collider but all with u as center node)\n- line 194: \"*Connection* to Causality\"\n- line 218: \"is *the* lq norm\"\n- line 322: \"become *a* MAG\""}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 0}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "yBCU2cL7cp", "forum": "gtKXWySjJh", "replyto": "gtKXWySjJh", "signatures": ["ICLR.cc/2026/Conference/Submission3084/Reviewer_1v33"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission3084/Reviewer_1v33"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission3084/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761316439187, "cdate": 1761316439187, "tmdate": 1762916544896, "mdate": 1762916544896, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper investigates the issue of score-based causal discovery of maximal ancestral graphs (MAGs). The authors focus on a parametric family of causal models that consist of linear functions with non-linear components for unobserved confounders. Based on these parametric assumptions, they define a score function to evaluate how well a causal graph fits the observed data. Specifically, this score function uses the standard Lp-norm distance, incorporating additional regularization terms that penalize graph complexity. To ensure that the algorithm favors MAGs, the authors translate the inducing-path constraints of MAGs into integer constraints. As a result, the structural learning problem is transformed into a mixed integer quadratic program. Finally, simulations were conducted to validate the proposed algorithms."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "The organization of this paper is generally clear. This paper studies an exciting problem in causal discovery for MAGs with unobserved confounders. Popular score-based methods focus on Markovian causal graphs without unobserved confounders. Additionally, the inequality constraints enforcing the inducing paths are novel."}, "weaknesses": {"value": "- The choice of the Lp-norm as the score function is intriguing. Typically, the design of the score function derives from approximating the free Bayes energy. For Markovian causal models without unobserved confounders (UCs), the free Bayes energy can be approximated using the standard Bayesian Information Criterion (BIC). However, in causal models that include UCs, issues of singularities can emerge, making BIC an inadequate score for graph selection. Watanabe (2013) provided a solid introduction to this problem, introducing a generalized BIC score known as WBIC, which can be applied to singular models. It is important to note that the Lp-norm is generally not the optimal choice for causal discovery, as it can yield inconsistent results. Specifically, two Minimal Aggregated Graphs (MAGs) that have the same free Bayes energy may have different Lp-norm scores, and a MAG with optimal free Bayes energy does not necessarily correspond to a minimal Lp-norm score.\n\n- Moreover, the formulation of mixed integer programs is typically computationally complex to solve. From this perspective, it remains unclear whether the current formulation offers any significant improvements over existing structural learning algorithms. For instance, in the reported simulations, the enhancements over the Fast Causal Inference (FCI) algorithm, a standard constraint-based approach, are not entirely consistent. The observed improvements may also be attributed to the fact that the proposed algorithm relies on additional parametric assumptions."}, "questions": {"value": "- Is the proposed score function consistent for causal discovery with unobserved confounders?\n- Is it possible to approximate the resulting mixed integer quadratic program using a differentiable optimization problem?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "dmrXGLtV6X", "forum": "gtKXWySjJh", "replyto": "gtKXWySjJh", "signatures": ["ICLR.cc/2026/Conference/Submission3084/Reviewer_yWWw"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission3084/Reviewer_yWWw"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission3084/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761790496396, "cdate": 1761790496396, "tmdate": 1762916544567, "mdate": 1762916544567, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "In their work, the authors focus on learning causal models from data. The main result is a proposed algorithm called ExMAG, which learns Maximal Ancestral Graph (MAG) from data. The algorithm is based on the formulation of the structure learning task via a mixed integer quadratic program (MIQP). The paper presents comparative experimental results for the algorithm."}, "soundness": {"value": 1}, "presentation": {"value": 2}, "contribution": {"value": 1}, "strengths": {"value": "Learning causal structure from observed data is an important and very challenging task in causality and ML in general. In particular, the problem becomes exceptionally difficult (and remains open) if we assume both latent confounders and selection bias, as is the case in the MAG model. So the problem studied in the work is important and extremely timely in the field."}, "weaknesses": {"value": "The paper presents an ad hoc heuristic whose properties have not been analyzed by the authors. The comparative experimental results are not convincing because the authors use incorrect measures of the quality of the algorithm results (or the given description is incomplete). Furthermore, the paper contains a number of incorrect formulations, erroneous statements and ambiguities. Details below.\n\nThe authors claim to have developed an algorithm for learning MAGs. However, in their paper, they only consider latent confounding and completely ignore selection bias.\n\nThe claim: \"We propose a score-based branch-and-cut algorithm for learning maximally ancestral graphs\" is wrong. The presented approach is not score-based.\n\nThere are several ambiguities in the article regarding (latent) confounders. In Figure 1 the authors claim that ExMAG correctly identifies the confounding in (c). But in the Berkeley graduate admission example (a) there is no confounder between Gender and Admit at all. Moreover, to explain the example in Figure 1, it is necessary to write which variables are latent and what D_A and D_B mean.\n\nThere is no precise definition for the ground truth data (linear) model assumed in the work. The equation in L. 178 is not clear enough. For example, what is the meaning of g, \\tilde{w}, w_{0,j} in eq. (1)? What is the relationship between Y and X? In MILP formulation in Section 3.2 Y is completely ignored.\n\nThere is no analysis of the correctness of using  Eq.(4) in causal structure learning.\n\nThe authors use incorrect measures of the quality of the algorithm results (or the description is incomplete): As follows from the description in Section 5 the authors  measure SHD between MAGs. But it is wrong. Instead, one should compare partial ancestral graphs (PAGs), which characterize the class of Markov equivalent solutions, with PAGs for ground-truth.\n\nIt is not clear why the running times of FCI in experiments presented in Section 5 are 0 (or very close to 0).\n\nThe algorithms presented in Section 4 are fairly standard and well known in the graphical causality community.\n\nThe claim that \"Rantanen et al. (2021) explored a constraint-based approach for MAG discovery, leveraging conditional independence testing\" is false. In fact, Rantanen et al.  develop methodology for *score-based* structure learning of directed maximal\nancestral graphs. They do not use conditional independence tests at all."}, "questions": {"value": "Please refer to my comments above. Moreover, what is the point of using *not* bow-free (BF) graphs in experiments if the definition of MAG assumed in the work satisfies the BF property?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "F91JoOwInb", "forum": "gtKXWySjJh", "replyto": "gtKXWySjJh", "signatures": ["ICLR.cc/2026/Conference/Submission3084/Reviewer_u9dP"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission3084/Reviewer_u9dP"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission3084/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761929989331, "cdate": 1761929989331, "tmdate": 1762916544290, "mdate": 1762916544290, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This work introduces ExMAG, a score-based branch-and-cut method for learning Maximally Ancestral Graphs (MAGs) that represent latent confounding via bidirected edges. The approach formulates structure learning as a MIQP and uses lazy constraints to enforce acyclicity, ancestral consistency, and maximality. Experiments on synthetic and financial data report competitive SHD and runtime, with scalability demonstrated up to 25 variables."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. **Clear exposition of the optimization framework.** \n\nThe formulation of the MIQP problem is well explained, and the authors explicitly relate each constraint type to known graph-theoretic properties (acyclicity, ancestry, maximality).\n\n2. **Empirical validation.**\n\n Experiments are diverse and compare against key baselines — FCI, ip4ancadmg, and ipbm. Results convincingly show improved SHD and runtime, with practical scalability benefits."}, "weaknesses": {"value": "1. **Lack of theoretical completeness.**  \n\nWhile the approach draws on guarantees from prior MIP formulations (Chen, 2021; Dash, 2025), the paper does not establish new proofs that ExMAG preserves acyclicity and ancestral correctness under its specific implementation. Maximality — a defining property of MAGs — is enforced only via iterative inducing-path checks, without a completeness or convergence guarantee. As a result, it remains unclear whether the final output is always a valid MAG.\n\n2. **Potential loss of global optimality.**  \n\nThe reliance on lazy constraint separation preserves optimality only when all relevant constraints can be identified. Because the inducing-path separation routine is heuristic, ExMAG may return a solution that is optimal under an incomplete constraint set. The paper does not theoretically analyze or empirically quantify this failure mode.\n\n3. **Limited causal interpretation.**  \n\nThe objective optimizes a regression-based reconstruction loss with sparsity regularization, not a likelihood or identifiable SEM formulation. Unlike approaches grounded in explicit causal assumptions (e.g., NOTEARS), the causal semantics of the recovered edges remains ambiguous."}, "questions": {"value": "* Could the authors formalize or at least characterize sufficient conditions under which the inducing-path separation routine is guaranteed to be complete? Is there a finite or provably convergent set of constraints that ensures the resulting graph is a true MAG?\n\n* Could the authors derive the objective from a Structural Equation Model (SEM) assumption (e.g., linear Gaussian noise), or clarify under what conditions the quadratic loss approximates a log-likelihood?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "V0J9XN0Ggq", "forum": "gtKXWySjJh", "replyto": "gtKXWySjJh", "signatures": ["ICLR.cc/2026/Conference/Submission3084/Reviewer_LKKY"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission3084/Reviewer_LKKY"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission3084/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762006646690, "cdate": 1762006646690, "tmdate": 1762916543727, "mdate": 1762916543727, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}