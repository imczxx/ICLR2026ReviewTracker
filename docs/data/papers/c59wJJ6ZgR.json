{"id": "c59wJJ6ZgR", "number": 7856, "cdate": 1758039266122, "mdate": 1759897827100, "content": {"title": "DRiFT: Differentiable Grid-Based Rigid-Fluid Coupling for Training and Control", "abstract": "Intelligent agents, interacting with physical environments, require an accurate\nunderstanding of the consequences of their action for efficient learning. Such\nagents are often trained inside simulated environments to alleviate over dependence\non data, and gradients from such a simulation can help in training the agent. To this\nend, we present an end-to-end differentiable grid-based fluid simulation including\nstrong two-way coupling with rigid bodies. In the forward pass, the solid-fluid\nboundary conditions are converted to a monolithic linear pressure solve using a\nvariational method. For the backpropagation, we introduce a novel method of\ncalculating and propagating gradients for the combined fluid-solid state using the\nadjoint method, which runs faster than the forward solve. This implementation,\nwhich is customized for coupling rigid bodies with inviscid fluids, is more suitable\nover general purpose methods like automatic differentiation, for use cases where\nperformance is key for analyzing overall flow patterns and learning fluid properties.\nWe demonstrate the utility of our simulator in training a neural network to learn\noptimal control for general target states. Additionally, we show the effectiveness\nof our differentiable simulator in isolation, by using the generated gradients for\nsimple derivative based optimization tasks. Finally, we showcase the accuracy,\nrobustness and efficiency of our gradient computation method.", "tldr": "", "keywords": ["Differentiable Physics", "Solid-Fluid Coupling"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/d2ea6142fe572b402d7c7eabb92f3e7fbd9475f5.pdf", "supplementary_material": "/attachment/5ee1db01910af25724d4f0fbc2d4257f31c882e3.zip"}, "replies": [{"content": {"summary": {"value": "This paper introduces DRiFT, a grid-based differentiable simulator designed to handle strong two-way coupling between rigid bodies and inviscid fluids. The primary contribution is a complete, end-to-end differentiable pipeline. In the forward pass, solid-fluid boundary conditions are unified into a monolithic linear pressure solve using a variational method. For the backward pass, the authors derive a novel adjoint method to efficiently back-propagate gradients for the combined fluid-solid state. They claim this adjoint pass is faster than the forward solve and more suitable than general-purpose automatic differentiation (AD) for performance-critical applications. The utility of the simulator and its gradients is demonstrated in derivative-based optimization tasks, such as initial state estimation, and for training neural network controllers for optimal control."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 1}, "strengths": {"value": "- Non-trivial technical contribution: the paper presents a complete, end-to-end differentiable simulator for strong two-way rigid-fluid coupling using a Eulerian method. The analytical derivation of the adjoint pass for the entire pipeline, especially for the monolithic variational pressure solve.\n- The resulting adjoint-based gradient computation is demonstrated to be exceptionally efficient. The authors report that the backward pass is faster than the forward solve and significantly outperforms general-purpose automatic differentiation frameworks like PhiFlow in runtime tests. This is promising, and it pushes in a direction that will benefit both the fluid dynamics and ICLR communities.\n- The practical utility of the simulator is demonstrated on diverse optimization tasks. The computed gradients are successfully used for solving inverse problems and for training neural network policies for optimal control."}, "weaknesses": {"value": "1) L064: It is not clear whether $\\mathcal{L}$ is the objective terminal state, or the loss function that compares it to the predicted terminal stated. It appears to be described as the former, which is inconsistent with the typical machine learning literature.\n2) Related work outlining a review of differentiable programming are fairly limited. One could think of [1, 2] among other studies\n3) The method is limited to inviscid fluid simulation, limiting its applicability.\n4) L304: the website link appears to be broken, or doesn't work. While the still frames are nice, they don't give an overview of the initial velocity which is often optimised. Having videos would significantly complement the results.\n5) Figure 5 appears to show a single method, not two (including DiffFR) as claimed in L374.\n6) The overview of the pipeline is interesting, but still limited. The Pseudo-code in Algorithm 1 would be much more useful if placed in the main text.\n\n### Minor issues:\n- L173: Figure ?\n\n### References\n- [ 1 ] Toshev et al., JAX-SPH: A Differentiable Smoothed Particle Hydrodynamics Framework, ICLR 2024 Workshop on AI4Differential Equations in Science\n- [ 2 ] Nzoyem et al., A Comparison of Mesh-Free Differentiable Programming and Data-Driven Strategies for Optimal Control under PDE Constraints, SuperComputing Workshop on AI4Science"}, "questions": {"value": "1) L447: What steps were taken to ensure the Runtime Analysis against PhiFlow is fair ? Please provide details of this experiment, which is incredibly vague in the current manuscript ! (This is all the more concerning given that your code is in C++, while PhiFlow is in Python, which should definately be slower than yours) \n2) What specifically makes the adjoint pass faster than the forward pass, as evidenced in Table 2. This is counter-intuitive, and the paper does not emphasize this enough. Please provide computationaal complexity analysis for Algorithms 2 and 3.\n3) What are the main challenges in extending the proposed adjoint derivation to include viscous effects?\n4) The paper claims the approach is highly scalable, but the experiments use relatively coarse grids (e.g., in L314). What is the computational and memory cost of this appraoch, and how far can you scale on the hardware avaialable?\n5) L352: Specifically in the text optimisation, why was rotation not considered ?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "Xp2ZyByYCt", "forum": "c59wJJ6ZgR", "replyto": "c59wJJ6ZgR", "signatures": ["ICLR.cc/2026/Conference/Submission7856/Reviewer_Nvep"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7856/Reviewer_Nvep"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission7856/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761504207049, "cdate": 1761504207049, "tmdate": 1762919895214, "mdate": 1762919895214, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents a grid-based two-way coupled differentiable fluids solver. The authors implement an adjoint method for computing control variable updates relative to a user-defined reward function. One of the contributions that the authors present is a derivation of analytic gradients for computing updates for the gradients of the pressure solve, that affect both the fluid and the coupled rigid body. The authors also use a variational formulation for the fluid-solid boundary, and a ghost fluid method for the fluid-air interface. Their results demonstrate that the proposed approach works reasonably for a set of predefined low-resolution guidance tasks."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- Working with fluids optimization is a though problem. It usually slow, hard to debug, requires a lot of memory, boundary conditions can be tricky, and the method has to be implemented precisely in all its stages to produce correct results. \n- The proposed variational approach and the ghost fluid discretization for liquid-air interfaces are solid modelling choices. \n- The derivation of the analytical updates seem correct, and the results demonstrate that the method works."}, "weaknesses": {"value": "- The quality of the results is sub-par. Grid resolutions are really coarse and there are not a lot of different examples. Also hard to really evaluate the method, since I was not able to access the website with the video results. \n- The method does not seem efficient. DiffFR uses 237699 particles and it is 2.3 times slower than the proposed method, but the authors compare against a fairly coarse grid setup of 39x15x24 = 14k cells. Therefore the proposed method uses about 5% of the variables of DiffFR and its x2 faster than it. \n- A first-order (Semi Lagrangian advection with forward Euler) fluid solver is an outdated approach. Hybrid (grid + particles), impulse-based methods are more effective and precise. \n- Missing references: \"Honey, I Shrunk the Domain: Frequency-aware Force Field Reduction for Efficient Fluids Optimization\", \"Efficient Solver for Spacetime Control of Smoke\".\n- Minor typos\n   - On plots, whats the concept of Epochs? Shouldn't it be iterations?\n   - L173: Figure ??\n   - L107: Langrangian"}, "questions": {"value": "I would like to understand what are the computational limitations of the proposed approach. How the memory and time would scale with grid size and what would be effective ways to deal with longer simulations."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "fdP3ilrOyG", "forum": "c59wJJ6ZgR", "replyto": "c59wJJ6ZgR", "signatures": ["ICLR.cc/2026/Conference/Submission7856/Reviewer_gZxW"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7856/Reviewer_gZxW"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission7856/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761832646332, "cdate": 1761832646332, "tmdate": 1762919894648, "mdate": 1762919894648, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents DRiFT, a differentiable grid-based fluid simulation with two-way coupling between fluid and rigid bodies. The grid-based discretization enables analytically deriving the gradients over each phase of the fluid simulation, covering fluid velocity advection, pressure solve for boundary conditions, rigid body update, and velocity correction for boundary conditions. The authors demonstrate that gradients from DRiFT can be used for simple optimization tasks, including training a neural network to predict a control sequence. DRiFT obtains 5-10x speedup over a comparable Eulerian differentiable fluid simulation that uses auto-differentiation from PyTorch to compute gradients."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The authors demonstrate how to analytically derive gradients for grid-based fluid simulation. They demonstrate that the gradients computed by adjoint-based gradient computation can be used for optimization of the initial state to achieve some desired final state. given some cost function, and to optimize control forces by training some neural-network based controller to predict a control sequence.\n\n- The proposed differentiable fluid simulation considers strong two-way coupling between fluid and rigid bodies. I believe most prior work on differentiable soft-body simulation is only capable of one-way coupling.\n\n- The authors release their differentiable fluid simulation code, which benefits reproducibility."}, "weaknesses": {"value": "- Based on the videos in the supplementary, the simulated fluid appears highly viscous. How stable is the simulation over longer simulation times? How accurate is the fluid simulation compared to Aquarium, PhiFlow, or other methods for fluid simulation, given that the proposed method uses a grid-based discretization?"}, "questions": {"value": "It would be helpful to discuss hybrid Eulerian-Lagrangian approaches for fluid simulation such as the Material Point Method (MPM) used in differentiable simulators Fluidlab [1], DaXBench [2], or Rewarped [3]. For instance, I believe MPM easily handles simulating different types of fluids in the same scene. How easy is it to extend DRiFT to multiple fluids?\n\n[1] https://arxiv.org/abs/2303.02346\n\n[2] https://arxiv.org/abs/2210.13066\n\n[3] https://arxiv.org/abs/2412.12089\n\nLine297: Does DRiFT support parallel simulation? Or is OpenMP/CUDA only used to parallelize operations in a single physics scene?\n\nFigure 4: Choice of epochs to visualize seems arbitrary (39, 58, 19). How stable is the optimization procedure? Running simulations with different random seeds or number of iterations and including error bars for Figure 6 would be helpful.\n\nSection 6.2: Are the control forces executed in an open loop, i.e the policy predicts the entire control sequence?\n\n- - -\n\n[minor]\n\nLine173: Missing figure number reference\n\nFigure 4: Should be epoch 19 not 10?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "N/a"}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "NOCJvrfl96", "forum": "c59wJJ6ZgR", "replyto": "c59wJJ6ZgR", "signatures": ["ICLR.cc/2026/Conference/Submission7856/Reviewer_U6dN"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7856/Reviewer_U6dN"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission7856/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761931677823, "cdate": 1761931677823, "tmdate": 1762919894301, "mdate": 1762919894301, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}