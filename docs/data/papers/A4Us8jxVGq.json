{"id": "A4Us8jxVGq", "number": 7902, "cdate": 1758042169552, "mdate": 1759897823426, "content": {"title": "How Do Transformers Learn to Associate Tokens: Gradient Leading Terms Bring Mechanistic Interpretability", "abstract": "Semantic associations such as the link between \"bird\" and \"flew\" are foundational for language modeling as they enable models to go beyond memorization and instead generalize and generate coherent text. Understanding how these associations are learned and represented in language models is essential for connecting deep learning with linguistic theory and developing a mechanistic foundation for large language models. In this work, we analyze how these associations emerge from natural language data in attention-based language models through the lens of training dynamics. By leveraging a leading-term approximation of the gradients, we develop closed-form expressions for the weights at early stages of training that explain how semantic associations first take shape. Through our analysis, we reveal that each set of weights of the transformer has closed-form expressions as simple compositions of three basis functions--bigram, token-interchangeability, and context mappings--reflecting the statistics in the text corpus and uncover how each component of the transformer captures the semantic association based on these compositions. Experiments on real-world LLMs demonstrate that our theoretical weight characterizations closely match the learned weights, and qualitative analyses further guide us on how our theorem shines light on interpreting the learned association in transformers.", "tldr": "", "keywords": ["Semantic associations", "Interpretability", "LLM"], "primary_area": "interpretability and explainable AI", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/1baf33219ae83f88a1c63f3242eedc5cf1ec4da0.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper study how transformers learn semantic associations during training on natural language data. The authors develop a theory based on training dynamics, specifically using a leading-term approximation of the gradients to analyze the model's weights in the early phase of training. Their central finding is that the weight matrices, like the output $W_O$, the value $V^{(\\ell)}$, and query-key $W^{(\\ell)}$ can be expressed as compositions of three basis functions derived directly from corpus statistics. These basis functions are bigram maping, that captures the next token co-occurrence ($\\bar{B}$); the interchangeability maping, that fnds tokens with similar preceding token distributions (like synonyms or words in the same grammatical class) ($\\sum_{\\bar{B}}$); and context mapping, that encodes long range co-occurrance between a token and the tokens in its prefix ($\\bar{\\Phi}$).\nThe authors validate this theory first on a 3 layer attention only model trained on TinyStories, and they show that the learned weights have a very high cosine similarity (often >0.99) to their theoretical characterizations. Then, they extend the analysis to the Pythia-1.4B checkpoints, showing that these foundational associations are also learned in larger models, especially during early training and in the later layers."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 4}, "strengths": {"value": "- The leading-term gradient approximation is a clever technical innovation that makes an otherwise intractable analysis feasible while maintaining interpretability. The decomposition into three basis functions provides clear mechanistic insight into how different components capture semantic structure.\n- Unlike much prior theoretical work that relies on synthetic data or heavily simplified models, this analysis is grounded in a more realistic setup. \n- The paper provides closed-form expressions for all major weight matrices uniformly across layers, showing how they compose the basis functions differently."}, "weaknesses": {"value": "- The theory applies to attention-only transformers, but validation on Pythia requires indirect analysis through covariance matrices of activations rather than direct weight comparison. This introduces an additional layer of approximation and makes it unclear how MLPs and multi-head attention affect the theoretical predictions.\n- The theoretical guarantees only hold for $\\mathcal{O}(1/\\eta)$ steps in early training. While empirical results show features persist longer, the paper lacks analysis of how and why these features evolve during later training, limiting practical applicability for understanding fully trained models.\n- To achieve theoretical tractability, the analysis relies on certain assumptions, such as \"sufficiently small\" initialization and bounds on the learning rate and number of steps (as seen in Theorem 4.1). The error bounds for the approximation, while derived, grow over time. This means the exact closed-form expressions are an idealization, and their accuracy naturally decreases as training progresses and the model's state becomes more complex.\n- Experiments use truncated vocabularies (3K for TinyStories, 20K for Pythia) which may not capture the full complexity of semantic associations in real LLMs with vocabularies of 50K+ tokens. The computational tractability argument doesn't fully justify this limitation."}, "questions": {"value": "Your leading-term approximation brilliantly explains how associations emerge in the very early stages of training. The empirical results with Pythia suggest these structures persist for some time but also evolve, especially in the earlier layers. What are your thoughts on the mechanisms that drive this evolution away from the initial basis functions? Is it simply the accumulation of higher-order gradient terms, or do you suspect qualitatively new structures, like logical reasoning circuits, are being built on top of this initial associative foundation?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "N/A"}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "4NSOiefasA", "forum": "A4Us8jxVGq", "replyto": "A4Us8jxVGq", "signatures": ["ICLR.cc/2026/Conference/Submission7902/Reviewer_XVTW"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7902/Reviewer_XVTW"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission7902/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760548335157, "cdate": 1760548335157, "tmdate": 1762919931109, "mdate": 1762919931109, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents a theoretical and empirical analysis of how semantic associations emerge in transformer-based language models during early training. By analyzing the leading-term approximation of training gradients, the authors derive closed-form expressions for the model's weight matrices. They show that these weights can be characterized by the composition of three interpretable basis functions—bigram, interchangeability, and context mappings—which collectively explain how transformers acquire semantic structure from data. The theoretical claims are rigorously validated through experiments on both the controlled TinyStories benchmark and large-scale models like Pythia-1.4B, demonstrating strong agreement between the theoretically predicted features and the empirically learned weights."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper starts from the perspective of gradient flow and utilizes the contextual distribution in the text to explain the implied semantic associations within the parameters. This perspective is very novel and provides an in-depth way of understanding the distributional characteristics of the parameters of transformer-based language models.\n2. The paper is trained on real text, and the experimental results are highly consistent with the theoretical analysis, demonstrating the reasonableness of its results."}, "weaknesses": {"value": "1. The paper is validated only on the TinyStories dataset, which I consider insufficient for comprehensive verification.\n2. The training loss on TinyStories remains very high (greater than 5), indicating that the model's learning on this dataset is inadequate and arguably unsuccessful. The value of discussing parameter characteristics under such inadequate fitting conditions is highly questionable.\n3. The description of how theoretical and experimental results are compared in Section 5.2 is difficult to understand. The authors should revise this section and provide more detailed methodological descriptions in the appendix, preferably in an algorithmic format.\n4. The paper uses one-hot encoding instead of the more commonly used embedding encoding. The authors should discuss how this distinction affects their theoretical results, particularly whether the presence of an embedding layer under zero initialization would invalidate their theoretical findings.\n5. Paper [1] also discusses from a gradient flow perspective how the embedding layer is influenced by semantic distributions under small initialization, and its findings share some similarities with certain results in this paper. I believe the authors should discuss the distinctions between their work and [1].\n\n[1] An Analysis for Reasoning Bias of Language Models with Small Initialization, Forty-second International Conference on Machine Learning."}, "questions": {"value": "See weakness."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "p50fsAp5Nx", "forum": "A4Us8jxVGq", "replyto": "A4Us8jxVGq", "signatures": ["ICLR.cc/2026/Conference/Submission7902/Reviewer_T8ho"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7902/Reviewer_T8ho"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission7902/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761483128183, "cdate": 1761483128183, "tmdate": 1762919930637, "mdate": 1762919930637, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies how semantic associations first emerge in attention-based language models by analyzing early training dynamics. Using a leading‑term expansion of the gradients, the authors derive closed‑form approximations for all major weight classes in a self attention only transformer with causal masking and learned relative positional bias. \nshows very high cosine similarity between learned weights and their leading‑term predictions, and an analysis of Pythia‑1.4B on OpenWebText shows strong early training alignment that gradually drifts laterr. Qualitative examples illustrate that the basis functions recover intuitive relations like \"fish\" <--> \"pond/lake\"."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "* The three basis functions (bigram, interchangeability provide an intuitive, corpus‑linked explanation for what each weight class is learning and how attention and values cooperate early in training\n\n\n* The writing is very clear\n\n* Near perfect cosine agreement on TinyStories over many steps and reasonable agreement in a non-toy sized model (pythia) support external validity. heatmaps/diagrams are clear"}, "weaknesses": {"value": "* Quantitative validation centers on cosine similarity and selected qualitative token lists. Some broader behavioral evaluations or ablations (e.g., other corpora, tokenizations, or stronger baselines) would further strengthen the claims\n\n* Unless I'm missing something, this doesn't hold well for later stages of training because of drift. That's fine, but I figured I'd raise it. I am not entirely sure how much this is a problem for the scope of the paper. Are there analyses on later stages of training that would be interesting but are blocked by this constraint?\n\n* I would like to see some interventional results showing some practicality: E.g., show that the leading term predictors enable training diagnostics or interventions (e.g., early phase monitoring that forecasts later perplexity or feature formation).\n\n* The theoretical result is clean and realistic for early training, and the empirical results are suggestive. I think the thing holding this paper back right now are scope"}, "questions": {"value": "N/A"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "kaeGRpVJ0K", "forum": "A4Us8jxVGq", "replyto": "A4Us8jxVGq", "signatures": ["ICLR.cc/2026/Conference/Submission7902/Reviewer_p4Xp"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7902/Reviewer_p4Xp"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission7902/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761970458225, "cdate": 1761970458225, "tmdate": 1762919930134, "mdate": 1762919930134, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper studies how semantic associations between tokens emerge during the early training of language models. Focusing on a self-attention-only architecture, the authors derive the leading-order gradient updates and show that the learned weights can be decomposed using three quantities that reflect the statistics of the training corpus: bigram mapping (correlations between consecutive tokens), intercheangiability mapping (correlations induced by similarity of tokens’ previous-token context distributions), and context mapping (average contextual features of tokens across their occurrences). They validate the theory on small attention-only models - where the predicted leading terms match the learned parameters in the early steps - and then analyze embeddings in Pythia models, finding qualitative alignment with the theory in the initial training phase."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The paper presents an interesting and, to my knowledge, novel blend of mathematical analysis, numerical experiments, linguistic insight, and mechanistic interpretability. The bottom-up approach of deriving representations from first principles of training dynamics is significant.\n- The paper analytically derives a leading-order approximation of the weight evolution and provides clear, intuitive interpretations for each component.\n- The theory does not rely on synthetic data models. Rather, the basis functions are derived directly from the statistics of the language corpora.\n- The paper is well-written and its assumptions are clearly outlined."}, "weaknesses": {"value": "- The primary weakness is that the theory still relies on strong architectural assumptions. It is derived only for self-attention-only transformers. This analysis does not account for the impact of MLP layers, which are important components of present models. While this is a limitation, it is an understandable simplification necessary to make the analysis tractable, and future work might build upon this to relax these assumptions."}, "questions": {"value": "- Th. 4.1 provides formal bounds on the error between the learned weights and their leading-term approximations. How tight are these error bounds in practice? For instance, in the TinyStories experiment."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "uEuBMcb9Jq", "forum": "A4Us8jxVGq", "replyto": "A4Us8jxVGq", "signatures": ["ICLR.cc/2026/Conference/Submission7902/Reviewer_qEwF"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7902/Reviewer_qEwF"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission7902/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762464128312, "cdate": 1762464128312, "tmdate": 1762919929574, "mdate": 1762919929574, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper addresses a critical gap in transformer interpretability: how semantic associations (e.g., \"bird\"-\"flew\", \"country\"-\"capital\") emerge during training of attention-based language models (LLMs) on natural language data. Unlike prior work that relies on synthetic data, simplified architectures, or non-standard training, the authors ground their analysis in realistic settings (natural text distributions, standard transformers with positional encoding, and standard next-token prediction loss). Their key technical innovation is leveraging a gradient leading-term approximation to derive closed-form expressions for transformer weights in the early training stage.\n\nThe authors show that all transformer weights (output, value, query-key, positional encoding) can be characterized as compositions of three interpretable basis functions: (1) bigram mapping (captures next-token dependencies), (2) token-interchangeability mapping (reflects functional similarity, e.g., synonyms), and (3) context mapping (encodes long-range prefix-suffix co-occurrence). They validate this theory empirically: on a 3-layer transformer trained on TinyStories, learned weights maintain cosine similarity ≥0.9 with theoretical predictions even beyond early training; on real-world LLMs (Pythia-1.4B trained on OpenWebText), early-stage activations and attention weights strongly align with the proposed basis functions."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 4}, "strengths": {"value": "1. Realism of the theoretical setup: By retaining critical components of practical transformers (positional encoding, causal masking, residual streams) and using natural text, the paper avoids the over-simplifications that limit the generalizability of prior work.\n\n2. Mechanistic interpretability: The basis functions provide a causal explanation for semantic association (e.g., the value matrix combines context and bigram mappings to encode long-range semantics), rather than just correlational observations.\n\n3. Strong empirical validation: The experiments are comprehensive, testing the theory on both small controlled models (TinyStories) and large real-world LLMs (Pythia-1.4B), with quantitative (cosine similarity) and qualitative (token correlation examples, Figure 5) evidence.\n\n4. Foundational value for future work: The closed-form expressions and basis functions can serve as a starting point for further research (e.g., diagnosing bias in LLMs by analyzing deviations from the theoretical bigram/context mappings, or designing more interpretable architectures)."}, "weaknesses": {"value": "1. Limited analysis of later training stages: While the paper notes that theoretical features persist beyond early training (e.g., cosine similarity ≥0.7 after 100 epochs in TinyStories), it does not explore why or how weights drift from the leading terms. Understanding this drift (e.g., whether it corresponds to higher-level semantic learning) would strengthen the theory’s completeness.\n\n2. Multi-head attention and MLP layers are understudied: The Pythia experiment adapts the analysis to multi-head attention by averaging attention heads, but it does not explore how individual heads or MLP layers interact with the proposed basis functions. For example, do some heads specialize in bigram mappings while others focus on context?\n\n3. Lack of causal interventions: The empirical validation relies on correlational measures (cosine similarity, covariance), not causal tests (e.g., ablating the bigram mapping component of weights to see if next-token prediction degrades). Causal interventions would more strongly confirm that the basis functions are necessary for semantic associations."}, "questions": {"value": "1. Drift in later training stages: You note that weights drift from leading terms as training progresses (Figure 6). Can you characterize this drift? For example, does it correspond to learning higher-level semantics (e.g., syntax, pragmatics) that build on the initial basis functions, or does it reflect overfitting to idiosyncrasies in the data?\n\n2. Multi-head attention specialization: In Pythia, you average attention heads to compute token correlations, but prior work shows heads specialize in different tasks. Do individual heads align with specific basis functions (e.g., some heads focus on bigram mappings, others on context)? If so, how does this specialization emerge?\n\n3. Causal validation: Your analysis uses correlational measures (cosine similarity) to link learned weights to theoretical terms. Have you tried causal interventions (e.g., modifying the bigram mapping component of the output matrix and measuring changes in next-token prediction accuracy for bigram-dependent pairs like \"bird\"-\"flew\")? Such tests would strengthen the claim that the basis functions are functional, not just correlational."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "bzPL1RfpL1", "forum": "A4Us8jxVGq", "replyto": "A4Us8jxVGq", "signatures": ["ICLR.cc/2026/Conference/Submission7902/Reviewer_bKRV"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission7902/Reviewer_bKRV"], "number": 5, "invitations": ["ICLR.cc/2026/Conference/Submission7902/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762871641465, "cdate": 1762871641465, "tmdate": 1762919929270, "mdate": 1762919929270, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}