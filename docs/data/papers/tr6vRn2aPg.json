{"id": "tr6vRn2aPg", "number": 18338, "cdate": 1758286575570, "mdate": 1759897109821, "content": {"title": "FragFM: Hierarchical Framework for Efficient Molecule Generation via Fragment-Level Discrete Flow Matching", "abstract": "We introduce FragFM, a novel hierarchical framework via fragment-level discrete flow matching for efficient molecular graph generation. FragFM generates molecules at the fragment level, leveraging a coarse-to-fine autoencoder to reconstruct details at the atom level. Together with a stochastic fragment bag strategy to effectively handle an extensive fragment space, our framework enables more efficient and scalable molecular generation. We demonstrate that our fragment-based approach achieves better property control than the atom-based method and additional flexibility through conditioning the fragment bag. We also propose a Natural Product Generation benchmark (NPGen) to evaluate modern molecular graph generative models' ability to generate natural product-like molecules. Since natural products are biologically prevalidated and differ from typical drug-like molecules, our benchmark provides a more challenging yet meaningful evaluation relevant to drug discovery. We conduct a FragFM comparative study against various models on diverse molecular generation benchmarks, including NPGen, demonstrating superior performance. The results highlight the potential of fragment-based generative modeling for large-scale, property-aware molecular design, paving the way for more efficient exploration of chemical space.", "tldr": "We introduce FragFM, a novel hierarchical framework employing fragment‐level discrete flow matching for efficient molecular graph generation, along with a new molecular generative benchmark focused on natural products.", "keywords": ["Molecular Graph Generation", "Discrete Flow Matching", "Fragment-Based Drug Discovery", "Natural Product"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/b9401c5210aa6d4f1ca1d0d06d32c284316edbc3.pdf", "supplementary_material": "/attachment/f018d820dc7a1a69e3dbe3ca6ea1307815bc331e.zip"}, "replies": [{"content": {"summary": {"value": "The paper introduces FragFM, a hierarchical framework for molecular graph generation that operates at the fragment level by combining a discrete and continuous flow matching approach with a coarse-to-fine autoencoder. The design enables efficient and scalable molecular generation by modeling chemically meaningful fragments, rather than individual atoms, while ensuring all-atom validity during molecular reconstruction. The authors also propose NPGen, a new benchmark focusing on natural products, which challenges existing approaches to generate larger, more complex, and more diverse biologically relevant compounds. Experimentally, FragFM outperforms atom- and fragment-based models on both standard molecule benchmarks and NPGen, and also demonstrates the ability to conditionally generate molecules based on desirable properties while maintaining validity."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The fixed-length graph embedding for fragments and fragment bag strategy allows scalable training for large fragment libraries without sacrificing chemical expressivity. By introducing the conditional fragment bag sampling term $\\lambda_B$, the fragment bag restriction does not hinder conditional generation. \n2. For both conditional and unconditional molecule generation, FragFM maintains high RDKit validity, demonstrating that the hierarchical approach and Blossom algorithm are effective methods to ensure chemical reasonableness.\n3. FragFM outperforms atom-based and fragment-based methods in most metrics while also demonstrating a high sampling efficiency, even compared to an existing flow matching model DeFoG."}, "weaknesses": {"value": "1. Despite the inclusion of chemical validity as a benchmark, the authors omit retrosynthetic analyses (i.e. Syntheseus) for generated molecules. This is especially important considering the reliance of the model on connecting building blocks via junction atoms, which does not necessarily guarantee a feasible experimental synthesis route.\n2. Although many relevant natural products are macrocycles, the ground-truth graphs are derived directly from the results of BRICS decomposition, which results in acyclic graphs. As the Blossom algorithm employed only considers pairs of junction atoms with edges decided by this fragmentation, the model is likely unable to generate macrocycles.\n3. While the hierarchical combination of fragment-level flow matching and coarse-to-fine reconstruction is well-executed, the scope of the work is somewhat incremental. Flow matching and autoencoder-based 2D molecular generation at the fragment level are individually present in the literature, as is the architecture used during training. \n\nMinor:\n1. The work omits training details for the conditional property regressor.\n2. Though it may exceed the scope of the work, the model does not explicitly consider information relevant to some conditional generation tasks, such as the local geometry of the protein pocket for binding affinity."}, "questions": {"value": "1. It is somewhat unclear how the regressor, which decides conditional fragment bag sampling weights, is trained. Does the model predict the property values of each fragment directly? If not, is it instead trained to predict the average property value of all molecules in the training dataset containing the fragment? \n2. Does the NPGen dataset contain macrocycles? \n3. Does conditional generation with higher $\\lambda_B$ result in lower diversity? It would be interesting to see the trade-off between the strength of conditioning signals like $\\lambda_B$ and $\\lambda_X$ and the diversity of the results.\n4. Is there any merit to changing the relative schedules of the latent vector and molecular graph during sampling? For instance, would it be possible to construct an analog design experiment by conditioning on a fully denoised latent vector of a difficult-to-synthesize molecule, then allowing the discrete graph flow matching module to run and generate analogs with a chosen fragment library?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "21ViTilusC", "forum": "tr6vRn2aPg", "replyto": "tr6vRn2aPg", "signatures": ["ICLR.cc/2026/Conference/Submission18338/Reviewer_FxE9"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18338/Reviewer_FxE9"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission18338/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761598887932, "cdate": 1761598887932, "tmdate": 1762928049281, "mdate": 1762928049281, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies the problem of molecular graph generation. The authors propose FragFM, a novel hierarchical framework via fragment-level discrete flow matching. The authors also propose the Natural Product Generation benchmark for comprehensive evaluation. FragFM enables effective distribution learning and property-guided molecular generation."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- FragFM includes a coarse-to-fine autoencoder to deal with the ambiguity in reconstructing atomic connections.\n- FragFM introduces a dynamic fragment vocabulary."}, "weaknesses": {"value": "- In related work, hierarchical generation models such as MolGrow[1], MolHF [2], and Coarse-to-fine [3] should be included. And their comparison with fragment-based methods should be discussed.\n- The coarse-to-fine autoencoder is not fully data-driven, which depends on predefined fragmentation rule and Blossom algorithm.\n- Several important baselines are missing in the proposed benchmark NPGen. For example, SAFE-GPT, a fragment-based method that performs well in MOSES.\n- Lacking ablation. The effectiveness of the autoencoder and the dynamic fragment vocabulary should be discussed.\n\n[1] MolGrow: A graph normalizing flow for hierarchical molecular generation\n\n[2] Molhf: A hierarchical normalizing flow for molecular graph generation\n\n[3] Coarse-to-fine: a hierarchical diffusion model for molecule generation in 3d"}, "questions": {"value": "See weaknesses"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "RL9CJTSfos", "forum": "tr6vRn2aPg", "replyto": "tr6vRn2aPg", "signatures": ["ICLR.cc/2026/Conference/Submission18338/Reviewer_hbdo"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18338/Reviewer_hbdo"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission18338/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761644417626, "cdate": 1761644417626, "tmdate": 1762928048810, "mdate": 1762928048810, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces FragFM, a hierarchical framework for molecular graph generation that combines fragment-level discrete flow matching with a coarse-to-fine autoencoder for efficient and scalable drug-like molecule generation. The authors also propose NPGen, a new benchmark designed to evaluate the generation of complex, natural product–like molecules."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. Interesting ideas that construct flows on latent variables and coarse graphs. \n2. The “in-bag” InfoNCE formulation is computationally efficient, and provides a surrogate for different computation budget, with the bag size increasing, $x_1$ posterior becomes unconditional.\n3. Strong performance on both standard benchmarks and NPGen."}, "weaknesses": {"value": "1. The paper only evaluates 2D molecular graphs. It would strengthen the contribution to include 3D molecular generation. \n2. While fragment-level generation is inherently interpretable, the paper does not analyze fragment–property correlations or latent space structure."}, "questions": {"value": "1. How sensitive is FragFM to the choice of fragment decomposition rules (e.g., BRICS vs. other methods)? \n2. Coarse graphs are generated by fixed chemical tools, can this process be learned by another graph autoencoder instead?\n3. How is the fragment property predictor trained?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "None."}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "M47fMIRhDl", "forum": "tr6vRn2aPg", "replyto": "tr6vRn2aPg", "signatures": ["ICLR.cc/2026/Conference/Submission18338/Reviewer_RJhm"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18338/Reviewer_RJhm"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission18338/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761667176446, "cdate": 1761667176446, "tmdate": 1762928048432, "mdate": 1762928048432, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes a fragment-based approach for molecular generation, with a particular focus on scalability to larger molecules (natural products; NPs).\n\nThe focus on NPs makes it difficult for me to judge the impact (of both the method and the dataset); I suspect it's somehow niche compared to the general small molecule generation, but at the same time it offers a comprehensive contribution (with both a benchmark and a new method)."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The paper is clearly written and easy to follow.\n- The approach focuses on scaling to the generation of large molecules (namely natural products), which is an interesting application area.\n- The approach seems novel, and has domain-specific contributions (e.g. coarse encoding)\n- A new benchmark dataset is introduced, which is an additional contribution.\n- Besides the comment below, the evaluation is in my opinion sound and fairly typical for 3D generation papers; it supports the claims made."}, "weaknesses": {"value": "- The authors rely on fairly old baselines in experiments past unconditional generation. This raises questions about relative performance of the method compared to SotA. It’s also not clear why only an atom-based baseline is used in conditional generation."}, "questions": {"value": "- The authors provide a figure for sampling times; how does the model compare in terms of training time?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "kkNOn55QzT", "forum": "tr6vRn2aPg", "replyto": "tr6vRn2aPg", "signatures": ["ICLR.cc/2026/Conference/Submission18338/Reviewer_PJ7B"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18338/Reviewer_PJ7B"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission18338/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761949236873, "cdate": 1761949236873, "tmdate": 1762928047856, "mdate": 1762928047856, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}