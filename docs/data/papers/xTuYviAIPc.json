{"id": "xTuYviAIPc", "number": 2149, "cdate": 1756998312583, "mdate": 1763748794376, "content": {"title": "Guided Diffusion by Optimized Loss Functions on Relaxed Parameters for Inverse Material Design", "abstract": "Inverse design problems are common in engineering and materials science. The forward direction, i.e., computing output quantities from design parameters, typically requires running a numerical simulation, such as a FEM, as an intermediate step, which is often an optimization problem by itself. In many scenarios, several design parameters can lead to the same or similar output values. For such cases, multi-modal probabilistic approaches are advantageous to obtain diverse solutions. Additional difficulties arise if the design problem is constrained. We propose a novel inverse design method based on diffusion models. The model learns a prior over possible approximate designs in a relaxed parameter space. Parameters are sampled using guided diffusion for which we leverage implicit differentiation of the simulation to evaluate the loss function. A design sample is obtained by backprojecting the sampled parameters. We develop our approach for a composite material design problem where the forward process is modeled as a linear FEM problem. We evaluate with the objective of finding designs that match a specified bulk modulus. We demonstrate that our method can propose diverse designs within 1% relative error margin from medium to high target bulk moduli in 2D and 3D settings. We also demonstrate that the material density of generated samples can be minimized simultaneously by using a multi-objective loss function.", "tldr": "", "keywords": ["guided diffusion", "inverse design", "material design"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/7271798e78c1dd56bf1b22b773ad76f7296a5f03.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper proposes a loss-guided diffusion framework for inverse material design where the loss requires solving an inner optimization problem, such as a FEM simulation. The approach relaxes the discrete design space into a continuous grid, trains an unconditional diffusion model as a prior over plausible microstructures, and steers denoising using gradients from implicit differentiation of the FEM equations.  After sampling, the “relaxed” parameters are back-projected into discrete material designs.  The method is demonstrated on synthetic 2-D and 3-D composite-material problems targeting prescribed bulk moduli."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "Interesting integration of implicit differentiation through physics-based simulations with diffusion-based generative modeling.\nThe idea of using a diffusion prior to regularize exploration of a high-dimensional, discrete design space is conceptually appealing.\nThe experiments are carefully described, with detailed dataset generation, FEM setup, and hyperparameters.\nVisual results show that the method can generate multiple microstructures achieving similar effective moduli."}, "weaknesses": {"value": "1.\tIll-posedness motivation. The paper treats non-uniqueness in inverse design as a “difficulty,” whereas multiple feasible designs are natural and desirable. The actual problem is the non-differentiability and discreteness of the design space, not ill-posedness itself. This conceptual confusion weakens the motivation.\n\t2.\tEquation (3). The “optimized loss function” derivation is standard total-derivative or adjoint sensitivity analysis used in PDE constrained optimization for decades. There is no new mathematical contribution, and the presentation of (∂c/∂u)^{-1} instead of an adjoint formulation may be computationally unrealistic.\n\t3.\tOverlap with Optimal Experimental Design (OED): The proposed method is essentially OED or gradient-based design optimization wrapped in a diffusion sampler: sensitivities from a differentiable simulator guide exploration of parameter space toward a target observation. This strong conceptual link to classical and Bayesian OED is not acknowledged, leaving the work not well contextualized.\n\t4.\tUnclear advantage of loss-guided diffusion: Since FEM gradients are available, one could directly perform deterministic or probabilistic gradient-based optimization. The paper provides no evidence that diffusion-based sampling yields better accuracy, stability, or diversity than standard OED or adjoint methods.\n\t5.\tMissing baselines. No comparison is made to:\n\t•\tgradient-based design optimization using the same sensitivities,\n\t•\tBayesian or stochastic OED samplers, or\n\t•\texisting diffusion-based design methods\nWithout these, performance gains cannot be assessed.\n\t6.\tNotation and clarity issues. The paper inconsistently switches between t and i as diffusion indices, making it unclear how gradients \\nabla_{x_t}\\ell_y are applied in practice. Terms such as “optimized loss” and “relaxed parameter space” are used ambiguously."}, "questions": {"value": "1.\tWhat is the concrete advantage of loss-guided diffusion over direct gradient-based or Bayesian OED methods using the same FEM sensitivities?\n\t2.\tCould the authors clarify whether the approach can handle nonlinear or time-dependent PDEs, or is it limited to linear FEMs?\n\t3.\tWould results change if the same loss were optimized directly via gradient descent rather than diffusion sampling?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "5L8awosLjl", "forum": "xTuYviAIPc", "replyto": "xTuYviAIPc", "signatures": ["ICLR.cc/2026/Conference/Submission2149/Reviewer_jnhQ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2149/Reviewer_jnhQ"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission2149/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760711609857, "cdate": 1760711609857, "tmdate": 1762916054596, "mdate": 1762916054596, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents a novel guided diffusion method for inverse material design. Its key innovation is using implicit differentiation of a physics-based simulation (FEM) to guide the denoising process, which eliminates the need for surrogate models. The model operates on a continuous, relaxed representation of material microstructures and is trained to generate designs that meet target bulk moduli. The approach successfully produces diverse 2D and 3D designs with low error for mid-to-high-range target values."}, "soundness": {"value": 2}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "The paper introduces an innovative, training-free guidance mechanism that uses implicit differentiation of FEM simulations, avoiding the need for surrogate models and increasing flexibility.\n\nIt effectively uses a continuous parameter space to enable differentiability, while a learned prior on the microstructures ensures physical plausibility.\n\nThe approach is validated with comprehensive experiments in both 2D and 3D, using diverse metrics such as relative error and material coverage.\n\nThe method demonstrates practical utility by using real material properties and employing a task-agnostic diffusion model that can be reused for different objectives.\n\nThe submission includes detailed ablation studies, architectural specifications, and hyperparameters that support reproducibility and clarify design choices."}, "weaknesses": {"value": "The evaluation is confined to linear elastic FEM problems and shows significantly degraded performance for targets at the extremes of the property distribution.\n\nThe evaluation is missing comparisons to established inverse design baselines like genetic algorithms or topology optimization, making it difficult to contextualize the method's performance.\n\nThe paper lacks a detailed analysis of computational cost, scalability with increased resolution, and the computational bottleneck of the guidance step.\n\nThe method relies on manual tuning of gradient scaling factors, which suggests sensitivity to parameter scales and raises questions about its generalizability.\n\nThe evaluation relies on a potentially arbitrary coverage metric and lacks statistical robustness, with most results based on single training runs."}, "questions": {"value": "- Could you elaborate on the specific challenges of extending this method to non-linear FEM and what approximations might be required?\n\n- To better contextualize your contribution, could you compare your method against at least one established baseline (e.g., GA, TO)? There is a rich literature on guided-diffusion models for design (see [here](https://proceedings.neurips.cc/paper_files/paper/2023/hash/a2fe4bb50fc6f3564cee1551d6309fea-Abstract-Conference.html) and [here](https://ojs.aaai.org/index.php/AAAI/article/view/26093) for example).\n\n- How did you determine the manual gradient scaling factors? Can you offer a more principled approach for tuning these on new problems?\n\n- How does the computational cost scale with simulation resolution? What is the main bottleneck: the FEM solver, implicit differentiation, or the denoising process?\n\n- How could your framework incorporate hard design constraints, such as minimum wall thickness or material density limits?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "WVariFhvdp", "forum": "xTuYviAIPc", "replyto": "xTuYviAIPc", "signatures": ["ICLR.cc/2026/Conference/Submission2149/Reviewer_wpS8"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2149/Reviewer_wpS8"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission2149/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761936817471, "cdate": 1761936817471, "tmdate": 1762916053818, "mdate": 1762916053818, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents a loss-guided diffusion framework for inverse material design. The method combines an unconditional diffusion prior trained over relaxed material representations (continuous per-element E,ν,ρ) with physics-based guidance derived from implicit differentiation through a FEM simulator. During generation, the reverse diffusion process is guided by loss gradients computed from the FEM, encouraging samples that achieve a target property (bulk modulus K). Generated relaxed samples are then “backprojected” to discrete material designs using a 2-component Gaussian Mixture Model (GMM) and skeletonization to identify particle/matrix assignments, particle radius, and volume fraction. The paper demonstrates the approach on 2D and 3D composite materials with spherical inclusions, targeting specific bulk moduli. Experiments report that several generated samples fall within 1 to 5% relative error of the target, showing diversity across feasible material designs."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "The combination of an unconditional diffusion prior with implicit FEM-based loss guidance removes the need for surrogate property predictors and allows direct physics-based gradients to guide the diffusion process.\n\nResults show the framework working across different scales with simple ablations (unguided vs guided, varying diffusion steps) and an analysis of runtime.\n\nThe use of bounds to validate generated samples demonstrates awareness of physical plausibility."}, "weaknesses": {"value": "Weaknesses\n\n1.Unclear positioning: The paper’s core mechanism of loss-guided diffusion is already well established through prior frameworks such as classifier-free guidance. A lot of work in engineering applications has also been done to solve inverse problems using diffusion models. The claimed novelty claimed here is the integration of FEM-based implicit gradients, but there is no direct comparison against simpler or existing alternatives (e.g., conditional or classifier-free guided diffusion, or regressors). Without such baselines, it is unclear what practical benefit the proposed method offers beyond using FEM gradients instead of learned surrogates.\n\n2. Weak treatment of constraints and backprojection; The method relies on relaxing discrete design variables into continuous fields, then heuristically mapping them back to discrete material configurations via GMM fitting and skeletonization. This post-hoc step lacks guarantees, and there’s no theoretical or empirical analysis of its robustness. It will be helpful if the authors can discuss whether the approach ensures design feasibility during diffusion or not or it simply hopes the prior keeps samples plausible. \n\n3. All results are restricted to isotropic, linear composites with spherical particles. There’s no evidence the approach scales to nonlinear materials, multiple objectives, or more complex geometries, such as those seen in topology optimization. Moreover, there are no comparisons with standard baselines such as diffusion-based topology optimization, adjoint-based inverse design, or surrogate-conditioned diffusion. The metrics could also be expanded by reporting diversity, uniformity, quality,etc."}, "questions": {"value": "Can you provide results against strong baselines such as conditional diffusion models, a regressor-guided sampler, or a classical optimization to show concrete benefits?\n\nHow often does the backprojection fail or deviate significantly from the guided relaxed solution? Can you quantify \n\nHow sensitive are your results to the number of denoising steps, or gradient scaling? Do these affect sample diversity or physical validity? \n\nCan this framework handle nonlinear or anisotropic materials, or multiple design targets? \n\nHow does the method work for extrapolation beyond the original space?\n\nReproducibility: Since the MatWeb data cannot be shared, can you release a synthetic dataset and a pretrained model for verification?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "yV7OkeQs9v", "forum": "xTuYviAIPc", "replyto": "xTuYviAIPc", "signatures": ["ICLR.cc/2026/Conference/Submission2149/Reviewer_3YSF"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2149/Reviewer_3YSF"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission2149/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761976710646, "cdate": 1761976710646, "tmdate": 1762916053262, "mdate": 1762916053262, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}