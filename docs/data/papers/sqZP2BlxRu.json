{"id": "sqZP2BlxRu", "number": 14412, "cdate": 1758234753577, "mdate": 1759897371885, "content": {"title": "Greedy Multi-Path Block Verification for Faster Decoding in Speculative Sampling", "abstract": "The goal of L-step speculative decoding is to accelerate autoregressive decoding of a target model by using a cheaper draft model to generate a candidate path of L tokens. Based on a verification algorithm involving target and draft model probabilities, a prefix of the candidate sequence is accepted, and an additional correction token is sampled from a residual distribution to ensure that the final output adheres to the target distribution. While standard speculative decoding uses a verification algorithm which is independent at each token on the path, a recent extension called block verification uses a joint condition involving all sampled on-path probabilities. Block verification (BV) was shown to be optimal over all verification algorithms which use only on-path probabilities, improving on standard speculative decoding. In this work, we first show that block verification is optimal even over verification algorithms that use off-path probabilities, by constructing an information-agnostic linear program (LP). Further, we can extend our LP to the setting where the draft model samples multiple candidate paths, and use it to construct a natural class of multi-path block verification generalizations. While computing the optimal algorithm in this class is not tractable, by considering a stricter class of greedy algorithms, we can formulate an efficient method called greedy multi-path block verification (GBV). Empirically, GBV can improve block efficiency by over 30% and reduce decoding walltimes by over 15% relative to BV.", "tldr": "We extend block verification to the multi-path setting to improve block efficiency", "keywords": ["LLMs", "Inference", "Optimal Transport", "Speculative Decoding"], "primary_area": "probabilistic methods (Bayesian methods, variational inference, sampling, UQ, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/18467ccc4f9bd64c1cb06f4e766b7965612a2229.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "The paper studies verification algorithms for L-step speculative decoding. It formulates an information-agnostic linear program (LP) and proves that Block Verification (BV) is optimal among all single-path verification schemes.  It then extends the LP to multi-path drafting. Several experiments on the OPT series model demonstrate the effectiveness of the method."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- The information-agnostic LP cleanly characterizes feasible node budgets with a theoretical guarantee.\n- The appendices provide solid derivations and decomposition lemmas.\n- This paper is overall well-written and easy to follow."}, "weaknesses": {"value": "-  Results only use OPT models and three academic datasets; evaluation on modern LLMs (e.g., Llama-2/3/4 and Qwen2.5/3 families) and diverse tasks (long-context, multilingual, tool-use) would strengthen external validity.\n- K=4 improves block efficiency but hurts wall-time (batch overhead dominates), which needs a more in-depth analysis of K to provide a deeper underrstanding of the method.\n- Reproducibility would benefit from open code and configurations to validate GBV’s efficiency in other hardware.\n- The author may want to porvide more  comparisons with strong multi-path or tree-based methods (e.g., staged/speculative variants, multi-token heads) and sensitivity to L, temperature, and draft quality."}, "questions": {"value": "- Could you provide a systems breakdown (per-token FLOPs, KV-cache traffic, batch effects) to explain the K=4 wall-time regression and to guide deployment choices?  \n- How sensitive is GBV to temperature?\n- Can GBV be combined with hierarchical or retrieval-augmented drafting and with multi-token heads?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "yyxVWyQICS", "forum": "sqZP2BlxRu", "replyto": "sqZP2BlxRu", "signatures": ["ICLR.cc/2026/Conference/Submission14412/Reviewer_FQHP"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14412/Reviewer_FQHP"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission14412/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760928933756, "cdate": 1760928933756, "tmdate": 1762924819863, "mdate": 1762924819863, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper formalizes verification for speculative decoding via an information‑agnostic LP. It shows (i) in the single‑path case, block verification (BV) remains optimal even if the verifier is allowed full off‑path probabilities; and (ii) in the multi‑path case (K>1), off‑path information can help, leading to a decomposition into path selection plus single‑path BV. Building on this, the authors propose a practical, on‑path‑only greedy multi‑path block verification (GBV) and report sizable block‑efficiency gains with best wall‑clock improvements at K=3."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "Clear formalization and optimality in single‑path. The LP view cleanly isolates prefix‑matching as the true bottleneck. Theorem 3.3 and Theorem 3.4 together pin down BV as optimal among all valid single‑path algorithms, not just on‑path‑restricted ones.  \nMulti‑path decomposition. The paper’s factorization, randomized path selection to induce a “skewed draft” followed by single‑path BV, is conceptually neat and technically useful for designing approximations.  \nPractical algorithm & evidence. GBV is implementable using only on‑path probabilities. Experiments show monotone block‑efficiency gains with K (diminishing returns) and best wall‑times at K=3, with K=4 hurting latency, is an honest and useful practical takeaway."}, "weaknesses": {"value": "1. Related‑work coverage needs to be tightened and comparisons made precise.  \n\nThe paper states that tree verification (Hu & Huang, 2024) improves over token‑wise verification but is provably worse than block verification (BV). Sun et al. (2024b) prove BV’s optimality among single‑path, on‑path verification algorithms, but that result does not by itself imply a strict separation from tree verification. If this is the intended positioning, please give a crisp statement of assumptions and regimes and, if possible, a short proof sketch or a pointer to a lemma that implies the strict separation (the current text only states it).\n\nI could not find a citation or discussion of “Traversal Verification for Speculative Tree Decoding”, which appears closely related to verification on drafted trees and off‑path usage. Given your multi‑path/tree motivations, a comparison seems important, please add and position it.\n\n2. Strength of the verification‑class constraints should be better motivated.  \n\nDefinition 3.1 enforces single‑path prefix‑matching by construction, your own results show this is exactly why single‑path optimality caps out at BV even with full off‑path information. It would help to explicitly foreground this as a modeling choice (not just a technical convenience) and to discuss whether any practically relevant relaxations of prefix‑matching are possible or desirable.  For example, “Traversal Verification for Speculative Tree Decoding” takes a less restrictive choice.\n\n3. typos:\n\nTheorem 4.6, Equation (17): missing a summation on the LHS.\nEquations (22), (23): the conditional distributions are omitted in the notation."}, "questions": {"value": "Comparison to “Traversal Verification for Speculative Tree Decoding.” How does GBV (path selection + BV) compare, conceptually and empirically, to traversal‑based verification over a draft tree? At $L=1$ special case, does “Traversal Verification for Speculative Tree Decoding” give better acceptance rate than GBV?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "aaZzIByhQv", "forum": "sqZP2BlxRu", "replyto": "sqZP2BlxRu", "signatures": ["ICLR.cc/2026/Conference/Submission14412/Reviewer_i8ax"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14412/Reviewer_i8ax"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission14412/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761998946702, "cdate": 1761998946702, "tmdate": 1762924818975, "mdate": 1762924818975, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes Greedy Multi-Path Block Verification (GBV), a practical extension of block verification for speculative decoding.\nThe authors formulate an information-agnostic linear program that characterizes all valid verification algorithms under prefix- and target-matching constraints, showing that standard block verification remains optimal in the single-path case. They then extend this formulation to multiple draft paths (K > 1), derive submodular constraints, and develop a tractable greedy approximation using tree-based path ranking with only on-path probabilities. Empirically, GBV improves block efficiency by 30% and reduces decoding walltime by around 15% on OPT model pairs across GSM8K, HumanEval, and MATH500."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "The paper writing is clear. The paper provides detailed theoretical analysis.  The paper also presents an efficient method called\ngreedy multi-path block verification."}, "weaknesses": {"value": "The evaluation is limited. First, this paper only select block efficiency and wall time as metrics. For other metrics, such as acceptance rates should also be incorporated. Moreover, this paper only select one model family, such as OPT and only consider relatively small model such as 6.7B. It is necessary to investigate the effectiveness of proposed approach on larger models. Furthermore, this paper does not consider some important factors, e.g., temperature. Different temperature may lead to different distribution and it is not clear whether the proposed approach can be robust across all temperature settings."}, "questions": {"value": "See weaknesses."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "AnAocKJYBz", "forum": "sqZP2BlxRu", "replyto": "sqZP2BlxRu", "signatures": ["ICLR.cc/2026/Conference/Submission14412/Reviewer_5zQa"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14412/Reviewer_5zQa"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission14412/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762245881592, "cdate": 1762245881592, "tmdate": 1762924818525, "mdate": 1762924818525, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}