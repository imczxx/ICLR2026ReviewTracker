{"id": "A9sDqFy82S", "number": 15913, "cdate": 1758257050415, "mdate": 1759897273385, "content": {"title": "Sampling On Metric Graphs", "abstract": "Metric graphs are structures obtained by associating edges in a standard graph with segments of the real line and gluing these segments at the vertices of the graph. The resulting structure has a natural metric that allows for the study of differential operators and stochastic processes on the graph. Brownian motions in these domains have been extensively studied theoretically using their generators. However, less work has been done on practical algorithms for simulating these processes. We introduce the first algorithm for simulating Brownian motions on metric graphs through a timestep splitting Euler-Maruyama-based discretization of their corresponding stochastic differential equation. By applying this scheme to Langevin diffusions on metric graphs, we also obtain the first algorithm for sampling on metric graphs. We provide theoretical guarantees on the number of timestep splittings required for the algorithm to converge to the underlying stochastic process. We also show that the exit probabilities of the simulated particle converge to the vertex-edge jump probabilities of the underlying stochastic differential equation as the timestep goes to zero. Finally, since this method is highly parallelizable, we provide fast, memory-aware implementations of our algorithm in the form of a custom CUDA kernel that is up to ~8000x faster than a GPU implementation using PyTorch. We corroborate our theoretical results with numerical experiments applying our implementation to star metric graphs. In terms of accuracy and efficiency, our scheme significantly outperforms a baseline finite volume scheme.", "tldr": "We present a parallelizable timestep splitting Euler-Maruyama algorithm for sampling on metric graphs with theoretical guarantees and a fast, custom CUDA kernel implementation.", "keywords": ["sampling", "metric graphs", "Langevin diffusion", "Brownian motion", "Euler-Maruyama", "GPUs", "CUDA", "Monte Carlo", "parallel algorithms"], "primary_area": "probabilistic methods (Bayesian methods, variational inference, sampling, UQ, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/76deb377323d96378420b8cce845899dc1cad49f.pdf", "supplementary_material": "/attachment/caa5787ef60b7f54060ae94a92629de5ff13eab4.zip"}, "replies": [{"content": {"summary": {"value": "The paper touches on a very interesting problem with solid research dealing with differential equations posed on metric graphs. Nevertheless, I feel that ICLR by its core definition is the wrong venue for this research and it is better suited for numerical analysis journal/UQ journal."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 1}, "strengths": {"value": "I think the paper is well written and deals with an interesting problem but I do not see it as being particularly focused on learning algorithms and doubt its suitability for ICLR."}, "weaknesses": {"value": "I feel that the poor performance of the FVM needs to be discussed and these methods usually perform very well on metric graphs but have, of course, other weaknesses. The formatting of all the references is terrible please fix the bib-entries."}, "questions": {"value": "- Please explain how changing the orientation of an edge does not change the inward derivative?\n- In (1) and (2) the subscript e is not explained. It is clearly the restriction onto the edge but please be precise.\n- I am a bit suspicious about the FVM scheme as it seems to completely fail for the Fokker Planck equation, any reasons why? There are existing FVM schemes for quantum graphs to be found on Github that seem to do well for other PDEs."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "OHwVmZBhMS", "forum": "A9sDqFy82S", "replyto": "A9sDqFy82S", "signatures": ["ICLR.cc/2026/Conference/Submission15913/Reviewer_uQfq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission15913/Reviewer_uQfq"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission15913/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761550398409, "cdate": 1761550398409, "tmdate": 1762926132999, "mdate": 1762926132999, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper tackles sampling on metric graphs by introducing a time-step–splitting Euler–Maruyama (EM) scheme to simulate Brownian motion, and hence Langevin diffusions, on metric graphs. It proves that the number of vertex crossings is finite with high probability and that exit probabilities of the simulation converge to the SDE's vertex-edge jump probabilities as the step size tends to zero. The authors also present highly parallel, memory-aware implementations, and experiments show the method outperforms a finite-volume baseline in accuracy and speed."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper introduces a novel and interesting time-step–splitting EM scheme for Brownian/Langevin on metric graphs, with guarantees of finite splits (w.h.p.) and exit-probability convergence as step size goes to 0. \n\n2. This method is efficient and scalable with memory-aware, highly parallel GPU implementation that showing strong speedups and accuracy gains over a finite-volume baseline with empirical validation"}, "weaknesses": {"value": "Results are interesting but restricted to star graphs and applicability to general metric graphs is neither analyzed nor empirically validated.\n\nBeyond finite splits and exit-probability consistency, there are no non-asymptotic weak/strong error bounds or sampling error rates.\n\nMinors:\n\n- \"Sampling On Metric Graphs\" should be \"Sampling on Metric Graphs\"\n\n- Line 405 the normalizing constant B if given by -> the normalizing constant B is given by"}, "questions": {"value": "Q1: What's the non-asymptotic convergence rate?\n\nQ2: What are the challenges for non-star graphs, and can you show experiments on non-star graphs?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "NA"}, "rating": {"value": 8}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "uEg6kbNhwX", "forum": "A9sDqFy82S", "replyto": "A9sDqFy82S", "signatures": ["ICLR.cc/2026/Conference/Submission15913/Reviewer_E8PR"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission15913/Reviewer_E8PR"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission15913/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761994477758, "cdate": 1761994477758, "tmdate": 1762926132525, "mdate": 1762926132525, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper investigated the practical implementation of sampling in metric graphs. It seems that the authors generalise the Euler-Maruyama discretization of Langevin diffusion for continuous distribution. They provide a theoretical guarantee that the jump distribution generated by their proposed algorithm asymptotically converges to the target distribution. Then they provide a parallelizable version of the proposed algorithm to get fast and memory-saving implementation."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. The problem investigated in this paper seems to be novel, having theoretical and practical value.\n\n2. This paper has a certain mathematical depth."}, "weaknesses": {"value": "1. There are some claims that they did not explain clearly. For example, in Line 133-134, they claimed that the results of the star graphs researched in this paper can extend to general graphs. They did not explain how to extend.\n\n2. The presentation should be improved. The key section “Brownian Motion on Metric Graphs” should be more detailed, especially on the boundary conditions, which is not friendly to the readers."}, "questions": {"value": "The theoretical results seems to be valid for all target distribution $b_v$, which means they did not need to make any assumption on $b_v$. This is different from Unadjusted Langevin Algorithm for sampling in continuous distribution, which usually make assumptions on smoothness and isoperimetry properties of potential function."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "HE09okbCTL", "forum": "A9sDqFy82S", "replyto": "A9sDqFy82S", "signatures": ["ICLR.cc/2026/Conference/Submission15913/Reviewer_se1y"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission15913/Reviewer_se1y"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission15913/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761997140255, "cdate": 1761997140255, "tmdate": 1762926131892, "mdate": 1762926131892, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper focuses on the numerical simulation problem of Brownian motion and Langevin diffusions on metric graphs and proposes a timestep splitting Euler-Maruyama-based discretization method.\nIt handles vertex crossings by recursively splitting the simulation step, moving the particle to the vertex, and sampling a new edge. Theoretical analysis prove the algorithm terminates finitely and converges to correct vertex-edge jump probabilities as the timestep decreases.\nA custom, memory-aware CUDA kernel is implemented for fast, parallelized execution on GPUs. \nNumerical experiments on a 5-edge star graph with linear and quadratic potentials demonstrated the effectiveness of the proposed method. \nThe reported results show significant speedups and higher accuracy in recovering steady-state densities compared to FVM."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. Though the theory of function space and Brownian motion on metric graphs is well-established, practical simulation algorithm is non-existent. This paper provides a concrete and practical method to simulate this process, which is a novel contribution to the field and will be beneficial for future work in this field. \n\n2. Theoretical analysis is thorough and insightful. Theorem 2 & 3 addresses the concern of an infinite loop due to repeated vertex crossings within a single timestep, which is crucial for the practicality of the algorithm.  Corollary 1 links the algorithm's behavior to the underlying SDE, proving that the simulated jump probabilities converge to the correct theoretical values $b_v$. These theoretical analysis provide a solid ground for the proposed method.\n\n3. The CUDA kernel implementation achieves a massive speedup over a simple Pytorch implementation. This engineering effort significantly elevates the paper's utility for practitioners and researchers needing large-scale simulations."}, "weaknesses": {"value": "1. Experimental Evaluation is limited critically. The entire numerical evaluation is conducted on a synthetic star graph with only 5 edges. Metric graphs are powerful precisely for modeling networks with complex cycles, multiple vertices, and varied edge lengths. Demonstrating performance only on a star graph provides almost no evidence that the algorithm works on metric graphs in general. Besides, this paper does not demonstrate the effectiveness of algorithm on a real-world problem or dataset, which undermines its potential impact. The performance gap versus the FVM baseline, while impressive, is less meaningful without a real-world context.\n\n2. While Theorem 2 guarantees finite runtime, empirical analysis of the computation cost introduced by vertex crossings is missed. How does the average number of splits M scale with $\\delta t$, the drift magnitude, and the graph complexity? This is an important practical consideration that is left unexplored."}, "questions": {"value": "1. Can you provide theoretical or experimental analysis to show that Algorithm 1 works effectively on a non-star metric graph, for instance, a graph containing a cycle or multiple interconnected vertices?\n\n2. Can you provide experimental results on a concrete real-world dataset?\n\n3. This paper focuses exclusively on standard boundary conditions, which can be further improved by discussing limitations of the current algorithm regarding these more general conditions or outlined a path for future extension."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "None"}, "rating": {"value": 4}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "KUl3AB8ccg", "forum": "A9sDqFy82S", "replyto": "A9sDqFy82S", "signatures": ["ICLR.cc/2026/Conference/Submission15913/Reviewer_Wjmx"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission15913/Reviewer_Wjmx"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission15913/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761998438405, "cdate": 1761998438405, "tmdate": 1762926131507, "mdate": 1762926131507, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}