{"id": "ZIFScA15KB", "number": 10834, "cdate": 1758182889479, "mdate": 1759897625650, "content": {"title": "Counterfactual Digital Twin: Generating What-If Trajectories with Uncertainty", "abstract": "Answering \\textit{what-if} questions is crucial in many decision-making domains, especially in time-sensitive areas such as healthcare, strategy, and policy. Generating counterfactual trajectories requires both predictions based on a unit's observed history and evidence from similar units exposed to the alternative conditions. Building upon this view, we develop an effective model called CounterTwin, which yields ensembles of all possible what-if trajectories and their posterior uncertainty. Specifically, CounterTwin learns how trajectories evolve from factual data using a transformer, and summarizes counterfactual evidence with synthetic control. These sources are then integrated through a Kalman filter, where the transformer serves as the prior belief and the synthetic control as a noisy measurement. This information fusion produces stable counterfactual rollouts with natural uncertainty. Extensive experiments on synthetic and real data show that CounterTwin achieves superior accuracy and robustness over existing methods. Code is available at \\url{https://anonymous.4open.science/r/CounterTwin-44F8/}.", "tldr": "Counterfactual Digital Twin: Generating What-If Trajectories with Uncertainty", "keywords": ["Causality", "Digital twin", "Kalman filter", "Synthetic control", "Transformer"], "primary_area": "causal reasoning", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/d661a24270fa76d6b274cd828207dea6e2a12547.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper aims to help provide full rundowns of multiple alternative versions of input scenarios, supported by clearly traceable reasoning."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "The authors have provided a detailed rundown of the mathematical processes they use to calculate these trajectories, and display a great understanding of the concepts they discuss."}, "weaknesses": {"value": "There should ideally be a little more detail given in the beginning about why some algorithms were chosen over others."}, "questions": {"value": "There should ideally be a little more detail given in the beginning about why some algorithms were chosen over others. \nFor example, why TFT over Informer (https://arxiv.org/abs/2012.07436), or pinball loss over a potentially more robust alternative (https://arxiv.org/pdf/2011.09588)? \nThe first part of this paper would strongly benefit from a diagram to provide a simple framework example of how this methodology can be applied to create multiple counterfactual trajectory paths, as parts of the current text read a bit like a walkthrough of a series of mathematical methods without callbacks to why these choices were made. \nWhile the last third of the paper does provide an experimental study within a medical context, the first two thirds read as a dense walkthrough of various mathematical concepts rather than an overview of a connected methodology. \nI also did not see a clear definition of uncertainty within the context of this paper, which is important when using a term that has multiple definitions. \nAdditionally, if KNNSampler consistently performs better than CounterTwin, why is CounterTwin necessary? In what ways does it provide a better alternative to KNNSampler?\n\nOverall, I rate this paper a weak accept. I think the idea is novel and has the capacity to address a variety of different real-world issues, particularly in the medical field. However, it needs to be more specific about the problems previous approaches have, as well as specify how CounterTwin solves these problems.\nAs a note, there may potentially be a typo on page 3: should one of the T expressions have a different suffix (not i), since itâ€™s representing an alternate treatment path?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "aFW3eFqxMe", "forum": "ZIFScA15KB", "replyto": "ZIFScA15KB", "signatures": ["ICLR.cc/2026/Conference/Submission10834/Reviewer_bkgq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission10834/Reviewer_bkgq"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission10834/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761951271691, "cdate": 1761951271691, "tmdate": 1762922037605, "mdate": 1762922037605, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces CounterTwin, a \"counterfactual digital twin\" framework that generates personalized what-if trajectories for an individual under different treatment scenarios, along with estimates of uncertainty. Instead of simulating a single observed trajectory, CounterTwin aims at produce multiple treatment-conditioned paths for the same unit (for instance a considered patient) and quantify the confidence in those prediction.  The contribution consists in formalizing the setting of conterfactual traectories generation with a digital twin, defining CounterTwin that combines quantile-level sequence predictions of individual progression with SC-based donor distributions, and integrates them via a Kalman update to produce treatment replicas with posterior uncertainty. Countertwin performance is evaluated on both synthetic and real-world data."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- the main paper is overall well written ad easy to read. \n- The considered topic of evaluating counterfactual trajectories over time is definitely relevant and the idea of combining this with modern architectures and UQ methods is nice\n- the experimental section combines both synthetics and real world examples"}, "weaknesses": {"value": "- the related work sections (and consequently baselines choice) is missing a major literature area that focuses on the formalization of structural causal models within dynamic treatment regimens for counterfactual trajectories generation. See below in questions\n- the paper does not mention any commonly made causal assumptions on the system, for instance consistency, sequential ignorability, and sequential overlap and then there are not theoretical results that its counterfactual estimates are identifiable from data. This is not necessary in all cases but I think in these settings then the claims need to be toned down and the experimental section more complete."}, "questions": {"value": "- can the authors elaborate on the methodological difference between this approach and methods like [1,2,3,4] and specifically whether the  identifiability guarantees are similar?\n\n\n[1] Melnychuk, Valentyn, Dennis Frauen, and Stefan Feuerriegel. \"Causal transformer for estimating counterfactual outcomes.\" International conference on machine learning. PMLR, 2022.\n[2] Bica, Ioana, et al. \"Estimating counterfactual treatment outcomes over time through adversarially balanced representations.\" arXiv preprint arXiv:2002.04083 (2020).\n[3] Li, Rui, et al. \"G-net: a recurrent network approach to g-computation for counterfactual prediction under a dynamic treatment regime.\" Machine Learning for Health. PMLR, 2021.\n[4] Schwarz, Thomas, Cecilia Casolo, and Niki Kilbertus. \"Uncertainty-Aware Optimal Treatment Selection for Clinical Time Series.\" arXiv preprint arXiv:2410.08816 (2024)."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "yMhjVtV8rp", "forum": "ZIFScA15KB", "replyto": "ZIFScA15KB", "signatures": ["ICLR.cc/2026/Conference/Submission10834/Reviewer_pmym"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission10834/Reviewer_pmym"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission10834/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762017496032, "cdate": 1762017496032, "tmdate": 1762922037119, "mdate": 1762922037119, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces CounterTwin, an approach that combines TTF (a transformer model for forecasting patient trajectories) and the synthetic control framework to generate uncertainty-aware counterfactuals. The approach is evaluated on both synthetic and real clinical data."}, "soundness": {"value": 1}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "* The problem of generating counterfactuals in digital twins is interesting and relevant\n* The idea of combining forecasting models, synthetic controls, and Kalman filter fusion seems novel"}, "weaknesses": {"value": "The paper has two main weaknesses: insufficient justification of some design choices and shortcomings in the experimental evaluation. Regarding design choices: \n* One is the choice of the TFT model. TFT outputs quantiles, but you need mean and variance. Have you considered architectures that directly output the parameters of the Gaussian? \n* Another is the choice of a Kalman filter for combining TFT and SC outputs. KFs are optimal only when the underlying system is linear and may perform poorly otherwise, with predicted covariance blow-ups. Why not consider a particle filter / rejection sampling-based approach, which doesn't require such assumptions?\n* The choice of uncertainty sources in the SC model is sensible, but arbitrary. Do you have empirical evidence to support this particular design, as opposed to e.g, deterministic weights (i.e., baseline SC) or without $\\Sigma_\\text{mis}$?\n\nRegarding the experimental evaluation:\n* The analysis of counterfactuals (Table 2 and Figure 4) should also include the performance of your SC method, to understand if the fusion with the TTF data brings any advantage.\n* Moreover, Figure 4 should include results with SynCtrl (2021)\n* Since it's a central part of the approach, it's important to assess the quality of the Kalman-based fusion on the real data, where process linearity is not guaranteed. It'd be good to assess, e.g., how the predicted covariance evolves over time and how variance distributes across the different components/dimensions of the state.  \n* Section 6 is not useful; figures 5 and 6 don't contribute to validating the method and are not adequately explained."}, "questions": {"value": "I'd appreciate it if you could address the questions and issues raised in the weaknesses section."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "iZuzxcwc4R", "forum": "ZIFScA15KB", "replyto": "ZIFScA15KB", "signatures": ["ICLR.cc/2026/Conference/Submission10834/Reviewer_Ap1p"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission10834/Reviewer_Ap1p"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission10834/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762051242232, "cdate": 1762051242232, "tmdate": 1762922036722, "mdate": 1762922036722, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}