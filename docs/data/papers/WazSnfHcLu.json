{"id": "WazSnfHcLu", "number": 18773, "cdate": 1758290758525, "mdate": 1763187735228, "content": {"title": "Flow-Distorted Plane Waves", "abstract": "The plane wave basis is widely used in Galerkin approximation, due to its periodicity and computational advantage, where the fast Fourier transform (FFT) can be applied. However, since its spatial resolution is uniform, the number of basis functions required can be excessive for problems with rapidly varying local features. We propose an adaptive basis called flow-distorted plane wave (FDPW), where the bijection of a normalizing flow is used to distort the problem domain, hence achieving adaptive resolution. We apply FDPW to Kohn-Sham density functional theory (DFT) calculations to both molecular and solid-state systems, demonstrating improved speed and memory usage.", "tldr": "", "keywords": ["AI for science", "Normalizing Flow", "Fourier Transform", "Density Functional Theory"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/034fa89c7736551d1d19ea82aca4b935ff2d60fb.pdf", "supplementary_material": ""}, "replies": [{"content": {"title": {"value": "Common replies to all reviewers"}, "comment": {"value": "We sincerely thank all reviewers for their constructive comments and valuable suggestions that have improved the quality of our submission. Here, we address some important questions raised by reviewers from the theoretical standpoint. We will also address questions that require further experiments later on, and we will include additional results in the revised manuscripts. \n\n(R1) Limited experimental scope:\n\nWe acknowledge this point. We would like to stress that the position of this paper is to propose the FDPW method, which can be further developed through subsequent papers. Adding support for all realistic scenarios requires substantial work, and all existing electronic structure methods start from the simple cases and gradually build up. We would like to emphasize again that our method is the first neural network ansatz that works in ab initio DFT calculation, and works for periodic systems.\n\n(R2) Didn't compare to USPP/PAW:\n\nWe would like to emphasize the positioning of our method: our method is an *adaptive basis* powered by normalizing flow, that can be used in all-electron periodic DFT calculations with *minimal overhead*. Our method is orthogonal to PW-pseudopotentials (PW-PP) and PAW, since these methods modify the external potential, whereas our method modifies the basis. In fact, FDPW can be used in conjunction with PP/PAW:\n\n- Using local pseudopotentials is straightforward. We already use ANC, which is a local all-electron pseudopotential\n- In previous literature, like [2], a similarly constructed adaptive PW is used together with a non-local pseudopotential\n- PAW methods work by separating the physical space into an augmentation sphere where pseudo-waves are used, and a smooth region where regular PW is used. It is entirely possible to replace PW with FDPW in the smooth region. Although formally compatible, we would like to note that combining FDPW and PAW is unnecessary since the main advantage of PAW over PP is that it can perform all-electron calculations; FDPW can already do that.\n\nWe would also like to clarify what benefits FDPW brings compared to PP/PAW:\n- PW-PP methods reduce the cutoff by not modeling core electrons. This makes the applicability of PP methods limited, as it cannot model physicals property that relies heavily on core states like the NMR shielding. FDPW is all-electron: we model the core electron, and cutoff reduction comes from the distortion of physical space. \n- While PAW is all-electron, it parameterizes the pseudo waves with off-line generated projectors for each atom type, whose generation procedure is opaque. In contrast, in FDPW, the basis generation process is transparent, which is a simple density fit as we described in section 4.4, and the basis is adapted to the whole system instead of atom-wise. Furthermore, the adaptation is created via a neural network, which enables subsequent works in creating data-driven methods for basis generation or other downstream tasks, which is not possible if one uses PAW.\n  \n(R3) Didn't compare to other adaptive bases:\n\nReal-space Finite difference (FD):\n1. The Laplace-Beltrami operator becomes non-SPD with naive discretization. The accuracy deteriorates quickly for nonsmooth metrics, which limits the degree of adaptivity possible.\n2. The energy is no longer variational, which means that the error can carry an arbitrary sign, i.e., one could obtain an energy below the true ground-state energy.\n3. Translational invariance is lost, so application to the periodic system becomes harder.\n4. FD does not benefit from the FFT acceleration. In contrast, FDPW retains k-point decoupling via the modified Bloch phase factor, and we can still use FFT for acceleration.\n\nFinite Elements (FE) and Wavelets (WL):\n1. Learning-ready adaptivity: Adaptive FE/WL improves the accuracy of a calculation via grid refinement. Adaptivity is typically driven by error estimators or hand-crafted refinement and is not naturally set up for data-driven or jointly learnable basis generation. In FDPW, adaptivity is encoded by a flow model, which enables data-driven development in the future. See more in (R6).\n2. Hardware and implementation: FFTs deliver very high arithmetic intensity and mature scaling on GPUs/TPUs. FE/WL matrices are sparse but non-diagonal, which pushes the cost into iterative sparse matvecs and preconditioning. Whether FE/WL outperforms PW depends on many engineering factors; we therefore chose to hold the algebra fixed and evaluate adaptivity alone. Also, FE typically has a much higher scaling constant than FFT, and its strength is mainly in handling complex boundary/geometry, which is not needed in the cases we consider."}}, "id": "DjTdhm9wmY", "forum": "WazSnfHcLu", "replyto": "WazSnfHcLu", "signatures": ["ICLR.cc/2026/Conference/Submission18773/Authors"], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18773/Authors"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission18773/-/Official_Comment"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1763187453484, "cdate": 1763187453484, "tmdate": 1763188140214, "mdate": 1763188140214, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Comment", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes Flow-Distorted Plane Waves (FDPW): a geometry-aware basis obtained by composing a lattice linear map $T$ with a learned torus diffeomorphism $g_\\theta$ while retaining PW-style algebra (FFT/NUFFT and k-point decoupling via a modified Bloch phase). The only \"learning\" component is a one-shot KL fitting of $g_\\theta$ to a prescribed density, after which $g_\\theta$ is frozen and the electronic structure problem is solved on the distorted basis."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "- **Algebraic elegance and clarity.**  \n  Recasting the Bloch phase as $ \\exp(i\\,k^\\top f^{-1}(r)) $ is a neat device that simultaneously addresses the $k$‚Äìspace coupling due to $T$ and the nonlinear phase distortion due to $g$, yielding block-diagonal structure across $k$ after the warp.  \n- **Computationally coherent PW replacement.**  \n  Local operators are evaluated via two inverse FFTs and pointwise products; the kinetic energy becomes a ‚Äúminimal‚Äëcoupling‚Äù quadratic form over the warped metric, avoiding dense $G{\\times}G'$ matrices while preserving PW‚Äëlike efficiency.  \n- **Compact warp parameterization.**  \n  A circular RQS autoregressive flow on the torus offers sufficient expressivity with a small parameter count, suggesting a practical path to spatial adaptivity without abandoning spectral tooling.  \n- **Potential for efficiency gains.**  \n  The premise‚Äîachieving target accuracy with fewer modes/smaller grids by concentrating resolution near physically singular/rapid‚Äëvariation regions‚Äîaddresses a real bottleneck in PW‚Äëstyle solvers. Flag For Ethics Review\n\nNo ethics review needed"}, "weaknesses": {"value": "(W1) Empirical evidence\n\n-\tThe present experimental scope appears limited (e.g., one crystalline material and one small molecule).\n-\tA quantitative, matched-accuracy comparison with recent adaptive bases/coordinate approaches, as well as strong PW+PAW/USPP setups, would help readers gauge relative merits in time/memory/accuracy.\n-\tAblations seem absent for:\n(i) NUFFT parameters (oversampling, kernel width) versus accuracy and wall-clock;\n(ii) flow capacity/regularization;\n(iii) the contribution of the prescribed-density fit versus simpler prescriptions/no fit;\n(iv) Hartree/Poisson preconditioner robustness.\nA compact table of matched-accuracy results and a few ablation curves would substantiate the efficiency claims more convincingly.\n\n(W2) Learning is used as a pre-fit; $g_\\theta$ is then fixed.\nThe ML component is currently a one-shot geometry pre-fit,\n\\\\[\\min_{\\theta}\\ \\mathrm{KL}\\\\big(p_\\theta \\,\\|\\, \\rho_{\\mathrm{prescribed}}\\big),\\qquad p_\\theta \\text{ induced by } g_\\theta,\\\\]\nafter which $g_\\theta$ becomes a fixed, differentiable background for operator evaluation. In essence this is a basis change (a warped PW basis).\n\n-\tWhy is learning necessary at all? Would an analytic/hand-crafted warp (e.g., radial crowding near nuclei plus lattice symmetries) achieve similar results? Please quantify.\n-\tWhy not adapt $g_\\theta$ during SCF/geometry optimization with stability safeguards (slow updates, penalties, bilevel schedules)? If attempted, please report stability and net benefit; otherwise the ML contribution may be viewed as just implementation convenience rather than learning.\n\n(W3) Writing/positioning for an ML venue\n\nThe abstract, introduction, and related work are too terse for orienting ML readers: the problem, background, and significance are not sufficiently articulated, and the method exposition mixes core ideas with plumbing. It may help to separate ‚Äúconcept $\\to$ algebraic consequences $\\to$ implementation modules‚Äù and to add a brief ‚Äúmethod-at-a-glance‚Äù figure."}, "questions": {"value": "- **(Q1)** Clarify roles of $T$ vs $g$ in Eq. (6). Even with $g=\\mathrm{Id}$, the lattice map $T$ generally couples $(G,k)$, breaking cross-$k$ orthogonality unless the Bloch phase is expressed through $f^{-1}$. The manuscript should explicitly separate: (a) the linear mismatch introduced by $T$ (which is induced by problems), and (b) the nonlinear distortion from $g$ (which is induced by methods).  \n- **(Q2)** On the representation $g=\\mathrm{Id}+g_p$ and its scope. Arguments that absorb the periodic part into the cell-periodic function rely on $g$ being an orientation-preserving torus diffeomorphism homotopic to identity (as realized by the circular-flow family). They do not cover flips such as $g=-\\mathrm{Id}$. Please state this assumption explicitly and indicate which steps (e.g., triangular Jacobian/log-det structure) rely on it.  \n- **(Q3)** There are several formatting issues.  \n  - Lines 248 and 249 are too close.  \n  - The format of the symbol \"-\" seems incorrect, e.g., in line 149.  \n  - There is a typo in lines 90‚Äì91: ‚Äúwhen we G in subscript we mean‚Ä¶‚Äù."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "70ut29Q6KP", "forum": "WazSnfHcLu", "replyto": "WazSnfHcLu", "signatures": ["ICLR.cc/2026/Conference/Submission18773/Reviewer_A7Dq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18773/Reviewer_A7Dq"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission18773/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761548962032, "cdate": 1761548962032, "tmdate": 1762999992202, "mdate": 1762999992202, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces Flow‚ÄëDistorted Plane Waves (FDPW), a Galerkin basis that composes a periodic, bijective normalizing flow on the 3‚Äëtorus with plane‚Äëwave coordinates to obtain adaptive spatial resolution while retaining much of the plane‚Äëwave algebra (FFT/NUFFT structure). The authors provide a rigorous mathematical formulation grounded in differential geometry, treating wavefunctions as half-densities. A key theoretical contribution is the introduction of a modified Bloch phase factor, which elegantly preserves k-space decoupling in periodic systems‚Äîa necessity for efficient solid-state calculations.\n\nHowever, this coordinate transformation introduces significant complexity. The Laplacian becomes the Laplace-Beltrami operator, requiring the evaluation of complex geometric quantities (Jacobian, metric tensor, connections) derived from the flow. Crucially, the Hartree potential can no longer be solved directly in Fourier space and requires an iterative Preconditioned Conjugate Gradient (PCG) solver. External potentials are handled via Non-Uniform FFTs (NUFFT).\n\nThe authors demonstrate the method on simple systems (Diamond, CO, H2), suggesting that FDPW can achieve comparable accuracy to standard PWs with a smaller basis set size (N). While this suggests potential memory savings, the analysis of the introduced computational overheads and the comparison against standard practices in the field are insufficient to establish practical superiority."}, "soundness": {"value": 3}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "The paper presents a mathematically sophisticated approach to adaptive basis sets, with notable theoretical innovations.\n\n1. Elegant Solution to K-Space Decoupling: The introduction of the modified Bloch phase (Sec 4.2) to maintain orthogonality between different k-points in a distorted coordinate system is a significant theoretical contribution. It elegantly resolves a fundamental barrier to applying DPW methods in periodic systems.\n\n2. Rigorous Geometric Formulation: The authors provide a thorough derivation based on differential geometry (Appendices E, F, G). The treatment of wavefunctions as half-densities ensures the unitarity of the transformation and provides a sound basis for deriving the operators.\n\n3. Novel Synthesis: Combining normalizing flows, a modern ML technique, with the established DPW framework offers a parameter-efficient and differentiable approach to defining the adaptive basis."}, "weaknesses": {"value": "While the approach is theoretically strong, the paper has significant limitations regarding the scope of validation, analysis of computational overhead, and practical applicability.\n\n1. Insufficient Comparisons to Standard Practices: The comparison is limited to vanilla Plane Waves. FDPW is presented as an all-electron method (using ANC potentials). To assess practical relevance, comparisons against highly optimized PW codes using standard pseudopotentials (e.g., PAW or ultrasoft), which inherently reduce the required basis size, are necessary. Comparisons with other modern adaptive basis methods (e.g., Lindsey & Sharma (2024)) are also missing.\n\n2. Dependence on Heuristic Initialization: The method's performance relies on a two-stage process where the flow is first fitted to a heuristic \"prescribed density\" (Sec 4.4), involving several hyperparameters (Eq 13) and regularization weights (Eq 15). The paper does not sufficiently explore the robustness and sensitivity of the results to this initialization procedure.\n\n3. Unanalyzed and Potentially Prohibitive Computational Overhead: FDPW introduces substantial overhead per iteration. This includes evaluating the flow and computing complex geometric quantities via automatic differentiation at every grid point. The kinetic energy evaluation (Eq. 18) and the iterative nature of the PCG solver also add significant cost. The paper lacks a breakdown of these costs and their scaling, making the true efficiency trade-off unclear.\n\n4. Numerical Stability and Conditioning: There is a fundamental tension between adaptation (requiring strong distortions) and numerical stability. Strong distortions lead to ill-conditioned metric tensors, which can slow down the PCG solver and increase quadrature errors. This trade-off is not analyzed.\n\n5. Limited Empirical Validation and Missing Features: The experiments are restricted to very simple systems (Diamond, H2, CO). Performance on realistic scenarios (metals, defects) remains unexplored. Furthermore, the framework lacks support for essential features like non-local pseudopotentials and efficient force calculations.\n\n6. Accessibility: The paper heavily relies on advanced concepts from differential geometry (e.g., fiber bundles, pullbacks, connections) and solid-state physics. While rigorous, this presentation style makes the paper highly inaccessible to a general ICLR audience, with crucial details buried in extensive appendices."}, "questions": {"value": "The following major concerns must be addressed to improve the assessment of this work:\n\n1. Have you tested FDPW on more complex systems than Diamond or CO, such as metallic systems or systems with defects? How does the complexity of the required normalizing flow scale with the heterogeneity of the physical system?\n\n2. Standard PW calculations typically use optimized pseudopotentials to significantly reduce the required energy cutoff. How does the efficiency of the proposed all-electron FDPW method compare to a standard PW implementation using efficient norm-conserving or PAW pseudopotentials? \n\n3. How sensitive are the final accuracy and convergence speed to the hyperparameters of the prescribed density initialization and the elastic regularization? Was significant tuning required for the examples shown?\n\n4. In the finite system experiments (Table 3), the PW results seem very poorly converged, and the FDPW energies also differ significantly from the reference. Could you clarify these discrepancies and the convergence behavior of both PW and FDPW for this system?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "lv9FNNuda4", "forum": "WazSnfHcLu", "replyto": "WazSnfHcLu", "signatures": ["ICLR.cc/2026/Conference/Submission18773/Reviewer_MiZ7"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18773/Reviewer_MiZ7"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission18773/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761716398082, "cdate": 1761716398082, "tmdate": 1762928549594, "mdate": 1762928549594, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces Flow‚ÄëDistorted Plane Waves (FDPW), an adaptive Galerkin basis for Kohn‚ÄìSham Density Functional Theory (DFT). The FDPW basis is constructed by applying a periodic normalizing flow on the 3‚Äëtorus to standard plane-wave coordinates. A key innovation is a modified Bloch factor, $ùëí^{ikf^{-1}(r)}$, which is designed to preserve ùëò-point orthogonality. A special care is taken to efficiently treat different terms of arising equations."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "- The paper proposes a principled way to add adaptivity to plane‚Äëwave methods while retaining their simple algebra and FFT‚Äëfriendly structure.\n- Modifying the Bloch phase to work with the distortion is neat and keeps the usual \\(k\\)-space structure intact. \n- Using a compact normalizing‚Äëflow map to enhance a classical solver is a sensible, lightweight use of ML that fits existing workflows.\n- Preliminary experiments suggest the method maintains spectral‚Äëlike accuracy in practice while noticeably reducing parameters and resource use."}, "weaknesses": {"value": "I see this paper as a first step in an interesting direction, but there remains substantial room for improvement. At the current stage, there is little theoretical or practical analysis of the approach‚Äôs limitations. In particular, there is no systematic study of accuracy versus cutoff or an examination of NUFFT and curvilinear discretization errors, which would help establish numerical reliability. The paper also lacks comparison with other adaptive bases, such as finite elements or wavelets, making it difficult to judge relative advantages. Despite these gaps, whether or not it becomes a powerful long-term method, in my opinion, it opens a valuable direction worth exploring, and I am leaning towards acceptance."}, "questions": {"value": "1) Is there anything you pay for using $f^{-1}(r)$ or are there no noticiable drawbacks?\n2) How does FDPW handle GGA gradients in practice? Any challenges with hybrid functionals or nonlocal pseudopotentials?\n3) How sensitive are performance and accuracy to the prescribed‚Äëdensity parameters $a_l,b_l,c$?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "M6koQn4YBk", "forum": "WazSnfHcLu", "replyto": "WazSnfHcLu", "signatures": ["ICLR.cc/2026/Conference/Submission18773/Reviewer_bdxq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission18773/Reviewer_bdxq"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission18773/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761933188140, "cdate": 1761933188140, "tmdate": 1762928516126, "mdate": 1762928516126, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}