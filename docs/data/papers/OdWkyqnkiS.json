{"id": "OdWkyqnkiS", "number": 16303, "cdate": 1758262949676, "mdate": 1759897248916, "content": {"title": "Contrastive Residual Energy Test-time Adaptation", "abstract": "Test-Time Adaptation (TTA) enhances model robustness by enabling adaptation to target distributions that differ from training distributions, improving real-world generalizability. However, most existing TTA approaches focus on adjusting the conditional distribution and therefore exhibit poor calibration, as they rely on uncertain predictions in the absence of labels. Energy-based TTA frameworks provide an alternative by modeling the marginal distribution of target data without depending on label predictions, but their reliance on costly sampling hinders scalability in real-world scenarios where decisions must be made without latency. In this work, we propose Contrastive Residual Energy Test-time Adaptation (CRETTA), a practical solution for reliable adaptation. We first redefine the marginal distribution of target data using residual energy function and embed it into contrastive objective. This design prevents overfitting through adaptive gradient reweighting mechanism that leverages the relative residual energy while eliminating the sampling process. Extensive experiments demonstrate that CRETTA achieves scalable and well-calibrated adaptation under real-world computational constraints.", "tldr": "CRETTA is a practical test-time adaptation strategy that uses a contrastive residual energy objective with adaptive gradient reweighting to achieve stable and well-calibrated robustness to distribution shifts.", "keywords": ["test-time adaptation", "energy-based model", "calibration"], "primary_area": "other topics in machine learning (i.e., none of the above)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/2eafd816c6e6a29ec39022bb604af88ec9dd8fa1.pdf", "supplementary_material": "/attachment/20e2c3c447b72cb1906891ebe700e74afc7033fd.pdf"}, "replies": [{"content": {"summary": {"value": "The paper aims to improve model robustness under distribution shift without access to labeled source data. The authors argue that existing TTA methods relying on conditional distributions suffer from poor calibration, while energy-based approaches, though label-free, are computationally expensive due to sampling. To address these limitations, the authors propose Contrastive Residual Energy Test-Time Adaptation (CRETTA), which defines a residual energy function over target data and incorporates it into a contrastive objective. An adaptive gradient reweighting mechanism is used to mitigate overfitting and eliminate the need for sampling. Experimental results are reported to show that CRETTA achieves better calibration and efficiency compared to prior TTA methods."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. Test-time adaptation remains an active and challenging area, and the paper’s focus on calibration and computational efficiency is well-motivated.\n\n2. The integration of residual energy modeling with a contrastive objective is conceptually interesting and may open paths toward energy-efficient adaptation."}, "weaknesses": {"value": "1. While the paper presents an interesting reformulation of energy-based adaptation, the overall contribution appears incremental—largely combining existing ideas (energy modeling, contrastive learning, and gradient reweighting) with limited novelty. \n\n2. According to Table 1, the experiment improvements are marginal at best, and are worse in many cases. In general the empirical section demonstrates some improvements but does not convincingly establish robustness, scalability, or significant gains over strong baselines."}, "questions": {"value": "1. Why does not the performance improve over TEA in Table 1? Why is the performance improvement is larger in Table 4?\n\n2. What is the computational cost of CRETTA relative to energy-based methods that rely on sampling?\n\n3. \"CRETTA consistently outperforms other methods on most of corruption types in calibration as reported in Table 9.\" But there is no Table 9, there are only 7 tables."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "6dk75h9Kck", "forum": "OdWkyqnkiS", "replyto": "OdWkyqnkiS", "signatures": ["ICLR.cc/2026/Conference/Submission16303/Reviewer_SoyK"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission16303/Reviewer_SoyK"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission16303/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760471221588, "cdate": 1760471221588, "tmdate": 1762926444635, "mdate": 1762926444635, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces CRETTA, a sampling-free energy-based framework for Test-Time Adaptation (TTA). Unlike conventional TTA methods that rely on uncertain conditional predictions (e.g., entropy minimization) or costly energy-based sampling, CRETTA focuses on modeling only the residual energy, the discrepancy between the source and target distributions. By embedding this residual energy into a contrastive learning objective, CRETTA removes the need for normalization constant approximation or Markov Chain Monte Carlo (MCMC) sampling, achieving well-calibrated and efficient adaptation."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The paper introduces a residual energy formulation that redefines TTA as learning only the distributional discrepancy between source and target domains. It is conceptually fresh and removes a reliance on normalization constant approximation.\n- The paper is well-structured and readable.\n- Experiments are extensive, covering CIFAR10/100-C, TinyImageNet-C, PACS, and ImageNet-C, with consistent improvements in both accuracy and calibration error (ECE)."}, "weaknesses": {"value": "- Although the paper argues that residual energy learning stabilizes adaptation, its claimed insensitivity to the source buffer suggests that the absolute source energy distribution plays a minor role. This raises the question of whether residual learning is fundamentally required, could similar stability be achieved simply by modulating target energies relative to arbitrary reference energies? (For example, AEA uses the low energy target samples as source buffer to reduce the source-target energy gap.)\n- The ablation studies focus mainly on buffer composition and size; additional analysis on temperature sensitivity or else for residual learning could strengthen understanding of the method’s robustness.\n- While the paper reduces the computational overhead of energy-based TTA by removing normalization constant estimation, the core idea of using EBMs for TTA follows prior works such as TEA and AEA. The contribution feels incremental, as sampling-free energy optimization has already been actively explored in other domains (e.g., sampling-free EBMs, RLHF, DPO). Moreover, performance gains over those baselines seem to be marginal.\n- Evaluation is confined to standard online TTA; results under continual or episodic adaptation are missing, limiting the understanding of CRETTA’s robustness in dynamic environments.\n- The ablation using CIFAR10-C with CIFAR100 as a replay buffer is not fully convincing, since the two datasets share similar data distributions and semantics. A more meaningful test would involve substituting with a cross-domain dataset (e.g., PACS or TinyImageNet) or reversing the setup (using CIFAR10 as the buffer for CIFAR100-C)."}, "questions": {"value": "See weakness section"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "N/A"}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "4cWhrQDBTA", "forum": "OdWkyqnkiS", "replyto": "OdWkyqnkiS", "signatures": ["ICLR.cc/2026/Conference/Submission16303/Reviewer_ew8X"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission16303/Reviewer_ew8X"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission16303/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761728551739, "cdate": 1761728551739, "tmdate": 1762926444029, "mdate": 1762926444029, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents CRETTA, a  residual energy–based test-time adaptation framework designed to achieve efficient and well-calibrated adaptation under distribution shifts. Unlike entropy minimization–based methods that depend on unreliable pseudo-labels or energy-based approaches that require costly sampling, CRETTA introduces a residual energy function to model the discrepancy between source and target distributions. By embedding this residual function within a contrastive learning objective, the method removes the need for normalization constant approximation and significantly reduces computational overhead. Experiments across multiple benchmarks, including CIFAR10/100-C, TinyImageNet-C, PACS, and ImageNet-C, showing consistent improvements in both accuracy and calibration error, with strong robustness to overfitting and catastrophic forgetting."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper introduces a residual energy perspective* on test-time adaptation, which elegantly models distribution shifts as residual corrections to a pretrained energy landscape. This idea is both conceptually appealing and technically original, offering a clear advance over existing MLE- or entropy-based methods.\n\n\n2. By eliminating sampling and normalization constant estimation, CRETTA achieves major computational savings (over 6× reduction in GFLOPs compared to TEA) without sacrificing performance, making it practical for real-time or resource-constrained deployment.\n\n\n3. The experiments are thorough, covering multiple benchmarks and including ablation studies, buffer analysis, and gradual shift scenarios. The results convincingly demonstrate CRETTA’s robustness, calibration quality, and insensitivity to buffer composition."}, "weaknesses": {"value": "1. The proposed framework adapts to the marginal distribution $p(x)$ via residual energy modeling, yet classification fundamentally depends on the conditional distribution $p(y|x)$. The paper does not clearly explain how aligning $p(x)$ leads to improved conditional decision boundaries or classification accuracy. Without a theoretical bridge (e.g., via Bayes decomposition or information-theoretic reasoning), the causal link between marginal alignment and better predictive performance remains speculative.\n\n2. Dependence on source data: CRETTA relies on a small source buffer to perform contrastive adaptation. While the buffer can be as small as 1% of the source dataset and even substituted with similar-domain data, this still departs from the strict source-free TTA setting. In privacy-sensitive or memory-limited scenarios, this requirement might constrain the method’s deployment.\n\n3. The contribution of the contrastive component is central to the method, yet there is no targeted ablation isolating its effect from the residual modeling itself. Including such analysis would help clarify whether performance gains stem mainly from contrastive optimization or other architectural factors."}, "questions": {"value": "The proposed framework adapts to the marginal distribution $p(x)$ via residual energy modeling, yet classification fundamentally depends on the conditional distribution $p(y|x)$. Could the authors clarify how aligning $p(x)$ contributes to improved conditional decision boundaries and classification accuracy? Is there any theoretical justification (e.g., based on Bayes decomposition or information-theoretic reasoning) for this linkage?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "LmrD7iasJa", "forum": "OdWkyqnkiS", "replyto": "OdWkyqnkiS", "signatures": ["ICLR.cc/2026/Conference/Submission16303/Reviewer_GnBf"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission16303/Reviewer_GnBf"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission16303/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761976207416, "cdate": 1761976207416, "tmdate": 1762926443299, "mdate": 1762926443299, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces a test-time adaptation framework based on residual energy, CRETTA to enable efficient and well-calibrated adaptation under distribution shifts. In contrast to entropy-minimization methods that rely on unreliable pseudo-labels or energy-based approaches that demand expensive sampling, CRETTA employs a residual energy function to capture the discrepancy between source and target distributions. By integrating this residual function into a contrastive learning objective, the framework eliminates the need for normalization constant estimation and substantially reduces computational cost."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. CRETTA avoids both sampling and normalization constant estimation, leading to remarkable efficiency gains relative to other energy-based method. \n\n2. The residual design is well-motivated, it allows the model to adapt using minimal, controlled adjustments to the existing parameters, ensuring stability and preserving previously learned knowledge.\n\n3. CRETTA consistently improves both accuracy and ECE across diverse datasets and corruption severities. The method maintains stable calibration even on challenging settings such as TinyImageNet-C and PACS, demonstrating that the proposed residual-energy mechanism contributes to reliable uncertainty estimation rather than merely higher accuracy.\n\n4. The paper is well written and easy to follow, with logical organization and smooth transitions between motivation, method, and experiment."}, "weaknesses": {"value": "1. The paper leverages an energy-based formulation for test-time adaptation, yet it remains unclear why energy modeling should be theoretically effective in this context. Could the authors provide more intuition or formal justification for why minimizing or adapting an energy function leads to improved generalization under distribution shift? \n\n2. While the experiments cover standard corruption and small-to-medium-scale datasets (CIFAR10/100-C, TinyImageNet-C, PACS), the paper does not evaluate CRETTA on larger and more diverse domain generalization datasets such as DomainNet. Validation on such benchmarks would better demonstrate the scalability and robustness of the proposed method under complex, real-world domain shifts."}, "questions": {"value": "Could the authors clarify the fundamental difference between energy-based and entropy-based test-time adaptation methods? Specifically, how does optimizing an energy function over the marginal distribution differ in objective and behavior from minimizing the prediction entropy of y given x?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "Wm4iCmWYOd", "forum": "OdWkyqnkiS", "replyto": "OdWkyqnkiS", "signatures": ["ICLR.cc/2026/Conference/Submission16303/Reviewer_fAWb"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission16303/Reviewer_fAWb"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission16303/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761997570695, "cdate": 1761997570695, "tmdate": 1762926442796, "mdate": 1762926442796, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}