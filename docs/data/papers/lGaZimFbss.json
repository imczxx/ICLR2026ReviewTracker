{"id": "lGaZimFbss", "number": 17860, "cdate": 1758281338210, "mdate": 1759897149530, "content": {"title": "Matching without Group Barrier for Heterogeneous Treatment Effect Estimation", "abstract": "In heterogeneous treatment effect estimation from observational data, the fundamental challenge is that only the factual outcome under the received treatment is observable, while the potential outcomes under other treatments or no treatment can never be observed. As a simple and effective approach, matching aims to predict counterfactual outcomes of the target treatment by leveraging the nearest neighbors within the target group. However, due to limited observational data and the distribution shifts between groups, one cannot always find sufficiently close neighbors in the target group, resulting in inaccurate counterfactual prediction because of the manifold structure of data. To address this, we remove group barriers and propose a matching method that selects neighbors from all samples, not just the target group. This helps find closer neighbors and improves counterfactual prediction. Specifically, we analyze the effect estimation error in matching, which motivates us to propose a self optimal transport model for matching. Based on this, we employ an outcome propagation mechanism via the transport plan for counterfactual prediction, and exploit factual outcomes to learn a distance as the transport cost. The experiments are conducted on both binary and multiple treatment settings to evaluate our method.", "tldr": "", "keywords": ["causal inference", "matching"], "primary_area": "causal reasoning", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/36aa9072d669defab14a3203525f6d6610ce15ae.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper investigate the limitation of existing matching approaches in causal inference, which select neighbors only from the target treatment group, leading to suboptimal counterfactual predictions due to data sparsity and distribution shifts. Hence, this paper proposes a novel matching framework: The core innovation is removing group barriers entirely, allowing neighbor selection from all samples regardless of treatment assignment. Then it develops a self optimal transport model and information propagation mechanism to realize the algorithm. The method is rigorously evaluated across both synthetic and semi-synthetic datasets."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper identifies a clear limitation in conventional matching methods-the data sparsity in the specific treatment group can induce the difficulty in finding the near neighborhood. \n\n2. It provides a solid theoretical motivation by analyzing the estimation error in matching, which naturally leads to the formulation of the self optimal transport model. \n\n3. The experimental design is thorough. A lot of typical baselines are incoporated into the experiments. This shows that the approach is effective."}, "weaknesses": {"value": "1. This paper propose the algorithm based on the matching method. Although I believe the proposed method is superior to the vanilla matching method, it is still unclear why the matching-based method is superior to the other classes of methods, such as regression-based method (e.g. CFRNet and GANITE).\n\n2. In the simulation experiments, only the statistics over all the setup $m=0.1, 0.4, 0.7, 1.0, 1.3$ is calculated. I suggest to reveal the results on each setup respectively. This is beneficial for understanding the behavior of the method under different scenarios."}, "questions": {"value": "1. I am curious about the role of $Y \\odot M$ in equation (14). I think $Y \\odot M = Y$. Why does this term is incorporated?\n\n2. In the current framework, the mapping function $\\phi$ and the transport cost matrix are learned simultaneously. I am interested in exploring the effect of adopting a two-stage learning process where these two components are learned separately."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "No"}, "rating": {"value": 4}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "O8eIJ4u3Cb", "forum": "lGaZimFbss", "replyto": "lGaZimFbss", "signatures": ["ICLR.cc/2026/Conference/Submission17860/Reviewer_dnf7"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17860/Reviewer_dnf7"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission17860/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761544290006, "cdate": 1761544290006, "tmdate": 1762927689034, "mdate": 1762927689034, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes MOGA (Matching without Group Barrier), a novel method for estimating heterogeneous treatment effects (HTEs) under the potential outcomes framework.\nThe key innovation lies in establishing a theoretical and algorithmic connection between Sinkhorn-regularized optimal transport (OT) and counterfactual effect estimation.\nInstead of restricting matching to samples within the same treatment group, MOGA finds neighbors across all groups, enabling more reliable counterfactual estimation even when group distributions differ.\n\nThe method further introduces a random walk–based outcome propagation procedure to iteratively diffuse factual outcomes over the learned sample graph, achieving global consistency of counterfactual prediction.\nAdditionally, MOGA learns a distance function via self-supervised optimal transport driven by factual outcomes, aligning the feature space with outcome similarity.\n\nExperiments on semi-synthetic and simulated datasets show consistent improvements in PEHE, ATE, and AMSE metrics over a broad range of baselines."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- This paper formulates causal matching as a Sinkhorn-regularized optimal transport problem, and provides theoretical error bounds which explicitly motivate the design of the objective.\n- The proposed framework integrates a novel random-walk mechanism for counterfactual propagation, combining matching, representation-learning and outcome-prediction into one unified pipeline. This global propagation over the sample manifold is inventive and extends beyond traditional nearest-neighbour or single‐group matching methods."}, "weaknesses": {"value": "- The empirical evaluation is restricted to semi-synthetic and simulation datasets. While these are common in causal inference research, including at least one real-world biased observational dataset would significantly strengthen the practical claims of the method, ensuring it generalises beyond controlled or synthetic settings.\n- The experimental comparisons omit recent OT-based causal estimators. \n- The current formulation appears to assume relatively homogeneous treatment-group distributions and does not explicitly model or correct for internal biases within treatment groups or highly unequal propensity distributions."}, "questions": {"value": "- How would the method perform on real-world biased observational datasets, or what challenges prevent such evaluation?\n- How does the approach address intra-group bias or unequal propensity distributions that may exist within treatment groups?\n- The Sinkhorn regularization introduces an entropy term that can make the transport plan overly smooth, potentially blurring the matching structure. How sensitive is the method to the entropy coefficient $\\lambda_h$? Have the authors considered strategies to prevent the transport plan from collapsing into a nearly uniform coupling?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "8k19x0xcXS", "forum": "lGaZimFbss", "replyto": "lGaZimFbss", "signatures": ["ICLR.cc/2026/Conference/Submission17860/Reviewer_MkPW"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17860/Reviewer_MkPW"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission17860/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761624674698, "cdate": 1761624674698, "tmdate": 1762927688692, "mdate": 1762927688692, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper addresses a fundamental challenge in heterogeneous treatment effect estimation—the unobservability of counterfactual outcomes. Targeting the issue of inadequate matching quality caused by within-group constraints in traditional matching methods, it proposes a Matching method named as Matching withOut Group bArrier (MOGA). MOGA introduces a matching framework that transcends inter-group barriers. While conventional matching only seeks nearest neighbors within the target treatment group, MOGA innovatively allows matching across all treatment groups. By optimizing matching weights through a self-optimal transport model, it expands the effective matching pool and mitigates the problem of excessive matching distances caused by data distribution discrepancies or insufficient samples. Unlike traditional matching that relies solely on covariates, MOGA incorporates factual outcomes into distance learning, ensuring that the matching distance aligns with outcome relevance. Furthermore, it enhances the smoothness of counterfactual predictions by disseminating outcome information via random walks and leveraging the manifold structure of the data, thereby balancing covariate similarity with consistency in outcome patterns."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "In terms of originality, this paper addresses the limitations of traditional within-group matching methods by proposing the MOGA framework, which enables cross-group matching. It integrates an optimal transport model with an outcome propagation mechanism, thereby forming a methodological adjustment to the existing matching paradigm. Regarding quality, the method is designed based on theoretical foundations such as the error bound of optimal transport optimization. Experiments conducted on semi-synthetic and simulated datasets, benchmarking against baseline methods like k-NN and PSM, demonstrate its relative advantages in metrics such as PEHE and ATE. The contribution of individual modules is further validated through ablation studies. In terms of clarity, the paper exhibits a logically coherent structure, with comprehensive explanations of technical details (e.g., the optimal transport formulation) and well-defined key concepts (e.g., cross-group matching), ensuring strong comprehensibility. As for significance, the study addresses the inadequacy of within-group matching in estimating heterogeneous treatment effects from observational data by offering a solution that broadens the matching pool. It enhances counterfactual prediction accuracy in multi-treatment scenarios, thereby holding referential value for methodological applications in the field of causal inference."}, "weaknesses": {"value": "1. Insufficient Verification of Theoretical Assumptions.\nThe core of MOGA relies on the \"self-optimal transport model\" and the \"outcome propagation mechanism.\" However, the paper does not adequately justify the rationality and applicability boundaries of its key assumptions. Optimal transport (OT) models require the transport cost (i.e., the distance between samples) to satisfy mathematical properties such as convexity and lower semicontinuity, while also assuming a certain level of smoothness in the data distribution. The paper does not explicitly clarify whether real-world data meet these conditions, nor does it verify whether the OT model may fail (e.g., by concentrating matching weights on a few samples) when the data exhibit high-dimensional sparsity, non-convex distributions, or outliers, thereby compromising the stability of counterfactual predictions.\n2. Practical application is questionable. \nThe computational complexity of optimal transport models is typically . Although the paper mentions the use of approximation algorithms for optimization, it does not report specific computational time or memory usage. Furthermore, in multi-treatment scenarios, the dimensionality of the transport matrix expands from  to , leading to an exponential increase in complexity. The paper fails to provide optimization strategies or experimental validation for such scenarios, raising doubts about the scalability of the method in practical applications.\n3. Insufficient Experimental Validation.\nThe paper only compares MOGA with k-NN, PSM, and TARNet, without including more advanced methods in the current HTE field (e.g., DragonNet, R-learner, or the Meta-learner series) or improved matching-based methods (e.g., Covariate Balancing Propensity Score). This makes it difficult to demonstrate whether the \"significant advantages\" of MOGA stem from methodological innovation or baseline selection bias. Additionally, the experiments primarily rely on semi-synthetic and simulated data. Semi-synthetic data, often generated based on known models, may fail to capture real-world challenges such as high-dimensional nonlinear confounding and sample selection bias."}, "questions": {"value": "1. The optimal transport models relied upon by MOGA typically assume that data distributions satisfy smoothness or convexity assumptions. If the data are high-dimensional, sparse, non-convex, or contain outliers, might the transport plans introduce biases that affect the stability of counterfactual predictions?\n\n2. The experiments are primarily based on semi-synthetic and simulated data. Has MOGA been validated on real observational data? If so, do metrics such as PEHE and ATE align with those obtained from synthetic data? If not, how can the method's generalization capability be ensured in real-world scenarios with unobservable counterfactuals?\n\n3. The paper claims MOGA exhibits enhanced stability in multi-treatment settings; however, it does not specify the exact number of treatments evaluated (e.g., K=3, 5, 10) nor the associated computational complexity as K increases. Could you provide performance comparisons across different K values and elaborate on scalability optimization strategies for scenarios where K > 10?\n\n4. Could you provide comparative results benchmarking MOGA against more advanced methodologies, such as DragonNet, R-learner, and Meta-learners?\n\n5. MOGA expands the matching pool through cross-group matching, which may implicitly impose stronger exchangeability requirements. Has sensitivity analysis  been conducted to quantify its robustness to unobserved confounding?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "BBQIyO1WlU", "forum": "lGaZimFbss", "replyto": "lGaZimFbss", "signatures": ["ICLR.cc/2026/Conference/Submission17860/Reviewer_7WJ5"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17860/Reviewer_7WJ5"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission17860/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761813853968, "cdate": 1761813853968, "tmdate": 1762927688307, "mdate": 1762927688307, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces a novel approach for estimating heterogeneous treatment effects (HTE) using matching without group barriers. In traditional matching methods, neighbors for a treatment group are selected solely from within that same group. However, the authors argue that such methods are limited by distribution discrepancies and scarce samples in some treatment groups. To address this, the paper proposes a method that removes the barriers between treatment groups, selecting nearest neighbors from all available samples, improving counterfactual predictions. This method is modeled as a self-optimal transport problem, where the transport cost is measured using the distance between samples and factual outcomes. This new method, called Matching withOut Group Barrier (MOGA), is demonstrated to improve prediction accuracy, particularly in both binary and multiple treatment settings, with extensive experiments on synthetic and semi-synthetic datasets."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1.\tInnovative Approach: The method removes the group barrier in matching, which is a common issue in traditional causal inference methods, allowing for better matching of similar samples from different treatment groups.\n\n2.\tTheoretical Foundation: The method is supported by a robust theoretical analysis, providing error bounds and drawing a connection with optimal transport.\n\n3.\tComprehensive Experiments: The paper presents experiments on a variety of datasets, including semi-synthetic data and real-world datasets like TCGA, comparing the proposed method against several traditional methods (e.g., k-NN, PSM, BART). The experimental results demonstrate that MOGA outperforms traditional matching methods, as well as other advanced models like BART and TARNet, in terms of precision in estimating heterogeneous treatment effects."}, "weaknesses": {"value": "1.\tComplexity: The method involves solving optimal transport problems and learning transport plans, which may be computationally intensive, especially for large datasets. The algorithm requires significant computational resources (e.g., a high-performance GPU) .\n\n2.\tDependence on Hyperparameters: The model's performance is sensitive to hyperparameters like λh, λf, λy, and ρ. While the authors provide sensitivity analysis, the method might require careful tuning depending on the dataset .\n\n3.\tAssumptions: A key assumption of the proposed method is that samples from different treatment groups can be meaningfully matched, which may not hold in real-world scenarios. In the presence of unobserved confounding, where latent variables affect both treatment assignment and outcomes, the matching may fail to balance treatment groups, leading to biased estimates. Moreover, if treatment effects vary significantly across subgroups, the assumption of similar effects for matched samples breaks down, as heterogeneous treatment effects may not be captured accurately. Finally, substantial distributional shifts between treatment groups can further hinder meaningful matching, particularly when groups are non-exchangeable due to underlying differences. Thus, the method's effectiveness is highly contingent on these assumptions, which may not always hold in practical settings."}, "questions": {"value": "Refer to Weaknesses above."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "SkgV2NHJDS", "forum": "lGaZimFbss", "replyto": "lGaZimFbss", "signatures": ["ICLR.cc/2026/Conference/Submission17860/Reviewer_VXGC"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17860/Reviewer_VXGC"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission17860/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761922924354, "cdate": 1761922924354, "tmdate": 1762927687648, "mdate": 1762927687648, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}