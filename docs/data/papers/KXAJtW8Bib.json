{"id": "KXAJtW8Bib", "number": 21792, "cdate": 1758321791544, "mdate": 1759896902839, "content": {"title": "Imitation Learning for Multi-turn LM Agents via On-policy Expert Corrections", "abstract": "A popular paradigm for training LM agents relies on *imitation learning*, fine-tuning on expert trajectories. However, we show that the off-policy nature of imitation learning for multi-turn LM agents suffers from the fundamental limitation known as *covariate shift*: as the student policy's behavior diverges from the expert's, it encounters states not present in the training data, reducing the effectiveness of fine-tuning. Taking inspiration from the classic DAgger algorithm, we propose a novel data generation methodology for addressing covariate shift for multi-turn LLM training. We introduce *on-policy expert corrections (OECs)*, partially on-policy data generated by starting rollouts with a student model and then switching to an expert model part way through the trajectory. We explore the effectiveness of our data generation technique in the domain of software engineering (SWE) tasks, a multi-turn setting where LLM agents must interact with a development environment to fix software bugs. Our experiments compare OEC data against various other on-policy and imitation learning approaches on SWE agent problems and train models using a common rejection sampling (i.e., using environment reward) combined with supervised fine-tuning technique. Experiments find that OEC trajectories show a relative 14% and 13% improvement over traditional imitation learning in the 7b and 32b setting, respectively, on SWE-bench verified. Our results demonstrate the need for combining expert demonstrations with on-policy data for effective multi-turn LM agent training.", "tldr": "We develop a novel method for addressing the problem of covariate shift in imitation learning for LM agent.", "keywords": ["large language models", "agents", "distillation", "imitation learning", "tool-use", "multi-turn", "reinforcement learning"], "primary_area": "foundation or frontier models, including LLMs", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/3806defc0940d83fc157239468bad648ab43c2a0.pdf", "supplementary_material": "/attachment/f33eced0d68e1f161fe6c637365e13741869843b.zip"}, "replies": [{"content": {"summary": {"value": "The paper introduces On-Policy Expert Corrections for LLMs' imitation learning, collecting expert correction data by rolling out student trajectories and switching to the expert midway. This allows training on on-policy states while involving expert supervision. Experiments on software engineering tasks show that OECs outperform both behavioral cloning and learning on fully on-policy data."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The experiment is performed on the newly released SWE-bench benchmark, outperforming the baselines in both 7B and 32B settings.\n2. The OEC framework is compatible with any combination of student and expert language models."}, "weaknesses": {"value": "1. **Switching to the LLM expert at a random step is an inefficient and outdated way** to collect online correction data. A better method is to let the expert take over when the student is about to make a mistake, such as LEAP [1], or analyze a complete failure rollout to identify the error steps and provide feedback, such as LFM [2].  \n\n2. Apart from the corrective actions, **LLM experts can also provide reward signals and trajectory preference pairs**. Agent-RLVR [3] uses the expert to generate a corrected trajectory t' for a failed rollout t and performs preference learning over (t, t'), instead of doing behavioral cloning on t'. IRPO [4] and DMPO [5] use LLM-provided reward models to finetune the student via preference learning. In contrast, **OEC discards the student's portion and only performs training on the expert portion of each trajectory**, which may have lower training efficiency.  \n\n3. The baselines are insufficient. In the paper, OEC is **only compared against behavioral cloning and on-policy trajectories**. Several prior works [1–5] share a similar teacher-student-learning setting (especially [3]), but the paper does not demonstrate that OEC achieves better sample efficiency or faster training compared to them.\n\n4. The OEC algorithm is **essentially a variant of DAgger with limited novelty**. DAgger (S Ross et al. 2010) has a lot of variants in robotics and RL, including EnsembleDAgger (K Menda et al. 2018), ThriftyDAgger (R Hoque et al. 2021), etc. These variants involve expert interventions in a much more interactive way, allowing the expert to take over when the agent is uncertain or is about to fail. OEC's sample complexity may be reduced if it uses these DAgger-variants to collect correction trajectories.\n\nReferences:  \n[1] Better than Your Teacher: LLM Agents that learn from Privileged AI Feedback, S Choudhury et al. 2024  \n[2] Policy Improvement using Language Feedback Models, V Zhong et al. 2024  \n[3] Agent-RLVR: Training Software Engineering Agents via Guidance and Environment Rewards, J Da et al. 2025  \n[4] Iterative Reasoning Preference Optimization, RY Pang et al. 2024  \n[5] Direct Multi-Turn Preference Optimization for Language Agents, W Shi et al. 2024"}, "questions": {"value": "1. Can OEC be deployed to other tasks? Does OEC still outperform baselines in the tasks other than SWE-bench? Why does the paper choose this task?\n2. Can you further explain the \"on-policy\" baseline? When the trajectories are entirely rolled out by the student model, how do you use the expert model for supervised fine-tuning?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "fizegywowg", "forum": "KXAJtW8Bib", "replyto": "KXAJtW8Bib", "signatures": ["ICLR.cc/2026/Conference/Submission21792/Reviewer_CGxJ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21792/Reviewer_CGxJ"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission21792/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761612495802, "cdate": 1761612495802, "tmdate": 1762941932463, "mdate": 1762941932463, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces an approach to finetune existing LLMs with on-policy expert corrections. The idea is to use a combination of on-policy and expert samples to construct trajectories, and only update the model with the expert portion of the trajectory. This helps mitigate the effect of covariate shift but also stabilizes training with on-policy samples. Experiments are conducted in software engineering tasks with improvements over prior works.\n\nThe method is a simple variation of online imitation learning, and shows good empirical results. Analysis on the covariate shift between student and expert policies offers an interesting view of the problem."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "* The idea of the approach is simple and easy to follow\n* Emperical results show improvements over prior works on open benchmark\n* The analysis on covariate shift is nicely done"}, "weaknesses": {"value": "* The author mentions the potential of using RL with verifier rewards, but does not compare with any baselines using RL.\n* Based on results, later switching improves the model more, but the method uses uniform sampling to determine the switch time. This seems to be a bit contradictory.\n* The authors mention the no-regret guarantee of DAgger is violated by using OECs, but do not provide any additional theoretical insights.\n* There are no explanations on the results provided in Table 3, so I am a bit confused about the meaning of this experiment.\n* Minor issue with y-axis on figure 2(a), showing 0.17% resolution rate (I believe that it is a plotting mistake?)"}, "questions": {"value": "* What is the rejection sampling with supervised finetuning procedure? Is it simply using successful trajectories from the verifier for supervised training?\n* What is the reasoning behind sampling from uniform distribution as opposed to other distributions, e.g. geometric distribution? Given that experiment results show that switching later is better?\n* How does the method work compared to DAgger?\n* What does finetuning the student model from scratch mean? Do you initialize the weights to be random?\n* Why is BC data added only to the 32B setting and not the 7B setting? Why is BC data important in one setting and not the other?\n* Are there any theoretical guarantees in terms of regret bounds for this algorithm?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "ALcfUdcfym", "forum": "KXAJtW8Bib", "replyto": "KXAJtW8Bib", "signatures": ["ICLR.cc/2026/Conference/Submission21792/Reviewer_x8cu"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21792/Reviewer_x8cu"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission21792/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761949637424, "cdate": 1761949637424, "tmdate": 1762941932152, "mdate": 1762941932152, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper tackles covariate shift for multi-turn LM agents on SWE-bench, proposing On-policy Expert Corrections (OEC): roll out the student on-policy, switch to an expert model at a randomly sampled turn, keep only the expert segment (student tokens are masked during SFT), and filter trajectories via unit-test verification and simple repetition heuristics. Claimed contributions are: (i) an analysis showing student–expert divergence grows with depth; (ii) the OEC data-generation recipe (random switch + masking + verifier filtering); (iii) improved pass@1 over behavioral cloning (BC) and fully on-policy data under their setup; and (iv) ablations isolating the importance of masking and repetition filtering. Key evidence comes from scaling curves (OEC > BC > on-policy), covariate-shift diagnostics across turns, and controlled ablations on filtering/masking."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The paper empirically quantifies turn-wise divergence between student and expert, motivating partial on-policy corrections.\n\n- OEC is simple to implement (random switch, mask student tokens, verifier-gated acceptance) and yields consistent gains over BC and fully on-policy data under the stated setup.\n\n- The study isolates two actionable levers—on-policy masking and repetition filtering—and shows they materially affect results, especially at larger model scales.\n\n- Findings like “later switches help,” and “unit-test filtering alone is insufficient without anti-loop filters,” offer concrete guidance to practitioners training SWE agents."}, "weaknesses": {"value": "1. **Limited novelty relative to established interactive IL.**\n\n   **Problem:** OEC’s core idea—on-policy rollouts with expert corrections—substantially overlaps with DAgger-style data aggregation and related learning-to-search methods; the paper’s unique elements are mainly engineering choices (random switch policy and masking) rather than a new principle. ICLR, novelty beyond well-known IL frameworks is expected; otherwise significance hinges on breadth and rigor of validation.\n\n   **Action:** Clearly position OEC against DAgger/LOLS/AggreVaTeD, including a small theoretical or synthetic analysis of the bias introduced by masking/truncation and the effect of the switch-time distribution; add a controlled comparison to a **DAgger-like** baseline adapted to the same scaffold. \n\n2. **SOTA framing is ambiguous.**\n\n   **Problem:** The paper claims or suggests “SOTA within class,” but the comparison set and constraints (backbone, scaffold, verifier usage, inference-time scaling) are not crisply defined, and some numbers are very close to strong baselines (Table 1). Without a precise protocol, improvements may reflect differences in test-time scaling or data collection rather than the training recipe.\n   \n   **Action:** Define the comparison “class” explicitly; if SOTA is not supported under strict parity (same scaffold, retries, timeouts, verifier configs), rephrase to “competitive.”\n\n\n3. **Possible confounds from distribution differences.**\n\n   **Problem:** Some OEC points in scaling plots appear to mix slightly different instance distributions compared to BC/on-policy. The gains could partially come from instance mix rather than the method.\n\n   **Action:** Re-run scaling where all regimes are collected on the same fixed instance set."}, "questions": {"value": "1. Please define precisely what “state-of-the-art in their respective classes” means (backbone size, scaffold, verifier rules, retries/timeouts, inference-time scaling). Under those constraints, is OEC actually SOTA?\n2. How many evaluation retries, max turns, and unit-test limits were used across methods? Were they identical for all baselines?\n3. Can you report mean ± std over ≥3 seeds for all key numbers and curves?\n4. What is the instance overlap (if any) among expert demos used for pretraining, OEC/BC/on-policy training data, and evaluation splits?\n5. Please provide a controlled comparison to a **DAgger-like baseline** adapted to your scaffold, and discuss how masking/truncation differs theoretically from classic dataset aggregation.\n6. Could you release the exact repetition-filtering heuristics (regexes/thresholds) and masking implementation code?\n7. Have you tested OEC beyond SWE-bench (e.g., SWE-bench-Live or a non-SWE agent domain)? If not, can you discuss expected limitations?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "lLAHZfHGyk", "forum": "KXAJtW8Bib", "replyto": "KXAJtW8Bib", "signatures": ["ICLR.cc/2026/Conference/Submission21792/Reviewer_3hf6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21792/Reviewer_3hf6"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission21792/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762062588593, "cdate": 1762062588593, "tmdate": 1762941931892, "mdate": 1762941931892, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces a method, termed `on-policy expert corrections (OECs)`, to improve imitation learning (i.e., finetuning on expert trajectories) for LLMs. The main problem they are trying to address is covariate shift in standard behavior cloning. OEC is a data-collection scheme where on-policy data from the learner is collected till a random timestep for each trajectory, and then the expert policy is used to collect data for the rest of the trajectory. They conduct experiments on SWE tasks, and show that a combination of standard behavior cloning and learning from OEC data improves over standard behavior cloning alone."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "The paper identifies an important that hasn’t been addressed yet (covariate shift in behavior cloning for LLMs), and proposes a well-motivated and easy-to-understand method\n\nThe experiment design is appropriate for the claims in the paper, and there’s evidence that (i) there is covariate shift between learner and expert’s policies trajectory distribution, and (ii) OECs improve performance for SWE task for 7B and 32B models derived from Qwen2.5-Coder-Instruct series. They include additional experiments (i) showing that masking loss from the learner’s part of the trajectory and filtering out repetitive trajectories is important for good performance, and (ii) showing a LLM-as-a-judge analysis of failure modes of the models trained with different strategies, which is great to have.\n\nThe presentation is very clear."}, "weaknesses": {"value": "The paper introduces OEC as a novel data-generation method, but this strategy of learning from trajectories where we use on-policy behavior till a certain timestep and then switching to expert policy for the rest of the episode has been studied before. For example, this family of strategies is the focus of “Learning to Search Better than Your Teacher” by Chang et. al. at ICML 2015. I think the paper should cite and discuss previous work on OEC in the related works section, and appropriately frame its contribution (e.g., bringing this idea to the setting of behavior cloning for LLMs).\n\nA significant issue with the experiments is that they are performed with a single seed, so there are no error bars. There is past work showing there is significant variation in LLM performance across fine-tuning runs [1, 2, 3], which makes the results suspect. I understand that single-seed results are somewhat the norm in the field due to computational costs, I think the paper should at least acknowledge this limitation.\n\n1. Assessing the Macro and Micro Effects of Random Seeds on Fine-Tuning Large Language Models by Zhou, Savova and Wang\n2. Measuring the Instability of Fine-Tuning by Du and Nguyen\n3. On the Stability of Fine-tuning BERT: Misconceptions, Explanations, and Strong Baselines by Mosbach, Andriushchenko and Klakow\n\nFinally, it seems like the best results in the experiments are obtained by a combination of behavior-cloning using expert data and OEC data, but the paper doesn’t suggest a strategy for choosing the ratio of both data sources. Looking at Figure 3, it seems like including a small amount of OEC data could even degrade performance sometimes."}, "questions": {"value": "-"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "AJ6z7ZJ10o", "forum": "KXAJtW8Bib", "replyto": "KXAJtW8Bib", "signatures": ["ICLR.cc/2026/Conference/Submission21792/Reviewer_Wgwf"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21792/Reviewer_Wgwf"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission21792/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762389336158, "cdate": 1762389336158, "tmdate": 1762941931600, "mdate": 1762941931600, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}