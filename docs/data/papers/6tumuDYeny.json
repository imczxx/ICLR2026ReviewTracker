{"id": "6tumuDYeny", "number": 12630, "cdate": 1758209125915, "mdate": 1759897497253, "content": {"title": "DATR: DDI-Aware Therapeutic Structure Reconstruction for Safer Medication Recommendation", "abstract": "Medication recommendation systems play a critical role in clinical decision support, where ensuring both predicting accuracy and safety, particularly drug-drug interaction (DDI) avoidance, is essential. While recent studies have explored drug molecular structures to enhance accuracy, they often overlook the semantic gap between chemical structures and therapeutic outcomes, leading to suboptimal recommendation. Moreover, existing DDI mitigation strategies typically operate in a post-hoc manner, limiting their ability to proactively prevent adverse interactions. In this work, we propose DDI-Aware therapeutic Structure Reconstruction (DATR), a novel framework that jointly models drug structures, therapeutic intent, and safety profiles. DATR conditionally encodes drug structures based on ATC-derived therapeutic labels, enabling intent-aware representation learning, and introduces a selectivity potential DDI constraint to proactively reduce interaction risk. Experiments on two real-world datasets and evaluations by clinical experts demonstrate that DATR achieves superior performance in recommendation accuracy and DDI reduction. Code is available at https://anonymous.4open.science/r/DATR-7EA8.", "tldr": "We propose DATR, a medication recommendation framework that jointly optimizes therapeutic accuracy and drug safety by therapeutic-aware structure reconstruction and proactive DDI avoidance.", "keywords": ["Medication Recommendation", "Drug-Drug interaction", "Drug Structure"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/bac754f3bbaa874bcf44ecc4c91712d894bcea3d.pdf", "supplementary_material": "/attachment/37b6d0c84f13471ded8e427334fcd57fcb675234.zip"}, "replies": [{"content": {"summary": {"value": "This paper introduces DDI-Aware Therapeutic Structure Reconstruction (DATR), a framework aimed at improving medication recommendation systems by simultaneously enhancing accuracy and safety, specifically by reducing drug-drug interactions (DDIs). The framework integrates molecular structure information with therapeutic intent, using a novel therapeutic structure reconstruction method and a proactive DDI constraint. Experimental results on two real-world datasets show that DATR outperforms existing methods in both accuracy and DDI reduction."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1. The integration of therapeutic intent with molecular structure is an innovative approach. Explicitly considering the clinical significance differences between interacting drugs is an interesting idea. The model is theoretically well-founded.\n2. Extensive experiments on two real-world datasets with ablation studies and case analysis demonstrate strong performance in both effectiveness and safety.\n3. The paper is well-written and well-organized, making it easy to follow. And the appendices gives reproducible details."}, "weaknesses": {"value": "1. The paper does not provide sufficient insight into how the model makes decisions, particularly how the integration of molecular structures and therapeutic intent influences the final recommendations. Explainability is crucial for making clinical decision.\n2. The paper does not discuss how the framework might perform across different therapeutic areas or for drugs with less common usage patterns. It would be helpful to see more discussion on its adaptability or limitations in diverse clinical contexts.\n3. The datasets used (MIMIC-III and MIMIC-IV) are widely used in the healthcare community, but their biases (e.g., patient demographic distribution or disease-specific contexts) might limit the generalizability of the model. Addressing potential biases and testing on more diverse datasets could improve the model’s applicability to different patient populations."}, "questions": {"value": "1. Can you illustrate how specific molecular fragments contribute to disease-specific recommendations through the proposed therapeutic structure reconstruction? Are there examples where the molecular features directly correlate with therapeutic outcomes?\n2. The experiments did not report how many drugs the framework recommends on average. Could you provide this information and discuss how it might affect clinical decision-making and the adoption of the framework in real-world settings?\n3. The variant without the substructure-level representation of DATR underperforms the original model, even worse than some baselines. Could you clarify why the substructure-level representation is crucial and whether the improvements come solely from the addition of BRICS or from other factors? Could alternative explanations be explored for this observed performance drop?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "Xw2w5Ozauk", "forum": "6tumuDYeny", "replyto": "6tumuDYeny", "signatures": ["ICLR.cc/2026/Conference/Submission12630/Reviewer_VBt1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission12630/Reviewer_VBt1"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission12630/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761045806610, "cdate": 1761045806610, "tmdate": 1762923476455, "mdate": 1762923476455, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes DATR (DDI-Aware Therapeutic Structure Reconstruction), a framework that jointly models drug molecular structures, therapeutic intent (ATC-4), and DDI (drug–drug interaction) knowledge. The method not only improves the overall performance of medication recommendation, but also reduces DDIs, thereby mitigating potential adverse impacts of drug–drug interactions during recommendation."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The authors introduce a DDI-constraint mechanism that simultaneously reduces the risk of drug–drug interactions and improves recommendation performance.\n\n2. On two real-world clinical datasets, MIMIC-III and MIMIC-IV, the model achieves state-of-the-art results.\n\n3. The study further involves 20 clinicians to subjectively evaluate the recommended drug combinations, taking into account medications in the patients’ histories that might be appropriate yet previously overlooked, which provides clinical validation of the approach."}, "weaknesses": {"value": "In Appendix D2, the paper presents detailed case analyses for individual patients (e.g., patients X and Y). However, Section 5.3 does not sufficiently document the details of the 20-clinic expert evaluation (e.g., patient conditions, criteria for judging effectiveness, and the underlying rationale). The paper would benefit from adding this analysis or providing more comprehensive expert-evaluation information in the appendix."}, "questions": {"value": "1. In many clinical settings, patients have limited visit histories; thus cold-start scenarios (first several visits) are particularly important for medication recommendation. What's the performance stratified by the number of visits?\n\n2. When the DDI loss is removed (i.e., $\\gamma=0$), the predictive performance decreases rather than increases. What primarily drives this drop? Please clarify if the DDI constraint offers any direct benefit to recommendation accuracy beyond mitigating interaction risk."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "PSVlfQ7Pw0", "forum": "6tumuDYeny", "replyto": "6tumuDYeny", "signatures": ["ICLR.cc/2026/Conference/Submission12630/Reviewer_YK7d"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission12630/Reviewer_YK7d"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission12630/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761809429793, "cdate": 1761809429793, "tmdate": 1762923476136, "mdate": 1762923476136, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces DDI-Aware Therapeutic Structure Reconstruction (DATR), a framework for medication recommendation that jointly optimizes for accuracy and safety. The authors attempt to address two key issues: the semantic gap, where a drug's molecular structure doesn't capture its specific clinical use, and the post-hoc nature of existing DDI-avoidance strategies. DATR's solution involves first applying Therapeutic Structure Reconstruction, which learns drug representations by encoding their molecular structure conditioned on their ATC category. Second, it introduces a Potential DDI Constraint, an asymmetric penalty that identifies interacting drugs and suppresses the one with lower therapeutic relevance to the patient's current condition, preserving only the most critical treatment. Extensive experiments on the MIMIC-III and MIMIC-IV datasets demonstrate that DATR significantly outperforms all baselines, achieving state-of-the-art accuracy while simultaneously recording the lowest DDI rates."}, "soundness": {"value": 3}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "The problem is relevant, and the proposed approach is reasonable. The presented results significantly improve performance when compared to competitor models. Ablation studies provide sufficient evidence for the importance of many of the components of the model, and the robustness to the selection of hyperparameters is well demonstrated."}, "weaknesses": {"value": "## General \n\nWhile the method seems sound and efficient, the presentation of the paper requires more work. Many paragraphs are unclear and convoluted, and following the presented argumentation is at times very difficult. Moreover, mathematical notation is often inconsistent and does not help understand the problem formulation and the proposed solution. Some crucial modeling choices are not properly justified by referencing the relevant literature or claiming authorship of those ideas. Finally, competitor methods are only briefly discussed. \n\nIt seems that the paper suffers from a lack of space to develop certain ideas due to the page limit. Please note that some minor issues are not necessarily wrong passages, but suggestions of parts that could be reduced to leave space to improve the discussion in other sections. \n\n## Major \n\n* Pieces of the Introduction and Related Works sections are too dense and high-level. Examples, concrete cases, figures and a clearer explanation are necessary. Main examples of these issues can be found below, but others may also be present, so the paper would benefit from additional proofreading by the authors.\n\n* Line 45: This alleged gap needs better justification. The cited paper discusses computer vision representation learning. It's not at all clear how this could be extended for molecular representations. Overall, it would be important to have stronger evidence of the existence of such gap, i.e., why only relying on the global structure is not sufficient. \n\n* Line 130: the authors say \"VAEs have recently...\" and proceed to cite a paper from 2015. My understanding is that VAEs are not a recent model, at least by machine learning standards. Other than that, I believe the original VAE paper by Kingma and Welling (2013) [1] would be a better reference for this paragraph. \n\n* Line 132: The sentence here may make a reader believe that the other models discussed in this section do not utilize gradients, which is not the case. \n\n* In \"Deep-learning-based molecular representations\" there's no discussion on molecular transformers, even though this class of models has shown significant results [2]. \n\n* Line 154: It is said that A is a binary matrix and afterward it is said that it is calculated as the amount of known interactions between the medications. Both definitions are contradictory. \n\n* Figure 1 does not correspond to the textual description in the main text. For example, it does not show how categorical features are used to quantify the relevance of a drug category to the health condition of the patient. \n\n* Figure 2 has several problems: the VAE structure is not illustrated, the arrows corresponding to the Potential DDI constraint do not correspond to what is written in the text and there's no mention about CA standing for Cross-Attention. Overall, these problems make it difficult to follow the general architecture of the model.\n\n* Some references seem to have errors. For instance, the reference for \"Attention is All You Need\" only mentions Vaswani as the author, while there are others. \n\n* Line 295: references to the previous works should be included in this part.\n\n* Lines 214-257 present material that largely summarizes well-established concepts. There is no need to go in-depth into the math, citing the original paper that derived these equations may be enough. This section could focus on explaining the practical steps employed to generate the reconstructions in the context of the model, which is not clear as it stands now. \n\n* My major issue with the paper lies on the many details missing to understand the overall structure of the model and the experimental settings. In addition to the examples already provided above, it is unclear what the actual input of the Reconstruction module is and how the authors choose to input the ATC label into the model. \n\n* The paper doesn’t explain how the dataset was handled apart from mentioning the training and testing split. It’s not clear, for example, whether this split was done by patients, that is, whether the model was tested on patients who were not included in the training set.\n\n* One of the claimed contributions of the paper is to address a “semantic gap” by using ATC labels. However, the ablation study does not include an experiment that tests whether this is actually addressed by DATR.\n\n## Minor \n\n* Line 97: this part is very confusing. If I understood it correctly, I would suggest something like \"Furthermore, the model can avoid the dependency on specific drug pairs in the training data because of its global consideration of all drug pairs for potential interacting risks\". \n\n* Lines 111-123: expanding the explanation of instance-based approaches could be beneficial. \n\n* Line 161: use of calligraphical M while before it was normal (see line 151). \n\n* Equation 1: epsilon is not described in the text. \n\n* Equation 7: It may be better to use one equation per line to improve readability. Also, $E_d$, $E_p$, $E_m$ and $T(\\cdot)$ are not explicitly defined in the text.\n\n* Lines 268-269 needs some work. It would be good to change it to something like \"The medication taken by the patient in the previous time point is denoted by...\".\n\n* Table 1: column DDI has no runner-up. Also, it may be beneficial to push down the table.\n\n* Line 434: Notation \"R->T\" needs to be introduced before it is used. \n\n* Appendix C1 is unnecesary.  \n\n* D.3.1: could be enriched by adding sources on this feature of VAEs and limitations in the transfer learning. \n\n## Typos and Language \n\n* Line 63: Reconstruction \n\n* Line 66: label \n\n* Line 101: bridge \n\n* Line 172: obtains \n\n* Line 184: medication, predictions, constraints \n\n* Equation 2: comma in formula \n\n* Line 267: linearly \n\n* Line 983: be \n\n* Line 1113: they are \n\n* Line 1127: utilize \n\nReferences\n\n[1] Kingma, D. P., & Welling, M. (2013). Auto-encoding variational bayes. arXiv preprint arXiv:1312.6114.\n\n[2] Luong, K. D., & Singh, A. (2024). Application of transformers in cheminformatics. Journal of Chemical Information and Modeling, 64(11), 4392-4409."}, "questions": {"value": "* Line 130: what does the authors mean by \"prime factors\"? \n\n* Line 159: Is the DDI graph A or D? Or are there two matrices describing these interactions? \n\n* Line 189: is the idea of using global and substructure-based representation new? \n\n* Line 336: is there a difference between the process for choosing the hyperparameters for DATR and for competitor models? If so, why? \n\n* Equation 12: only $L_{DDI}$ has a weight coefficient? It is common practice in VAEs to also ponder the reconstruction loss. Is there a reason for this choice?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "vegzz6GnJF", "forum": "6tumuDYeny", "replyto": "6tumuDYeny", "signatures": ["ICLR.cc/2026/Conference/Submission12630/Reviewer_cR99"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission12630/Reviewer_cR99"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission12630/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761842868018, "cdate": 1761842868018, "tmdate": 1762923475872, "mdate": 1762923475872, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}