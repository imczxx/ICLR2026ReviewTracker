{"id": "NwzY2yhlme", "number": 17057, "cdate": 1758271684212, "mdate": 1763547088812, "content": {"title": "CryoNet.Refine: A One-step Diffusion Model for Rapid Refinement of Structural Models with Cryo-EM Density Map Restraints", "abstract": "High-resolution structure determination by cryo-electron microscopy (cryo-EM) requires the accurate fitting of an atomic model into an experimental density map. Traditional refinement pipelines like Phenix.real_space_refine and Rosetta are computationally expensive, demand extensive manual tuning, and present a significant bottleneck for researchers. We present CryoNet.Refine, an end-to-end, deep learning framework that automates and accelerates molecular structure refinement. Our approach utilizes a one-step diffusion model that integrates a density-aware loss function with robust stereochemical restraints, enabling it to rapidly optimize a structure against the experimental data. CryoNet.Refine stands as a unified and versatile solution capable of refining not only protein complexes but also nucleic acids (DNA/RNA) and their assemblies. In benchmarks against Phenix.real_space_refine, CryoNet.Refine consistently yields substantial improvements in both model–map correlation and overall model geometric quality. By offering a scalable, automated, and powerful alternative, CryoNet.Refine is poised to become an essential tool for next-generation cryo-EM structure refinement.", "tldr": "", "keywords": ["Protein structure refinement; Cryo-electron microscopy; Deep learning; Density-guided refinement; Geometric restraints; Diffusion model"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/312455aef853ac0cf84598f9cc1187f096eb2d73.pdf", "supplementary_material": "/attachment/0ca8e598f6bb613a022adfa1242164e6809d22c8.zip"}, "replies": [{"content": {"summary": {"value": "This paper proposes CryoNet.Refine, a neural refinement framework that integrates a one-step diffusion model with experimental cryo-EM density map restraints.\nUnlike traditional refinement programs such as Phenix.real_space_refine, CryoNet.Refine introduces:\n1. A learnable density model that maps atomic coordinates to voxelized densities, enabling end-to-end differentiable correlation with experimental maps, and\n\n2. A geometry loss suite that includes differentiable Ramachandran, rotamer, and bond-length/angle penalties.\n\nThe model refines initial structures (often AlphaFold3 predictions) toward experimental densities, showing improvements in map correlation (CCmask, CCmain-chain) and stereochemical quality across 63 cryo-EM complexes."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The combination of a density-aware differentiable loss and stereochemical constraints is technically sound.\n- The paper is well written\n- The paper demonstrates consistent gains over Phenix in both correlation coefficients and geometric metrics (notably, Ramachandran favored and rotamer outliers)."}, "weaknesses": {"value": "- The proposed “one-step diffusion” formulation is described as an innovation, but its necessity is not clearly demonstrated. The ablation shows marginal benefit, and it is unclear why a diffusion step—traditionally for generative sampling—improves deterministic refinement. A comparison to standard coordinate optimization (e.g., gradient descent using the same losses) would help establish that the diffusion mechanism contributes beyond architecture novelty.\n- The “density generator” is mentioned but not architecturally described (layers, parameters, training regime, loss balance weights γ). It is also unclear how the network differs from a Gaussian scattering baseline (molmap from ChimeraX).\n- The ablation in Table 4 shows individual loss terms but does not isolate the impact of the density model vs. geometry components.\nThe diffusion vs. non-diffusion refinement comparison (one-step vs. multi-step) is qualitative; quantitative runtime and accuracy tradeoffs are missing."}, "questions": {"value": "1. What concrete advantage does the diffusion step provide compared to standard coordinate optimization using the same losses?\n2. The authors state that they developed a novel, parameter-free, and differentiable density generator in the Introduction, but Section 3.2.1 indicates that they simply follow the ‘molmap’ implementation in ChimeraX. What, specifically, is novel in this component?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "No concerns"}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "auF1KjgN95", "forum": "NwzY2yhlme", "replyto": "NwzY2yhlme", "signatures": ["ICLR.cc/2026/Conference/Submission17057/Reviewer_yjst"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17057/Reviewer_yjst"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission17057/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761514163752, "cdate": 1761514163752, "tmdate": 1762927070246, "mdate": 1762927070246, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "CryoNet.Refine is an end-to-end framework that automates and accelerates molecular structure refinement. It utilizes a one-step diffusion model that integrates a density-aware loss function with robust stereochemical restraints, enabling it to rapidly optimize a structure against the experimental data."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- This study bridges the gap between structure prediction models and cryoEM densities in a modern approach. With some carefully designed loss functions, CryoNet.Refine brings the power of folding models to cryo-EM model building.\n- The ablation study is comprehensive, and the figures are well made."}, "weaknesses": {"value": "- Why is the model named “one-step diffusion” but takes several recycling numbers?\n- The method part lacks several technical details, and is hard to follow. \n\t- What is the training set of CryoNet.Refine? Is it “trained” for each protein (like ReLION/CryoDRGN), or trained over a set of proteins and evaluated on some test set without tuning the model parameters?\n    - In Section 3.1, line 202, the authors wrote that the model is initialized from Boltz-2’s parameters.\n\t\t- Does CryoNet.Refine has exactly the same model architecture as Boltz-2?\n\t\t- If I am understanding correctly, CryoNet.Refine can be viewed as something like AF3 with classifier guidance. Is that true? \n\t- In line 208, the authors said that AF3 requires hundreds of sampling steps. In line 212, the authors wrote that one-step diffusion poses a key advantage that guidance can be performed directly on the predictions. I admit these two statements, but what confused me is that: AF3 is also a diffusion model which predicts the final sample (instead of predicting the velocity or noise), what is the difference between CryoNet.Refine and AF3?\n\t\t- Can I view AF3 as a one-step diffusion model, although it takes hundreds of steps in the sampling process?"}, "questions": {"value": "- In Section 3.1, line 193, the initial atomic structure is fed into CryoNet.Refine. You said that the model derived pair representation $z$ from the atomic structures. What is the shape of the pair representation? Is the side length of $z$ the number of residues, or the number of atoms?\n- I think AF3 can also benefit from the loss you proposed. What if adopting the loss you proposed to the predicted sample of AF3, like diffusion posterior sampling? (ref: (1) Diffusion posterior sampling for general noisy inverse problems, (2) CryoFM: a flow-based foundation model for cryoEM densities)\n- Since the model is initialzied from Boltz-2, why do you need some geometry loss to constrain the structures? I think a folding model has already contained such knowledge."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "NA"}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "WJajgefuOv", "forum": "NwzY2yhlme", "replyto": "NwzY2yhlme", "signatures": ["ICLR.cc/2026/Conference/Submission17057/Reviewer_aP6u"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17057/Reviewer_aP6u"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission17057/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761573433234, "cdate": 1761573433234, "tmdate": 1762927069931, "mdate": 1762927069931, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposed a model for the refinement of atomic models based on CryoEM density map. Specifically, this work finetunes Boltz2 for each pair of density map and atomic model with the density loss and the geometry loss. The structure is output by a specially designed one-step diffusion module which enables direct back-propagation from the complex loss functions."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- The density loss is conceptually elegant and novel. The one-step diffusion module is well motivated as typical diffusion models can only be trained using specific loss function. The one-step diffusion allows flexible loss defitions.\n- Structure-specific post-training of the Boltz2 model ensures generalization. Previous works directly learn a mapping from density maps to atomic models, which might fail on structures that are significantly different from training data.\n- Better performance than previous methods."}, "weaknesses": {"value": "- As it requires fine-tuning for each structure at inference time, the efficiency is still limited, and the efficiency improvement is not very significant compared to previous methods."}, "questions": {"value": "- What would happen if we directly optimize the coordinates of the input structure instead of network parameters using the density loss and the geometry loss?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "6LgwVuSaLK", "forum": "NwzY2yhlme", "replyto": "NwzY2yhlme", "signatures": ["ICLR.cc/2026/Conference/Submission17057/Reviewer_6iZo"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17057/Reviewer_6iZo"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission17057/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761616692072, "cdate": 1761616692072, "tmdate": 1762927069101, "mdate": 1762927069101, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper focuses on the process of fitting atomic models into experimental density maps for structure determination by cryo-electron microscopy (cryo-EM). Traditional refinement pipelines are computationally expensive and require extensive manual tuning. To address these challenges, the authors present CryoNet.Refine, an end-to-end deep learning framework that automates and accelerates molecular structure refinement. Specifically, CryoNet.Refine employs a one-step diffusion model that integrates a density-aware loss function with robust stereochemical restraints to rapidly optimize structures against experimental data. The framework is capable of refining not only protein complexes but also DNA/RNA–protein assemblies. Experimental results demonstrate that CryoNet.Refine achieves clear improvements over traditional approaches in both model–map correlation and overall geometric accuracy."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1. This paper connects two important things in structural biology, computational modeling (e.g., AlphaFold3) and cryo-EM experimental density maps.\n\n2. The architecture design is well-motivated, improving efficiency while maintaining refinement quality.\n\n3. Presented experimental results demonstrate strong refinement performance, reduced manual effort, and clear efficiency gains over traditional methods."}, "weaknesses": {"value": "1. It is confusing what exactly happens during a training step versus inference. I assume Fig. 2 provides an overview of the training process. During inference, there seems to be no computation of density or geometry loss, and the model likely performs only a single pass through the Atom Encoder, Sequence Embedder, and Diffusion Module. Clarifying this distinction would help readers better understand the workflow and computational efficiency.\n\n2. Several simple yet informative baselines are missing — for example, numerical optimization starting from the initial structure. Including such comparisons would better contextualize the claimed improvements.\n\n3. There is no ablation study comparing the classical diffusion model with the one-step diffusion approach. \n\n4. The density generator component is not evaluated. Details about its data patterns or visualizations are absent, and there is no discussion on how well the generated densities align with experimental cryo-EM maps, which can vary significantly depending on the instrument and imaging conditions.\n\n5. The number of reported test cases is too small. A larger-scale evaluation is necessary to establish robustness and generalizability across diverse molecular systems."}, "questions": {"value": "1. If my assumption in Weakness 1 is correct, that no density or geometry loss is computed during inference, would it be beneficial to incorporate these losses as a form of test-time refinement? \n\n2. Figure 2 includes a Pairformer module, but it is never discussed in the text. Is this a Transformer-based component where cross-attention occurs between atom and sequence embeddings?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "sKEw77KMkE", "forum": "NwzY2yhlme", "replyto": "NwzY2yhlme", "signatures": ["ICLR.cc/2026/Conference/Submission17057/Reviewer_9SBf"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17057/Reviewer_9SBf"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission17057/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761939499715, "cdate": 1761939499715, "tmdate": 1762927068671, "mdate": 1762927068671, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}