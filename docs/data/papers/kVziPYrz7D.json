{"id": "kVziPYrz7D", "number": 14843, "cdate": 1758244628196, "mdate": 1759897345988, "content": {"title": "One-Shot Clustering for Contextual Bandits with Knapsacks", "abstract": "In this work, we study the problem of clustered linear contextual bandits with knapsack constraints, a setting that closely models real-world recommender systems. In such systems, the overwhelmed number of items makes it impractical to explore all options, and overexposing certain items can harm content diversity and fairness. To address these challenges, our algorithm clusters actions to enable knowledge transfer across similar items and incorporates global resource constraints to limit over-consumption. We provide a formal analysis showing that the algorithm achieves sublinear regret in the number of time periods, even without access to the full action set. Notably, we prove that it is sufficient to perform clustering once on a randomly selected subset of actions.", "tldr": "", "keywords": ["bandits", "knapsack", "clustering"], "primary_area": "other topics in machine learning (i.e., none of the above)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/59dc72e3137ce1a4f7c1c464698723066b0b5d37.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This work studies the contextual bandits problem with knapsack constraints, with the additional condition that the total $K$ arms are grouped into $C$ clusters, and only the arms in a pre-determined subset $\\mathcal S \\subset [N]$ can be played. \nMeanwhile, contexts are i.i.d. across arms and timeslots. \nIn this problem, this paper proposes an algorithm that is based on OFU (optimism in the face of uncertainty), the algorithm achieves a regret of $O(T^{1 - \\delta})$ when the resource is $\\tilde{\\Omega}(T^{2\\delta})$ for $\\delta \\in (0, 1/2)$."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "On the pro side, I think the problem is well motivated, and the model is appropriate. \nThe solution of this paper combines the methods from clustering and contextual bandits with knapsacks, and leads to a no-regret result, which is generally satisfying."}, "weaknesses": {"value": "The authors do not discuss the widely-studied case that $\\delta = 1/2$, or that the resource constraint increases linearly with the timespan. \nThis is an important case that is covered by works in the CBwK literature. \n(Btw, in Line 71, $B > \\tilde{O}(T^{2\\delta})$ is not an appropriate expression. \nIt seems that you mean $B = \\tilde{\\Omega}(T^{2\\delta})$?)\n\nMeanwhile, I highly suggest that the authors improve their organization and writing of this paper. \nFor example, in Section 4, the paper keeps using $N_{\\mathcal S}$ and $T_0$ before they are formally defined in Section 5. \nIn Section 5, $\\rho(\\pi)$ is also used before being defined. \nAlso, the clustering process is almost not discussed in the main body, only by a sentence in Line 322 and in Line 5 of Algorithm 1. \nThis procedure should be emphasized more since it is an important part of this work, yet the detailed clustering method is only given in the Appendix. \nI encourage the authors to talk more about intuitions on the clustering in the main body and put less effort on the technical lemmas given by the clustering. \nThis will lessen the burden of reading the paper. \n\nFurther, some folklores are not mentioned in this paper, e.g., $OPT$ gives an upper bound on all online algorithms. \nAs another example, the online mirror descent algorithm, though widely used, is not given in the paper, which makes the paper a bit incomplete. \nMeanwhile, the citation could be more appropriate. \nFor example, no citation is given in the main body when the confidence ellipsoid is discussed, yet this is a common technique in the online learning literature. \n\nIn fact, I have reviewed this paper in NeurIPS 2025, when the authors committed to having ALREADY resolved the above issues in the manuscript. \nI failed to see that, unfortunately. \nI have to give an even lower score based on this."}, "questions": {"value": "See the above \"weakness\" part."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "PFOOHX8kpt", "forum": "kVziPYrz7D", "replyto": "kVziPYrz7D", "signatures": ["ICLR.cc/2026/Conference/Submission14843/Reviewer_QqcZ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14843/Reviewer_QqcZ"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission14843/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761411329310, "cdate": 1761411329310, "tmdate": 1762925198202, "mdate": 1762925198202, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies contextual bandits with knapsack constraints in which arms share unknown cluster structures. It proposes clusterLCBwK, an algorithm that performs one-time clustering on a small subset of sampled arms using Classifier-Lasso, then optimizes decisions under resource constraints based on estimated cluster parameters. The algorithm jointly learns the cluster structure and the linear models, achieving high-probability cluster identification and sublinear regret bounds."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- The paper provides a thorough theoretical analysis of the proposed algorithm, including regret bounds and cluster identification errors.\n- The proposed algorithm combines techniques for clustering using Classifier-Lasso with techniques for bandits with budget constraints."}, "weaknesses": {"value": "- The assumptions that the number of clusters is known and fixed, and the smallest cluster proportion $p_{\\min}$ is known, are restrictive and may not hold in real-world scenarios. \n- No empirical evaluation is provided to validate the theoretical findings and demonstrate the algorithm's performance in practice."}, "questions": {"value": "- Could the authors discuss the practical applicability of the assumption that the number of clusters is known and fixed, or is there any solution to relax this assumption?\n- Comparing to LinCBwK, it seems that the dependence on the context dimension $m$ is worse in clusterLCBwK. Could the authors discuss this?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "9ydn2SDF0T", "forum": "kVziPYrz7D", "replyto": "kVziPYrz7D", "signatures": ["ICLR.cc/2026/Conference/Submission14843/Reviewer_axvH"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14843/Reviewer_axvH"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission14843/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761652652395, "cdate": 1761652652395, "tmdate": 1762925197793, "mdate": 1762925197793, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies the linear contextual bandit problem with knapsack constraints, motivated by real-world scenarios that involve resource and fairness considerations. To address these challenges, the authors propose an algorithm that clusters actions to enable knowledge transfer across similar items. The paper provides a formal regret analysis showing that the proposed algorithm achieves sublinear regret in $T$. A notable feature is that clustering only needs to be performed once on a randomly selected subset of actions."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. The problem is well-motivated and captures realistic constraints such as fairness and limited resources. The combination of arm clustering and knapsack constraints is natural and timely.\n2. The theoretical contribution is solid and helps to tackle an existing gap in the literature.\n3. The discussion on the dependence on $K$ is appreciated and provides useful insight."}, "weaknesses": {"value": "1. The paper lacks experimental validation. Including even synthetic experiments would help demonstrate the practical effectiveness of the proposed one-shot clustering approach and the impact of $K$.\n2. Key assumptions should be stated clearly in the main text and discussed in terms of their realism or applicability to practical settings.\n3. Some references appear misplaced or unclear. For example, in line 128, *Wang et al. (2024)* and *Yang et al. (2024)* seem to belong to the discussion in line 120. Additionally, the phrase “requiring a lower bound on the number of units to be clustered” (line 129) is vague and should be clarified."}, "questions": {"value": "Please refer to the weakness part above."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "5WbPI3VSUl", "forum": "kVziPYrz7D", "replyto": "kVziPYrz7D", "signatures": ["ICLR.cc/2026/Conference/Submission14843/Reviewer_5n9t"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14843/Reviewer_5n9t"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission14843/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761981174560, "cdate": 1761981174560, "tmdate": 1762925197404, "mdate": 1762925197404, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies clustered contextual bandits with knapsack constraints, where arms belong to unknown clusters (but the number of clusters $C$ is assumed known). Arms in the same cluster share linear reward & consumption models. The authors propose clusterLCBwK. The algorithm first performs a one-shot clustering on a randomly sampled subset of arms, then runs a conventional optimism-in-the-face-of-uncertainty policy over the subset. The authors prove that this algorithm achieves sublinear regret of order $T^{1-\\delta}$ for $\\delta \\in (0,1/2)$ when the resource budgets scale as $T^{2\\delta}$."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. To my knowledge, this is the first work that integrates clustered contextual bandits and bandits with knapsacks.\n2. The algorithm design is simple and intuitive. It discovers cluster structure once, then leverages the standard bandit with knapsacks machinery.\n3. The authors provide a strong theoretical analysis. The regret bound clearly exposes how performance depends on subset size, cluster coverage, budget scaling, and clustering error."}, "weaknesses": {"value": "1. The analysis requires heavy assumptions such as i.i.d. contexts, known number of clusters $C$, and knowledge of or lower bounds on parameters such as $p_{\\min}$. In many applications, these are unknown.\n2. In the regret analysis, the dependence on $m$ (feature dimension) is $m^{3/2}$, which is worse than the $m$ dependnece in non-clustered knapsacks. However, the paper does not provide a principled explanation or any ideas to close this gap.\n3. The writing needs improvement. For example, one novelty of this paper is arm clustering, but the key elements of the clustering step, including its assumptions, estimator, and how mis-clustering propagates, are scattered across sections and the appendix. Centralizing these would greatly improve readability.\n4. The \"informal\" lemmas are identical to their \"formal\" versions, providing no additional intuition.\n5. The paper is purely theoretical. There is no empirical validation. Even small synthetic studies would be valuable."}, "questions": {"value": "1. Can similar theoretical guarantees be achieved without knowing $C$? For example, (Gentile et al., 2014) does not require knowledge of the number of clusters.\n2. Is the extra $\\sqrt{m}$ factor in the regret bound intrinsic to your mis-clustering handling? Can you close this gap, or can you provide a lower bound showing that this extra factor is unavoidable?\n3. How sensitive is clusterLCBwK to non-i.i.d. contexts or model misspecification?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "sq02ojllWK", "forum": "kVziPYrz7D", "replyto": "kVziPYrz7D", "signatures": ["ICLR.cc/2026/Conference/Submission14843/Reviewer_B6Bg"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14843/Reviewer_B6Bg"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission14843/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761996177994, "cdate": 1761996177994, "tmdate": 1762925197088, "mdate": 1762925197088, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}