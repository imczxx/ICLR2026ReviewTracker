{"id": "lbh62QBt01", "number": 14106, "cdate": 1758228575180, "mdate": 1763414439070, "content": {"title": "Space Group Conditional Flow Matching", "abstract": "Inorganic crystals are periodic, highly-symmetric arrangements of atoms in three-dimensional space. Their structures are constrained by the symmetry operations of a crystallographic \\emph{space group} and restricted to lie in specific affine subspaces known as \\emph{Wyckoff positions}. The frequency an atom appears in the crystal and its rough positioning are determined by its Wyckoff position. Most generative models that predict atomic coordinates overlook these symmetry constraints, leading to unrealistically high populations of proposed crystals exhibiting limited symmetry.\nWe introduce Space Group Conditional Flow Matching, a novel generative framework that samples significantly closer to the target population of highly-symmetric, stable crystals. We achieve this by conditioning the entire generation process on a given space group and set of Wyckoff positions; specifically, we define a conditionally symmetric noise base distribution and a group-conditioned, equivariant, parametric vector field that restricts the motion of atoms to their initial Wyckoff position. Our form of group-conditioned equivariance is achieved using an efficient reformulation of \\emph{group averaging} tailored for symmetric crystals. Importantly, it reduces the computational overhead of symmetrization to a negligible level.\nWe achieve state of the art results on crystal structure prediction and de novo generation benchmarks. We also perform relevant ablations.", "tldr": "generative model that generates symmetric crystals by conditioning on space group and Wyckoff positions.", "keywords": ["Crystal generation", "Equivariant models", "Flow matching"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/f2b8c096663946042c5bf4c3f364b922951ce381.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper proposes a way of obtaining a space group equivariant generative flow model for generation of crystals. The method relies on group averaging, and the authors use the special properties of space groups and show how the group averaging can be computed with a single evaluation of the neural network. They evaluate the method on crystal structure prediction and *de-novo* generation.\n\nWhile I think the method seems theoretically sound (although I have a question related to the comparison with using symmetrical unit, “Questions”) and very interesting, my main concern is about the choice of the CSP task, how this is performed, and how the results are presented and discussed. More details are in “Weaknesses”, but this is the reason for my rating. However, based on my current overall interpretation of the paper, if the authors address my concerns and question, I am inclined to raise my rating and soundness score."}, "soundness": {"value": 1}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "The proposed method seems theoretically sound and, as far as I know, novel, and I think it is a nice contribution. The results on *de novo* generation look ok."}, "weaknesses": {"value": "I think that the CSP problem is in some sense a questionable choice of task for evaluation, as the proposed method requires knowledge about the Wyckoff positions, which essentially is part of what should be predicted in the CSP task. The weakness is not that the method requires Wyckoff positions, but that this task is used for evaluation as the method is not designed for this task. Now, the authors point out that they need access to the Wyckoff positions, which are not known, and on line 357 state that they need to predict them. However, on this line they do not mention how they make the prediction, nor reference where in the paper I can read about how they make this prediction. Continuing reading, I therefore interpret it as if they use some method for predicting the Wyckoff positions. **However**, as I understand it, **in the main results table (Table 2), they have used the ground truth Wyckoff positions**, and it is not until Line 412 they come back to the problem of predicting Wyckoff positions, and then present results when they have used a method for predicting. In that case, the (limited) results seem to indicate that their method perform roughly as the baseline methods, including the method they use for predicting the positions. \n\nI think that having access to the ground truth Wyckoff positions is a very strong and unfair advantage compared to the other methods (except DiffCSP++ which also has that access) as once you have the Wyckoff positions, the method “only” has to find the remaining degrees of freedom. I think this is a big concern with the evaluation of the CSP task, especially since Table 4 demonstrates that the proposed method doesn’t really improve over the method used for predicting Wyckoff positions, indicating that the big improvements over other methods in Table 2 could be due to having access to parts of the answer (in the case of Wyckoff positions with 0 degrees of freedom, knowing the position should leave nothing more to predict). I therefore think the authors should first clarify that they are indeed using the ground truth in Table 2, potentially add a row in Table 2 with the results when using predicted Wyckoff positions (like in the DiffCSP++ paper), and early in section 4, CSP task, incorporate a more transparent discussion about the limitations of the method in this setting, and how they evaluate this.\n\nI am also thinking about the interpretation of the ablation study on equivariant vs non-equivariant. Table 3 indicates that the proposed method with equivariant vector field still provides a significant gain. On the other hand, table 2 seems to indicate that the proposed method and DiffCSP++, which also relies on knowledge of Wyckoff positions, perform somewhat similar, although the proposed method performs better. However, this to me could indicate (again) that a large chunk of the performance gain comes from having access to the correct Wyckoff positions.\n\nIn the DNG task, however, I think this is not really a concern as I think the results there should depend less on having access to the correct or incorrect distributions of Wyckoff positions."}, "questions": {"value": "Fig 1c is first referenced on line 87, and then there has been no mention of details about the method. Can you extend the caption so that the figure is easier to understand (i.e., what is $\\sigma$?) when only having read until line 87? \n\nTable 1: Even if you cannot train the GA model, can’t you still use an untrained (randomly initialized) model to see the generation speed? \n\nLine 357: I think it is supposed to be “*prima faci****a***”? But even so, I am not sure what you mean by this line? I would have expected *a priori*\n\nMinor comment, but I believe that Latin terms like *de novo*, *prima facia*, etc, in general should be italicized \n\nLine 387: it says the method returns atom types, but those are the same as the input (which were conditioned on)?\n\nTable 2 + Figure 4: I assume GCFM is a typo?!\n\nWhen discussing the comparison with methods using the asymmetrical unit, I become a little bit confused what the benefits of the method are. What are the symmetries for which, e.g., SymmCD are **not** equivariant to? In other words, I would have liked to see some expansion of this discussion (appendix F is only a single line)\n\nLine 472: A related work in the same category as WyCryst and WyckoffTransformer is [1]\n\n[1] WyckoffDiff -- A Generative Diffusion Model for Crystal Symmetry, Filip Ekström Kelvinius, Oskar B. Andersson, Abhijith S. Parackal, Dong Qian, Rickard Armiento, Fredrik Lindsten, ICML 2025"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "d6647aPXD3", "forum": "lbh62QBt01", "replyto": "lbh62QBt01", "signatures": ["ICLR.cc/2026/Conference/Submission14106/Reviewer_SKAi"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14106/Reviewer_SKAi"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission14106/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761387081291, "cdate": 1761387081291, "tmdate": 1762924577895, "mdate": 1762924577895, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces SGFM, a flow-matching-based crystal generation framework condition on a given space group and Wyckoff positions. Based on simplified group averaging specifically for space groups, the proposed framework constrains the flow matching process to preserve the given symmetries. Results on Crystal Structure Prediction (CSP) and De Novo Generation (DNG) demonstrate the performance and efficiency of SGFM."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1. The paper provides a clear and well-structured formulation of space group symmetries, specifically Wyckoff positions, and effectively applies the concept of Group Averaging (GA) to this problem.\n2. Experiments showcase the superiority of SGFM over previous space-group-related methods."}, "weaknesses": {"value": "While the proposed framework and writing are generally straightforward, several aspects are missing or unclear, including:\n\n1. Apart from the equations of G-equivariant operations (Eq. 3-4), the design of G-invariant operation should also be explicitly provided, which is required for atom type generation.\n2. The method name is inconsistant. In Table 1 and Figure 4, it is it is referred to as GCFM. Besides, in Figure 4, the name of the baseline should be DiffCSP++.\n3. For the lattice flow matching, since $k_1=-\\log(3)/4\\neq 0$ for hexagonal crystals, directly applying a 0-1 mask in the construction of $\\mathbf{k}_0$ is not quite rigorous. A more precise definition should be $\\mathbf{k}_0=\\mathbf{k}'\\odot m(G)+\\mathbf{k}_1 (1-m(G))$.\n4. In line 318, $\\tilde{A}_0$ appears twice in the definition of the interpolation."}, "questions": {"value": "1. In the implementation of Eq. 4, is it computed by explicitly enumerating all $|G|$ space group elements, or simplified by averaging over each Wyckoff site only?\n2. According to the theories of Group Averaging and Frame Averaging, Eq. 4 should be G-equivariant for any arbitrary $u(c)$. Hence, instead of functioning as an equivariant operator during training, Eq. 4 could also serve as a post-processing step applied only at inference. The reviewer wonders how the two non-equivariant variants in Table 3 would perform if they were additionally equipped with this post-processing step as defined in Eq. 4 during inference. This may further validate whether the proposed SGFM can also serve as a constrained plugin for pretrained unconditional flow matching models."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "u3GwbOknKt", "forum": "lbh62QBt01", "replyto": "lbh62QBt01", "signatures": ["ICLR.cc/2026/Conference/Submission14106/Reviewer_2ExA"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14106/Reviewer_2ExA"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission14106/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761501735751, "cdate": 1761501735751, "tmdate": 1762924577294, "mdate": 1762924577294, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes a flow matching based method to generate crystals conditioned on space groups and Wyckoff positions. This is done by leveraging an efficient construction for models equivariant to space group transformations. The proposed method obtains competitive empirical performance on crystal structure prediction and unconditional generation."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The method is sound and well motivated\n- The experimental results are competitive and improve existing methods on many metrics. The detailed appendix is appreciated and should help with reproducibility and usage\n- The background section of the paper is well written and accessible"}, "weaknesses": {"value": "- I find the contributions relatively incremental with respect to the recent line of work on space group conditioning of diffusion models for crystals, especially Chang et al. 2025. The main contribution is the improvement in the efficiency of the group averaging operation for equivariance, which is interesting. But I feel like the paper overstates its contributions a bit.\n- I found the theoretical section overall a bit confusing. I think it is possible to reduce the amount of formalism and theorems, and would see this as an improvement.\n    - In section 3.1 the paper introduces a notion of G-symmetry for distributions, which I think is confusing. The problem is that if we take the (canonical) action of G on distributions  $g \\cdot P(c \\mid G, W) = P(g \\cdot c \\mid G, W)$, the definition of a G-symmetric distribution should be a distribution satisfying  $P(g \\cdot c \\mid G, W) = P(c \\mid G, W)$. This coincides with the notion of invariant distribution and is not the same as the definition used in the paper. I suggest that instead of talking about G-symmetric distribution, the authors say that they are interested in distributions supported on G-symmetric crystals, which is straightforward to understand.\n    - It is my impression that the previous criterion (G-symmetry or support on G-symmetric crystals) is not even necessary. If a crystal is W-constructible with W compatible with G, then it is clear that the crystal is automatically G-symmetric as (see in lemma 3.4). So the analysis can be simplified by only considering W-constructibility and not G-symmetry (as defined in the paper) or support on G-symmetric crystal (as suggested above).\n    - I don't think theorem 3.1 is needed. These results are already known from several previous works and can be directly used.\n    - Related to the previous point, G-invariance of the distribution is discussed a few times early in the paper, but not used in the subsequent results. What is needed is G-symmetry of the support of the distribution, as said earlier, they are different.\n    - I think the proof of lemma 3.3 could be simplified by using the fact that the stabilizer of the output of an equivariant function has larger stabilizer than its input (similar to Chang et al. 2025). This applies at the level of individual atomic position with stabilizer given by the site symmetry group, which should imply W-constructibility of the crystal and in turn G-symmetry.\n    - I also don't see the need for theorem 3.2. As said in the text it is directly implied by lemma 3.3 and does not add to the discussion.\n    - My overall feedback on the theoretical section is that it should be simplified. Lemma 3.4 implies that W-constructibility of the distribution is the necessary and sufficient criterion for generating crystals conditioned on space group. I think this fact can be mentioned in the background section. A lemma is not even necessary, this is clear from crystallography. Then you need to show that the equivariant generative model yields W-constructibility which is done through lemma 3.3 (this is similar to Chang et al.). I feel like this should be enough and much more straightforward.\n- I also suggest avoiding the use of very general geometry concepts like logarithmic maps. For the torus, this is simply a modulo operation. This will be clearer to practitioners familiar with crystals and will simplify exposition. The torus is the only manifold of interest here and is not complicated enough to justify this level of abstraction.\n- I would like to see a more fine-grained analysis of the impact of how the Wyckoff positions are sampled. Using Wyformer to sample the positions seems to perform worse than using empirical distributions, which is counterintuitive. Using the empirical distributions should result in a significant loss of diversity.\n- The authors should include MatterGen amongst the baselines (similar to Chang et al. 2025), it is one of the state-of-the-art methods\n- Evaluating efficiency based on the number of function evaluations is not best practice, since the model architectures used for these different methods are not standardized. Instead, the authors should use metrics that report actual use of compute (memory and time). Even if they are hardware dependent, they are much more useful in practice.\n- Minor comments:\n    - I think \"constructibility\" is more correct than \"constructability\"\n    - Couple of typos\n        - line 47: and, and (2)\n        - line 427: realsitic -> realistic\n        - line 447: \"we the thermodynamic stability\""}, "questions": {"value": "- I did not understand the issue with using a standard E(n) x S_n equivariant network. Can the authors clarify that point? I also didn't understand figure 5."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "wyii3ogeOX", "forum": "lbh62QBt01", "replyto": "lbh62QBt01", "signatures": ["ICLR.cc/2026/Conference/Submission14106/Reviewer_akat"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14106/Reviewer_akat"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission14106/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761963356938, "cdate": 1761963356938, "tmdate": 1762924576816, "mdate": 1762924576816, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces Space Group Conditional Flow Matching (SGFM), a generative model for crystal structures that enforces crystallographic symmetry. The method uses a symmetric noise prior and an equivariant vector field, enabled by a novel, computationally efficient formulation of Group Averaging (GA). The model achieves state-of-the-art (SOTA) results on crystal structure prediction (CSP) and de novo generation (DNG) benchmarks."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. Methodological Rigor: SGFM intrinsically preserves symmetry via an equivariant flow, which is different from the post-hoc projection method used by models like DiffCSP++.\n\n2. Efficient Group Averaging: The proposed efficient solves the computational bottleneck of applying equivariance to high-order space groups, making the approach practical.\n\n3. Empirical Results: The model demonstrates SOTA performance, with clear gains on the challenging MPTS-52 dataset."}, "weaknesses": {"value": "1. Limited Novelty & Unclear Theoretical Advantage: The work is an improved constraint enforcement method, not a new paradigm. This is acceptable, but the paper fails to clearly articulate the theoretical superiority of its equivariant flow over DiffCSP++'s projection. It states what DiffCSP++ does (projection) but not why this is theoretically flawed (e.g., error accumulation, breaking the true flow path), leaving the theoretical advantage of SGFM unclear.\n\n2. Marginal Gains & Missing Baselines: Performance gains are moderate on some datasets (e.g., MP-20), and the key comparison to DiffCSP++ on the large-scale Alex-MP-20 dataset is missing.\n\n3. Questionable Convergence Comparison: The claimed convergence speedup may also be a trivial consequence of adopting the Flow Matching framework or some sample tricks, which is a simple modification to implement from DiffCSP++. Related ablation experiments are needed.\n\n4. Potential Theory-Practice Mismatch: The standard L2 regression loss does not guarantee the network learns the correct equivariant vector field. This creates a gap, as the learned field might be an incorrect path that is simply forced into symmetry by the final GA operator, rather than being the true physical path."}, "questions": {"value": "1. Training-Inference Mismatch: Does the conventional L2 regression loss ensure the learned vector field is truly the correct equivariant field, or just a field that appears symmetric post-averaging? Is there a risk of learning an incorrect, non-physical path?\n\n2. Missing Baseline: Can the authors provide the CSP results for DiffCSP++ on the Alex-MP-20 dataset to substantiate the SOTA claim on large-scale data?\n\n3. Sampler Ablation: Can the authors provide an ablation study to isolate the performance gains from the sampling strategy? Can the authors provide reproducible code for this comparison?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "cSBfQ1446l", "forum": "lbh62QBt01", "replyto": "lbh62QBt01", "signatures": ["ICLR.cc/2026/Conference/Submission14106/Reviewer_gjio"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission14106/Reviewer_gjio"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission14106/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761989159667, "cdate": 1761989159667, "tmdate": 1762924576348, "mdate": 1762924576348, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}