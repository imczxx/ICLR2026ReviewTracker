{"id": "hlbvj39xaN", "number": 20956, "cdate": 1758312015344, "mdate": 1762981200700, "content": {"title": "Cooperative TD Learning in Heterogeneous Environments via Joint Linear Approximation", "abstract": "We study cooperative temporal-difference (TD) learning with heterogeneous agents, where a collection of agents interacts with heterogeneous environments, yet tries to accelerate learning via seeking collaboration with other agents.   \nWe focus on the setting where there exists a shared linear representation and the agents' optimal weights collectively lie in an $r$-dimensional linear subspace. Intuitively, the smaller the $r$, the greater the potential benefits of the collaboration. \nHowever, heterogeneity in the agents' state transition kernels can lead to misaligned learning signals across agents, which may significantly hinder convergence and impair the generalization of the learned policies. \nIn this paper, inspired by the recent success of personalized federated learning (PFL), we study the convergence of federated single-timescale TD in which agents iteratively estimate the common subspace and local heads. We showed that this decomposition can filter out conflicting signals while amplifying shared structures, effectively balancing the above two competing intuitions.\nIn the analysis, the Markovian sample of TD error makes it difficult to obtain a direct contraction for the principal angle distance between the optimal subspace and the estimated subspace, but only an indirect subtraction in terms of the local weights error. To address this challenge, we found that when the principal angle distance is positive, the local weights error will always be positive as well. Following this line of thought, we further discovered that the local weights error can be lower-bounded by the principle angle distance times a constant depends on the diversity of the optimal local weights.", "tldr": "", "keywords": ["Federated Learning", "Reinforcement Learning", "Representation Learning"], "primary_area": "reinforcement learning", "venue": "ICLR 2026 Conference Withdrawn Submission", "pdf": "/pdf/a47c456e3db71e919ddae6a9752c1913ddbe3561.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper studies the problem of cooperative TD learning in heterogeneous environments, where the value functions of $K$ agents share an unknown $r$-dimensional linear subspace. The paper proposes a Federated Single-Timescale TD algorithm (Algorithm 1), where agents iteratively estimate this common subspace and their respective local \"heads\". \n\nThe main contribution is a finite-time convergence analysis under Markovian sampling, showing that reward estimation and subspace estimation errors decay at rates of $\\mathcal{O}(\\log T / \\sqrt{T})$ and $\\mathcal{O}(r \\log T / \\sqrt{T})$, respectively. The analysis suggests the method is resilient to heterogeneity but does not show a clear acceleration from cooperation."}, "soundness": {"value": 2}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "1. The paper delivers a finite-time convergence analysis for the proposed FSTTD algorithm (Algorithm 1) under Markovian sampling, which is a high standard in RL theory.\n\n2. The paper identifies a core technical difficulty: the lack of a direct contraction for the evolution of the principal angle distance ($m_t$) between the estimated and optimal subspaces."}, "weaknesses": {"value": "1. The overall presentation of the manuscript falls significantly below the expected standard. The reviewer encountered substantial difficulty in reading and understanding the paper due to numerous undefined notations and typographical errors. A major issue lies in the fact that the paper investigates the infinite-horizon average-reward setting rather than the more common discounted-reward formulation. However, this critical distinction is never explicitly clarified in the text. As a result, Equations (2)–(3) are particularly hard to interpret for readers without prior knowledge of average-reward reinforcement learning, since many of the symbols and assumptions appear to be taken for granted.\n\n2. The novelty and overall contribution of this work appear limited. As discussed in the related work section, both MARL and personalized federated RL (PFRL) have already been extensively explored. Although most existing studies focus on the discounted-reward setting, extending these frameworks to the average-reward formulation does not, by itself, constitute a sufficiently novel contribution. The primary methodological idea, introducing a shared low-dimensional “subspace” structure, is directly inspired by the PFLg approach of Collins et al. (2021). The technical development mainly involves combining this subspace-based representation with standard analytical tools for handling Markovian sampling in conventional MARL literature. \n\n3. The main contribution is a finite-time convergence analysis under Markovian sampling, showing that reward estimation and subspace estimation errors decay at rates of $\\mathcal{O}(\\log T / \\sqrt{T})$ and $\\mathcal{O}(r \\log T / \\sqrt{T})$, respectively. However, the dependece with the number of agents K and heterogeneity level is unknown.  Moreover, the analysis suggests the method is resilient to heterogeneity but does not show a clear acceleration from cooperation.\n\n4. Assumption 4 (that $span(B^\\*)$ is $A^k$, invariant for all $k$) is a very strong assumption. It requires that the dynamics of all agents (encoded in $A^k$, which depends on $P^k$ and $\\phi(s)$) must \"preserve\" the same unknown shared subspace $B^\\*$. This assumption is used critically in the proof  to make a difficult cross-term disappear ($P_{\\perp}^{*}A^{k}P^{\\*}=0$), which is essential for deriving the contraction in the subspace error.  The paper provides no discussion of when Assumption 4 might hold in practice, even in simple synthetic MDPs, or how much it limits the scope of problems being solved. A similar assumption may hold in PFL like Collins et al. (2021) in a federated supervised learning setting, but it is not true for RL setting. \n\n5. An $\\mathcal{O}(1)$ error term means the algorithm, in theory, cannot get arbitrarily close to the optimal value function. The authors attribute this to the \"gap\" from QR decomposition and projection. \n\n6. A major downside of this paper is the lack of empirical validation. Can the authors show the advantage of the proposed algorithm over existing benchmarks?\n\n7. Many issues in mathematical notations and formulations. Just name a few in below: \n\nwhat is $\\eta$ in Eq. (3)?\nThe TD(0) update for $z_{t+1}^k$ in Eq. (3) appears to be missing the feature vector $\\phi(s_t^k)$.  \nWhat does Eq. (10) mean?"}, "questions": {"value": "Please see the Weakness above."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "e4QxrE7sXl", "forum": "hlbvj39xaN", "replyto": "hlbvj39xaN", "signatures": ["ICLR.cc/2026/Conference/Submission20956/Reviewer_4TJf"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20956/Reviewer_4TJf"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission20956/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761686365806, "cdate": 1761686365806, "tmdate": 1762939053411, "mdate": 1762939053411, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"withdrawal_confirmation": {"value": "I have read and agree with the venue's withdrawal policy on behalf of myself and my co-authors."}}, "id": "zQdeUEwIMl", "forum": "hlbvj39xaN", "replyto": "hlbvj39xaN", "signatures": ["ICLR.cc/2026/Conference/Submission20956/Authors"], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission20956/-/Withdrawal"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762981199903, "cdate": 1762981199903, "tmdate": 1762981199903, "mdate": 1762981199903, "parentInvitations": "ICLR.cc/2026/Conference/-/Withdrawal", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies cooperative temporal-difference (TD) learning with heterogeneous agents. the existence of a common subspace may accelerate the learning of individual agents, yet heterogeneity in state transition kernels can lead to misaligned learning signals across agents . The authors try to answer the question: do the benefits of collaboration outweigh the drawbacks . An algorithm is devised in which agents iteratively estimate the common subspace and local heads, and the convergence of the algorithm is analyzed. Theoretical results show that the proposed algorithm can filter out conflicting signals and mitigate the negative impacts of misaligned signals with certain assumptions."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 4}, "strengths": {"value": "1. The core question this paper tries to answer is interesting and meaningful. To investigate the beneficial or harmful effects of multiple agents cooperating is essential for practical applications.\n\n2. The idea of personalized federated learning is introduced to devise the algorithm, which is straightforward and novel.\n\n3. The theoretical analysis is solid, and provide insights to understand the interactions of multiple agents when they cooperate in heterogeneous environments. \n\n4. The theoretical results show that the convergence rate does not decrease in the number of agents, which suggests that the algorithm does not suffer from the heterogeneity.\n\n5. The proof sketch provides a good intuition to understand how the authors deal with the coupled error terms in the convergence analysis."}, "weaknesses": {"value": "1. The theoretical results show that the cooperation of multiple agents does not speedup the convergence rate of TD algorithm. The proposed algorithm does not exploit the benefits of low dimensional subspace ($r<<d$).\n\n2. No empirical results are provided. Experimental analysis using whether synthetic or real-world data will make the work more solid and complete. \n\n3. Not enough explanation for some assumptions. The convergence might not be guaranteed (since $\\bar{X}_T = O(1)$) if the gap between between the raw updates and the updates after QR decomposition and projection. The gap requires more dedicated treatment. \n\nTypo: line 86/87, “under the heterogeneity” should be removed."}, "questions": {"value": "1. How the heterogeneity of environments is characterized? It seems that the paper only considers multiple agents with different transition matrix $P^k$. But how different $P^k$'s are from each other? Maybe for different agent, $P^k$ is associated with different $\\rho$ in assumption 1. An extreme example: there are an agent with $\\rho=0.9$, and all others with $\\rho=0.1$. The agent with $\\rho=0.9$ might decrease the convergence rate compared with the case where all agents are with $\\rho=0.1$. \n\n2. What does assumption 4 mean? Apart from mathematical descriptions, can you provide more explanation on what does it mean in the multiple agent learning system. Does it hold in practice or is it just for the simplification of theoretical analysis. \n\n3. In Theorem 1, there is an unavoidable O(1) error for the weight. What is the explicit form of this error term? If it is too large, the weight might not converge at all, which might destroy the convergence of the whole system (i.e., the convergence analysis might be vacuous). Can you eliminate the step for QR decomposition of $B$ to get rid of this error term. Or maybe more advanced techniques are required to deal with the error term from the QR decomposition.\n\n4. Is it possible to leverage the dimension information $r$ (assume that we know it a prior, or we enforce a $r$-dimension subspace to approximate the optimal subspace) in the algorithm do achieve speedup."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "None"}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "wTjQPH74dd", "forum": "hlbvj39xaN", "replyto": "hlbvj39xaN", "signatures": ["ICLR.cc/2026/Conference/Submission20956/Reviewer_vPG2"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20956/Reviewer_vPG2"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission20956/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761818013570, "cdate": 1761818013570, "tmdate": 1762939052806, "mdate": 1762939052806, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies federated temporal-difference (TD) learning among heterogeneous agents, each interacting with distinct environments, and learning jointly their value functions. Assuming that agents’ optimal parameters lie in a shared low-dimensional subspace, the authors propose a single-timescale federated TD algorithm that jointly estimates a shared subspace and agent-specific heads. They provide a finite-time convergence analysis under Markovian sampling, showing an $O(\\log T / \\sqrt{T})$ rate for the reward estimation error."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The paper addresses a timely and relevant problem: personalised federated TD learning under heterogeneous environments. The work provides non-asymptotic convergence guarantees for cooperative TD under Markovian noise.\n\n- The theoretical analysis is careful, mathematically sound, and the assumptions are clearly stated."}, "weaknesses": {"value": "-  $\\textbf{Main concern:}$ The proposed method closely mirrors the  PFEDTD-REP algorithm introduced in [1]. That earlier work already analyzed a two-timescale federated TD algorithm with shared representations and proved linear convergence speedup with respect to the number of agents under Markovian noise.  \n    In contrast, the current paper adopts a single-timescale variant and explicitly states that no acceleration or speedup is achieved (see Lines 91–100 of the submission). Thus, the contribution is primarily incremental: removing the two-timescale update but offering weaker theoretical performance.\n    \n- The proposed method appears to address a $\\textit{distributed}$ setting rather than a truly $\\textit{federated}$ one. In particular, there are no mechanisms such as local updates, compression, or partial participation that are typically used in federated learning to reduce communication complexity. Adding mechanisms to reduce the communication complexity would strengthen the paper.\n    \n - The paper provides no experimental validation or comparison against prior works such as PFEDTD-REP[1], making it difficult to evaluate the practical benefits of the proposed single-timescale approach.\n\n- The following two important works on heterogeneous federated (personalized) TD learning are missing in the related works section:\n    - Guojun Xiong et al, On the linear speedup of personalised Federated reinforcement learning with shared representations, ICLR 2025\n    - Paul Mangold et al, SCAFFLSA: Taming Heterogeneity in Federated Linear Stochastic Approximation and TD Learning, NeurIPS 2024.\n\n    \n    [1] Guojun Xiong et al, On the linear speedup of personalised Federated reinforcement learning with shared representations, ICLR 2025"}, "questions": {"value": "- How does the proposed cooperative single-timescale TD method differ technically from the PFEDTD-REP algorithm in [1]?\nSpecifically, what new theoretical or algorithmic insights does this paper provide beyond removing the two-timescale design?\n\n\n- Since the paper explicitly mentions that no acceleration or speedup is achieved, could the authors clarify whether the absence of linear speedup is fundamental to the single-timescale formulation, or a limitation of the current analysis?\nWould modifying the assumptions (e.g., relaxing bounded features) allow for a speedup result comparable to [1]?\n\n\n- The proposed algorithm resembles a distributed averaging scheme rather than a federated learning setup.\nCould the authors clarify whether their framework supports typical federated mechanisms such as partial participation, local updates, or communication compression? How would such extensions affect the convergence guarantees?\n\n- Could the authors include empirical comparisons with PFEDTD-REP or other federated TD baselines to illustrate the practical implications of the single-timescale design?\nAre there any qualitative benefits that compensate for the lack of speedup?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "1EqDtpTibZ", "forum": "hlbvj39xaN", "replyto": "hlbvj39xaN", "signatures": ["ICLR.cc/2026/Conference/Submission20956/Reviewer_zMJJ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20956/Reviewer_zMJJ"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission20956/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761970880774, "cdate": 1761970880774, "tmdate": 1762939052230, "mdate": 1762939052230, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies the problem of cooperative TD learning, where multiple agents aim to collaboratevily estimate the value function of a shared policy in the average-reward setting.\nThe proposed method simultaneously estimates (i) the projection from the full-dimensional space to a reduced-dimension space, (ii) the weights in the underlying projection space.\nThis allows flexibility between the global and the personalized settings, depending on the size of the projection subspace.\nA theoretical convergence analysis is performed, showing convergence under the assumption that a common structure exist, showing that the method is able to exploit this structure without require knowledge of it."}, "soundness": {"value": 2}, "presentation": {"value": 4}, "contribution": {"value": 1}, "strengths": {"value": "1. The proposed method is general enough to encompass both global federated TD learning and personalized TD learning.\n2. In the case where a low-dimensional structure exist, the method is able to retrieve it without requiring prior knowledge of it.\n3. Convergence rates are given in a general case where noise is Markovian."}, "weaknesses": {"value": "1. The proposed approach does not lead to linear speed-up: the author claim that this may be due to the assumption that features maps are uniformly bounded by $1$, which may obfuscate the dependency on the dimension. This is surprising especially since similar work manage to obtain linear speed-up:\n   - in [1], a shared feature map is directly learned with linear speed-up; while the approaches are different, it seems that learning the feature map should be a more difficult problem;\n   - in federated TD, [2] obtain linear speed-up with the exact same assumption on the feature maps (but without personalization);\n   - in federated learning (not RL), a very similar algorithm was studied by [3], with linear speed-up.\nAlthough all these approaches indeed differ from the setting considered here, it suggests that the lack of linear speed-up may be an artefact of the analysis. It seems that these references are also missing from the discussion of related work.\n1. The assumption that there exists a low-dimensional subspace containing all solutions seem to be a bit artificial.\n2. Some of the theoretical results are difficult to interepret, providing a convergence rate of order $O(1/\\sqrt{T})$ up to a $O(1)$ error, which dominates all other terms. In its current form, this may invalidate many of the theoretical results presented in the paper.\n\n[1] Personalized Federated Learning Ali Dadras, Sebastian U. Stich, Alp Yurtsever, TMLR 2025.\n\n[2] SCAFFLSA: Taming Heterogeneity in Federated Linear Stochastic Approximation and TD Learning, Paul Mangold, Sergey Samsonov, Safwan Labbi, Ilya Levin, Reda Alami, Alexey Naumov, Eric Moulines, NeurIPS 2024.\n\n\n[3] On the Linear Speedup of Personalized Federated Reinforcement Learning with Shared Representations, Guojun Xiong, Shufan Wang, Daniel Jiang, Jian Li, ICLR 2025."}, "questions": {"value": "1. How could assumption 3 be adapted to uncover the linear speed-up? What could be other reasons for the lack of speed-up?\n2. Are there practical problems where the personalized solutions lie within a subspace of low dimension?\n3. Is it possible to give an explicit, non-asymptotic expression for the additive error terms $O(1)$ that appear in multiple of the derived upper bounds?\n\nThere is a typo in Assumption 1 (\"expLoration\")"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "kTUANbW0YC", "forum": "hlbvj39xaN", "replyto": "hlbvj39xaN", "signatures": ["ICLR.cc/2026/Conference/Submission20956/Reviewer_pMr4"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20956/Reviewer_pMr4"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission20956/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762366271382, "cdate": 1762366271382, "tmdate": 1762939051926, "mdate": 1762939051926, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": true}