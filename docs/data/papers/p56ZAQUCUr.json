{"id": "p56ZAQUCUr", "number": 17201, "cdate": 1758273402270, "mdate": 1759897191145, "content": {"title": "Source-Guided Flow Matching", "abstract": "Guidance of generative models is typically achieved by modifying the probability flow vector field through the addition of a guidance field. In this paper, we instead propose the Source-Guided Flow Matching (SGFM) framework, which modifies the source distribution directly while keeping the pre-trained vector field intact. This reduces the guidance problem to a well-defined problem of sampling from the source distribution. We theoretically show that SGFM recovers the desired target distribution exactly. Furthermore, we provide bounds on the Wasserstein error for the generated distribution when using an approximate sampler of the source distribution and an approximate vector field. The key benefit of our approach is that it allows the user to flexibly choose the sampling method depending on their specific problem. To illustrate this, we systematically compare different sampling methods and discuss conditions for asymptotically exact guidance. Moreover, our framework integrates well with optimal flow matching models since the straight transport map generated by the vector field is preserved. Experimental results on synthetic 2D benchmarks, physics-informed generative tasks, and imaging inverse problems demonstrate the effectiveness and flexibility of the proposed framework.", "tldr": "", "keywords": ["Flow matching", "conditional generation", "guided flow"], "primary_area": "probabilistic methods (Bayesian methods, variational inference, sampling, UQ, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/e6e7887fed0e11c966aac1945bed2a55f1703aeb.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "The paper proposes an interesting method to do guidance in conditional generation of flow matching, by modifying the source distribution instead of training the velocity neural network. The method has rigorous theoretical guarantee and various sampling algorithms can be utilized to sample from the modified source distribution, but this process can be very computationally expensive. Experimental comparisons with previous methods demonstrate the effectiveness of the proposed method."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "The paper is well organized and easy to follow, motivated by an interesting theorem that to modify the source distribution can also achieve guidance. Building on this, the authors discuss several sampling algorithms to sample from the modified source distribution. Extensive experiments are also conducted to verify the the efficiency of the proposed framework."}, "weaknesses": {"value": "1. The major concern is how to sample from $q_0'\\propto q_0\\cdot\\exp(-J\\circ T^* )$ efficiently? \nThe authors mention HMC and optimization-based methods, but all of these methods require gradient computation of the potential function $J\\circ T^* $, where  $ T^* $  is the FM model. This requires backpropagatio through an ODE trajectory, which is super computationally expensive and impractical.\n\n2. Following the question above, what if the potential function $J$ is not differentiable or to compute the gradient of $J$ is very expensive? In this case, only importance-sampling based algorithms can be used and the convergence is very slow. Will the proposed method be more efficient than fine-tuning velocity neural network using, say, reinforcement learning methods?"}, "questions": {"value": "Please see weakness part."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "VnQ7C1z70A", "forum": "p56ZAQUCUr", "replyto": "p56ZAQUCUr", "signatures": ["ICLR.cc/2026/Conference/Submission17201/Reviewer_wX5E"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17201/Reviewer_wX5E"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission17201/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761715861234, "cdate": 1761715861234, "tmdate": 1762927172754, "mdate": 1762927172754, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents the Source-Guided Flow Matching (SGFM) framework that modifies the source distribution directly to incorporate the guidance for flow matching. This framework is backed by the theorem that sampling from the modified source distribution and driving the flow along the exact vector field precisely recovers the desired target distribution. Based on this, the paper also provides the Wasserstein convergence guarantee. The framework is open for different sampling methods to sample from the modified source distribution. Finally, the paper experiments on synthetic 2D benchmarks, physics-informed generative tasks and imaging inverse problems to demonstrate the effectiveness and flexibility of the proposed method."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "•\tThe paper is well-written and clearly-organized. The center of the proposed method based on modifying the source distribution is focused with in-depth discussion.\n\n•\tThe framework is flexible to combine with different types of sampling methods based on the characteristics of the target distribution. The pros and cons of different methods are discussed in Section 4.\n\n•\tThe experiments are selected from low to high dimensional problems, which is comprehensive."}, "weaknesses": {"value": "•\tThe clarity of the notations could be improved. For example, it would be better to denote samples from $q’_0$ by $x’_0$ rather than $x_0$ in Algorithm 1 to reduce ambiguity.\n\n•\tEven though the framework is flexible to incorporate different types of sampling methods, the mode collapse issue when the target distribution is highly non-concave still remains. In addition, the remedy to mitigate the mode collapse issue in line 309 only adapts to the Gaussian source distribution, it remains unknown whether it could extend to general source distributions.\n\n•\tIt would be beneficial to add the variance interval in Table 2 similar to Table 1."}, "questions": {"value": "•\tIs it possible to address the mode collapse issue with annealed sampling or add some other types of regularization term to equation (4) similar to (5)? What kind of regularization term should we use when the source distribution is not Gaussian?\n\n•\tThe proposed method requires additional sampling procedure from the modified target distribution compare to the standard flow matching method. What is the benefit of the proposed method compared to the guided flow matching methods like [1] that does not require the additional sampling procedure?\n\n•\t[1] Xie, T., Zhu, Y., Yu, L., Yang, T., Cheng, Z., Zhang, S., ... & Zhang, C. (2024). Reflected flow matching. arXiv preprint arXiv:2405.16577."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "FooBS2zFtJ", "forum": "p56ZAQUCUr", "replyto": "p56ZAQUCUr", "signatures": ["ICLR.cc/2026/Conference/Submission17201/Reviewer_Tm1L"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17201/Reviewer_Tm1L"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission17201/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761917608375, "cdate": 1761917608375, "tmdate": 1762927172489, "mdate": 1762927172489, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper presents an approach for guided sampling using flow matching by changing the source distribution while keeping the pretrained vector field intact. The authors theoretically derive the form of such a source distribution. Building on this, the authors derive the bound for the Wasserstein error in generative modeling and show that it is linear in terms of the error in sampling from the source distribution. Based on this finding, the authors propose various strategies for accurately sampling from the source distribution. Through empirical analysis on 2d synthetic, physics-based Darcy flow, and natural image datasets, they show the effectiveness of their approach compared to the baselines."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "I appreciate the thorough theoretical analysis in presenting the method. The writing is clear, and all the theory was backed by intuition. The idea of modifying the source distribution through the constraint function is interesting and has not been explored as far as I am aware."}, "weaknesses": {"value": "I am not very familiar with the baselines that have been compared with. The main weakness of this method is the weak empirical performance on the Darcy flow data. The promise of this method, as I see it, is in enforcing constraints (differentiable) in the generative modeling. Therefore, physical consistency is an important metric in which the method falls short compared to PnP. This is not a major weakness; however, I would request the authors to add a discussion on this."}, "questions": {"value": "1. In line 91, please define the composition operator $\\circ$.\n\n2. For Darcy flow data, how was the conditional sampling done based on a partial pressure field? Did the authors use masking in the ODE reverse process to achieve this?\n\n3. Please explain the usefulness of the \"validity of the inverse estimate\" metric when it is observed that the joint sampling matches closely with the target pressure field."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "t5C0yk8qmU", "forum": "p56ZAQUCUr", "replyto": "p56ZAQUCUr", "signatures": ["ICLR.cc/2026/Conference/Submission17201/Reviewer_T7yj"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17201/Reviewer_T7yj"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission17201/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762244872258, "cdate": 1762244872258, "tmdate": 1762927172213, "mdate": 1762927172213, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces Source-Guided Flow Matching (SGFM), a novel framework that guides generative models by modifying the source distribution rather than the vector field. The key motivation is to keep the pre-trained vector field intact while only adjusting the source distribution to achieve conditional generation. Specifically, this approach transforms the guidance problem into a well-defined task of sampling from a modified source distribution. This work also demonstrates that this approach precisely recovers the desired target distribution under ideal conditions and provides Wasserstein error bounds for cases involving approximate samplers and vector fields."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The core methodology is grounded in a theoretical result, Theorem 1, which states that if a vector field with flow map transports a source distribution to a target distribution, then for a desired new target distribution, there exists a modified source distribution that is precisely transported to the target one by the *same* vector field. This theorem provides the foundation for SGFM.\n\n2. The framework also provides theoretical guarantees to ensure the quality of generated samples. Besides, the practical implementation of SGFM hinges on accurately and efficiently sampling from the modified source distribution. The paper emphasizes the flexibility to choose sampling methods based on problem specifics.  Experimental evaluations on synthetic 2D datasets demonstrate SGFM-IS's superior sample quality (lower Wasserstein distance) and asymptotic exactness."}, "weaknesses": {"value": "I am not familiar with the field. Here are a few comments:\n\n1. Practical experimental setup: while this work provides solid theoretical derivations guaranteeing the quality of generated samples, all experiments were conducted on relatively small datasets. For large-scale datasets, such as the class-to-image task on ImageNet with vanilla diffusion model, i.e. DiT and SiT, it remains to be seen whether this work can also achieve high-quality generated samples. I hope the authors can provide implementation results on this task, and it is suggested to report gFID and gIS metrics.\n\n2. How to obtain the value of $J$: How should this parameter be handled in practice, given its critical impact on the modified target distribution?\n\n3. The paper clearly notes that optimization-based methods (like D-Flow) can suffer from mode collapse, but does not propose a general solution beyond using more advanced samplers like HMC.\n\n4. The theory assumes access to an optimal or near-optimal vector field. In practice, learning such a field is non-trivial, especially in high dimensions.\n\n5. While the method is general, most experiments use Gaussian source distributions. More analysis on complex source distributions would be beneficial."}, "questions": {"value": "N/A"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "tnpKSvZzBf", "forum": "p56ZAQUCUr", "replyto": "p56ZAQUCUr", "signatures": ["ICLR.cc/2026/Conference/Submission17201/Reviewer_3Ext"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17201/Reviewer_3Ext"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission17201/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762875417613, "cdate": 1762875417613, "tmdate": 1762927171944, "mdate": 1762927171944, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}