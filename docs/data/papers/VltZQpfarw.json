{"id": "VltZQpfarw", "number": 5021, "cdate": 1757835068344, "mdate": 1759897999893, "content": {"title": "Shift-Tolerant Allocation via Black-Litterman Using Conditional Diffusion Estimates", "abstract": "In dynamic financial market characterized by shifting regimes, how can we make effective investment decisions under the changing 1) market regimes and 2) their impact?\nAmong many research fields in financial AI, portfolio allocation stands out as one of the most practically significant areas.\nConsequently, numerous researchers and financial institutions continually seek approaches that improve the risk–reward trade-off and strive to apply them in real-world investment scenarios.\nHowever, achieving robust risk-adjusted performance is extremely challenging, because each asset's return and volatility fluctuate according to the shifting market regime.\n\nIn response, modern portfolio theory (MPT) addresses this issue by solving for asset weights that maximize a risk–reward objective, using estimates of the return mean and covariance from historical returns.\nReinforcement learning (RL) frameworks have been introduced to directly decide portfolio allocations by optimizing risk‑adjusted objectives using asset prices and macroeconomic indices.\n\nIn this work, we propose STABLE (Shift-Tolerant Allocation with Black-Litterman Using Conditional Diffusion Estimates), which combines a diffusion-based generative model that captures regime shifts with an estimation-based portfolio allocation module that maximizes expected risk-adjusted return. STABLE takes macroeconomic context and asset-specific signals as inputs and generates per-stock return trajectories that reflect the prevailing macro regime while preserving firm-specific dynamics.\nThis yields regime-aware predictive return distributions at the single-stock level together with a coherent covariance structure, which are then incorporated as investor views within a Black-Litterman allocation module to obtain risk-diversified portfolio weights.\nEmpirically, STABLE delivers superior portfolio outcomes, achieving up to 122.9% higher Sharpe ratios with reduced drawdowns across major equity markets.\nIt also attains state‑of‑the‑art time‑series estimation, lowering MSE by up to 15.7% compared with generative baselines.", "tldr": "We present STABLE, a portfolio allocation method that maximizes expected risk-adjusted return", "keywords": ["portfolio allocation", "time-series estimation", "generative modeling"], "primary_area": "learning on time series and dynamical systems", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/305c9aa857d51865283d3fd4446814743ad304d0.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper introduces a novel portfolio allocation framework named STABLE (Shift-Tolerant Allocation via Black-Litterman Using Conditional Diffusion Estimates), designed to tackle the dynamic allocation challenges in financial markets characterized by \"regime shifts.\"\nThe method innovatively integrates deep generative models (Diffusion) with classical financial theory (Black-Litterman). The framework primarily consists of three stages:\n\n1.\tConditional Diffusion Generator (CDG): A Conditional Diffusion Model (DDIM) generates future stock return paths based on macroeconomic conditions and stock-specific signals. The stock-specific signal includes a \"time-varying stock embedding\"  estimated via Kalman filtering to capture the dynamic sensitivity of the stock to macro factors.\n\n2.\tMulti-Level Guidance (MLG): An improved classifier-free guidance technique is used during the diffusion model's denoising process. This technique decomposes noise into shared \"systematic noise\" (macro-driven) and \"idiosyncratic noise\" (firm-specific), and dynamically balances their influence using a learnable gate.\n\n3.\tBlack-Litterman Mean-Variance Optimizer (BL-MVO): The K return paths generated by CDG+MLG are used to form a predictive \"investor view,\" including a view mean and covariance. This \"view\" is merged with a historical \"prior\" using the Black-Litterman framework to obtain a posterior mean and covariance. Finally, these posterior estimates are fed into a standard Mean-Variance Optimizer (MVO) to compute the final portfolio weights.\n\nThe authors conducted experiments across four regional stock markets (US, China, Europe, and Korea). Results show that STABLE achieves SOTA performance on both portfolio allocation and time-series forecasting tasks. For instance, it shows up to a 122.9% improvement in Sharpe Ratio on the portfolio task and up to a 15.7% reduction in MSE on the time-series estimation task."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1.\tHigh Novelty (Connecting Generative Models and Classic Finance): The main contribution of this paper is building a sophisticated bridge between state-of-the-art deep learning technology (Conditional Diffusion Models) and established classic financial theory (Black-Litterman). Utilizing the predictive paths generated by the diffusion model as the \"investor view\" within the BL framework is a very novel and insightful idea.\n\n2.\tElegant Architectural Design (Macro/Micro Decoupling): STABLE is not a simple application of diffusion models. The design of the Multi-Level Guidance (MLG) module is a major highlight. By decomposing noise into systematic (macro) and idiosyncratic (micro) components and using a learnable gate, the model can more finely capture the varied reactions of individual stocks under different market conditions. This directly addresses the shortcomings of previous models that often overfit macro signals and neglect stock-specific dynamics.\n\n3.\tPowerful Feature Engineering (Dynamic Embeddings): The authors innovate by using a Kalman filter to estimate the time-varying stock embedding instead of static industry labels or simple price embeddings. This allows the model to capture the dynamic sensitivity of stocks to macro factors.\n4.\tRigorous Experimental Validation: The experimental setup is comprehensive:\n\nMulti-Task: Evaluation on both portfolio allocation (Q1) and time-series forecasting (Q2) tasks, proving the model's effectiveness from different angles.\n\nMulti-Market: Tested across four diverse regional markets (US, China, Europe, Korea), demonstrating robustness and cross-market applicability.\n\nSOTA Results: The experimental results are impressive, with STABLE outperforming all baseline methods across almost all key metrics (ASR, RMDD, AVol, MSE, DTW) in all markets."}, "weaknesses": {"value": "1.\tLack of Ablation Study: STABLE is a very complex, multi-stage pipeline with Kalman Filter, CDG, MLG and BL-MVO. Although the final results are good, I cannot determine which component contributes the most to the performance gains. Without ablations, the actual value of each innovative element of the model is hard to assess.\n\n2.\tShort Testing Period: According to Table 2, the training set ends in 2024-09, and the test set ends in 2025-03. This means the testing period is only 6 months. For a model claiming to address \"regime shifts,\" a 6-month window is far too short to evaluate its robustness across different macroeconomic cycles (e.g., a full recession, a high-inflation period, a zero-rate period). The model's excellent short-term performance might simply be due to its parameters fitting the market dynamics of these specific six months.\n\n3.\tHyperparameter Tuning and Reproducibility: The model introduces a large number of hyperparameters. The authors state these parameters were tuned \"per dataset.\" This raises concerns about potential overfitting and presents certain challenges to its generalization ability.\n\n4.\tLack of Stylized Facts Validation: Since STABLE uses a diffusion model, it is expected to capture the non-Gaussian properties of real financial returns. However, the paper lacks evidence that its generated distributions successfully replicate essential financial stylized facts such as high kurtosis (heavy tails), negative skewness, and volatility clustering. This omission undermines the validation of the diffusion model's intrinsic advantage over simpler generative baselines.\n\n5.\tMissing Distribution Goodness-of-Fit Tests: Given the unpredictability of financial time series, I would prefer that the distribution of the generated results be similar to the actual distribution, rather than having a sufficiently small error and a sufficiently close trajectory. But the paper fails to perform rigorous statistical goodness-of-fit tests (e.g., Kolmogorov-Smirnov, Anderson-Darling tests) on the distribution of the K generated return paths, leaving the similarity between the generated and true return distributions unquantified."}, "questions": {"value": "See weakness above"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "fPvFm6CkJI", "forum": "VltZQpfarw", "replyto": "VltZQpfarw", "signatures": ["ICLR.cc/2026/Conference/Submission5021/Reviewer_FycL"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5021/Reviewer_FycL"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission5021/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761920598940, "cdate": 1761920598940, "tmdate": 1762917826310, "mdate": 1762917826310, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes STABLE, a portfolio allocation framework that combines a conditional diffusion model with the Black–Litterman optimizer. The diffusion model is used to predict future return paths for each stock, conditioning on both macroeconomic indicators and firm-specific features. It introduces a multi-level guidance mechanism to separate shared market noise from idiosyncratic noise, making the predictions regime-aware. These diffusion-based forecasts are then treated as “views” in a Black–Litterman update to produce robust and stable portfolio weights. Across multiple markets, STABLE achieves higher Sharpe ratios and lower risk metrics than classical and deep RL baselines."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "As far as I am concerned, the paper’s most interesting idea is using a diffusion process to get a better estimate of how assets move together (their covariance). This is very important because good covariance estimates are key to controlling risk and building better portfolios.\n\nThe method has been tested in several major markets and consistently beats older methods in both return and stability.\n\nThe model’s internal patterns also make economic sense, showing realistic links between companies and sectors."}, "weaknesses": {"value": "Indeed, the paper tackles two key challenges in portfolio construction: (1) return prediction and (2) covariance estimation, both crucial for building effective, risk-controlled portfolios. The proposed diffusion-based framework is designed to improve both — by generating realistic future return paths and by learning dynamic relationships among assets.\n\nThe authors do provide some prediction performance analysis. In Section 4.3, they compare STABLE’s return forecasting accuracy (using MSE and DTW) against other generative models such as Diffusion-TS, AEC-GAN, and KoVAE, showing that STABLE achieves the lowest prediction errors across multiple markets. However, these comparisons are limited to deep generative baselines. There is no evidence that diffusion modeling improves predictive power over simpler and widely used models like regression, deep learning, or tree-based approaches.\n\nFor covariance estimation, which directly drives risk control, the paper also lacks clear evidence. It does not explicitly test whether the diffusion-derived covariance matrices are superior. Ideally, this would involve fixing the same return forecasts and showing that the covariance estimates from the proposed method lead to better risk-adjusted portfolios.\n\nIn short, while the framework is novel and conceptually appealing, the benefits of using the diffusion process are not rigorously demonstrated for either return prediction or covariance estimation. Moreover, the comparison setup is not entirely fair, since the proposed model uses richer macro- and firm-level inputs than the RL baselines."}, "questions": {"value": "My concerns are summarized above. My question is that`, can you provide experiments isolating the covariance estimation—e.g., keeping returns fixed and comparing portfolio volatility using covariance from different models—to show that the diffusion-based covariance is truly better?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "Iv8Z66heLB", "forum": "VltZQpfarw", "replyto": "VltZQpfarw", "signatures": ["ICLR.cc/2026/Conference/Submission5021/Reviewer_b8bB"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5021/Reviewer_b8bB"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission5021/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762014757300, "cdate": 1762014757300, "tmdate": 1762917825953, "mdate": 1762917825953, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents STABLE, a Shift-Tolerant Allocation framework that integrates a conditional diffusion generator with Black–Litterman (BL) portfolio optimization to achieve regime-aware portfolio allocation."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "The problem formulation and derivations (Eqs. 1–6) correctly extend diffusion sampling to a conditional macro-financial setting.\n\nThe BL posterior update and Sharpe-maximizing allocation are mathematically consistent with canonical forms.\n\nExperiments use proper multi-region datasets, fixed seeds, clear metrics, and ablations verifying each module’s contribution."}, "weaknesses": {"value": "Ablation depth: while individual module ablations exist, a joint ablation of CDG + MLG + BL contributions would clarify interdependencies.\n\nCompute transparency: GPU hours and sampling latency per rebalance step are not reported."}, "questions": {"value": "How sensitive are results to the number of generated paths (k) for BL view estimation?\n\nHave you compared STABLE’s performance during crisis windows (e.g., COVID-19) vs. stable regimes?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "O3dQsRcRgx", "forum": "VltZQpfarw", "replyto": "VltZQpfarw", "signatures": ["ICLR.cc/2026/Conference/Submission5021/Reviewer_zHmG"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5021/Reviewer_zHmG"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission5021/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762107544003, "cdate": 1762107544003, "tmdate": 1762917825042, "mdate": 1762917825042, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}