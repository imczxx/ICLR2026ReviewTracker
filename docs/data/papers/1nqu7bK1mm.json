{"id": "1nqu7bK1mm", "number": 2356, "cdate": 1757063150949, "mdate": 1759898153726, "content": {"title": "WFR-FM: Simulation-Free Dynamic Unbalanced Optimal Transport", "abstract": "The Wasserstein–Fisher–Rao (WFR) metric extends dynamic optimal transport (OT) by coupling displacement with change of mass, providing a principled geometry for modeling unbalanced snapshot dynamics. Existing WFR solvers, however, are often unstable, computationally expensive, and difficult to scale. Here we introduce **WFR Flow Matching (WFR-FM)**, a simulation-free training algorithm that unifies flow matching with dynamic unbalanced OT. Unlike classical flow matching which regresses only a transport vector field, WFR-FM simultaneously regresses a vector field for displacement and a scalar growth rate function for birth–death dynamics, yielding continuous flows under the WFR geometry. Theoretically, we show that minimizing the WFR-FM loss exactly recovers WFR geodesics. Empirically, WFR-FM yields more accurate and robust trajectory inference in single-cell biology, reconstructing consistent dynamics with proliferation and apoptosis, estimating time-varying growth fields, and  applying to generative dynamics under imbalanced data. It outperforms state-of-the-art baselines in efficiency, stability, and reconstruction accuracy. Overall, WFR-FM establishes a unified and efficient paradigm for learning dynamical systems from unbalanced snapshots, where not only states but also mass evolve over time.", "tldr": "Solve the dynamic unbalanced optimal transport WFR problem by using flow matching", "keywords": ["flow matching; unbalanced optimal transport; Wasserstein-Fisher-Rao"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/9b27b3f83dc0b840c34f17956ffcd28f0d8ee082.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper tackles the important and challenging problem of modeling continuous dynamics from sparse, unbalanced temporal snapshots --- a problem of significant interest in single-cell biology, where cell proliferation and apoptosis are key factors. The authors propose WFR Flow Matching (WFR-FM), a novel, simulation-free framework that unifies dynamic unbalanced optimal transport (under the WFR geometry) with flow matching.\n\nThe core technical contribution is a method that, unlike standard flow matching, simultaneously regresses both a transport vector field for particle displacement AND a scalar growth rate function for birth-death dynamics. The authors provide theoretical guarantees that this approach exactly recovers WFR geodesics. Empirically, the paper demonstrates that WFR-FM achieves state-of-the-art performance on several single-cell trajectory inference benchmarks, outperforming a wide range of baselines in accuracy, efficiency, and stability."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. **Clarity**: The paper is well-written, clear, and easy to follow. The problem, the proposed method, and its theoretical underpinnings are all explained well.\n2. **Thorough Related Work**: The authors provide a comprehensive review of related work with broader context of optimal transport, flow matching, and single-cell trajectory inference.\n3. **Empirical Validation**: The experimental evaluation is a significant strength. The authors compare WFR-FM against a wide and appropriate range of state-of-the-art baselines (including both balanced and unbalanced OT/FM methods).\n4. **Scalability and Efficiency Analysis**: The inclusion of detailed scalability analysis, including training time and memory usage (e.g., Figure 3), is good.\n5. **Straightforward generalisation to multiple time points**: The method's design, which naturally extends to multiple time points by concatenating successive intervals (Proposition 5.1), is practical and well-justified for real-world snapshot data."}, "weaknesses": {"value": "1.  **Positioning wrt to VGFM**: The paper currently relegates the detailed comparison with VGFM to Appendix C.4. While this appendix clearly articulates the important differences, VGFM appears to be the most direct competitor that also jointly models velocity and growth (and as reviewer believe was the first extension of flow matching to that). For fairness and clarity, a more prominent discussion of both the similarities and differences in the main body would be beneficial. This would also help readers better attribute the significant performance gains (e.g., in Table 1) to the novel methodological contributions of WFR-FM rather than potentially superior hyperparameter tuning\n2.  **Baseline Tuning**: The experimental results show some performance variations among baseline methods (e.g., MFM/SF2M vs. MIOFlow) that appear inconsistent across different experiments. The text lacks a detailed description of the hyperparameter tuning procedure used for these baselines. Without this, it is difficult to ascertain whether the reported baseline results represent their optimal performance."}, "questions": {"value": "1. **Practicality of Weighted Samples**: Regarding the practical application: As I understand from the inference workflow (Algorithm 2), the number of simulated particles/samples remains fixed from $t_0$. The 'growth' is modeled by increasing the mass $m^{(i)}$ of each particle. Is this interpretation correct? If so, the final output is a set of weighted points, where the number of points equals the initial number. How does this weighted-point representation practically benefit downstream analysis in single-cell biology, beyond simply matching benchmark distribution measures (like $\\mathcal{W}_1$ and RME)?\n\n2. **Coupling of Growth and Transport**: In the governing ODEs (Eq. 3.1), the evolution of the position $\\phi_t$ (driven by $u_t$) and the mass $m_t$ (driven by $g_t$) appear to be two separate, parallel processes, evaluated along the same path. Does the learned growth term $g_t$ (or the WFR-OET coupling) implicitly change the learned transport field $u_t$ for a given sample, compared to a model (like UOT-FM) that uses a similar unbalanced OT coupling but only models the vector field $u_t$?\n\n3. **Baseline Tuning**: This question refers to 2nd weakness.  Could the authors elaborate on the hyperparameter tuning procedure used for the baseline methods? Specifically, what steps were taken to ensure a fair and robust comparison, and to ensure that each baseline was performing optimally on these specific datasets?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "jpjVztags2", "forum": "1nqu7bK1mm", "replyto": "1nqu7bK1mm", "signatures": ["ICLR.cc/2026/Conference/Submission2356/Reviewer_Tvju"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2356/Reviewer_Tvju"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission2356/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761148611468, "cdate": 1761148611468, "tmdate": 1762916205276, "mdate": 1762916205276, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"title": {"value": "Quick and Initial Response to Reviewers"}, "comment": {"value": "We sincerely thank all reviewers for their careful reading of our manuscript and for providing constructive feedback and valuable suggestions. We are grateful for the positive comments regarding the novelty, clarity, theoretical grounding, and empirical validation of our work, and we fully agree with the reviewers on the aspects that can be further strengthened.\n\nOver the past few days we have carefully evaluated each point raised by the reviewers and have begun implementing substantial revisions. Below we outline the key updates we are undertaking; most of these are already in progress or partially completed.\n\n1. **Evaluation of Learned Growth Dynamics**: We will add experiments as Q5 in the results section to explicitly evaluate the quality of the learned growth dynamics. Particularly, this will include more thorough comparisons and discussions with state-of-the-art unbalanced transport methods such as Action Matching (AM) and Var-RUOT, which are highly relevant for their strong theoretical foundations and performance in modeling unbalanced stochastic dynamics. We will also expand the accompanying discussion to situate WFR-FM within the broader methodological landscape.\n\n2. **Discussion of Multi-Marginal Methods**: We will include a detailed discussion of the relationship between our approach and recent multi-marginal methods, highlighting both connections and key differences.\n\n3. **Figure 1 and Caption Update**: Figure 1 will be redrawn to offer a clearer and more intuitive overview of the WFR-FM workflow. The caption will also be revised to better explain the components, inputs, and outputs involved in the framework.\n\n4. **Mini-Batch OT Discussion**:  We will add a more explicit discussion of mini-batch OT, along with ablations evaluating batch-size sensitivity in WFR-FM. This addresses the reviewers’ question about training stability and potential bias introduced by mini-batching.\n\n5. **Real Biological Data and Unbalanced Dynamics**: We will add a discussion on the widespread presence of unbalance effects in real biological datasets, providing a more detailed rationale why WFR-FM performs better than balanced OT methods in these contexts.\n\n6. **Comparison to VGFM**: We will provide a more thorough and prominent discussion of VGFM into the main text and present a clearer, more direct discussion. We fully agree that VGFM represents an important advance in the joint modeling of velocity and growth, and it has opened an important line of research on unbalanced flow matching that our work builds upon. In the revised main text, we will explicitly acknowledge how WFR-FM is developed within this intellectual trajectory, and also detailing the conceptual, theoretical, and algorithmic distinctions that characterize our approach, highlighting how WFR-FM contributes unique capabilities within this emerging research direction.\n\n7. **Baseline Hyperparameter Tuning**: We will provide a detailed explanation of the hyperparameter tuning procedures for all baseline methods to ensure fair and robust comparisons.\n\nWe appreciate the reviewers’ detailed comments, many of which have already led us to improve both the clarity and rigor of the manuscript. We are finalizing the new experiments and analyses, and we will soon provide a complete, point-by-point response together with the updated manuscript. In the meantime, we welcome any additional suggestions from the reviewers and will do our best to incorporate them in the final revision."}}, "id": "ARfbrW3jTf", "forum": "1nqu7bK1mm", "replyto": "1nqu7bK1mm", "signatures": ["ICLR.cc/2026/Conference/Submission2356/Authors"], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2356/Authors"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission2356/-/Official_Comment"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1763718812765, "cdate": 1763718812765, "tmdate": 1763718812765, "mdate": 1763718812765, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Comment", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces WFR-FM, a model for learning continuous cellular dynamics from single-cell snapshot data when population sizes change over time. WFR-FM is based on the Wasserstein–Fisher–Rao (WFR) geometry, which couples transport of cell states with birth–death mass changes. To learn these dynamics efficiently, the authors combine WFR with flow matching, producing a simulation-free training objective. WFR-FM learns two components of cell dynamics jointly: a velocity field that transports cell states through gene expression space, and a growth rate field that models local changes in cell population density. The method constructs conditional particle trajectories inspired by traveling WFR geodesics, and trains a neural network to regress both velocity and growth directly, without integrating differential equations during training. The primary use of WFR-FM is to infer trajectories from time-series scRNA-seq data, particularly when cell counts shift between time points. The authors show that WFR-FM reconstructs developmental and differentiation dynamics more accurately and efficiently than ODE-based dynamic optimal transport methods, while capturing biologically meaningful patterns of proliferation and apoptosis."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "Overall, I enjoyed the paper. I think it is clean, well-written, and the math flows quite well. Broadly, I also find the research timely and compelling. While existing publications have already studied how to approach unbalancedness in flow matching, the present paper provides quite a deep formulation of the problem with updated probability paths and proper justifications. The model also seems to be working well in applied scenarios."}, "weaknesses": {"value": "Overall, my evaluation of the paper is positive (see the score). However, some aspects where I would suggest some improvements. I will elaborate on them below. \n\n- **Minor:** L136 -- change the citation to `\\citep` for Tong et al. \n- In Eq. 3.3, $\\delta$ is undefined. Since later the same symbol is used to define Dirac measures, I think it would be better to differentiate the meaning of $\\delta$ in different scenarios. \n- **Consistency in velocity notation:** In 3.5, the velocity notation is $x'$, but this is not used anywhere else in the text, where velocity is mostly expressed in terms of differentials. \n- L195: \"They\" does not seem like a correct pronoun here. What's the subject?\n- Eq. 3.8: The OET misses the constraints.\n- In Eq. 4.7: Refer to $\\tau$ as the $\\tau$ described above. \n- The way the traveling Gaussian is introduced could benefit from more elaboration. Especially, you could add one sentence explaining why the mass $m_0=1$ (hence, cause it's a relative mass change along the flow). \n- The concept figure could be bigger with a more exhaustive caption.\n- In the paper, I would probably describe the RME metric with a few sentences, and then refer to the appendix. At the moment, there is no clear intuition about it in the main text, and this breaks the readability of the experimental section a bit. Also, acronyms are not expanded in the main. Similarly, I would add a few sentences about where the presence of unbalancedness plays a role in the chosen datasets and why accounting for it is expected to produce a better performance. \n- Is the action in Tab. 2 calculated over multiple trajectories? If yes, can you please add error bars? Along these lines, I think that most of the tables would benefit from error bars, as the results are very close."}, "questions": {"value": "- L 308: Could you provide more intuition on the unit velocity here and why it is equivalent to flow matching by Tong?\n- Did the authors inspect any theoretical guarantees of their batchwise approach (just asking for an intuition)? How detrimental is it to use this approach for learning the true coupling?\n- Why would unbalanced OT work better on the EMT, EB, and cite datasets? I expect it to work on par with other OT and FM models, but why would it overcome them? Is it related to some aspect of umbalancedness?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "mMhsaz1tU7", "forum": "1nqu7bK1mm", "replyto": "1nqu7bK1mm", "signatures": ["ICLR.cc/2026/Conference/Submission2356/Reviewer_V2He"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2356/Reviewer_V2He"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission2356/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761932557662, "cdate": 1761932557662, "tmdate": 1762916205101, "mdate": 1762916205101, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposed use of Wasserstein-Fisher-Rao (WFR) metric to capture unbalanced transport by jointly regressing both a transport vector field and growth function, while explicitly modeling growth dynamics unlike other unbalanced transport FM methods. The method is evaluated on a range of synthetic datasets as well as commonly used real-world datasets for single-cell biology application."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "* **Clarity**: The authors provide comprehensive theoretical background in main text and appendix as well as relation to other unbalanced OT related work highlighting key differences between baselines and proposed method. The authors further support theoretical background with extensive proofs in the appendix.\n* **Robustness**: Robustness is tested through several ablation studies on batch size and coupling as well as controlled synthetic settings.\n* **Low computational cost**: The authors suggest method that improves performance in matching end-point marginals in comparison to baselines while keeping low computational cost. Further authors also show that the computational cost does not significantly increase across different dimensions or batch sizes."}, "weaknesses": {"value": "* **Evaluation of learned growth dynamics**: The paper demonstrates superior performance across $W_1$ and $RME$ metrics, however paper would benefit from showing it also manages to learn correct growth dynamics given it explicitly learns term $g_{\\phi}(x,t)$. This should be added as Q5 in experiments section and validated in synthetic or real-world setting.\n\n* **Adding further overview of use of WFR for FM-based algorithms**: It would be good to see more extensive discussion and if possible empirical comparison to unbalanced transport action matching (AM) by Neklyudov (2023) which also uses WFR distance to construct unbalanced OT. It would be good to see trade-off between using WFR to explicitly learn growth dynamics and using a single network to learn both transport and growth dynamics as presented in AM"}, "questions": {"value": "* In line 115 and 118, authors cite work by Neklyudov (2023, 2024) [1,2] and Sun (2025) [3] providing commentary that existing unbalanced approaches lack framework that can jointly recover velocity and growth dynamics or require costly ODE simulations. Would it be possible to evaluate the quality of learnt growth dynamics in a synthetic setting and compare to other unbalanced transport baselines such as Neklyudov (2023, 2024) and Sun (2025)?\n* Proposition 5.1 states that the solution to the multi-time WFR problem is equivalent to the concatenation of the solutions of consecutive time points. From algorithm 1 it also seems that the shared time-continuous velocity network is trained on consecutive pairs of points? However recent multi-marginal methods such as 3MSBM by Theodoropoulos et al (2025) [4] jointly enforce all marginals achieving better global coherence. Does proposition 5.1 then still hold?\n\n**References**\n\n[1] Neklyudov, Kirill, et al. \"Action matching: Learning stochastic dynamics from samples.\" International conference on machine learning. PMLR, 2023.\n\n[2] Neklyudov, Kirill, et al. \"A computational framework for solving wasserstein lagrangian flows.\" arXiv preprint arXiv:2310.10649 (2023).\n\n[3] Sun, Yuhao, et al. \"Variational Regularized Unbalanced Optimal Transport: Single Network, Least Action.\" arXiv preprint arXiv:2505.11823 (2025).\n\n[4] Theodoropoulos, Panagiotis, et al. \"Momentum Multi-Marginal Schr\\\" odinger Bridge Matching.\" arXiv preprint arXiv:2506.10168 (2025)."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "vf1q8MEcfY", "forum": "1nqu7bK1mm", "replyto": "1nqu7bK1mm", "signatures": ["ICLR.cc/2026/Conference/Submission2356/Reviewer_XcwL"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2356/Reviewer_XcwL"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission2356/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762154685432, "cdate": 1762154685432, "tmdate": 1762916204508, "mdate": 1762916204508, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}