{"id": "QZBFY2DaWh", "number": 8505, "cdate": 1758088525418, "mdate": 1759897779939, "content": {"title": "MoleRanker: Spectrum-Driven Molecular Structure Ranking with Heterogeneous Co-occurrence Graphs", "abstract": "Identifying molecular structures in environmental and biological samples is essential for assessing ecological risks and human health, yet remains highly challenging due to the vast number of unidentified compounds. Tandem mass spectrometry (MS/MS) provides high-throughput spectrum measurements, but existing spectrum-driven identification approaches face key limitations: spectrum-isolated modeling methods are computationally expensive and tend to overlook molecular clustering effects. Moreover, network-based methods typically fail to incorporate environmental co-occurrence across chemical samples, yielding unsatisfactory performance. To address these challenges, we revisit molecular identification as spectrum-driven molecular structure ranking and propose \\textsc{MoleRanker}, a novel heterogeneous graph neural network that integrates chemical constraints with environmental co-occurrence patterns. Specifically, we first construct a heterogeneous co-occurrence graph that encodes both \\textit{molecular-level chemical clustering effects} and \\textit{sample-level environmental co-occurrence correlations}. We then design a multiplex-relation message-passing mechanism to perform information propagation in a relation-aware manner across these heterogeneous relations. We construct four diverse datasets, including in-situ environmental pollutants and human metabolomics, and release them as a benchmark for spectrum-driven molecular structure ranking. Extensive experiments demonstrate that \\textsc{MoleRanker} achieves state-of-the-art performance, improving mean reciprocal rank (MRR) by 12.18\\% on average. Beyond accuracy, our approach opens new opportunities for discovering emerging pollutants and advancing the molecular understanding of human metabolism through graph-based integration of chemical and environmental evidence. Code is available at \\url{https://anonymous.4open.science/r/MoleRanker}.", "tldr": "", "keywords": ["Molecular structure ranking", "Heterogeneous co-occurrence graph"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/66e79bb9a12390fb4b805b80a6b7cf441598da93.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper redefines molecular identification as spectrum-driven molecular structure ranking, and proposes a heterogeneous co-occurrence graph algorithm that combines molecule-level chemical concentration information and sample-level environmental information to score and rank candidate molecular structures. The authors conduct experiments on both self-collected and public datasets to demonstrate the contribution of the algorithm."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 1}, "strengths": {"value": "I believe the paper is clearly written and conveys the authors’ ideas well. The core idea is interesting and intuitive, the reported metrics exhibit improvements, and the ablation studies substantiate the effectiveness of both information sources."}, "weaknesses": {"value": "1. The proposed “heterogeneous co-occurrence graph” approach does not appear to be novel; the contribution largely consists of injecting two additional information sources, while the remaining components follow standard practice. This amounts to an engineering blend rather than a deeper investigation of the molecular structure ranking problem.\n2. The supplementary material lists the compared methods but omits detailed experimental configurations. I strongly recommend fully specifying all baseline setups. For instance, were the homogeneous-graph baselines (GCN, GAT, GraphSAGE) trained on the same two relation layers/graphs?\n3. The training and evaluation pipeline is under-specified; please provide a detailed description.\n4. Although the paper claims lower computational cost than existing methods, no supporting experiments are reported; please include computational efficiency results."}, "questions": {"value": "1. The current comparative experiments are fairly conventional. Was a comprehensive investigation of strong baselines conducted?\n2. The reported performance of MetFrag, CFM-ID, and SIRIUS is near zero on three datasets. Is this consistent with prior empirical evidence? Please provide a detailed explanation for these results."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "gxGQtjGWG8", "forum": "QZBFY2DaWh", "replyto": "QZBFY2DaWh", "signatures": ["ICLR.cc/2026/Conference/Submission8505/Reviewer_NbWy"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8505/Reviewer_NbWy"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission8505/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761788986904, "cdate": 1761788986904, "tmdate": 1762920375973, "mdate": 1762920375973, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents MOLERANKER, a heterogeneous graph neural network specifically designed for spectrum-based molecular structure ranking. The core idea is to integrate chemical constraints (spectral similarity) and environmental co-occurrence (concentration correlations between samples) into multiple heterogeneous graphs, thereby enhancing message passing and improving the accuracy of candidate molecule ranking. The proposed architecture comprises spectrum-based and SMILES-based encoders, relation-aware graph convolution, and a dual-tower scoring mechanism optimized via a pairwise Bayesian Personalized Ranking (BPR) loss function. Experimental results on four datasets—including a newly curated environmental pollutant dataset and three human metabolomics datasets—demonstrate that the proposed method significantly outperforms existing approaches."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. The integration of a dual-tower scoring mechanism with a pairwise Bayesian Personalized Ranking (BPR) objective exhibits practical value for large candidate sets and severe class imbalance problems.\n2. The experiments conducted in this study are relatively comprehensive, and the results are favorable.\n3. The visualization outcomes are presented with commendable clarity."}, "weaknesses": {"value": "1. Omission of certain recent baselines in evaluation: The selection of baselines overlooks several directly relevant recent methods, particularly those leveraging topological or spectral graph modeling, or explicitly employing multi-relational molecular graphs for ranking tasks beyond the GNPS ecosystem.\n2. Insufficient discussion of practical limitations and generalization ability: Although the paper demonstrates strong performance on the relevant datasets, the discussion does not fully address potential generalization constraints—such as distributional shift in environmental chemistry or biomedical metabolomics—nor does it quantify the effects of batch variability, sample bias, or differences in candidate quality.\n3. Lack of, or insufficient, justification for not adopting other established GNN variants or loss functions: While the study implements standard GCN, GAT, and GraphSAGE as baselines, it does not utilize other advanced heterogeneous/relational GNN variants that have proven effective for multi-graph or biochemical graph tasks. The rationale for including only the proposed baselines is not sufficiently substantiated.\n4. Limited discussion on computational efficiency and scalability: Although the manuscript claims that MOLERANKER surpasses spectral isolation methods in computational efficiency, it provides no runtime or complexity analysis. Given the scale of candidate datasets shown in Figure 5 and Table 4, a clearer comparison is needed to articulate the trade-offs between actual runtime and scalability."}, "questions": {"value": "See the weaknesses."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "BpA3GasCsn", "forum": "QZBFY2DaWh", "replyto": "QZBFY2DaWh", "signatures": ["ICLR.cc/2026/Conference/Submission8505/Reviewer_8Hq5"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8505/Reviewer_8Hq5"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission8505/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761849902954, "cdate": 1761849902954, "tmdate": 1762920375581, "mdate": 1762920375581, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes a new method of identifying molecules from mass spectra combined with their co-occurrences. The work combines information from multiple resources, including correlation information computed from multiple samples, encoding of mass spectra, similarity between mass spectra, and molecule structures of candidates. The proposed method designs a graph neural network to learn information from all these resources. By minimizing the loss derived from a few mass spectra with known molecules, the model learns to identify molecule structures of other mass spectra. The performance shows that the proposed model achieves good performance in the transductive setting (identifying molecules in the constructed graph on all mass spectra)."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "On the data with multiple samples, it is a novel approach to include the correlation information from the concentration of molecules to improve the model's performance.\n\nThe proposed method outperforms several baselines, though new baselines from recent years should be included."}, "weaknesses": {"value": "1. The setup of the problem is not very realistic. The research seems to be a rediscovery of the ground truth. In a real situation, we can obtain a collection of mass spectra and construct a graph over them. However, it is hard to know the molecular structures of some nodes for training a neural network. It is possible that we could get the structures of a few of them because they are easy to identify, or we can use some external information. Even in this case, the known molecules will not represent the distribution of all molecules in the graph. The training model might be biased. Without the ability to generalize to different networks, it is hard to put the model to use in real situations. \n\n2. The model design with graph neural networks is largely known to the community. Therefore, the contribution to the machine learning aspect is limited. \n\n3. In the experiment, the three algorithms specially designed for molecule identification, MetFrag, CMF-ID, SIRIUS, are traditional methods without advanced neural networks. Other baselines are all generic learning models. There are a series of improvements [1] over these three methods, and these new methods should be included in the comparison. \n\n\n[1] Liu, Youzhong, et al. \"Current and future deep learning algorithms for tandem mass spectrometry (MS/MS)‐based small molecule structure elucidation.\" Rapid Communications in Mass Spectrometry 39 (2025): e9120."}, "questions": {"value": "I have no questions."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "hd8zrtGDpO", "forum": "QZBFY2DaWh", "replyto": "QZBFY2DaWh", "signatures": ["ICLR.cc/2026/Conference/Submission8505/Reviewer_sthq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8505/Reviewer_sthq"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission8505/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761875567816, "cdate": 1761875567816, "tmdate": 1762920374987, "mdate": 1762920374987, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The authors address the problem molecular structure ranking from tandem mass spectrometry data. They present MoleRanker, a novel graph neural network-based method which uses molecular groupings (as graphs) of shared functional groups (environmental co-occurrence) and chemical constraints. The authors additionally construct a new dataset to evaluate their proposed approach. Through a set of empirical experiments across several datasets, comparing with various baselines, and numerous ablations, the authors demonstrate the effectiveness of their proposed method for spectrum-driven molecular structure ranking."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The paper is clearly written and well presented (barring some minor comments below). As a result, the claims and contributions of this work are easy to follow.\n- The authors construct a new tandem mass spectrometry dataset to evaluate and benchmark molecular identification as a spectrum-driven molecular structure ranking task.\n- The authors introduce a novel method for molecular identification and validate it through comprehensive empirical experiments. The newly proposed method offers a novel insight into how to approach the problem of molecular identification, which could be useful to the research community."}, "weaknesses": {"value": "- Some details still require further clarification and possibly some additional experiments. Please see questions below."}, "questions": {"value": "- In equation 6, in $f$, can you clarify if the molecules in the candidate  set $\\mathcal{C}_i$ correspond to the nodes in $\\mathcal{G}$, or if $\\mathcal{G}$ is a graph over candidate sets? Furthermore, In the problem definition, specifically in equation 6, what is the ranking over? Molecules in one candidate set $\\mathcal{C}_i$? Or over all candidate sets $\\mathcal{C}$?\n- From section 3.2, is my understanding correct that you manually curated a novel dataset of molecules analyzed via tandem mass spectrometry?\n- Since the co-occurrence graph is constructed using prior knowledge, have you ablated for the cases where the molecular co-occurrence graph has errors? For instance, what happens if some of the edges in the co-occurrence graph are removed or additional edges are added? \n- In a similar vein, for the ablation in Table 2, what is the architecture used in the w/o graph setting?\n- The method uses SMILES representations of molecules, which are encoded into an embedding space. Have the authors considered other molecular representations (such as molecular graphs)? How would performance of the method change when using different molecular representations?\n\n\nMinor comments: \n\n- \"environmental co-occurrence\" seems pertinent to this work and is mentioned several times in the abstract and introduction before a clear definition is provided. Possibly defining this term earlier would be beneficial to the reader. \n- In section 5, it would be helpful to state a summary of the research questions in the title of each respective sub-section."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "Bz2CAvWurH", "forum": "QZBFY2DaWh", "replyto": "QZBFY2DaWh", "signatures": ["ICLR.cc/2026/Conference/Submission8505/Reviewer_9kL1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8505/Reviewer_9kL1"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission8505/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761938694266, "cdate": 1761938694266, "tmdate": 1762920374580, "mdate": 1762920374580, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"title": {"value": "General Response"}, "comment": {"value": "Dear Program Chairs, (Senior) Area Chairs and Reviewers,\n\nWe appreciate all reviewer's time and valuable comments. Below is a concise summary of the review.\n\n## Reviewer Acknowledgement\n1. **(Insight) Novel and interesting insight**  \n- Reviewer `9kL1`: *...offers a novel insight into how to approach the problem of molecular identification, which could be useful to the research community.*\n- Reviewer `NbWy`: *The core idea is interesting and intuitive,...*\n2. **(Dataset and Method) New dataset and novel method.**  \n- Reviewer `9kL1`: *The authors construct a new tandem mass spectrometry dataset...*; *The authors introduce a novel method for molecular identification,....*\n- Reviewers `sthq`: *...it is a novel approach to include the correlation information from the concentration of molecules to improve the model's performance.*\n- Reviewers `8Hq5`: *The integration of a dual-tower scoring mechanism with a pairwise Bayesian Personalized Ranking (BPR) objective exhibits practical value for large candidate sets and severe class imbalance problems.*\n3. **(Experiments) Comprehensive empirical validation.**  \n- Reviewers `9kL1`: *...validate it through comprehensive empirical experiments.*\n- Reviewers `8Hq5`: *The experiments conducted in this study are relatively comprehensive, and the results are favorable.*\n- Reviewers `NbWy`: *...the reported metrics exhibit improvements, and the ablation studies substantiate the effectiveness of both information sources.*\n- Reviewers `sthq`: *The proposed method outperforms several baselines,...*\n4. **(Presentation) Clearly-written and well presentation.**  \n- Reviewers `9kL1`: *The paper is clearly written and well presented....*\n- Reviewers `NbWy`: *I believe the paper is clearly written and conveys the authors’ ideas well.*\n- Reviewers `8Hq5`: *The visualization outcomes are presented with commendable clarity.*\n\nWe sincerely appreciate the reviewers’ thoughtful engagement once again and believe that our responses address their concerns. Moreover, we would be glad to further discuss any aspect of the work with you.\n\nBest regrads,\n\nAuthors"}}, "id": "lmaeOZdkCB", "forum": "QZBFY2DaWh", "replyto": "QZBFY2DaWh", "signatures": ["ICLR.cc/2026/Conference/Submission8505/Authors"], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission8505/Authors"], "number": 5, "invitations": ["ICLR.cc/2026/Conference/Submission8505/-/Official_Comment"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1763625754624, "cdate": 1763625754624, "tmdate": 1763625754624, "mdate": 1763625754624, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Comment", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}