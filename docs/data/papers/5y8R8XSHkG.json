{"id": "5y8R8XSHkG", "number": 19003, "cdate": 1758292658203, "mdate": 1759897068029, "content": {"title": "Smoothie: Smoothing Diffusion on Token Embeddings for Text Generation", "abstract": "Diffusion models have achieved state-of-the-art performance in generating images, audio, and video, but their adaptation to text remains challenging due to its discrete nature. Prior approaches either apply Gaussian diffusion in continuous latent spaces, which inherits semantic structure but struggles with token decoding, or operate in categorical simplex space, which respect discreteness but disregard semantic relation between tokens. In this paper, we propose Smoothing Diffusion on Token Embeddings (Smoothie), a novel diffusion method that combines the strengths of both approaches by progressively smoothing token embeddings based on semantic similarity. This technique enables gradual information removal while maintaining a natural decoding process. Experimental results on several sequence-to-sequence generation tasks demonstrate that Smoothie outperforms existing diffusion-based models in generation quality. Furthermore, ablation studies show that our proposed diffusion space yields better performance than both the standard embedding space and the categorical simplex.", "tldr": "We present Smoothie, a text diffusion method that constructs its diffusion process with consideration of the discrete nature of text and the semantic relationships between tokens.", "keywords": ["text diffusion", "text generation", "continuous text diffusion"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/77be64e0373ef51fcac2760f5e5bee444dbe0add.pdf", "supplementary_material": "/attachment/629cd341861f2bbd5b172499de700590920e9064.zip"}, "replies": [{"content": {"summary": {"value": "The paper introduces **SMOOTHIE**, a diffusion model that operates on token embeddings by constructing a *semantic distance tensor* for each token. Instead of performing diffusion in the discrete simplex (as in D3PM or SSD-LM) or the embedding space (as in Diffusion-LM), SMOOTHIE models the evolution of the *pairwise distances* between each token and all vocabulary embeddings. This design allows the diffusion process to preserve both discrete structure and semantic smoothness: at each timestep, Gaussian noise is added to perturb these distances, generating soft distributions that reflect evolving semantic relationships.\n\nThe authors prove that simplex diffusion (D3PM-style) is a special case of SMOOTHIE when using a trivial distance metric, thus theoretically generalizing prior discrete diffusion frameworks. Experiments on summarization (XSum), paraphrasing (QQP), detoxification (ParaDetox), story generation (ROCStories), and question answering (Quasar-T) show consistent improvements over both discrete and continuous diffusion baselines. While the paper includes a basic step-count and self-conditioning analysis, more systematic ablations (e.g., noise schedule, δ̃ magnitude) are needed to isolate where the gains truly come from."}, "soundness": {"value": 4}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1. **Unified formulation:** The paper provides a clear mathematical unification of discrete simplex diffusion and continuous embedding diffusion via a distance-based representation. Theorem 4.1 elegantly connects distance regression with embedding regression.\n2. **Semantic-aware diffusion:** By perturbing the distance tensor with Gaussian noise, the model embeds semantic structure directly into the diffusion process, enabling smooth transitions between semantically related tokens.\n3. **Comprehensive evaluation:** Experiments cover diverse tasks (XSum, QQP, ParaDetox, ROCStories, Quasar-T) and compare fairly with both discrete (TESS, SSD-LM, D3PM) and continuous (DiffuSeq, Diffusion-LM) baselines.\n4. **Fair comparison setup:** Model sizes (~100M), datasets, and decoding strategies are kept consistent; pretrained advantages of baselines (e.g., TESS) are removed.\n5. **Strong performance:** SMOOTHIE outperforms all diffusion baselines and achieves results comparable to autoregressive models like FLAN-T5."}, "weaknesses": {"value": "1. **Computation cost not analyzed:** Although vectorization and mean-embedding compression are mentioned, there is no report on runtime, GPU memory, or FLOPs. Given that every token interacts with all vocabulary embeddings, the training cost may be substantial.\n2. **Limited ablations on general enhancements:** While the authors tested self-conditioning and found minimal gains (and thus did not adopt it), other general mechanisms such as the tanh-style noise schedule or δ̃ magnitude lack comprehensive ablations. More systematic sensitivity studies would clarify whether improvements stem primarily from the distance-based diffusion rather than secondary hyperparameters.\n3. **Embedding dependency untested:** The model fixes the BERT embedding matrix during training but does not evaluate alternative embeddings (e.g., random, GloVe, or fine-tuned). It remains unclear how sensitive performance is to the embedding quality or domain.\n4. **No convergence or efficiency analysis:** Beyond theoretical equivalence, convergence behavior and stability relative to token-level diffusion are unreported; adding epoch-wise loss curves would clarify training efficiency."}, "questions": {"value": "1. **Computation cost:** Can you report training time, GPU memory, or FLOPs compared to TESS or DiffuSeq? How is the full distance tensor computation optimized, and how does it scale with vocabulary size?\n2. **Embedding dependence:** Have you evaluated SMOOTHIE using other embeddings (e.g., random or domain-specific)? How robust is the model to embedding quality and distribution shifts?\n3. **Noise schedule and δ̃ ablations:** Why was the tanh-style schedule chosen? Have you tested alternative schedules or δ̃ values to confirm robustness across datasets?\n4. **Self-conditioning and fairness:** Since self-conditioning yields limited improvement and was excluded, can you confirm that no other general enhancements influenced the main gains? Could similar gains be achieved by applying self-conditioning to baselines?\n5. **Convergence and stability:** Please include training curves or epoch-wise loss comparisons with baseline diffusion models to demonstrate convergence efficiency and numerical stability.\n6. **Scalability:** How does SMOOTHIE perform with larger vocabularies (e.g., >50K tokens)? Are there feasible strategies (e.g., top-k distance pruning or clustering) to reduce complexity while maintaining accuracy?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "rrxvoA9gst", "forum": "5y8R8XSHkG", "replyto": "5y8R8XSHkG", "signatures": ["ICLR.cc/2026/Conference/Submission19003/Reviewer_gFQF"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19003/Reviewer_gFQF"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission19003/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761793220446, "cdate": 1761793220446, "tmdate": 1762931054342, "mdate": 1762931054342, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces SMOOTHIE (Smoothing Diffusion on Token Embeddings), a novel diffusion model framework for text generation that aims to bridge the gap between continuous (Gaussian) and discrete (Simplex/Categorical) text diffusion methods. The core innovation lies in defining a new latent space where each token is represented by a vector of negative squared Euclidean distances between its embedding and the embeddings of all vocabulary tokens.\nThe authors demonstrate that SMOOTHIE consistently outperforms prior diffusion-based approaches across several sequence-to-sequence tasks, achieving generation quality comparable to strong autoregressive baselines."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 4}, "strengths": {"value": "The core contribution of defining the diffusion space using semantic distances (Euclidean proximity) in the embedding space is highly intuitive and well-justified. It elegantly addresses the major trade-off in existing work: retaining semantic structure (like Gaussian diffusion) while enabling natural decoding from discrete representations (like Simplex diffusion)."}, "weaknesses": {"value": "SMOOTHIE (like most text diffusion models) runs over fixed-length sequences. In practice, they set a dataset-specific max length and pad shorter sequences with a special padding token that the model learns to predict. The generation process is bounded by the preset max. It can emit different effective lengths up to a cap, but it doesn’t truly sample variable length the way an autoregressive model does."}, "questions": {"value": "In Figure 1 (a), why is the color of the arbitrary i-th embedding always the same? What is the meaning of the structured shape (a flag-shaped pattern with an oval in the bottom) that the dots form?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "WLmHD0pm40", "forum": "5y8R8XSHkG", "replyto": "5y8R8XSHkG", "signatures": ["ICLR.cc/2026/Conference/Submission19003/Reviewer_QSj6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19003/Reviewer_QSj6"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission19003/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761883918613, "cdate": 1761883918613, "tmdate": 1762931053826, "mdate": 1762931053826, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "SMOOTHIE proposes diffusion over distance-based token-embedding logits, smoothing semantics while preserving discreteness, outperforming prior text diffusion on seq2seq tasks; analyses highlight noise, steps, and self-conditioning."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1.\tUnifies prior lines: maps each token to a vector of negative squared distances to all vocab embeddings, then diffuses and feeds softmax(D_t) to the model; enables natural argmax decoding while preserving semantics and discreteness. Clear training/sampling pseudocode. \n2.\tThe distance-based latent generalizes simplex diffusion (simplex emerges under a trivial metric), giving a clean conceptual frame. \n3.\tPractical guidance on schedules/self-conditioning; moderate steps (~100–200) are sufficient, with analysis of step count and reverse-noise. \n4.\tConsistent gains over diffusion baselines on multiple seq2seq tasks."}, "weaknesses": {"value": "1.\tFixed pre-trained embeddings (E) cap expressivity; authors acknowledge end-to-end training would likely help but leave it to future work. \n2.\tFixed sequence length forces substantial padding; variable length is emulated by truncating after EOS, which is inefficient; prior early-truncation is ad hoc. \n3.\tEvery step computes softmax over the full vocabulary V (and final argmax), which scales poorly for large V and long m; no top-k/approximation is provided. \n4.\tRelies on the Euclidean semantic space hypothesis; authors note other domains may need different distances—raises concerns for polysemy/anisotropy. \n5.\tLittle on throughput/memory vs. competing diffusion methods under equal steps; limited evaluation breadth (small/medium datasets, few human evals)."}, "questions": {"value": "1. Please fine-tune embeddings or learn a task-adaptive metric (e.g., Mahalanobis) on at least one dataset; report lifts vs. fixed E. \n2. Efficiency. Provide tokens/sec, GPU memory, and wall-clock vs. SSD-LM/TESS/embedding-diffusion at matched steps; include step–quality curves. \n3. Try top-k candidate sets (ANN/FAISS) or hierarchical/adaptive softmax; quantify quality vs. speed trade-offs for long sequences and large vocabularies. \n4. Beyond EOS truncation, test a general dynamic-length denoising strategy (e.g., entropy/energy-based early stop) and compare to SeqDiffuSeq’s early truncation. \n5. Add longer-form generation, dialogue, or factual QA, and report mean±σ over multiple seeds; analyze sensitivity to δ ̃and steps across tasks."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "RFgAQtkIbS", "forum": "5y8R8XSHkG", "replyto": "5y8R8XSHkG", "signatures": ["ICLR.cc/2026/Conference/Submission19003/Reviewer_Uud8"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19003/Reviewer_Uud8"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission19003/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761966916651, "cdate": 1761966916651, "tmdate": 1762931053290, "mdate": 1762931053290, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces SMOOTHIE, a diffusion model framework designed for text generation. The authors identify a key challenge in adapting diffusion models to discrete data like text: existing methods either operate in a continuous latent space (e.g., Gaussian diffusion on embeddings), which struggles with accurate token decoding, or in a discrete/categorical space, which ignores the semantic relationships between tokens. SMOOTHIE perturbs distance-based representations of tokens, dissolving semantic structure over time. The authors claim this technique is superior to both standard embedding space diffusion and categorical diffusion. They provide empirical evidence on several sequence-to-sequence generation tasks."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 1}, "strengths": {"value": "- The proposed diffusion space, which perturbs representations based on semantic similarity, is a contribution to the field.\n- The authors provide empirical validation across multiple text generation tasks. The reported results suggest that the proposed method may offer a performance improvement over other diffusion-based baselines, and the inclusion of ablation studies helps to substantiate the specific design choices made in the SMOOTHIE framework."}, "weaknesses": {"value": "- The proposed method's reliance on a pre-trained word embedding model (in this case, BERT) may limit its scalability and applicability. This dependency raises questions about the framework's potential to scale effectively with larger models or different architectures, as it is tied to the properties and constraints of the initial embedding space.\n- The experimental evaluation is missing a common and important conditional text generation task: machine translation. Including results from machine translation would provide a more comprehensive assessment of the method's capabilities and generalizability.\n- The paper lacks an analysis of the method's sensitivity to the choice of the pre-trained word embedding. It would be beneficial to investigate whether the approach is viable with other types of embeddings, such as those from GPT-based models, to better understand the robustness and flexibility of the proposed framework."}, "questions": {"value": "See weakness"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "jIpnhAIfDb", "forum": "5y8R8XSHkG", "replyto": "5y8R8XSHkG", "signatures": ["ICLR.cc/2026/Conference/Submission19003/Reviewer_V1zB"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19003/Reviewer_V1zB"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission19003/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762098197001, "cdate": 1762098197001, "tmdate": 1762931052821, "mdate": 1762931052821, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}