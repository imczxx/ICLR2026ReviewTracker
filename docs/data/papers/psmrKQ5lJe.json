{"id": "psmrKQ5lJe", "number": 19002, "cdate": 1758292643834, "mdate": 1759897067963, "content": {"title": "Carré du champ flow matching: better quality-generalisation tradeoff in generative models", "abstract": "Deep generative models often face a fundamental tradeoff: high sample quality can come at the cost of memorisation, where the model reproduces training data rather than generalising across the underlying data geometry. We introduce Carré du champ flow matching (CDC-FM), a generalisation of flow matching (FM), that improves the quality-generalisation tradeoff by regularising the probability path with a geometry-aware noise. Our method replaces the homogeneous, isotropic noise in FM with a spatially varying, anisotropic Gaussian noise whose covariance captures the local geometry of the latent data manifold. We prove that this geometric noise can be optimally estimated from the data and is scalable to large data. Further, we provide an extensive experimental evaluation on diverse datasets (synthetic manifolds, point clouds, single-cell genomics, animal motion capture, and images) as well as various neural network architectures (MLPs, CNNs, and transformers). We demonstrate that CDC-FM consistently offers a better quality-generalisation tradeoff. We observe significant improvements over standard FM in data-scarce regimes and in highly non-uniformly sampled datasets, which are often encountered in AI for science applications. Our work provides a mathematical framework for studying the interplay between data geometry, generalisation and memorisation in generative models, as well as a robust and scalable algorithm that can be readily integrated into existing flow matching pipelines.", "tldr": "We improve the quality-generalisation tradeoff in flow matching by adding geometric noise to probability paths.", "keywords": ["flow matching", "diffusion geometry", "manifold learning", "regularisation"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/1240d1181ee3b661b1069553151dfcf37a7ab72f.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper introduces **Carré du Champ Flow Matching (CDC-FM)**, a *geometry-aware generalization of Flow Matching (FM)* designed to improve the tradeoff between **sample quality** and **generalisation** in deep generative models.  \n\nStandard FM often suffers from *memorisation*, in which the model reproduces training examples rather than sampling broadly from the underlying manifold. CDC-FM addresses this by introducing a **spatially varying, anisotropic diffusion term** aligned with the data manifold’s local geometry.  \n\nThe method provides both a **theoretical framework** linking geometric regularisation and generative transport, and a **scalable algorithm** (O(N log N)) applicable to large datasets."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. **Conceptual Novelty and Theoretical Depth**  \n   - Reformulating flow matching as a geometry-regularised stochastic process via the *Carré du Champ* operator is mathematically elegant and well justified.  \n   - The theoretical analysis clearly connects the anisotropic diffusion term to Dirichlet energy minimisation and optimal transport interpolants.  \n\n2. **Empirical Breadth**  \n   - Demonstrations span multiple domains (geometric point clouds, biological data, motion capture, image synthesis), highlighting robustness.  \n   - Consistent improvements in *generalisation* metrics (NLL, Earth Mover’s Distance, memorisation ratio) show the practical benefit of geometry-aware noise.  \n\n3. **Quality–Generalisation Tradeoff Analysis**  \n   - The paper systematically studies how FM overfits under data sparsity and heterogeneous sampling and shows CDC-FM mitigates memorisation even without early stopping.  \n   - Figures such as Fig. 3–6 effectively illustrate the dynamics of quality, memorisation, and generalisation over training epochs."}, "weaknesses": {"value": "1. **Limited Theoretical Generality**  \n   - The approach depends on accurate tangent-space estimation via diffusion maps, which scales poorly with high-dimensional data and may break for non-manifold or mixed-domain datasets.  \n   - The analysis assumes a strong form of the manifold hypothesis; the method’s behaviour in non-geometric or noisy data regimes is not deeply studied.\n\n2. **Empirical Limitations**  \n   - Although CIFAR-10 results are included, they remain moderate; improvements appear strongest in low-data or geometric domains rather than large-scale image generation.  \n   - Some evaluations (e.g., motion-capture experiments) are largely qualitative; more statistical metrics (e.g., variance, confidence intervals) would improve credibility.\n\n3. **Ablation and Hyperparameter Sensitivity**  \n   - The role of parameters such as the scaling factor \\(\\gamma\\) and rank \\(d_{cdc}\\) is discussed but not systematically ablated.  \n   - The influence of kernel bandwidth and nearest-neighbour size on \\(\\hat{\\Gamma}\\) estimation could be quantitatively explored."}, "questions": {"value": "1. How sensitive is CDC-FM to the choice of kernel bandwidth and neighbour count in the diffusion map estimation of \\(\\hat{\\Gamma}\\)?  \n2. Could the authors explore combining CDC regularisation with learned adaptive manifolds or latent diffusion embeddings?  \n3. In higher-dimensional settings (e.g., CIFAR-10), can CDC-FM’s benefits be retained through hierarchical or local manifold approximations?  \n4. How does CDC-FM interact with implicit architectural regularisation (e.g., transformers vs UNet backbones)?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "cgtJK7uoza", "forum": "psmrKQ5lJe", "replyto": "psmrKQ5lJe", "signatures": ["ICLR.cc/2026/Conference/Submission19002/Reviewer_M4z6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19002/Reviewer_M4z6"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission19002/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761881174066, "cdate": 1761881174066, "tmdate": 1762931053791, "mdate": 1762931053791, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces Carré du Champ Flow Matching (CDC-FM), a generalization of the Flow Matching method designed to enhance generalization while maintaining generation quality. The approach incorporates a geometry-aware noise term as a regularizer. Its effectiveness is demonstrated through extensive experiments across diverse datasets, validating the model’s properties and performance."}, "soundness": {"value": 4}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The paper is well-structured and clearly written, with a rich set of figures that effectively illustrate the concepts and accurately present the results.\n- The work presents a novel, interesting, and mathematically sound solution to an open problem in flow matching, demonstrating strong practical performance.\n- The model is extensively evaluated to properly experimentally show the benefits provided by the method, as well as to test and show the limitations, which are the ones usually affecting geometric models."}, "weaknesses": {"value": "- The main weakness of the paper, also acknowledged by the authors, lies in its reliance on the manifold hypothesis. The experiments show that as the dimensionality of the data manifold increases, CDC-FM struggles to maintain the same sample quality as FM when trained with the same number of data points. I consider this a significant limitation, though the paper remains of high quality overall.\n\n- Another area for improvement is the writing. Although the paper is detailed and mathematically precise, the motivation for adopting this specific approach to address the generalization–memorization problem in FM is not clearly articulated in the introduction. Moreover, while the method is rigorously developed in the introduction and Section 3, providing an intuitive explanation before delving into the technical discussion (e.g., before Equation (1)) would make the paper more accessible. I will elaborate on these points in the Questions section."}, "questions": {"value": "**Experiments**\n- In Tables A6 and A7, I noticed that the DtM for FM is consistently lower than for CDC-FM, which is quite interesting. Do you think this is just due to memorization?\n- The experiment \"Early stopping for spatially heterogeneous data\" is very interesting.\n\n**Paper structure and writing**\n- In the introduction, the motivation for using geometric regularization as a means to improve the quality–generalization trade-off is not clearly stated. While it is clear that it introduces a more geometry-aware noise, it remains unclear how this would contribute to better generalization.\n- Providing an intuitive explanation of the method - similar to the excellent one you give in the Conclusion - before presenting the technical details in the introduction would make the paper easier to follow.\n- Making your loss function explicit could also improve clarity.\n- The paragraph preceding Section 3.2, which introduces the connection to the Dirichlet energy and carré du champ, is quite dense but conceptually important. I believe this explanation should be expanded and made less synthetic.\n- The explanation of the experiment on animal motion capture data is also rather dense and not very smooth to read. In this case, the solution might not be to add more text, but rather to move some details to the Appendix. Of course, this is just a suggestion to improve readability."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "yjFda126PF", "forum": "psmrKQ5lJe", "replyto": "psmrKQ5lJe", "signatures": ["ICLR.cc/2026/Conference/Submission19002/Reviewer_gnWi"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19002/Reviewer_gnWi"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission19002/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761923802035, "cdate": 1761923802035, "tmdate": 1762931053277, "mdate": 1762931053277, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper addresses a key challenge in deep generative modeling via flow-matching methods: achieving very high sample quality often comes at the cost of over-fitting or memorization of the training data, rather than genuine generalization to the underlying data manifold. The authors propose a novel method termed Carré du champ flow matching (CDC-FM) that augments the standard flow‐matching (FM) framework with a geometry‐aware noise regularization."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "The paper is well written. Fig. 1 provides an overview of the proposed method and clearly shows its difference with classic flow matching.\n\nThey introduce the novel idea of aligning the noise covariance in the conditional paths of FM with the local geometry of the data manifold. It leverages diffusion geometry / local covariance estimation to regularise generative flows. The authors also show the connection with anisotropic diffusion, providing nice theoretical justification. \n \nThe authors show how one can estimate the local covariance (noise field) from data in a scalable way (via k-NN/diffusion kernel methods) and integrate it into the FM pipeline. The method can be plugged into existing flow matching implementations. \n\nThe experiments span a nice variety of domains: synthetic engineered manifolds, point clouds, genomics, motion capture, and images. o\tAccording to the results, CDC‐FM achieves similar or better sample quality while reducing memorisation and improving generalisation."}, "weaknesses": {"value": "The authors point out the scalability issue due to the use of manifold hypothesis. When the underlying manifold dimension grows, the samples required to estimate the tangent space grow exponentially. \n\nThe practical benefit seems strongest in specialized regimes (maybe low-dimensional manifold data, low data) rather than the large‐scale image domain that most practitioners focus on; the implementation adds complexity and hyper-parameters."}, "questions": {"value": "1. Is there a practical guidance on when to use Carré du champ FM vs regular FM?\n\n2. In practice, people use latent diffusion models (or flow-based models) for high-dimensional data.Can Carré du champ FM work in the latent space? Is it possible to show some results on data like CelebA-HQ?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "Z3wMwzFjHC", "forum": "psmrKQ5lJe", "replyto": "psmrKQ5lJe", "signatures": ["ICLR.cc/2026/Conference/Submission19002/Reviewer_bx3v"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19002/Reviewer_bx3v"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission19002/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761979653516, "cdate": 1761979653516, "tmdate": 1762931052911, "mdate": 1762931052911, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes CDC-FM, a geometry-aware variant of flow matching that replaces the standard isotropic conditional path with an anisotropic, spatially varying Gaussian whose covariance estimates local tangent structure via diffusion-geometry tools. The resulting conditional path is the displacement (OT) interpolant between standard Gaussian and the spatially varying Gaussian. The authors show is equivalent to adding a space-dependent diffusion (Fokker–Planck) term. Across geometric datasets (circles, LiDAR surfaces, single-cell trajectories, animal motion), CDC-FM aims to mitigate memorisation while preserving or improving sample quality and test NLL, especially in data-scarce and heterogeneous regimes."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. Clear replacement of the FM conditional path with an OT-consistent Gaussian path. The equivalence to adding anisotropic diffusion (Fokker–Planck form) is neat and well-derived. \n\n2. It works with MLP/UNet/Transformer and diverse domains, including both low-dim synthetic and higher-dim biological/motion data and scaling discussion.\n\n3. The paper uses nearest-neighbour ratio to quantify memorisation; separates quality, generalisation, and the percentage memorised, showing heterogeneous behaviour over manifolds/regions."}, "weaknesses": {"value": "1. The test NLL is model-dependent and sometimes hard to compute reliably for FM variants; \n\n2. Key assertions (e.g., improved convergence/quality or robustness) are not tested across standard benchmarks, strong baselines, or multiple seeds with confidence intervals."}, "questions": {"value": "1. How is NLL computed across models?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "9CiaO9kh5Z", "forum": "psmrKQ5lJe", "replyto": "psmrKQ5lJe", "signatures": ["ICLR.cc/2026/Conference/Submission19002/Reviewer_7Zem"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission19002/Reviewer_7Zem"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission19002/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761984200324, "cdate": 1761984200324, "tmdate": 1762931052462, "mdate": 1762931052462, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}