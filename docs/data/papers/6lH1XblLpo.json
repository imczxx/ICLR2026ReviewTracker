{"id": "6lH1XblLpo", "number": 17896, "cdate": 1758281734129, "mdate": 1763724759242, "content": {"title": "Delay Flow Matching", "abstract": "Flow matching (FM) based on Ordinary Differential Equations (ODEs) has achieved significant success in generative tasks. However, it faces several inherent limitations, including an inability to model trajectory intersections, capture delay dynamics, and handle transfer between heterogeneous distributions. These limitations often result in a significant mismatch between the modeled transfer process and real-world phenomena, particularly when key coupling or inherent structural information between distributions must be preserved. To address these issues, we propose Delay Flow Matching (DFM), a new FM framework based on Delay Differential Equations (DDEs). Theoretically, we show that DFM possesses universal approximation capability for continuous transfer maps. By incorporating delay terms into the vector field, DFM enables trajectory intersections and better captures delay dynamics. Moreover, by designing appropriate initial functions, DFM ensures accurate transfer between heterogeneous distributions. Consequently, our framework preserves essential coupling relationships and achieves more flexible distribution transfer strategies. We validate DFM's effectiveness across synthetic datasets, single-cell data, and image-generation tasks.", "tldr": "We propose Delay Flow Matching, a generative framework based on delay differential equations that overcomes flow matching's limits-trajectory intersection, delay dynamics, heterogeneous transfer- while providing universal approximation guarantees.", "keywords": ["Generative Models", "Flow Matching", "Delay Differential Equations", "Trajectory Intersection", "Heterogeneous Distribution Transfer"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/129e04c5726d50726999e9e6b85bea8dd3e3829c.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "The paper proposes Delay Flow Matching (DFM) which is a framework that replaces the role of ODEs within standard flow matching, with flows derived from delay differential equations. \nThis is motivated from the fact that ODEs can fail to represent certain distribution transport plans as they cannot represent flows with intersections (relevant to real world problems such as reconstructing trajectories of single-cell data)\nFrom this, the paper shows how the standard flow machine recipe can be generalised to work with flows from delay differential equations that overcome the previous issues. The paper then provide empirical validation of their framework on different datasets of image data and single-cell data, demonstrating compelling results."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "* The core idea of replacing flow from ODEs with flows from delay differential equations is very interesting due to the properties such flows are afforded. In particular, this address key limitations of standard flow matching around trajectories not being able to intersect.\n\n* The derivation and setup of DFM is nicely presented and formulated, as well as the theoretical justification that standard flow matching cannot handle common transport plans\n\n* The paper provides good empirical evidence to support DFM across a range of modalities."}, "weaknesses": {"value": "* The paper makes very limited evaluation of the profile of computational cost of training and inference (e.g. FLOPs and wall-clock time instead of just NFEs) for DFM in comparison with flow matching which makes it hard to see whether the increase in performance is worth it in cases such as image generation\n\n* The experimental setup in the image generation differ from the standard setup - i.e. the choice of the prior distribution is made to highlight regimes where DFMs are expected to perform better, which makes it hard to mentally compare against other flow matching approaches."}, "questions": {"value": "* Can you provide further details about the computational profile of DFM compared with flow matching\n\n* How restrictive is the design of the initial function. For example, this requires prior information about the structural of the problem. For cases such as text to image generation, how should we design the initial function - i.e thinking about where we want to generate based on a prompt instead of the fixed classes in the dataset.\n\n* Moreover, do you have experiments where you compare DFM with flow matching where the setup is closer to the standard setup - i.e. the prior is a isotropic Gaussian."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "z61NvRoX1b", "forum": "6lH1XblLpo", "replyto": "6lH1XblLpo", "signatures": ["ICLR.cc/2026/Conference/Submission17896/Reviewer_LNpe"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17896/Reviewer_LNpe"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission17896/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761953110298, "cdate": 1761953110298, "tmdate": 1762927719463, "mdate": 1762927719463, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"title": {"value": "General Response"}, "comment": {"value": "We express our sincere gratitude to all the reviewers for their professional evaluation of our article, which has greatly contributed to enhancing the quality of our manuscript. In response to the reviewers’ valuable comments and questions, we have made substantial additions and revisions to the manuscript. All modifications are highlighted in color in the updated version. The main changes are summarized as follows:\n\n**1. Revision of the theorem:**\n\nWe have refined the statement of the universal approximation theorem under the DFM framework to make it more rigorous and accurate. \n\n*Please refer to Page 7, Lines 331–336 of the revised manuscript*.\n\n**2. Addition of illustrative examples:**\n\nTo better assist readers in understanding the overall process of DFM, we add two simple illustrative examples to specifically demonstrate it. These two examples respectively present the problems of trajectory intersections and distribution heterogeneity during the transport process (see Figure 2). In Section 6.1, we provide a detailed explanation of the training procedure of DFM on these examples, including the choice of the coupling strategies, the design of the initial functions, and the construction of the interpolation paths. Moreover, for both examples, we not only present the inference results but also construct specific DDEs to intuitively illustrate why the delay vector field naturally resolves trajectory crossing and distribution heterogeneity. \n\n*Please see Page 8, Lines 406–424 of the revised manuscript.*\n\n\n**3. Pseudocode:**\n\nTo summarize different DFM methods, we add pseudocode for both DFM(C) and DFM(D) in Appendix C. \n\n*Please see Page 19, Lines 1009–1013 of the revised manuscript.*\n\n**4. Summary of related works:**\n\nWe add a dedicated Related Works section (Section 5) to summarize existing ODE-based generative methods that address the problem of trajectory intersections and distribution heterogeneity. We further provide a detailed comparison between these variants and our DDE–based generative framework, highlighting the remaining limitations of ODE-based methods and the conceptual advantages of DFM. \n\n*Please refer to Page 7–8, Lines 374–397 of the revised manuscript.*\n\n**5. Comparison with additional baseline methods:**\n\nAmong the various ODE-based Flow Matching variants discussed in the Related Works section, we select two representative methods—Augmented Bridge Matching (AugBM) and Switched Flow Matching (SFM)—for direct comparison. AugBM augments the vector field with initial-point information to allow trajectory crossing, whereas SFM introduces a switching signal to enable precise transport between heterogeneous distributions. Through experiments on illustrative examples, we show that these baseline methods still suffer from inherent limitations, while our DFM framework is able to simultaneously overcome these issues. \n\n*Details can be found on Page 32–33, Lines 1724–1756 of the revised manuscript.*\n\n**6. Comprehensive ablation studies:**\n\nWe add a systematic set of ablation experiments in Appendix F, covering:\n\n(F.1) a sensitivity analysis of the time delay $\\tau$ and guidelines for its selection;\n\n(F.2) a sensitivity analysis of the initial functions and corresponding selection strategies;\n\n(F.3) an ablation study on how clustering quality affects the generative performance of DFM;\n\n(F.4) additional analysis of the choices related to other DFM components, including the construction of interpolation paths, the employed coupling strategies, and the rationale for selecting specific strategies in different tasks.\n\nThese ablations collectively demonstrate that the proposed DFM framework exhibits strong robustness with respect to all of its components.\n\n*Please refer to Page 28–32, Lines 1500–1723 of the revised manuscript.*\n\n**7. Training and inference time analysis:**\n\nIn Appendix E, we provide a detailed comparison of training and inference time between DFM and CFM. Our experiments show that although DFM incurs slightly higher training cost than CFM, it typically produces significantly *straighter* transport paths—particularly in scenarios involving trajectory intersections or distribution heterogeneity. This leads to substantially shorter inference times while maintaining high generative quality.\n\nWe include intuitive comparisons of DFM and CFM across several examples, evaluating training and inference time, trajectory curvature, and generation quality under varying discretization steps (or NFE) (See Table 14, Figure 5, Figure 6, Table 13, and Table 4).\n\n*Please refer to Page 27–28, Lines 1435–1498 of the revised manuscript.*\n\n\n\nFinally, we thank all the reviewers again for your valuable and insightful comments. We hope that our general response as well as the individual responses for each reviewer adequately address the reviewers’ concerns."}}, "id": "cRynrRY8x5", "forum": "6lH1XblLpo", "replyto": "6lH1XblLpo", "signatures": ["ICLR.cc/2026/Conference/Submission17896/Authors"], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17896/Authors"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission17896/-/Official_Comment"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1763724864207, "cdate": 1763724864207, "tmdate": 1763724864207, "mdate": 1763724864207, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Comment", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes a new generative-model framework based on the idea of using delay‐differential equations (DDEs) instead of ordinary differential equations (ODEs) for the “flow‐matching” paradigm. Traditional flow matching (FM) uses an ODE to learn a vector field transporting samples from a simple base distribution (e.g., Gaussian) to a target data distribution. The authors identify three limitations of standard FM: inability to model trajectory intersections, and difficulty transferring between heterogeneous distributions. To address this, they introduce Delay Flow Matching (DFM): rather than modelling $\\dot{x}(t)=v(x(t),t)$, they incorporate delay terms $\\dot{x}(t)=v(x(t),x(t-\\tau),t)$ in a neural-parametrised vector field. They further provide a theoretical universal approximation guarantee."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. It clearly articulated the limitation of classic FM models. \n\n2. The authors introduce the delay differential equation (DDE) dynamics. \n\n3. They provide the universal approximation claim that DFM can approximate any continuous tansfer map, providing the theoretical pinning to the method. \n\n4. The experiments include a wide range of data, including synthetic, biological, and natural images."}, "weaknesses": {"value": "1. There are several papers that addressed the problem of non-intersecting trajectories in rectified flow / flow matching [1, 2, 3, 4]. I think it would be good to review and compare with those related works.  \n\n2. It seems to me that the proposed framework might be computationally more expensive than the classical FM. What is the trade-off between efficiency and quality? \n\n3. I feel the FID value is too high in Table 3 for $\\tau = 0$ (CFM). \n\n4. The FID values for OT-CFM on CIFAR-10 seem to be higher than what earlier works reported. \n\nReferences: \n[1] Park et al. Constant Acceleration Flow, 2024\n[2] Zhang et al. Towards Hierarchical Rectified Flow, 2025\n[3] Chen et al. Gaussian Mixture Flow Matching Models, 2025\n[4] Guo et al. Variational Rectified Flow Matching, 2025"}, "questions": {"value": "1. Could you provide the training time and inference time for DFM and other baseline models?\n\n2. Could you add more baselines (using the papers mentioned above) in the experiments? \n\n3. Could you add a section to discuss related work?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "U7U6SECYkw", "forum": "6lH1XblLpo", "replyto": "6lH1XblLpo", "signatures": ["ICLR.cc/2026/Conference/Submission17896/Reviewer_7LHR"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17896/Reviewer_7LHR"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission17896/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761987010032, "cdate": 1761987010032, "tmdate": 1762927718604, "mdate": 1762927718604, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes Delay Flow Matching (DFM), a framework that incorporates a delay term and appropriate initial functions to enable the model to capture delay dynamics, handle trajectory intersections, and transfer between heterogeneous distributions. The paper theoretically proves the universal approximation capability of DFM and demonstrates its effectiveness on a series of synthetic and real-world tasks through various experiments."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "This work seems to be the first to combine DDE with FM. The delay term enables the model to capture delay dynamics and handle trajectory intersections, while the design of appropriate initial functions allows it to handle heterogeneous distributions. The paper provides a compelling theoretical analysis, demonstrating the limitations of FM and proving the expressive power of DFM. The effectiveness of DFM is validated through various experiments."}, "weaknesses": {"value": "1. Lack of a Systematic Ablation Study: The DFM framework introduces multiple components, including the presence of a delay term, the choice of initial function (constant vs. diverse), the path interpolation method (linear vs. CSpline vs. geodesic), and the coupling strategy (OT-, KP-, I-). While the paper does conduct some comparisons across different experiments, these analyses are scattered and do not form a single, comprehensive ablation study.\n    \n2. Missing discussion and contextualization of related work: The paper fails to discuss the recent research progress in handling trajectory intersections of FM as well as FM for heterogeneous data. A prime example is Switched Flow Matching (SFM), whose core idea is highly similar to this work's: to handle heterogeneous distributions, SFM \"switches\" between different ODEs based on clustering, whereas this paper \"switches\" the initial function. However, the paper lacks both a discussion of this conceptual relationship and a necessary experimental comparison.\n    \n3. Lack of specific guidance for the selection of tau: Tau is a critical parameter of the proposed algorithm, exerting a significant impact on the algorithm’s performance. While the paper presents experiments with substantially different tau values (e.g., tau = 1 or tau = 3), it fails to offer specific guidance on how to select tau in practice (although provides a sensitivity analysis for tau)\n    \n4. Lack of details on efficiency and resource consumption: A major pain point of FM lies in its slow inference speed. While the paper designs experiments primarily focusing on the algorithm’s accuracy, it fails to provide detailed comparisons with other models regarding training and inference time, which are valuable for practical implementation considerations.\n\n5. For image translation experiments, the generated images are in wrong contrast and rather blurry, for which FID is not sufficient to justify the performance. More image quality index should be considered, especially for paired case. Furthermore, the image translation experiments are performed in low-dimensional (such as MINST and Cifar), how the method can be scalable to  high dimension (>=256) \nimage generation problems?"}, "questions": {"value": "1. For the experiments, various adaption with KP, OT and Conditional FM are used, the corresponding  cost function is not precised. \n2.  note that the performance of I-DFM(D) in Table 4 outperforms that of OT-DFM(D). However, only OT-DFM was utilized in the preceding sections of the paper. Could you explain the reason for this inconsistency? Additionally, how should we reasonably tune each component of the proposed algorithm in practice?\n    \n2. The diverse initial function appears to be built on the clustering of the dataset. If the clustering results are not particularly optimal (e.g., an excessive or insufficient number of clusters), to what extent would this affect the model’s performance?\n    \n3. All image generation tasks in the paper are designed for scenarios with trajectory intersections and heterogeneous data. If DFM were applied to a standard image generation benchmark task, what performance would you anticipate it to achieve? Would the \"Delay\" mechanism still provide advantages in such a scenario?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "rbTGMbYGfK", "forum": "6lH1XblLpo", "replyto": "6lH1XblLpo", "signatures": ["ICLR.cc/2026/Conference/Submission17896/Reviewer_qSLq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17896/Reviewer_qSLq"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission17896/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762095258412, "cdate": 1762095258412, "tmdate": 1762927717519, "mdate": 1762927717519, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper extends Flow Matching to Delay Differential Equations via Delay Flow Matching (DFM), where the drift $u(t,x,x_\\tau)$ depends on both the current state and a delayed past state. This lets the model capture trajectory intersections, delay dynamics, and heterogeneous source/target supports while remaining simulation-free to train. The authors instantiate variants with constant vs diverse initial functions and provide empirics on synthetic delay systems, single-cell trajectories, and image tasks, showing consistent gains over ODE-FM baselines."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "The paper is original in extending flow matching to delay differential equations and in using tailored initial-function designs, including constant and diverse variants, to cope with heterogeneous supports and keypoint-guided transport. The theoretical development is solid as the paper establishes a universal-approximation result for continuous transport maps together with a well-motivated conditional training objective. The empirical evaluation is broad, spanning synthetic delayed systems, single-cell trajectory inference, and image generation, with consistent improvements on standard metrics. The writing is generally clear and well structured."}, "weaknesses": {"value": "1) The practical significance is less clear in settings where the sole goal is high-quality final samples and intermediate trajectories are irrelevant. In such cases, the added machinery of delays and historical states may not translate into noticeably better samples versus strong ODE/SDE baselines. \n\n2) Relatedly, some benefits attributed to the framework (e.g., handling heterogeneous classes) might also be achieved with common conditioning mechanisms such as classifier-free guidance, where the network ingests class or conditioning vectors directly. It is unclear whether the proposed approach would outperform such simpler alternatives.\n\n3) The paper is a little imprecise at times, using phrases like \"approximately push-forward\" without a precise definition, which makes it hard to interpret the guarantees."}, "questions": {"value": "1) How does the required time-step (or number of function evaluations) for stable and accurate integration of DDEs compare to ODEs in your experiments? Do DDEs typically demand finer discretization?\n\n2) Many practical generative systems rely on guidance (e.g., classifier-free guidance). How does your framework integrate with these mechanisms? Does introducing delays change how guidance is applied?\n\n3) Your approach allows different initial function choices. How sensitive is performance to this choice in practice?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "R0MBpxwmkE", "forum": "6lH1XblLpo", "replyto": "6lH1XblLpo", "signatures": ["ICLR.cc/2026/Conference/Submission17896/Reviewer_vrRC"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17896/Reviewer_vrRC"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission17896/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762111017351, "cdate": 1762111017351, "tmdate": 1762927716935, "mdate": 1762927716935, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposed to learn vector field that uses dynamics with memory (a dependence on a past state) to overcome two core limitations of standard flow matching: difficulty to handle trajectory crossings and difficulty with heterogeneous source/target supports. This “delay” preserves sample identity at intersections, enabling mappings like Gaussian point-wise negation and keypoint-consistent image translations that ODE flows struggle with. Both theoretical support and experimental validations are provided for the claims."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1.\tThe proposed approach is novel and and enables learning more flexible vector fields using flow matching than is possible with existing approaches.\n2.\tExperimental Observations are also interesting and clearly show the benefits of DFM."}, "weaknesses": {"value": "1.\tThe writing could be made clearer. The paper is dense in terms of information content. A simple and concrete running example to illustrate each of the section’s content would be helpful for following the paper.\n\n2.\tThe claim that the described limitations of ODE based FM are inherent and unavaoidable is too strong. With the right choice of interpolant and coupling, those limitations could be addressed as in [1,2]\n\n[1] Shrestha, Sagar, and Xiao Fu. \"Diversified Flow Matching with Translation Identifiability.\" Forty-second International Conference on Machine Learning.\n\n[2] Albergo, Michael S., and Eric Vanden-Eijnden. \"Building normalizing flows with stochastic interpolants.\" arXiv preprint arXiv:2209.15571 (2022).\nHowever, ODE based FMs do require special design for different types of constraints and might not be as universal as the proposed DFM. The authors are recommended to include such discussions."}, "questions": {"value": "1.\tCould the authors discuss realizations of initial functions and the path gamma for the two examples in Figure 1 and (intuitive) explanations of how the learnt vector field circumvent the described issues? \n\n2.\tCould the authors provide algorithms to summarize different DFM methods in the appendix ? \n\n3.\tWould it be more precise to say that the universal approximation theorem states the existence of delayed vector field that can approximate any mapping, rather than DFM can approximate any mapping? Because the flow matching objective for identifying those vector fields might still need to be modified (with different choice of coupling and gamma) for different cases ?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "zLdgFx0c9l", "forum": "6lH1XblLpo", "replyto": "6lH1XblLpo", "signatures": ["ICLR.cc/2026/Conference/Submission17896/Reviewer_KnhQ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17896/Reviewer_KnhQ"], "number": 5, "invitations": ["ICLR.cc/2026/Conference/Submission17896/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762633322450, "cdate": 1762633322450, "tmdate": 1762927716055, "mdate": 1762927716055, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}