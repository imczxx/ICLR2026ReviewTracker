{"id": "9AA27en4go", "number": 22159, "cdate": 1758326936466, "mdate": 1759896883180, "content": {"title": "Difference-Aware Retrieval Polices for Imitation Learning", "abstract": "Behavior cloning suffers from poor generalization to out-of-distribution states due to compounding errors during deployment. We present Difference-Aware Retrieval Polices for Imitation Learning (DARP), a novel nearest-neighbor-based imitation learning approach that addresses this limitation by reparameterizing the imitation learning problem in terms of local neighborhood structure rather than direct state-to-action mappings. Instead of learning a global policy, DARP trains a model to predict actions based on k-nearest neighbors from expert demonstrations, their corresponding actions, and the relative distance vectors between neighbor states and query states. Our method requires no additional data collection, online expert feedback, or task-specific knowledge beyond standard behavior cloning prerequisites. We demonstrate consistent performance improvements of 15-46\\% over standard behavior cloning across diverse domains, including continuous control and robotic manipulation, and across different representations, including high-dimensional visual features.", "tldr": "DARP addresses behavior cloning's instability by conditioning action predictions on difference vectors between query states and neighbors", "keywords": ["behavior cloning", "robotics", "imitation learning", "nearest neighbor", "retrieval"], "primary_area": "applications to robotics, autonomy, planning", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/0b2c0fd9fecbb9599645ec70ef5102f29765ebdc.pdf", "supplementary_material": "/attachment/07366ab4c358f09bfab3bcd068c1ad01174f576f.zip"}, "replies": [{"content": {"summary": {"value": "Authors propose a way to combine retrieval based IL with standard BC that will turns out to be equivalent to manifold smoothed BC. Authors add both theoretical analysis and experimental validation in terms of standard MuJoCo IL experiments and ablation studies."}, "soundness": {"value": 4}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- Interesting, theoretically motivated and practical offline IL method. \n- MuJoCo and robosuite experimental results are quite good. \n- Narrative is well written and easy to follow."}, "weaknesses": {"value": "- Even though narrative is well written, the mathematical exposition leaves room for improvement. For example looking at page 3, we see a lot of symbols that have not been defined: s^*, \\pi(s_t), L, ... \n- Even though I understand that focus is in offline IL, it would be good obtain results from IL methods that have access to environment, such as adversarial methods (GAIL, AIRL etc). Can the proposed method bridge the gap between BC and GAIL? \n- It appears that expert demos have been obtained from an optimal RL policy, or have I been mistaken? In the \"What Matters for Adversarial Imitation Learning?\" -paper authors note that there is a difference when using expert demos from optimal policy and expert demos from human expert. It would be good to test with such demos, one option is to use ALE environment and with Atari-HEAD expert demo dataset."}, "questions": {"value": "- How would you contrast the proposed method to the retrieval IL method presented in: Federico Malato, Ville Hautamäki, \"Online Adaptation for Enhancing Imitation Learning Policies\", CoG 2024?\n- In Section 2.4.2 you show an interesting way to go beyond simple averaging, but in experiments I see no improvement in using it. Why is that? I would suggest not to bold DARP Set Transformer numbers in Table 1 as all of those numbers are worse than plain DARP."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "nr09YNzrXm", "forum": "9AA27en4go", "replyto": "9AA27en4go", "signatures": ["ICLR.cc/2026/Conference/Submission22159/Reviewer_iFBA"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22159/Reviewer_iFBA"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission22159/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761782910713, "cdate": 1761782910713, "tmdate": 1762942095229, "mdate": 1762942095229, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes DARP, a new semi-parametric BC method that integrates non-parametric retrieval with parametric prediction. DARP retrieves a set of nearest-neighbor expert demonstrations for a given query state and conditions the policy’s action prediction on both the neighbor states and their difference vectors relative to the query. The retrieved neighbors are aggregated in a permutation-invariant manner, enabling the model to enforce implicit local smoothness without explicit regularization. The authors show theoretically that DARP approximates a Laplacian smoothing operation over the expert k-NN graph, promoting manifold-consistent policies. Empirical results demonstrate the improved stability, generalization, and robustness across various continuous-control tasks."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1. The core idea of reparameterizing the policy in terms of relative differences to known expert state-actions is highly intuitive. It anchors the policy's predictions to the ground-truth data manifold, providing a strong and data-centric form of 'regularization'.\n\n1. The authors provide a strong theoretical motivation for their architectural choice. The connection drawn between neighbor aggregation (iMRIL) and explicit manifold regularization (MRIL) via spectral graph theory (Theorem 2) offers a compelling, first-principles explanation for why this method should reduce variance and improve stability, linking it to low-pass filtering on the graph Laplacian.\n\n1. The experimental results are good, and the ablation is impressive and sufficient."}, "weaknesses": {"value": "Overall, the proposed method is inspiring and technically sound, and the paper is easy to read. I only have concerns on the inference cost and the distance metric:\n\n1. The method could suffer from large computational/storage overhead at inference time. For every single decision step, the policy must perform a k-NN search over the entire $N$-point expert dataset and then perform $k$ network forward passes. Also, the method requires storing a large expert dataset or its embeddings, which increases memory and storage requirements by orders of magnitude compared to a standalone policy network. \n\n1. The paper assumes that Euclidean distance (or a simple temporal extension with decay) suffices to identify meaningful neighbors, which strong in high-dimensional or structured state spaces, where Euclidean proximity does not necessarily imply functional similarity."}, "questions": {"value": "1.  Have the authors analyzed the trade-off between inference latency and performance?\n\n1. In the proof of Theorem 1 (iii), what does $r$ represent? There seems a loss of definition.\n\n1. Can the method be extended to other distance metrics?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "h6NK4UcfDj", "forum": "9AA27en4go", "replyto": "9AA27en4go", "signatures": ["ICLR.cc/2026/Conference/Submission22159/Reviewer_kF51"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22159/Reviewer_kF51"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission22159/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761910235196, "cdate": 1761910235196, "tmdate": 1762942094730, "mdate": 1762942094730, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents DARP, a method to reduce variances in behavior cloning methods. It conditions the action generation using the retrieved nearest neighbors and aggregates the predictions from individual neighbors to output the final action. The experiments show the improvements over prior methods based on retrieved neighbors and BC on MuJoCo and robosuite tasks."}, "soundness": {"value": 4}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The paper bridges the non-parametric retrieval-based method and the parametric BC to improve the policy performance.\n- The paper provides good analysis, both theoretical and experimental, to show the effect of DARP."}, "weaknesses": {"value": "- The main experiment result is based on MuJoCo tasks, which have a lot more neighbors than manipulation, so it is easier to show the improvements. For manipulation tasks, it is unclear which BC architecture it is employing. If it is an MLP, it is not a well-performing architecture for manipulation; it will need to compare with other BC architectures, like diffusion policy, to show the real improved performance.\n- As shown in Appendix A2.1, the performance is significantly affected by the distance measure, e.g.,  the amount of look-back. This can show that the retrieval mechanism outweighs the architectural changes proposed in the paper. \n- The motivation of the paper is about improving generalization. However, none of the experiments evaluate the generalization performance of DARP."}, "questions": {"value": "- The step of divergence analysis can be considered as slight evidence that DARP handles OOD better, but how often can we detect the divergence? Also, it seems like this analysis is only possible with deterministic policies. How can we apply the same analysis to the push-T task, where DARP uses a GMM head?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "7oBzaxRwis", "forum": "9AA27en4go", "replyto": "9AA27en4go", "signatures": ["ICLR.cc/2026/Conference/Submission22159/Reviewer_vWKv"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22159/Reviewer_vWKv"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission22159/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761989709205, "cdate": 1761989709205, "tmdate": 1762942093988, "mdate": 1762942093988, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces DARP, a retrieval-based imitation learning method that addresses covariate shift in behavior cloning by reparameterizing the problem using local neighborhood structure. The key innovation is conditioning action predictions on k-nearest neighbors along with their actions and crucially, the difference vectors between neighbor states and query states. The authors provide theoretical analysis showing DARP implicitly performs Laplacian smoothing and demonstrate 15-46% performance improvements across continuous control and robotic manipulation tasks."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The use of difference vectors (s*_i - s_q) rather than just neighbor states is creative and well-motivated. The ablation in Figure 5 convincingly shows this is crucial for performance.\n- The connection to Laplacian smoothing provides intuition for why the method works and bridges local and global learning paradigms effectively.\n- The experiments span MuJoCo locomotion, robotic manipulation, visual observations, and even deliberately discontinuous environments, showing broad applicability."}, "weaknesses": {"value": "-  The paper doesn't discuss the computational cost of k-NN retrieval at every training and inference step. For k=500 (as suggested in Figure 8), this could be prohibitive for large datasets or real-time applications.\n- While the paper compares to BC and some retrieval methods, it lacks comparison with other smoothness-inducing approaches mentioned in related work (L2C2, CCIL). The MRIL baseline helps but isn't a published method.\n- The jump from iMRIL (which uses simple averaging) to DARP (with difference vectors and learned aggregation) isn't theoretically justified. Does the Laplacian smoothing interpretation still hold?"}, "questions": {"value": "- What is the time complexity for training and inference? How does this scale with dataset size and k?\n- How sensitive is DARP to the choice of distance metric, especially in high-dimensional spaces? Have you experimented with learned metrics?\n-  Does the Laplacian smoothing analysis extend to the full DARP algorithm with difference vectors and parametric aggregation functions?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "N/A"}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "PhZeie3tPj", "forum": "9AA27en4go", "replyto": "9AA27en4go", "signatures": ["ICLR.cc/2026/Conference/Submission22159/Reviewer_T2hb"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22159/Reviewer_T2hb"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission22159/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762528355587, "cdate": 1762528355587, "tmdate": 1762942093718, "mdate": 1762942093718, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}