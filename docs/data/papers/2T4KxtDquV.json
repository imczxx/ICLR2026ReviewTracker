{"id": "2T4KxtDquV", "number": 21392, "cdate": 1758317069117, "mdate": 1763676136814, "content": {"title": "Rapid Training of Hamiltonian Graph Networks Using Random Features", "abstract": "Learning dynamical systems that respect physical symmetries and constraints remains a fundamental challenge in data-driven modeling. Integrating physical laws with graph neural networks facilitates principled modeling of complex N-body dynamics and yields accurate and permutation-invariant models. However, training graph neural networks with iterative, gradient-descent-based optimization algorithms (e.g., Adam, RMSProp, LBFGS) often leads to slow training, especially for large, complex systems. In comparison to 15 different optimizers, we demonstrate that Hamiltonian Graph Networks (HGN) can be trained 150-600× faster - but with comparable accuracy - by replacing iterative optimization with random feature-based parameter construction. We show robust performance in diverse simulations, including N-body mass-spring and molecular dynamics systems in up to $3$ dimensions and 10,000 particles with different geometries, while retaining essential physical invariances with respect to permutation, rotation, and translation. Our proposed approach is benchmarked using a NeurIPS 2022 Datasets and Benchmarks Track publication to further demonstrate its versatility. We reveal that even when trained on minimal 8-node systems, the model can generalize in a zero-shot manner to systems as large as 4096 nodes without retraining. Our work challenges the dominance of iterative gradient-descent-based optimization algorithms for training neural network models for physical systems.", "tldr": "Our random feature-based training algorithm for Hamiltonian graph neural networks achieves comparable accuracy while being 100–1000× faster than traditional gradient-descent-based iterative training.", "keywords": ["Graph neural networks", "physics-informed machine learning", "random feature methods", "gradient-descent-free training", "Hamiltonian neural network"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/3c7dc92f1a006d156b8e0aedc650442254b95b34.pdf", "supplementary_material": "/attachment/8bb4f3bed71169496b121b4c558c2a6cff0b07f4.zip"}, "replies": [{"content": {"summary": {"value": "This paper proposes a novel iterative method to train Hamiltonian Graph Neural Networks (GNNs) orders of magnitude faster than standard optimizers. The approach leverages random feature sampling over the small shared node, edge, and message MLPs of the GNN, followed by a least-squares fit to determine the final linear layer that outputs the Hamiltonian. To ensure translation and rotation invariance, the particle positions are processed by aligning the simulation frame of reference to the center of mass and rotating the coordinates to a fixed orthonormal basis. The proposed training algorithm is evaluated on four different graph configurations and compared against multiple standard optimizers, achieving at least two orders of magnitude speedup (even outperforming the second-order L-BFGS optimizer). Furthermore, the method is benchmarked against seven state-of-the-art structure-preserving architectures using publicly available datasets."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "* The method is tested over Neurips 2022 open source benchmarks.\n* The paper proposes an interesting way to enforce rotation-invariances in the system.\n* The experiments are varied, exploring N-body systems (chains, regular grids) and molecular interactions in Lennard-Jones systems\n* The generalization and rollout results are good. These are the precise experiments needed to show the power of structure-preservation in learning conservative dynamics."}, "weaknesses": {"value": "* Even though the method is tested over a wide variety of systems, they are still small scale toy problems."}, "questions": {"value": "* Section 4.3: Is there a particular reason why coosing Hamiltonian GNNs instead of, say, Lagrangian GNNs? Have the authors tried to train the tested architectures (GNODE, LGNN, FGNN, etc) with the presented method to see which architecture performs better?\n* Have the authors tried to use simpler invariance tricks, like using relative distances or relative angles?\n* Line 1079: $ 5^{-3}$ might refer to $5\\cdot 10^{-3}$?\n* Line 1079: Here is specified that the molecular dynamics experiments are only rolled-out to 50 timesteps. However, Table 2 shows T=99999 timesteps. Which is the correct one? 50 timesteps is very few time horizon for a molecular system, given that the timestep is very small for stability.\n* Equation 6: Is the least squares minimization well-posed? Have the authors found any problems when training? I'm thinking about a bad conditioning number for the normal equations $Z^TZ$, or some degeneracies induced by the rotation-translation invariance."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "I have no ethics concerns."}, "rating": {"value": 8}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "S4kwSDgPWd", "forum": "2T4KxtDquV", "replyto": "2T4KxtDquV", "signatures": ["ICLR.cc/2026/Conference/Submission21392/Reviewer_nwfX"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21392/Reviewer_nwfX"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission21392/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761320500798, "cdate": 1761320500798, "tmdate": 1762941741443, "mdate": 1762941741443, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces Random-Feature Hamiltonian Graph Networks, whose hidden layers are fixed random features, with only the final linear readout solved in one least-squares step instead of iterative gradient descent. The model encodes translation/rotation/permutation invariances, reports 100-600x training time speedups over many optimizers on mass-spring and Lennard-Jones systems, and shows zero-shot scaling from tiny to very large graphs without retraining."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. Replacing long iterative GD with a single convex least-squares solve is simple and yields substantial speedups without complicated tuning.\n2. The model encodes translation, rotation, and permutation invariances appropriate for N-body dynamics, which improves data efficiency and generalization within a family.\n3. Demonstrates training on small systems and inference on much larger ones without retraining."}, "weaknesses": {"value": "1. The core idea is somehow similar to reservoir computing: both avoid training the feature generation module and optimize only the final readout layer.\n2. With a single message passing stage and a linear head, it’s unclear how the method scales to long range or multi scale interactions. There is no ablation on stacking multiple RF blocks.\n3. The training formulation assumes no external forces and exact energy conservation. Robustness to mild non-conservation (damping, stochasticity) is only lightly tested.\n4. Transfer across distinct topologies is under-explored."}, "questions": {"value": "1. What are the key differences between your approach and reservoir computing? \n2. What happens with 2-3 random feature message passing blocks versus a single block? How does performance scale with feature width, and do you observe conditioning issues in the least-squares solve as capacity grows?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "IxDurxACAQ", "forum": "2T4KxtDquV", "replyto": "2T4KxtDquV", "signatures": ["ICLR.cc/2026/Conference/Submission21392/Reviewer_258K"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21392/Reviewer_258K"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission21392/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761759512389, "cdate": 1761759512389, "tmdate": 1762941740677, "mdate": 1762941740677, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces RF-HGN, a method for training Hamiltonian Graph Networks using random feature sampling instead of iterative gradient-descent optimization. The authors demonstrate significant training speedups compared to other optimizers (Adam, LBFGS, etc.) while maintaining competitive accuracy on mass-spring and molecular dynamics systems."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 4}, "strengths": {"value": "The proposed method offers a significant speedup without sacrificing accuracy in multiple systems. \n\n- comprehensive benchmarking\n- elegant solution by merging  Hamiltonian Graph Networks (for physics-informed modeling), Random Features (for fast, non-iterative training), and careful construction of physical invariances (translation, rotation, permutation). \n- generalizability from small to larger systems"}, "weaknesses": {"value": "- the paper could give more background on why random features work\n- acknowledge the limitation more prominently and discuss it\n- the acceleration is significant, but the claimed 600× speed-up is overstated; compared to the second-best model, it is actually 150×."}, "questions": {"value": "- The method is presented in the context of Hamiltonian systems. How readily can it be applied to other physics-informed graph networks, such as Lagrangian or Port-Hamiltonian networks, or even non-conservative systems? Does the \"random features + linear solve\" recipe generalize? \n\n-  The method demonstrates impressive zero-shot generalization to larger systems, but does this generalization hold for structurally heterogeneous systems? For instance, if a model is trained on a regular lattice (where all nodes have the same degree), can it accurately predict the dynamics for a system with a mix of node degrees, or for a node with an unexpectedly high degree not seen during training?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "uivBRpEohA", "forum": "2T4KxtDquV", "replyto": "2T4KxtDquV", "signatures": ["ICLR.cc/2026/Conference/Submission21392/Reviewer_5YK6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21392/Reviewer_5YK6"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission21392/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761872249958, "cdate": 1761872249958, "tmdate": 1762941739675, "mdate": 1762941739675, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes RF-HGN, a method to accelerate training of Hamiltonian Graph Networks by replacing gradient-based optimization with random feature sampling and least-squares solvers. The approach samples dense layer parameters randomly (using ELM or SWIM) and optimizes only the final linear layer, achieving 100-600× speedups while maintaining comparable accuracy. The method demonstrates zero-shot generalization from small training systems (8 nodes) to large test systems (4096 nodes) across mass-spring, lattice, and molecular dynamics systems."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. Dramatic Practical Speedups: The 100-600× training acceleration is genuinely impressive and could enable new applications in physics\n  simulation.\n2. Strong Zero-Shot Generalization: Training on 8-node systems and testing on 4096-node systems demonstrates remarkable scalability - this is perhaps the paper's most valuable contribution.\n3. Comprehensive Experimental Validation:\n    - Comparison against 15 different optimizers provides robust baselines\n    - Multiple physical systems (springs, lattices, molecular dynamics)\n    - Use of established NeurIPS 2022 benchmark dataset\n4. Physical Consistency: The method maintains energy conservation and incorporates essential symmetries (translation, rotation, permutation invariance).\n5. Clear Algorithmic Contribution: The two-stage training procedure (random sampling + least squares) is well-defined and reproducible."}, "weaknesses": {"value": "1. Weak Theoretical Foundation:\n    - No convergence guarantees or approximation bounds\n    - Limited analysis of when/why the method works\n    - Missing connection to random feature theory for this specific setting\n2. Poorly Motivated Architectural Choices:\n    - No compelling justification for choosing HNNs over alternatives (Lagrangian, Port-Hamiltonian, etc.)\n    - Graph networks not well-motivated for many test systems (regular lattices better suited for CNNs)\n    - Missing literature review of Hamilton graph neural networks\n3. Limited System Complexity:\n    - Mostly simple spring-mass systems and basic molecular dynamics\n    - ~10% relative error on Lennard-Jones systems suggests limitations for complex potentials\n    - No testing on truly challenging physics (e.g., turbulence, phase transitions)\n4. Accuracy Trade-offs Not Well Characterized:\n    - Sometimes less accurate than second-order methods (LBFGS)\n    - Large variance in results (Table 1) raises questions about reliability\n    - No principled way to predict accuracy vs. speed trade-offs\n5. Scalability Questions:\n    - Memory complexity O(MNe) may become prohibitive for very large systems\n    - Linear solver bottleneck O(Kd²L) not thoroughly analyzed\n    - Integration constant handling appears ad-hoc\n6. Missing Key Comparisons:\n    - No comparison with other physics-informed ML acceleration techniques\n    - No baseline comparisons with structure-specific alternatives (CNNs for lattices)\n    - Limited comparison with other random feature applications to physics"}, "questions": {"value": "1. Can you provide convergence guarantees or approximation bounds for the random feature approach in the\n  physics-informed setting?\n2. Why specifically Hamiltonian neural networks? How does performance compare when applying random features to\n  Lagrangian or other physics-informed architectures?\n3.Can you provide principled guidelines for when accuracy degradation becomes significant? What physical properties are most affected?\n4. What are the practical limits of your approach? At what system size does the linear solver become prohibitive?\n5. How does the method perform on more challenging physical systems beyond simple spring-mass dynamics?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "pUUhyJqhkf", "forum": "2T4KxtDquV", "replyto": "2T4KxtDquV", "signatures": ["ICLR.cc/2026/Conference/Submission21392/Reviewer_RhM6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21392/Reviewer_RhM6"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission21392/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761925712764, "cdate": 1761925712764, "tmdate": 1762941739199, "mdate": 1762941739199, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}