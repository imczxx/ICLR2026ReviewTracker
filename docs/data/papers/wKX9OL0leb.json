{"id": "wKX9OL0leb", "number": 24486, "cdate": 1758357319301, "mdate": 1759896763315, "content": {"title": "Error as Signal: Stiffness-Aware Diffusion Sampling via Embedded Runge-Kutta Guidance", "abstract": "Classifier-Free Guidance (CFG) has established the foundation for guidance mechanisms in diffusion models, showing that well-designed guidance proxies significantly improve conditional generation and sample quality.\nAutoguidance (AG) has extended this idea, but it relies on an auxiliary network and leave solver-induced errors unaddresed.\nIn stiff regions, the ODE trajectory changes sharply, where local truncation error (LTE) becomes a critical factor to deteriorate sample quality.\nOur key observation is that these errors align with the dominant eigenvector, motivating us to target the solver-induced error as a guidance signal.\nWe propose \\textbf{E}mbedded \\textbf{R}unge–\\textbf{K}utta based \\textbf{Guid}ance (ERK-Guid), which exploits detected stiffness to reduce LTE and stabilize sampling.\nWe theoretically and empirically analyze stiffness and eigenvector estimators with solver errors to motivate the design of ERK-Guid. \nOur experiments on  both synthetic datasets and popular benchmark dataset, ImageNet, demonstrate that ERK-Guid consistently outperforms state-of-the-art methods.", "tldr": "", "keywords": ["Diffusion models", "Classifier-free guidance"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/6be5582162836599ce5ee647e8189503670c7e12.pdf", "supplementary_material": "/attachment/56b01d387396a0cc4b5a7107b0fab6ce919f9e61.zip"}, "replies": [{"content": {"summary": {"value": "Classifier-Free Guidance (CFG) has established the foundation for guidance mechanisms in diffusion models, showing that well-designed guidance proxies significantly improve conditional generation and sample quality. Autoguidance (AG) has extended this idea, but it relies on an auxiliary network and leaves solver-induced errors unaddressed. In stiff regions, the ODE trajectory changes sharply, where local truncation error (LTE) becomes a critical factor that deteriorates sample quality. This paper's key observation is that these errors align with the dominant eigenvector, motivating it to target the solver-induced error as a guidance signal. This paper proposes \\textbf{E}mbedded \\textbf{R}unge–\\textbf{K}utta based \\textbf{Guid}ance (ERK-Guid), which exploits detected stiffness to reduce LTE and stabilize sampling. This paper theoretically and empirically analyzes stiffness and eigenvector estimators with solver errors to motivate the design of ERK-Guid. This paper's experiments on both synthetic datasets and the popular benchmark dataset ImageNet demonstrate that ERK-Guid consistently outperforms state-of-the-art methods."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1. Unlike Autoguidance (AG) which relies on an auxiliary network and fails to address solver-induced errors, ERK-Guid avoids dependence on auxiliary networks and specifically targets solver-induced errors, overcoming key drawbacks of prior guidance mechanisms.\n\n2. Leverages a key observation that solver-induced errors align with the dominant eigenvector, innovatively using such errors as a guidance signal—providing a novel direction for optimizing diffusion model sampling.\n\n3. Exploits detected stiffness in ODE trajectories (where trajectories change sharply) to reduce local truncation error (LTE) and stabilize sampling, directly mitigating a critical factor that degrades sample quality in stiff regions."}, "weaknesses": {"value": "1. Lack of visualization comparison.\n\n2. More experiments are needed. e.g. t2i, t2v.\n\n3. Missing related works with bespoke solver[1, 2, 3], which also searches the optimal solver parameters (linear multisteps solver, RK solver) of a pretrained diffusion model.\n\n[1] Xue, Shuchen, et al. \"Accelerating diffusion sampling with optimized time steps.\" Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2024.\n\n[2] Wang, Shuai, et al. \"Differentiable Solver Search for Fast Diffusion Sampling.\"  International Conference on Machine Learning (ICML) 2025. \n\n[3] Shaul, Neta, et al. \"Bespoke solvers for generative flow models.\" arXiv preprint arXiv:2310.19075 (2023)."}, "questions": {"value": "In practice, extrapolation acceleration is more widely used in sampling. Could this method apply to linear multistep solvers (Adams–Bashforth solver)?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "3f9yw5sc1M", "forum": "wKX9OL0leb", "replyto": "wKX9OL0leb", "signatures": ["ICLR.cc/2026/Conference/Submission24486/Reviewer_Rzwt"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission24486/Reviewer_Rzwt"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission24486/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761027685603, "cdate": 1761027685603, "tmdate": 1762943099293, "mdate": 1762943099293, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "Based on the situation that LTE in stiff regions aligns with the dominant eigenvector of the drift function’s Jacobian, this paper proposes Embedded Runge–Kutta Guidance is a new guidance method for diffusion models. The experiments validate ERK-Guid's effectiveness and can combine well with existing guidance methods."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The paper rigorously derives the alignment between LTE/dominant eigenvectors via local linearization of the drift field, and proves the approximation accuracy of the stiffness estimator \n- This paper designs Comprehensive experiments. Evaluations cover synthetic data and ImageNet with metrics including fidelity, diversity, and alignment. This paper also combines ERK-Guid with existing guidance methods and these methods don't conflict with each other.\n- ERK-Guid improves quality in low-step regimes, which means it has the potential to do acceleration in other works."}, "weaknesses": {"value": "- Experiments are limited to EDM2 and ImageNet. It remains unproven whether ERK-Guid works for other architectures or non-image tasks. Stiffness varies across tasks, so generalization needs more validation.\n- The performance improvement is not significant, and it is hard to determine whether it is superior to the existing methods. The most crucial point is that even after combining ERK-Guid with other guiding methods, degradation occurred on some datasets, which requires thorough argumentation."}, "questions": {"value": "- See weaknesses.\n- Typo should also be considered. For example, the first row of Table 2 and Table 3 has the same content but different formats.\n- Please make sure to use vector graphics."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "pjG8zZgeda", "forum": "wKX9OL0leb", "replyto": "wKX9OL0leb", "signatures": ["ICLR.cc/2026/Conference/Submission24486/Reviewer_4VrJ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission24486/Reviewer_4VrJ"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission24486/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761858012669, "cdate": 1761858012669, "tmdate": 1762943099004, "mdate": 1762943099004, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents ERK-Guid, a guidance mechanism for diffusion models aimed at reducing the local truncation error (LTE) of ODE solvers, with explicit consideration of the stiffness of ODE trajectories.\nThe authors provide a mathematical analysis of LTE and embedded Runge-Kutta pairs, leveraging the Jacobian of the score function.\nBased on this analysis, they propose cost-free estimators for ODE stiffness and the direction in which LTE is dominant, and demonstrate how to guide the Heun sampler to achieve smaller LTE.\nThrough experiments on a toy dataset, mathematical observations are confirmed. Further experiments using EDM2 on ImageNet examine design choices for the cost-free estimators and demonstrate the effectiveness of ERK-Guid."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The theoretical analysis in Section 4 and the toy example provide clear and insightful explanations of the proposed method.\n2. The proposed method is supported by solid mathematical justification and ablation studies.\n3. The flow of the paper after the introduction is clear and easy to follow, with well-defined mathematical formulations and illustrative figures.\n4. The method can be combined with other guidance techniques such as CFG and Autoguidance, suggesting broad applicability.\n5. The experimental results demonstrate the effectiveness of ERK-Guid."}, "weaknesses": {"value": "1. The introduction is somewhat difficult to follow, especially regarding the relationship between stiffness and other guidance methods such as CFG and Autoguidance, since the motivation for the proposed method and those for CFG and Autoguidance seem different.\n2. It is unclear whether comparing ERK drift and the dominant eigenvector in Figure 2(c) with CFG and Autoguidance is meaningful, since these methods are not designed to minimize ODE solver step error.\n3. The choice of the hyperparameters w_con and w_stiff is important for performance, as shown in Table 2. Hyperparameter search appears necessary, which may be considered a weakness.\n4. While the paper focuses on guidance mechanisms, a more thorough comparison with advanced ODE solvers for diffusion models, such as those mentioned in the RELATED WORKS section or other models such as GENIE [Dockhorn et al., 2022], would be valuable.\n5. Minor comment: Typo in the caption of Table 2 (\"InageNet\" should be \"ImageNet\").\n\n[Dockhorn et al., 2022] Tim Dockhorn, et al. \"Genie: Higher-order denoising diffusion solvers.\" Advances in Neural Information Processing Systems 35 (2022): 30150-30166."}, "questions": {"value": "Regarding Weakness 4: Do you have any results or insights regarding the comparison of your method with advanced ODE solvers for diffusion models?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "8VQqCin1xv", "forum": "wKX9OL0leb", "replyto": "wKX9OL0leb", "signatures": ["ICLR.cc/2026/Conference/Submission24486/Reviewer_2Zyk"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission24486/Reviewer_2Zyk"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission24486/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761908729930, "cdate": 1761908729930, "tmdate": 1762943098756, "mdate": 1762943098756, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "In this paper, the authors propose ERK-Guid, a new sampling algorithm for diffusion ODE samplers that uses the embedded Euler/Heun pair to estimate a local stiffness scalar and approximate the dominant eigenvector direction via the ERK drift difference in order to cancel the local truncation errors. The authors demonstrate the effectiveness of their method on toy examples and ImageNet-512."}, "soundness": {"value": 2}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "1. The proposed method is “cost-free” ,i.e. no additional network evaluation is needed.\n2. ERK-Guid is complementary to CFG and autoguidance.\n3. The sampling recipe is clean and easy to follow."}, "weaknesses": {"value": "1. The paper positions itself in the same line of work as CFG and autoguidance. However, the proposed algorithm resembles more of an advanced solver with a corrector rather than a guidance sampling method. The first two pages of the paper read extremely disconnected to the rest of the paper.\n2. Following up on the previous point, for an advanced solver paper, the authors fail to compare their algorithm with other strong solvers like DPM-Solver-v3, UniPC and DEIS, which the authors cite but did not provide any empirical comparison to. Moreover, the authors also cite a classic remedy, adaptive step-size, for stiffness (Petzold (1983); Shampine & Gear (1979)), which they also did not compare in their experiments.\n3. Only toy examples and one dataset (Imagenet-512) are examined in their experiments.\n4. ERK-Proj, which outperforms the main algorithm ERK-Guid in one of the major experiments, is only introduced on the second to the last paragraph of the main paper with very minimal details in it. There is also very minimal theoretical backing to this algorithm.\n5. The theoretical analysis for the entire Section 4.3 is very vague and mostly heuristic. However, it constitutes the algorithms that work in practice.\n6. The difference among images in Figure 7 and 8 is extremely subtle and mostly not visible.\n7. No wallclock time or memory overhead is compared, which can be a big factor affecting the practicality of the algorithm.\n\nMinor: \n    (i) Line 51-52 seems to be missing citations?\n    (ii) Line 209 “Let denote”\n    (iii) Table 2 caption: “InageNet”"}, "questions": {"value": "1. How did the authors determine the hyperparameters $\\omega_{conf}$ and $\\omega_{stiff}$?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "m3sMEC92Fo", "forum": "wKX9OL0leb", "replyto": "wKX9OL0leb", "signatures": ["ICLR.cc/2026/Conference/Submission24486/Reviewer_qmxA"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission24486/Reviewer_qmxA"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission24486/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762196850369, "cdate": 1762196850369, "tmdate": 1762943098490, "mdate": 1762943098490, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}