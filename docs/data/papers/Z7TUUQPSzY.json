{"id": "Z7TUUQPSzY", "number": 21405, "cdate": 1758317199666, "mdate": 1763333231175, "content": {"title": "Fun2spec: Code Contract Synthesis At Scale", "abstract": "Specification synthesis -- the problem of inferring program specification from program implementation -- is an undecidable problem. Therefore, machine learning and more specifically, autoregressive large language models (LLMs) are a good fit for solving this problem. We demonstrate that code contracts, the most widespread software specification mechanism, can be generated by LLMs and validated using a software testing oracle on large real-world codebases. This oracle acts as an approximate code contract verifier. It only selects LLM-generated contracts that are test-valid, guaranteeing that the obtained contracts are at least as good as the test suite provided by the program. Our tool Fun2spec is the first code contract synthesis tool applied to real-world large-scale low-level C and C++ programs of millions of lines of code, raising the state-of-the-art of automated software verification using LLMs.", "tldr": "", "keywords": ["Specification", "LLM", "Code Contracts", "Postconditions", "Software"], "primary_area": "neurosymbolic & hybrid AI systems (physics-informed, logic & formal reasoning, etc.)", "venue": "ICLR 2026 Conference Withdrawn Submission", "pdf": "/pdf/5a04fee1f6f382b314b26358e960e24cd7aeab05.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper proposes a LLM-based workflow, Fun2Spec, for synthesizing code contract. The workflow is a loop consisting of a code miner, an LLM-based generator, a specification parser, and a tester. The paper argues the strength of the tool by comparing to the SOTA on other benchmarks. The paper also shows that the tool is industrial-level by applying the tool on large C++ projects."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- The paper builds a simple yet effective framework combining specific insights into synthesizing specifications.\n- Fun2Spec is evaluated on both small benchmarks and large industrial projects.\n- The workflow of Fun2Spec is well presented and explained."}, "weaknesses": {"value": "- The paper has multiple presentation issues and seems rushed (for example, algorithm 1 has overlap to the main text)\n- The workflow is not evaluated on (or compared with) any flagship models despite not requiring any finetuning effort\n- The paper does not provide artifacts of any sorts."}, "questions": {"value": "- Why is the tool targeting only C++ and not other important languages for verification (like Lean, Verus, etc.)?\n- How does the workflow compare with flagship models/agents? For example, the latest GPT/Claude models."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "GQGuMebph8", "forum": "Z7TUUQPSzY", "replyto": "Z7TUUQPSzY", "signatures": ["ICLR.cc/2026/Conference/Submission21405/Reviewer_xv9E"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21405/Reviewer_xv9E"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission21405/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761900319685, "cdate": 1761900319685, "tmdate": 1762941751418, "mdate": 1762941751418, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"withdrawal_confirmation": {"value": "I have read and agree with the venue's withdrawal policy on behalf of myself and my co-authors."}, "comment": {"value": "We thank the reviewers for the constructive feedback. We will address these points in a future submission"}}, "id": "sCHPFXpQNM", "forum": "Z7TUUQPSzY", "replyto": "Z7TUUQPSzY", "signatures": ["ICLR.cc/2026/Conference/Submission21405/Authors"], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission21405/-/Withdrawal"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1763333230334, "cdate": 1763333230334, "tmdate": 1763333230334, "mdate": 1763333230334, "parentInvitations": "ICLR.cc/2026/Conference/-/Withdrawal", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "FUN2SPEC is an industrial-strength framework for automatically synthesizing formal specifications (postconditions) in first-order logic for large-scale C++ codebases using large language models. The system employs a five-stage pipeline—mining code repositories to extract functions and contextual information, generating candidate postconditions via LLM prompting with chain-of-thought reasoning, validating and translating specifications into executable C++ assertions, testing them against unit tests, and refining them through error-driven feedback loops—to achieve 85% test validity and generate the strongest postcondition 60% of the time. Evaluated on industrial repositories like BDE and BlazingMQ containing millions of lines of code, FUN2SPEC substantially outperforms the prior NL2POST baseline by 20-35 percentage points across multiple benchmarks while successfully handling complex first-order logic constructs, including quantifiers (FORALL/EXISTS) that enable specification of properties over collections and ranges of values."}, "soundness": {"value": 2}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "1. Fun2Spec generates the first-order logic expressions based on the context, and creates assertions from these logic expressions to generate more feedback for refinement.  These logic expressions and assertion-based feedback can examine the designed behavior and provide more grounded and reliable feedback. \n2. Compared with the baseline, Fun2Spec shows better performance with different backbone LLMs on HumanEval and FormalSpecCPP benchmark.   \n3. Human evaluation shows that on complex C++ repos such as BDE and BlazingMQ, the specifications generated by Fun2Spec only have 2% incorrect solutions."}, "weaknesses": {"value": "1. Insufficient experiments to verify their main claims\n\t1. The average number of code lines in HumanEval-CPP and FormalSpecCPP is very small\n\t2. For large repos like BDE and BlazingMQ, they only present the Fun2Spec results, without any comparison with other baselines. These results cannot show that the proposed method is better than the others. \n\t3. Simple baselines such as direct prompting for specification, few-shot prompting for specification, and self-correct prompting should be applied to verify the effectiveness of the proposed pipeline. \n\t4. The ablation study only considers the impact of the few-shot examples. The effectiveness of each step should also be verified. \n2. A lot of formatting issues need to be fixed:  \n\t1. In Line 250-253. There are overlaps between the main context and the algorithm.   \n\t2. Table 2 exceeds the page boundary\n\t3. Figure 3 should be Table 4, and this figure is never mentioned in the main body. \n3. The discussion on qualitative analysis is not enough. While Figure 3 shows that the incorrect cases of Fun2Spec are only 2, it is unclear how the baseline performs. The lack of comparison cannot show the advantage of Fun2Spec."}, "questions": {"value": "1. Can this method extend to other languages? \n2. Adding one conclusion section may be better."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "uJP5vMoHIq", "forum": "Z7TUUQPSzY", "replyto": "Z7TUUQPSzY", "signatures": ["ICLR.cc/2026/Conference/Submission21405/Reviewer_vNa2"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21405/Reviewer_vNa2"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission21405/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761937399825, "cdate": 1761937399825, "tmdate": 1762941750820, "mdate": 1762941750820, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents Fun2spec, an LLM-based framework for automatically synthesizing formal software specifications (postconditions) for large-scale C++ codebases. The system uses a five-stage pipeline involving code mining, LLM-guided specification generation, parsing, validation through test oracles, and iterative refinement via error feedback. The authors evaluate their approach on benchmark datasets (HumanEval-CPP, FormalSpecCPP) and two industrial C++ repositories (BDE and BlazingMQ), demonstrating 20-35% improvements in test validity over the baseline NL2POST method."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1. The work addresses a genuine pain point in software engineering - the lack of formal specifications in existing large codebases. Application to million-line C++ production codebases represents a significant empirical contribution.\n2. The paper includes both quantitative metrics (test validity rates) and qualitative analysis (manual inspection of correctness and strength), tested across multiple LLM models and benchmarks.\n3. Consistent improvements of 20-35% over state-of-the-art baselines across different models and datasets demonstrate the method's effectiveness."}, "weaknesses": {"value": "1. The core technique (reprompting/self-refinement with error feedback) is well-established in LLM literature and can be found in lots of LLM coding literature.\n\n2. Who verifies the verifier? Using unit tests as a proxy brings about questions such as what happens if the tests are not high-coverage or wrong. This undermines the usefulness of the method."}, "questions": {"value": "N/A"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "pxBpOOE3je", "forum": "Z7TUUQPSzY", "replyto": "Z7TUUQPSzY", "signatures": ["ICLR.cc/2026/Conference/Submission21405/Reviewer_c23M"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21405/Reviewer_c23M"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission21405/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762017991348, "cdate": 1762017991348, "tmdate": 1762941750545, "mdate": 1762941750545, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents Fun2spec, a tool for synthesizing formal specifications in first-order logic for C++ functions using LLMs. Fun2spec consists of three main phases: code miner to extract contextual information, LLM generator to synthesis postconditions, and specification tester to filter out invalid candidate specifications. The experiment results demonstrate notable improvements compared with existing approach."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- Practical value. Fun2spec targets real, large-scale industrial C++ codebases, which is a step beyond prior works that focus on small or toy examples.\n- Well-designed architecture.  The architecture of Fun2spec is thoughtfully designed, and consists of three main phases. The tester phase can help validate the synthesised specifications.\n- Evaluation on industrial codebases. Fun2spec is evaluated on industrial codebases (BDE and BlazingMQ) that contain millions lines of code."}, "weaknesses": {"value": "- Evaluation relies on unit tests. The paper’s primary validity metric is unit-test-based (Sections 4.1, 4.2). but there is limited discussion on the completeness of these unit tests. The reliance on tests undermines claims of true behavioral correctness, as tests can miss coverage for program behaviors. Although Section 4.3 evaluates the correctness of specification synthesis by Fun2spec, the metric is vague. For example, there is no clear definition of what is the \"strongest correct postcondition\". \n- Some details are not clear. \n  - In Section 4 (Evaluation), it is not specified how many postconditions are generated by Fun2spec and nl2post. The authors should report the exact numbers for transparency and comparability.\n  - In Figure 3, it is unclear why Fun2spec generates propositional postconditions, since as stated in line 107, the system only uses first-order logic to represent specifications. \n  - In Section 4.3, how many postconditions are evaluated by the authors? \n\nMinor issues:\n- The main content and Algorithm 1 appear to overlap.\n- In Table 3, some metric titles (e.g., Trivial, Formatting Error) are inconsistent with those used in the main text (e.g., Nontrivial, Invalid Formatting). Please ensure consistency between the table and the text for better readability"}, "questions": {"value": "- Could the authors clarify how “the strongest correct postcondition” is formally defined in Section 4.3?\n- Can the authors provide detailed statistics regarding unit test coverage, and discuss how coverage limitations affect confidence in the correctness of the generated specifications.\n- I noticed that the paper of nl2postcond proposes the metrics of test-set correctness and test-set completeness for code mutants to evaluate the postcondition, why did the authors not adopt these metrics in the evaluation? Moreover, the paper nl2postcond reports an evaluation on industrial-scale projects and claims to have detected 64 historical bugs. How does Fun2spec perform in terms of bug detection? If no similar experiment was conducted, could the authors explain the rationale for omitting such an evaluation?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "N.A."}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "2artTO8NSF", "forum": "Z7TUUQPSzY", "replyto": "Z7TUUQPSzY", "signatures": ["ICLR.cc/2026/Conference/Submission21405/Reviewer_FzDY"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21405/Reviewer_FzDY"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission21405/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762092384839, "cdate": 1762092384839, "tmdate": 1762941750245, "mdate": 1762941750245, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": true}