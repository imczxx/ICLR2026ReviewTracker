{"id": "RswgcvZ76N", "number": 5741, "cdate": 1757930991013, "mdate": 1763708287414, "content": {"title": "From Shell to Structure: Spherical Shell Diffusion for Molecular Geometry Generation", "abstract": "Diffusion-based generative models have recently advanced the state of the art in 3D molecular conformation generation, yet most existing methods rely on an isotropic Gaussian prior and unstructured Gaussian noise in Euclidean space. By concentration of measure, such Gaussians place most of their mass on a thin high-dimensional shell, but this shell is a statistical artifact of dimensionality rather than a chemically meaningful scale. As a result, initialization and early dynamics are often mismatched, leading to dispersed trajectories, high entropy, and unstable convergence. We propose Spherical Shell Diffusion (SSD), a framework that explicitly replaces the Gaussian prior with a chemically scaled spherical-shell initialization and substitutes Gaussian noise with a structured dynamics field combining radial contraction, short-range repulsion, and an SE(3)-equivariant correction. This design avoids wasted radial drift, stabilizes early trajectories, and yields denoising processes that better align with molecular geometry. Empirical results on GEOM-Drugs and GEOM-QM9 show that SSD consistently improves both quality and diversity across multiple diffusion backbones, underscoring the value of combining structured geometric priors with geometry-aware dynamics for 3D molecular generation.", "tldr": "We propose Spherical Shell Diffusion (SSD), a geometry-aware framework for 3D molecular generation that replaces Gaussian priors with spherical shells and structured dynamics, achieving state-of-the-art results.", "keywords": ["3D molecular generation", "diffusion models", "flow matching"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/ed7708b070d76cbda430cad7c1718022669cb584.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "As prior diffusion and flow-based approaches rely on Gaussian priors and unstructured noise processes, they often produce invalid molecular conformations and diverge during early diffusion steps. To address these issues, this paper introduces a spherical-shell prior and a geometry-aware diffusion process, which improve conformation generation by better aligning with molecular geometry and eliminating unnecessary radial drift."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The paper is well-structured and well-written, and it is generally easy to follow.\n- The paper presents a clear and well-motivated problem statement, highlighting the limitations of current approaches that rely on unstructured diffusion processes, which can degrade the quality of generated samples.\n- The authors demonstrate the effectiveness of their proposed method through extensive experiments and ablation studies, showing that it improves both sample quality and diversity. The proposed approach enhances the performance of state-of-the-art molecular models across both 2D→3D generation and 3D generation tasks."}, "weaknesses": {"value": "- I have some concerns regarding the novelty and effectiveness of the proposed approach. While the authors claim to introduce a novel geometry-aware noising process, they also employ additional guidance terms during sampling. Specifically, in Equation (10), an additional radial contraction term (pulling atoms inward) and a short-range repulsion term (enforcing a minimum interatomic distance) are added. I question whether these guidance terms alone could already steer the diffusion trajectories toward reasonable conformations, without modifying the prior or the forward process during training. A similar form of conformational guidance was explored in prior work [1] (ShapeMol with Shape Guidance) for Ligand-Based Drug Design tasks and achieved improved results without requiring additional training.\n\n- Following the point above, I recommend including additional experiments using pre-trained backbones and a modified reverse process that only applies the two guidance terms (i) and (ii) from Equation (10) to constrain the conformation space. Similarly, I suggest providing results using only the proposed prior and geometry-aware noising process, without the added guidance terms in the reverse process. These comparisons are important to disentangle the effects of the proposed geometry-aware noising process from those of the added sampling guidance terms.\n\n- It remains unclear whether the proposed noising process converges to the prior in the limit as $t \\rightarrow T$. This theoretical aspect is not discussed in the paper and should be clarified.\n\n[1] Chen, Ziqi, et al. \"Shape-conditioned 3d molecule generation via equivariant diffusion models.\" arXiv preprint arXiv:2308.11890 (2023)."}, "questions": {"value": "- The authors claim that the proposed approach reduces the spatial entropy during generation, however, there are no experiments in the paper supporting this claim. In particular, how much does SDD reduce the spatial entropy during early/later steps of the generation?\n\n- As the proposed method constrains the spatial space of generated conformations, it would also be important to assess how this constraint impacts the performance on structure-conditioned tasks, such as scaffolding or linker design, as studied in prior works [2,3]. Evaluating the method in these settings can clarify whether the spatial constraints introduced by SSD limit flexibility or generalization in more complex tasks.\n\n[2] Ayadi, Sirine, et al. \"Unified guidance for geometry-conditioned molecular generation.\" Advances in Neural Information Processing Systems 37 (2024): 138891-138924.\n[3] Schneuing, Arne, et al. \"Structure-based drug design with equivariant diffusion models.\" Nature Computational Science 4.12 (2024): 899-909."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "8e7BFSf9OI", "forum": "RswgcvZ76N", "replyto": "RswgcvZ76N", "signatures": ["ICLR.cc/2026/Conference/Submission5741/Reviewer_HYhF"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5741/Reviewer_HYhF"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission5741/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760614787873, "cdate": 1760614787873, "tmdate": 1762918232487, "mdate": 1762918232487, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes Spherical Shell Diffusion (SSD), a geometry-aware framework for molecular conformation generation. The key insight is that standard Gaussian priors place most probability mass on a high-dimensional shell determined by statistics rather than molecular chemistry, leading to inefficient denoising trajectories. SSD addresses this by explicitly initializing atoms on a chemically scaled spherical shell and introducing structured reverse dynamics with three components: global radial contraction toward the origin, short-range repulsion to prevent atomic overlap, and a learned SE(3)-equivariant score correction. The framework is model-agnostic and extends naturally to both diffusion and flow matching paradigms. Experiments on GEOM-QM9 and GEOM-Drugs demonstrate consistent improvements across multiple backbones in both conditional generation and unconditional refinement tasks, with faster convergence and better robustness to limited sampling budgets."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "**Novel geometric prior design.** The paper provides a principled approach to replace the statistically motivated Gaussian shell with a chemically meaningful spherical shell. The explicit decomposition of reverse dynamics into radial contraction, physical repulsion, and learned correction offers clear geometric intuition and aligns well with molecular structure. This structured design stands in contrast to purely data-driven baselines.\n    \n**Strong and consistent empirical results.** SSD achieves state-of-the-art performance across both conditional generation and unconditional refinement benchmarks. The improvements are consistent across multiple architectures (GeoDiff, SubGDiff, EDM) and datasets (QM9, Drugs), with notable gains in both quality metrics and diversity measures. The method also demonstrates faster training convergence and better efficiency under reduced sampling steps.\n    \n**Broad applicability and extensibility.** SSD serves as a drop-in module that works with existing SE(3)-equivariant backbones without architectural modifications. The framework naturally extends beyond diffusion to flow matching (SSD-Flow), demonstrating its generality. The auto-calibrated hyperparameters require no per-dataset or per-backbone tuning, enhancing practical usability across different molecular generation tasks."}, "weaknesses": {"value": "**Theoretical gap between forward and reverse processes.**\nThe forward process directs each atom toward a randomly assigned target point on the spherical shell, while the reverse process uses a radial contraction toward the origin that does not depend on these forward assignments. This asymmetry means the reverse dynamics are not the time-reversal of the forward dynamics, violating the standard diffusion framework where forward and reverse marginal distributions are guaranteed to match. The paper provides no theoretical proof of distributional consistency or convergence guarantees, instead implicitly relying on the learned score network to compensate for this mismatch. While empirical results are strong, the lack of rigorous probabilistic justification raises questions about the theoretical soundness of this design.\n\n**Missing baselines.**\nThe paper omits comparisons with several relevant baselines, notably Torsional Diffusion for Molecular Conformer Generation and Generating Molecular Conformer Fields. Although I recognize that the paper's primary objective is to improve coordinate-based diffusion methods via structured initialization and dynamics, the proposed enhancement appears limited in scope and may not provide sufficient incentive for researchers to adopt this approach over existing methods.\n\n**Insufficient experimental evidence.**\nWhile SSD achieves strong results, the ablation studies raise questions about the relative contributions of initialization vs. dynamics. Table 8 shows that replacing Gaussian with spherical-shell initialization yields minimal gains (90.9→91.0 COV-R), whereas adding structured dynamics produces substantial improvements (91.0→93.2). This suggests the core contribution is the geometry-aware dynamics rather than addressing concentration of measure in the prior.\nTo substantiate the paper's central claim—that Gaussian initialization is fundamentally problematic—the authors should test: (1) Gaussian init + SSD dynamics, and (2) repeat the Section 4.4 large-molecule analysis with this variant. If Gaussian init + SSD dynamics performs comparably to full SSD, it would indicate the initialization scheme is largely irrelevant, and the paper's theoretical motivation should be reframed accordingly."}, "questions": {"value": "- Your forward process assigns atoms to random shell points (Eq. 8), but the reverse process contracts uniformly toward the origin (Eq. 10), breaking time-reversal symmetry. Why not use Langevin dynamics where the score network directly handles corrections? Do you have theoretical or empirical evidence that $p(x_t)$ matches between forward and reverse processes?\n\n\n- Since you propose a new noising process, key ablations are missing: Noise schedules: Does reducing $\\sigma_t$ in Gaussian baselines to match your thin-shell noise eliminate the performance gap? Flow stability: Can you compare SSD-Flow against FlowMol/GeoLDM and show ODE trajectory stability metrics?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "nQByas8UDt", "forum": "RswgcvZ76N", "replyto": "RswgcvZ76N", "signatures": ["ICLR.cc/2026/Conference/Submission5741/Reviewer_QSDZ"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5741/Reviewer_QSDZ"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission5741/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761725266814, "cdate": 1761725266814, "tmdate": 1762918232101, "mdate": 1762918232101, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"title": {"value": "General Response"}, "comment": {"value": "We thank all reviewers for their thoughtful and constructive feedback. Across the four reviews, several strengths of the paper were consistently highlighted: the mathematical clarity of the concentration-of-measure argument and the motivation for replacing Gaussian priors; the clean, model-agnostic design of SSD as a drop-in module compatible with GeoDiff, SubGDiff, EDM, and flow-matching architectures; the clear geometric intuition behind the spherical-shell prior and the decomposition of reverse dynamics; and the strong, consistent empirical improvements across QM9 and Drugs in both conditional 2D→3D generation and 3D→3D refinement. Reviewers also noted the stability and efficiency of SSD’s sampling scheme and the clarity and structure of the manuscript.\n\nAt the same time, reviewers raised several recurring technical questions: (i) whether SSD provides benefits beyond replacing the Gaussian prior;\n(ii) whether the gains arise from initialization or dynamics;  \n(iii) robustness across datasets and backbone architectures; and  \n(iv) whether the forward and reverse processes are theoretically consistent.\n\nTo address these concerns, we added one theoretical clarification and seven targeted experiments in the revised manuscript. The full supplementary tables (R1–R7) and justification are provided in the follow-up comment immediately below.\n\n### **Theoretical clarification**\nWe added a formal derivation (Appendix I) showing that the SSD forward SDE converges to a thin spherical shell (radial OU + angular isotropic diffusion) and that reverse marginal consistency follows directly from score-based diffusion theory. This resolves concerns about forward–reverse asymmetry and validates the use of geometry-aligned reverse dynamics.\n\n### **Summary of supplementary tables**\n\n1. **Table R1 — Added torsion- and field-based baselines.**  \n   SSD-SubGDiff and SSD-GeoDiff outperform Torsional Diffusion and Conformer Fields under our unified evaluation protocol, which follows the standard settings used in SubGDiff for fair comparison.\n\n\n2. **Table R2 — Initialization vs. dynamics decomposition.**  \n   Gaussian-init + SSD-dynamics is radially incompatible. The only valid control, a Gaussian concentration shell at $r_{\\text{Gauss}}=\\sigma_T\\sqrt{3N_{\\mathrm{med}}}$, shows no meaningful gain, while the **mean chemical shell** with matched SSD dynamics achieves the full improvement. This demonstrates that SSD’s geometry, rather than additional guidance terms, is responsible for the improved performance.\n\n\n3. **Table R3 — Computational cost.**  \n   SSD introduces no additional parameters for coordinate ackbones (SubGDiff) and preserves their training/inference cost. In the latent-flow setting, SSD-Flow uses a more compact ncoder than SemlaFlow, reducing computation while still adding no new parameters to the underlying generative model.\n\n\n\n4. **Table R4 — Dataset robustness.**\nSSD performs consistently across QM9 (small–rigid) and Drugs (large–flexible), which are the most widely adopted benchmarks for 3D molecular generation and allow direct comparison with a wide range of prior methods.\n\n\n5. **Table R5 — Atom–shell assignment.**  \nRandom permutation preserves permutation symmetry and is stable; deterministic nearest-matching degrades performance, and explicitly enforcing this nearest-distance assignment only worsens results.\n\n\n6. **Table R6 — Reduced-variance Gaussian schedules collapse SubGDiff.**  \n   Lowering or matching the Gaussian noise variance does not approximate SSD. Reduced-$\\sigma_{t}$ SubGDiff consistently shows worse COV-R and MAT-R, confirming that SSD’s gains come from its shell-aligned geometry rather than variance tuning.\n\n7. **Table R7 — Trajectory stability (“spatial entropy”).**  \n   SSD reduces radial variance and drift in both SDE and ODE sampling, yielding substantially more stable trajectories."}}, "id": "267CPvXUJp", "forum": "RswgcvZ76N", "replyto": "RswgcvZ76N", "signatures": ["ICLR.cc/2026/Conference/Submission5741/Authors"], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5741/Authors"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission5741/-/Official_Comment"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1763705136367, "cdate": 1763705136367, "tmdate": 1763707565846, "mdate": 1763707565846, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Comment", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The authors address the challenge of achieving efficient and stable sampling for flow-based generative models such as score-based diffusion and flow-matching, by explicitly initializing the sampling process with dataset-specific priors and constrained dynamics. Through experiments on GEOM-QM9 and GEOM-Drugs, the authors demonstrate the model-agnostic efficacy of their proposed framework across multiple existing generative models. This method provides faster convergence and more stable sampling for generating 3D conformers of organic small molecule compounds."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1)\tState-of-the-art technology in conformer generation\n2)\tModel-agnostic, simple to integrate with existing or developing models.\n3)\tEfficient and stable sampling scheme."}, "weaknesses": {"value": "1)\tpotential OOD fragility \n- In real-world datasets, inconsistent molecule size and atypical shape may degrade performance. Rather than testing on internally homogeneous benchmarks such as QM9 and Drugs, the authors should verify whether the same spherical-shell design performs robustly under shifted or more diverse distributions.\n\n2)\treliance on handcrafted geometric priors (non-separable)\n- Although the paper claims model-agnosticism, several parameters are still determined from the training data, which introduces implicit dataset dependence.\n\n3)\tThe terminology is underexplained and occasionally inconsistent, leading to confusion.\n- Since the major contribution lies in the spherical shell prior, it should be clearly defined. In particular, the difference between the proposed ‘spherical shell’ and the gaussian distribution concentrated on a shell, needs to be explained explicitly in the main text. \n- The distinction between ‘attraction’ and ‘contraction’ is unclear. \n- The paper should describe in more detail the specific tasks chosen to demonstrate the proposed framework’s effectiveness. To my knowledge, when a model starts from an already generated 3D graph, producing a more accurate conformer is usually referred to as refinement. The authors should justify why they use the term refinement when starting from an unconditional graph."}, "questions": {"value": "Please refer to the questions below and the weaknesses section.\n- The figure and the described methodology seems inconsistent. In the forward process, atoms are supposed to be initialized on a spherical shell, but the figure does not depict this. Moreover, the manuscript states that both the forward and reverse process are guided by a contraction field. How exactly is this represented in the figure?\n- Since some recent models like DiSCO[1] corporate latent-level structure, how does SSD compare in terms of computational cost and convergence behavior when extended to those paradigms?\n\nreferences\n\n[1] Lee, D., Lee, D., Bang, D., & Kim, S. (2024). DiSCO: Diffusion Schrödinger Bridge for Molecular Conformer Optimization."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "l5CBW5zJ4G", "forum": "RswgcvZ76N", "replyto": "RswgcvZ76N", "signatures": ["ICLR.cc/2026/Conference/Submission5741/Reviewer_6tT3"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5741/Reviewer_6tT3"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission5741/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761927402833, "cdate": 1761927402833, "tmdate": 1762918231865, "mdate": 1762918231865, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes Spherical Shell Diffusion (SSD), a novel framework for 3D molecular conformation generation that replaces the standard Gaussian prior with an explicit spherical shell initialization and introduces structured dynamics. The key insight is that Gaussian priors in high dimensions concentrate mass on a spherical shell by concentration of measure, but this shell's radius is determined by dimensionality rather than chemical scales, leading to mismatched initialization and inefficient denoising trajectories. Thus paper replaces Gaussian prior with chemically-scaled spherical shell initialization, introduces structured reverse dynamics: radial contraction, short-range repulsion, and SE(3)-equivariant corrections. It demonstrates consistent improvements across multiple backbones (GeoDiff, SubGDiff, EDM), and extends framework to Flow Matching (SSD-Flow)."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The concentration of measure argument provides solid mathematical justification for why Gaussian priors are suboptimal. The observation that the Gaussian shell radius is determined by dimensionality rather than chemistry is insightful. \n2. SSD works as a drop-in replacement across different architectures (GeoDiff, SubGDiff, EDM) and paradigms (diffusion and flow matching), demonstrating generality. \n3. The experiments are comprehensive, showing consistent Improvements from SSD."}, "weaknesses": {"value": "1. The individual components (radial drift, repulsion forces, SE(3)-equivariant networks) are standard. The the combination is not novel enough.\n2. On some metrics, gains over baselines are modest, and inportant baselines lack, such as Torsional Diffusion [1].\n3. The paper argues that Gaussian priors are problematic due to concentration of measure, but the ablation seems showing that fixing this initialization problem alone provides almost no benefit from Table 7. More ablation study should be conducted for to properly decompose the contributions. For example, add SSD dynamics and priors with Gaussian initialization.\n\n[1] Jing B, Corso G, Chang J, et al. Torsional diffusion for molecular conformer generation. Advances in neural information processing systems, 2022, 35: 24240-24253."}, "questions": {"value": "1. Does introducing additional geometric priors significantly increase the computational cost of training or inference? Is there a noticeable increase in training time?\n2. Table 7 shows performance degrades with extreme radii, but how stable is the median-based calibration across different data splits? What if train/test distributions differ in molecular size?\n3. Eq. 8 assigns atoms to shell points via random permutation. How sensitive are results to this assignment strategy? Have you tried optimal transport or other matching schemes?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "eMgKWMdRj0", "forum": "RswgcvZ76N", "replyto": "RswgcvZ76N", "signatures": ["ICLR.cc/2026/Conference/Submission5741/Reviewer_B9v9"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5741/Reviewer_B9v9"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission5741/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762005286772, "cdate": 1762005286772, "tmdate": 1762918231604, "mdate": 1762918231604, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}