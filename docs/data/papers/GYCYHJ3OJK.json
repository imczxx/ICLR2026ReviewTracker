{"id": "GYCYHJ3OJK", "number": 2616, "cdate": 1757164601384, "mdate": 1759898137331, "content": {"title": "Y-shaped Generative Flows", "abstract": "Modern generative models usually assume V-shaped flows: The probability mass moves from the source to the targets along straight separate paths. We argue that this bias underrepresents hierarchical structure in real data, where classes share ancestral pathways. We propose Y-shaped generative flows, a alternative derived from branched optimal transport, which favors moving particles together before branching to specialized targets. We developed a scalable neural network-based formulation trained with continuous normalizing flows. In synthetic, image, and biology datasets, our method produces hierarchy-aware trajectories while matching strong baselines.", "tldr": "Generative models with branched flow structures", "keywords": ["Generative Flows", "Normalizing Flows", "Optimal Transport"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/ef702f76bda2204e985df716933be77e2b84912f.pdf", "supplementary_material": "/attachment/3c517284ed5b5db23b71b064eccbd5121cdb3796.zip"}, "replies": [{"content": {"summary": {"value": "The paper suggests that the inductive bias of later 'branching' in flow based generative models may be beneficial for modeling data with a similar hierarchical generative structure. They make a connection with Branched Optimal Transport, and introduce a new method to efficiently solve such problems which otherwise are computationally intractable. The method appears novel, interesting, and intuitively appealing. The results appear quite preliminary and mostly qualitative, with unclear significance. The paper also has a surprising number of typos and grammatical errors."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "- The paper raises the interesting point to the attention of the community that perhaps the shape of the flow itself may be relevant for modeling the data distribution; and that hierarchical flows are better modeled by tree like structures as opposed to 'straight line' flows. \n- The introduction of Branched Optimal Transport as a potential technique to bias flow based generative models is elegant and a welcome cross-disciplinary contribution. \n- They propose a tractable alternative to classic branched optimal transport which is more computationally efficient, thereby allowing them to test the potential benefits of such an inductive bias. \n- They validate that this tractable alternative is equivalent up to a constant to their original objective under mild assumptions \n- The method qualitatively appears to work and intuitively makes sense."}, "weaknesses": {"value": "- The results are largely qualitative, making it hard to judge the significance of the proposed contribution.\n- For tasks with quantitative results, there are no measures of variance of the solutions.\n- The reason why the original branched OT problem is computationally costly is not immediately clear from the text.\nThe metrics in Table 1 are not defined. \n- There are a surprising number of typos and grammatical errors virtually everywhere throughout the text. See the list of some below. These raise concerns about the degree of 'completeness' of the work, and if there may be similar errors in the mathematics. \n\n**Typos:**\n- Line 34 typo: \"These approaches generates data by simulating an ODE\"\n- \"We think it is important to study different kinds of generative models that can allocate notion of transport from the general to the specific, it in the simplest way\"\"\n- \"a wide range of natural and engineered structures as vascular systems, trees, river basins\"\n- \"Continuous Normalizing Flow (CNF) proposed by Chen et al. (2018) ar generative model that\"\n- \"the particle dynamics is linear\"\n- \"The evolution of mass is governed by the continuity constraint ∇ · u = μ0 − μ1, acts as a fundamentalconservation of mass law\"\n- \"running this methods in practice is often not feasible in continues case.\"\n- “What the reader can notice is that for the cost 4 need to be finite, the …”\n- “Branching transport problems mostly been studied in discrete.”\n- “Both use models the same time-conditioned MLP “\n\n**Minor:**\n- The continuity equation is written nearly identically twice in the text."}, "questions": {"value": "- In the intro you state: \"In general, the question of flow shapes has not been previously raised. On the contrary, the prevailing direction in generative modeling is to simplify and straighten trajectories, making them as V-shaped as possible.\" This intuition makes sense for the simple 2D flows you demonstrate in Figure 1, but how can we be sure that there is actually a dichotomy between straightness and hierachical flow structures?\n- It would seem logical that there are many datasets that have this sort of a hierarchical structure in their data generating process that you could use your method on. However, one would expect that your method would be better able to model these distributions in a convincing manner. Besides Table 1, it is difficult to see that. Have you tried this method on other datasets where you get convincing performance improvements, rather than qualitative ones?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "MkdObWJO1z", "forum": "GYCYHJ3OJK", "replyto": "GYCYHJ3OJK", "signatures": ["ICLR.cc/2026/Conference/Submission2616/Reviewer_ezAa"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2616/Reviewer_ezAa"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission2616/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761923771722, "cdate": 1761923771722, "tmdate": 1762916308798, "mdate": 1762916308798, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces \"Y-shaped generative flows,\" a continuous-time generative modeling framework designed to capture hierarchical structures in data. The authors argue that  existing flow-based models produce a \"V-shaped\" path, where samples move independently from the prior to the data distribution along nearly straight trajectories. The conclude this produces an in-efficient flow which require many integration steps and may overlook share structure in data. Instead, they propose Y-flows, which remedy this by encouraging probability mass to travel together along shared \"trunks\" before \"branching\" off to target-specific endpoints.\n\nThe core of the paper's theoretical contribution is a new velocity-powered transport cost inspired by branched optimal transport theory. Instead of the standard Benamou-Brenier formulation for Wasserstein-2 distance, which minimizes a kinetic energy with a quadratic $||v||^2$ term, this work proposes minimizing an action with a sublinear $||v||^\\alpha$ term (where $0 < \\alpha < 1$). The concavity of this objective is what incentivizes mass to aggregate and move quickly along common pathways. The authors provide theoretical justification for this objective, proving its equivalence to flux-power costs under bounded-density assumptions. They also include a time-compression lemma to demonstrate why this formulation favors faster transport in fewer integration steps.\n\nPractically, this continuous-time objective is realized as a neural-ODE algorithm. The velocity field is parameterized by a neural network, $v_\\theta$, which is trained to minimize a two-part loss function. The first part is an approximation of the proposed $V^\\alpha$ action, calculated by summing $||v_\\theta||^\\alpha$ along the discretized ODE trajectories. The second part is a boundary constraint, implemented as the Sinkhorn divergence, which measures the dissimilarity between the transported particle distribution at $t=1$ and the true target distribution. The authors demonstrate their method on synthetic, 3D LiDAR, and single-cell datasets, showing it can recover branching structures. They also report performance on a latent-space image translation task (FFHQ-ALAE), with only two integration steps."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "The primary strength of this paper is its elegant and intuitive theoretical formulation. The central objective (Eq. 7) is a simple modification of the standard dynamic optimal transport problem, replacing the convex $||v||^2$ cost with a concave $||v||^\\alpha$ cost. This provides a principled, well-motivated method for encouraging branched, non-straight-line flows. I wonder whether formulation can also be viewed as a novel Lagrangian cost for optimal transport [1,2], effectively defining a preference for specific paths (Y-shaped) over others (V-shaped) to move mass from source to target.\n\n[1] A Computational Framework for Solving Wasserstein Lagrangian Flows: https://arxiv.org/pdf/2310.10649\n[2] Neural Optimal Transport with Lagrangian Costs: https://arxiv.org/abs/2406.00288"}, "weaknesses": {"value": "Despite the elegance of the theoretical formulation, the paper's main contributions are algorithmic, and the practical algorithm suffers from significant weaknesses. There is a disconnect between the continuous-time theory and the ad-hoc implementation. The final loss is a combination of a distributional loss (Sinkhorn divergence) and the $V^\\alpha$ path penalty. This immediately calls the method's scalability into question. Like continuous normalizing flows (CNF), the algorithm must simulate the full ODE trajectory at each training step. However, unlike modern scalable methods such as Flow Matching (which uses a per-point loss) or likelihood-based NFs, this method requires computing the Sinkhorn divergence, which scales quadratically with the batch size $N$. This is a massive computational burden that most modern generative models are explicitly designed to avoid. This scalability issue permeates the experimental results, which are mostly confined to small or simulated datasets (e.g., ~2.7k cells, ~5k LiDAR points) or the 512-dim latent space of a pretrained ALAE model. \n\nFurthermore, the paper's central premise, that modern generative models like Flow Matching (FM) produce \"V-shaped\" flows, is not sufficiently demonstrated. While straight paths are a feature of optimal transport under $L_2$ cost, this reviewer's experience with FM is that the learned flows are often highly non-linear. The authors do not provide a strong empirical analysis to support their claim, weakening the motivation for their proposed solution."}, "questions": {"value": "Given the significant computational trade-off of this method, can the authors provide more substance on the practical benefits of Y-Flows over more scalable baselines like Flow Matching (FM) and Mean Flows (MF)? Are the benefits of \"hierarchy-aware structure\" or the quantitative gains in \"fewer integration steps\" (e.g., in the latent-space FFHQ experiment) significant enough to justify this high computational cost, especially for large-scale, high-dimensional datasets? A more direct comparison of the performance-vs-compute trade-off against these baselines would be necessary to motivate the adoption of this less-scalable algorithm."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "K5u7HZJ6zA", "forum": "GYCYHJ3OJK", "replyto": "GYCYHJ3OJK", "signatures": ["ICLR.cc/2026/Conference/Submission2616/Reviewer_LMzY"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2616/Reviewer_LMzY"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission2616/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761928372735, "cdate": 1761928372735, "tmdate": 1762916308396, "mdate": 1762916308396, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "Some previous work has shown how to produce branch-like behavior in diffusion models, in which however the trajectories were independent from each other. In this work for the first time actual Branched Optimal Transport theory, in which the evolution of trajectories is not independent from each other (rather, the cost depends on the flux of trajectories though an area) and actual branching can happen. The lack of previous works is not by chance: as authors show, usual approaches from Branched Transport are all problematic, and thus it was an open problem how to apply actual Brached Transport ideas effectively in diffusion models. Here this is elucidated and a reasonable solution  is shown for the first time, via an approximation to the Branched Transport loss which is a slight simplification but nevertheless maintains the branching property."}, "soundness": {"value": 4}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "1) As said in the summary, this is the first paper to actually apply a Branched Optimal Transport setup in a stable and scalable way to Deep Learning, in particular to Diffusion Models.\n\n2) This solves some technical open problems via a novel approximation, as described in the paper. By this I mean that a strength of the paper is actually the novelty in the method of approximation of Branched transport.\n\n3) The paper is presented mostly very clearly, and in a didactic way making it easy to follow."}, "weaknesses": {"value": "1) The full comparison to the Modica-Mortola approach to Branched Transport is not fully clear to me, and I think that it would be useful to try and compare more precisely the methods. I will also formulate this as a question below.\n\n2) The discussion of why the method uses fewer steps is a bit superficial, not easy to follow.\n\n3) The \"mild\" hypotheses on $\\rho$ in Proposition 1, I'm not sure if they are verified in practice, and there is no discussion of what are mitigations that in practice may make a result akin to Proposition 1 valid.\n\n4) See my question 8 below, this is another difficulty I have with the paper, but it's better formulated as a question."}, "questions": {"value": "1) Can you comment on why the Modica-Mortola (MM) loss is different than yours ? Of course the second term in MM formulation is not present, but why is your formulation essentially different than keeping only the first term in eq. 18? \n\n2) The remark 2 says that a term akin to second term in MM formulation does not change stability, do you have numerical proof for this?\n\n3) When treating MM you say it is \"dramatically\" unstable. Do you have some experiments to prove this dramatical claim?\n\n4) The lines 216 - 223 are not clear \n- (note typo of \"Lets\"->\"Let's\" but I don't mean that)\n- when you say \"any straight corridor\" what does that mean?\n- Where did we talk about corridors before?\n- and \"per-step\" means what? What steps do you mean?\n- And finally, the last sentence \"Consequently, ... regularity bounds\" I don't fully get it.\nCan you transform these lines in a lemma+proof please?\n\n5) By the way, line 225, what do you mean by \"resemble instantaneous motion along a network jumps\" ? is there some grammatical mismatch maybe? I can't parse that sentence.\n\nLine 226 it's \"Mortola\" with only one \"l\".\n\n6) lines 481-482 what does it mean concretely / precisely that \"utility of small temporal/spatial smoothness regularizers\". What would such regularizers look like? and \"small\" in what sense? (This question is quite similar to my question 5 I think, but I may be wrong)\n\n7) in Branched Transport, the role of alpha is to change the steepness of the angles in the \"Y\", with alpha=1 or higher, corresponding to \"Y\" becoming effectively a \"V\". Do you include alpha=1 in the inequality from line 241? And more interestingly, can you verify the steepness dependence on alpha as it decreases?\n\n8) in Branched Transport, a famous result by Devillanova-Solimini says that a Dirac mass cannot be connected to a d-dimensional measure in R^N in $\\alpha$-branched transport, unless $alpha>1-1/d$. Sometimes (for some alpha) branched transport cost is infinite. Can you comment on how this difficulty does not affect the setting, or how could it affect it, in the case of very large or well spread distributions, or when matching noise to a concentrated distribution?\n In this case (i.e. for high d and if we want to Y-flow-match an absolutely continuous distribution to a concentrated one), in order to still have a \"Y\" and non-infinite cost, one has to take alpha between 1-1/d and 1, a very small interval very close to the alpha=1 corresponding to the \"V\". \n Of course one works with a finite sample from the continuous distribution, but the approximation/stability issues will manifest as bad sampling bounds, if the actual underlying cost is infinite. So can you comment on this difficulty, what is your view?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "p0oJ92ZgSo", "forum": "GYCYHJ3OJK", "replyto": "GYCYHJ3OJK", "signatures": ["ICLR.cc/2026/Conference/Submission2616/Reviewer_kJ38"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2616/Reviewer_kJ38"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission2616/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761963922084, "cdate": 1761963922084, "tmdate": 1762916307844, "mdate": 1762916307844, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "Some previous work has shown how to produce branch-like behavior in diffusion models, in which however the trajectories were independent from each other. In this work for the first time actual Branched Optimal Transport theory, in which the evolution of trajectories is not independent from each other (rather, the cost depends on the flux of trajectories though an area) and actual branching can happen. The lack of previous works is not by chance: as authors show, usual approaches from Branched Transport are all problematic, and thus it was an open problem how to apply actual Brached Transport ideas effectively in diffusion models. Here this is elucidated and a reasonable solution  is shown for the first time, via an approximation to the Branched Transport loss which is a slight simplification but nevertheless maintains the branching property."}, "soundness": {"value": 4}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1) As said in the summary, this is the first paper to actually apply a Branched Optimal Transport setup in a stable and scalable way to Deep Learning, in particular to Diffusion Models.\n\n2) This solves some technical open problems via a novel approximation, as described in the paper. By this I mean that a strength of the paper is actually the novelty in the method of approximation of Branched transport.\n\n3) The paper is presented mostly very clearly, and in a didactic way making it easy to follow.\n\n---Update-- see reviewer comment below"}, "weaknesses": {"value": "1) The full comparison to the Modica-Mortola approach to Branched Transport is not fully clear to me, and I think that it would be useful to try and compare more precisely the methods. I will also formulate this as a question below.\n\n2) The discussion of why the method uses fewer steps is a bit superficial, not easy to follow.\n\n3) The \"mild\" hypotheses on $\\rho$ in Proposition 1, I'm not sure if they are verified in practice, and there is no discussion of what are mitigations that in practice may make a result akin to Proposition 1 valid.\n\n4) See my question 8 below, this is another difficulty I have with the paper, but it's better formulated as a question.\n\n---Update-- see reviewer comment below"}, "questions": {"value": "1) Can you comment on why the Modica-Mortola (MM) loss is different than yours ? Of course the second term in MM formulation is not present, but why is your formulation essentially different than keeping only the first term in eq. 18? \n\n2) The remark 2 says that a term akin to second term in MM formulation does not change stability, do you have numerical proof for this?\n\n3) When treating MM you say it is \"dramatically\" unstable. Do you have some experiments to prove this dramatical claim?\n\n4) The lines 216 - 223 are not clear \n- (note typo of \"Lets\"->\"Let's\" but I don't mean that)\n- when you say \"any straight corridor\" what does that mean?\n- Where did we talk about corridors before?\n- and \"per-step\" means what? What steps do you mean?\n- And finally, the last sentence \"Consequently, ... regularity bounds\" I don't fully get it.\nCan you transform these lines in a lemma+proof please?\n\n5) By the way, line 225, what do you mean by \"resemble instantaneous motion along a network jumps\" ? is there some grammatical mismatch maybe? I can't parse that sentence.\n\nLine 226 it's \"Mortola\" with only one \"l\".\n\n6) lines 481-482 what does it mean concretely / precisely that \"utility of small temporal/spatial smoothness regularizers\". What would such regularizers look like? and \"small\" in what sense? (This question is quite similar to my question 5 I think, but I may be wrong)\n\n7) in Branched Transport, the role of alpha is to change the steepness of the angles in the \"Y\", with alpha=1 or higher, corresponding to \"Y\" becoming effectively a \"V\". Do you include alpha=1 in the inequality from line 241? And more interestingly, can you verify the steepness dependence on alpha as it decreases?\n\n8) in Branched Transport, a famous result by Devillanova-Solimini says that a Dirac mass cannot be connected to a d-dimensional measure in R^N in $\\alpha$-branched transport, unless $alpha>1-1/d$. Sometimes (for some alpha) branched transport cost is infinite. Can you comment on how this difficulty does not affect the setting, or how could it affect it, in the case of very large or well spread distributions, or when matching noise to a concentrated distribution?\n In this case (i.e. for high d and if we want to Y-flow-match an absolutely continuous distribution to a concentrated one), in order to still have a \"Y\" and non-infinite cost, one has to take alpha between 1-1/d and 1, a very small interval very close to the alpha=1 corresponding to the \"V\". \n Of course one works with a finite sample from the continuous distribution, but the approximation/stability issues will manifest as bad sampling bounds, if the actual underlying cost is infinite. So can you comment on this difficulty, what is your view?\n\n\n---Update-- see first reviewer comment below"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "p0oJ92ZgSo", "forum": "GYCYHJ3OJK", "replyto": "GYCYHJ3OJK", "signatures": ["ICLR.cc/2026/Conference/Submission2616/Reviewer_kJ38"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2616/Reviewer_kJ38"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission2616/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761963922084, "cdate": 1761963922084, "tmdate": 1763052910774, "mdate": 1763052910774, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "Flow matching methods commonly use continuous-time flows with independent, straight-line trajectories -- V-shaped flows -- to transport simple distributions to data distributions, lacking mechanisms for trajectories to share transport. Authors argue that this uniform treatment overlooks the hierarchical and taxonomic structures of many real-world datasets. Inspired by branched transportation theory, they propose Y-shaped generative flows to enable adaptive, hierarchical transport: samples travel together initially, then branch to diverse targets. Empirically, Y-flows capture data hierarchies, reduce required integration steps, and improve distributional metrics over baseline flow models, offering a novel generative framework."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "- Very clearly motivated, and very well-justified problem setup -- Standard flow matching and its alignment with optimal transport is in many ways too limited to capture real-world data and transitioning from independent, straight-line transport to branched, hierarchical movement inspired by branched optimal transport theory is significant. This represents a conceptual leap in generative modeling and addresses a limitation of current continuous-time flows that overlook hierarchical structure.\n\n- The proposed velocity-powered objective is formally analyzed, with proofs showing its equivalence (up to constants) with flux-power costs under bounded density assumptions. The time-compression lemma provides elegant justification for improved computational efficiency.\n\n- Instead of relying on computationally intractable classical branched transport formulations, the authors develop a neural ODE-based training objective and approximation procedure."}, "weaknesses": {"value": "- The presentation could be improved; there are several typos across the paper. The technical constructions are mostly clear but Sec 4 could benefit from more explanations/intuitions.\n- The theoretical guarantees rely on assumptions of bounded density, and the approach may favor near-instantaneous jumps or degenerate time-compression in less regular cases. \n- Authors acknowledge that spatial-temporal regularization increases Jacobian computation and may be required for harder problems. There may remain edge-cases not fully addressed where non-smooth or singular data distributions could challenge this approach."}, "questions": {"value": "Please see my review."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "EMdfznDCH7", "forum": "GYCYHJ3OJK", "replyto": "GYCYHJ3OJK", "signatures": ["ICLR.cc/2026/Conference/Submission2616/Reviewer_sui5"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission2616/Reviewer_sui5"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission2616/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762697132150, "cdate": 1762697132150, "tmdate": 1762916306883, "mdate": 1762916306883, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}