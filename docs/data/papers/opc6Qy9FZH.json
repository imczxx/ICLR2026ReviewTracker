{"id": "opc6Qy9FZH", "number": 552, "cdate": 1756745740323, "mdate": 1763498459643, "content": {"title": "A Theoretical Analysis of Discrete Flow Matching Generative Models", "abstract": "We provide a theoretical analysis for end-to-end training Discrete Flow Matching (DFM) generative models. \nDFM is a promising discrete generative modeling framework that learns the underlying generative dynamics by training a neural network to approximate the transformative velocity field. \nOur analysis establishes a clear chain of guarantees by decomposing the final distribution estimation error.\nWe first prove that the total variation distance between the generated and target distributions is controlled by the risk of the learned velocity field. \nWe then bound this risk by analyzing its two primary sources: (i) Approximation Error, where we quantify the capacity of the Transformer architecture to represent the true velocity, and (ii) Estimation Error, where we derive statistical convergence rates that bound the error from training on a finite dataset. \nBy composing these results, we provide the first formal proof that the distribution generated by a trained DFM model provably converges to the true data distribution as the training set size increases.", "tldr": "", "keywords": ["discrete flow matching"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/ec94f67886161102c22d4a65546aedb6b42065df.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "The authors provide a full error analysis for a discrete flow-matching model parametrized by a transformer, trained on factorized mixture path interpolants. On the technical level, a central result is their construction of a smooth velocity field valued on a continuous domain, extending the true velocity field which takes discrete arguments. This in turn allows them to apply approximation results for transformers, and reach error guarantees, alongside norm bounds for the model parameters."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 4}, "strengths": {"value": "The work extends the growing body of works on theoretical analyses of flow-matching models to the discrete case. This extension requires technical extensions such as Lemma 4.4, which allows to bridge from the discrete case to the continuous case. The contribution is, to the best of my awareness, novel and interesting, and will thus prove of interest to the ICLR community. The paper is overall clearly written, and the main technical ideas sufficiently explained and motivated. In this light, I am overall in favor of acceptance; however, I have limited familiarity with the field, and did not read the proofs in detail."}, "weaknesses": {"value": "My main criticism is the lack of sufficient discussion on certain aspects, which I highlight in the questions section."}, "questions": {"value": "- The main weakness of the bound is an error guarantee exhibiting a curse with the effective dimensionality $Md_0$. Could the authors provide more intuition or discussion on why this is the case? Section $6$ discusses the prefactor but not the rate. Notably, it seems that this depends on the choice of the model through $d_0$ and is not a fundamental limitation. If this is the case, could the authors brieflw discuss this point and how it can be refined in future works?\n\n- I understand that the discrete-to-continuous mapping leverages the natural inclusion embedding of $\\mathcal{V}$ in $\\mathbb{R}$, with vocabulary items of higher index receiving larger values. Naively, it seems that this embedding, unlike e.g. one-hot encodings, does not treat all vocabulary items in the same fashion, and is not the most natural embedding. Could the authors comment on this, and how this choice impacts (or not) the bounds?\n- Further motivation on the choice of transformer architectures would be helpful. In particular, many previous works on continuous generative models studied ResNet or auto-encoder architectures (e.g. Boffi et al; Shallow diffusion networks provably learn hidden low-dimensional structure; 2024). Is the transformer particularly adapted to the discrete case, or simply chosen to reflect most practical settings?\n- (Minor) l 266 : \"total variation distance bound scales exponentially with vocabulary size M\" I am confused as I do not see any exponential dependence in Theorem 3.1.\n- I invite the authors to include further comparison with analyses in the continuous case to better highlight the main differences, which would be interesting. In particular, I am wondering whether the authors have an idea how an analysis of the time discretization error would proceed and differ in the discrete setting ?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "wtmSOV0Ogj", "forum": "opc6Qy9FZH", "replyto": "opc6Qy9FZH", "signatures": ["ICLR.cc/2026/Conference/Submission552/Reviewer_8isv"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission552/Reviewer_8isv"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission552/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760606548769, "cdate": 1760606548769, "tmdate": 1762915545369, "mdate": 1762915545369, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper provides the first end-to-end theoretical analysis of Discrete Flow Matching (DFM). It establishes: (1) Intrinsic error bound linking velocity field risk to distributional error; (2)Approximation theory showing Transformers can approximate DFM velocity fields; (3)Estimation theory giving statistical convergence rates for training DFM-Transformers. In summary, the paper produces a complete approximation and estimation theory analogous to classical diffusion and flow matching results but for discrete flow matching."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "(1) The paper proposes a rigorous end-to-end theory for descrete flow matching.\n(2) The chain of results (intrinsic error, approximation error, estimation error) is elegant and well-motivated.\n(3) The derivation of total variation bounds via Kolmogorov equations and Grönwall’s inequality seems technically non-trivial and new."}, "weaknesses": {"value": "(1) The paper currently lacks empirical experiments. In pratice, the is hard to make the training objective to be very small while the error bound relies heavily on terms like \\sqrt(M)exp(M). The resulting guarantees could be loose for typical M, limiting practical interpretability.\n(2) Some modeling assumptions appear stronger than usual, for example, time-Hölder smoothness of CTMC paths, exponentially large UA constants for transformers, and a global velocity-field bound. Clarifying why these are needed and how sensitive the results are to them would improve transparency."}, "questions": {"value": "The theoretical analysis is interesting; I would consider raising my score if the authors address the following question:\n(1) Could the authors analyze error bounds for the out-of-vocabulary (OOV) case, now or in future work? The current theory appears to assume a finite discrete state space; with OOV tokens, how should the problem be treated?\n(2) Recent work (e.g., Dirichlet Flow, H. Stark 2024; Diffusion LM, Shen et al., 2025) models discrete diffusion/flow using cross-entropy objectives that naturally yield KL bounds. Why is MSE chosen here instead, and why analyze total-variation (TV) bounds rather than KL?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "anOGkZRdkW", "forum": "opc6Qy9FZH", "replyto": "opc6Qy9FZH", "signatures": ["ICLR.cc/2026/Conference/Submission552/Reviewer_4jY8"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission552/Reviewer_4jY8"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission552/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761719283938, "cdate": 1761719283938, "tmdate": 1762915545079, "mdate": 1762915545079, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper provides a useful bounds for Conditional Discrete Flow Matching (CDFM)  controlling the sampling error in total variation by a so-called riskk directly linked to the training loss. The authors also provide quantitative universality bounds for Transformers in the context of CDFM."}, "soundness": {"value": 1}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The main body of the paper is well written.\n- The main TV bound is useful\n- The Roadmap on page 6 is a nice addition to the paper to help understand how the proof works."}, "weaknesses": {"value": "Major: the math is particularly clumsy and not to the expected level of a purely theoretical paper.\n- The hypothesis that the velocity approximator is \"factorized\" seems unnecessary\n- The whole Appendix B needs rewritting. In fact, the whole section is a combination of statement and proofs of undergraduate level written in a rather inefficient way. For instance,\n    -  Lemmas B.5 and B.8 are standard undergraduate analysis statements (and the proof of B.8 is incorrect under the assumptions used, it is a common mistake but still...). Similar remarks apply to  part of section D.\n     -  Lemma B.9 and B.6 are so standard they may probably be stated without proof.  Lemma B.10 would be highly simplified by using the Lipchitz constant of (X,Y) -> X+Y and better used of B.5. \n     -  Theorem B.17 is not original and I fail to understand why it is rewritten here or what the proofs written here brings to the discussion.\n- Appendix C has too many problems to be acceptable:\n     -  Lemma C.3 is FALSE!!!!  It is only true if the matrices $U_{t,\\theta}$ commute.  \n     -  Holder inequality seems to be unknown to the authors as they repeatedly bound the L1 norm of a product by the product of the L1 norms.\n     - That being said, I do not doubt the final result, pending replacement of Lemma C.3 by slightly more sophisticated inequality one can obtain using Gronwall Lemma. \n    \nMinor\n- The chosen embedding of vocabulary is non-standard, quite restrictive and an unnecessary hypothesis.\n- The same holds for the timestep embedding.\n- Theorem 4.6 statement is unecessarily complicated, the notations of the space of transformers is not defined  - Lemma 4.4 may be most likely found in a functional analysis book, although in the context of an ML article, reproving it directly as in Appendix E is acceptable.\n- some typos\n- Theorem 4.6 is expected to hold in some form for any architectures for which one is able to prove a quantitative universality theorem. It is not specific to transformers, stating the result only for transformers is rather odd."}, "questions": {"value": "See Weaknesses."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "8VgRaOuC1D", "forum": "opc6Qy9FZH", "replyto": "opc6Qy9FZH", "signatures": ["ICLR.cc/2026/Conference/Submission552/Reviewer_ziA1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission552/Reviewer_ziA1"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission552/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761972801562, "cdate": 1761972801562, "tmdate": 1762915544961, "mdate": 1762915544961, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper provides a useful bounds for Conditional Discrete Flow Matching (CDFM)  controlling the sampling error in total variation by a so-called riskk directly linked to the training loss. The authors also provide quantitative universality bounds for Transformers in the context of CDFM."}, "soundness": {"value": 1}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The main body of the paper is well written.\n- The main TV bound is useful\n- The Roadmap on page 6 is a nice addition to the paper to help understand how the proof works."}, "weaknesses": {"value": "Major: the math is particularly clumsy and not to the expected level of a purely theoretical paper.\n- The hypothesis that the velocity approximator is \"factorized\" seems unnecessary\n- The whole Appendix B needs rewritting. In fact, the whole section is a combination of statement and proofs of undergraduate level written in a rather inefficient way. For instance,\n    -  Lemmas B.5 and B.8 are standard undergraduate analysis statements (and the proof of B.8 is incorrect under the assumptions used, it is a common mistake but still...). Similar remarks apply to  part of section D.\n     -  Lemma B.9 and B.6 are so standard they may probably be stated without proof.  Lemma B.10 would be highly simplified by using the Lipchitz constant of (X,Y) -> X+Y and better used of B.5. \n     -  Theorem B.17 is not original and I fail to understand why it is rewritten here or what the proofs written here brings to the discussion.\n- Appendix C has too many problems to be acceptable:\n     -  Lemma C.3 is TRUE!!!!  It is only true if the matrices $U_{t,\\theta}$ commute.  (CORRECTED I mistakenly stated in was false)\n     -  Holder inequality seems to be unknown to the authors as they repeatedly bound the L1 norm of a product by the product of the L1 norms.\n     - That being said, I do not doubt the final result, pending replacement of Lemma C.3 by slightly more sophisticated inequality one can obtain using Gronwall Lemma. \n    \nMinor\n- The chosen embedding of vocabulary is non-standard, quite restrictive and an unnecessary hypothesis.\n- The same holds for the timestep embedding.\n- Theorem 4.6 statement is unecessarily complicated, the notations of the space of transformers is not defined  - Lemma 4.4 may be most likely found in a functional analysis book, although in the context of an ML article, reproving it directly as in Appendix E is acceptable.\n- some typos\n- Theorem 4.6 is expected to hold in some form for any architectures for which one is able to prove a quantitative universality theorem. It is not specific to transformers, stating the result only for transformers is rather odd."}, "questions": {"value": "See Weaknesses."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "8VgRaOuC1D", "forum": "opc6Qy9FZH", "replyto": "opc6Qy9FZH", "signatures": ["ICLR.cc/2026/Conference/Submission552/Reviewer_ziA1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission552/Reviewer_ziA1"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission552/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761972801562, "cdate": 1761972801562, "tmdate": 1763362003349, "mdate": 1763362003349, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper provides a useful bounds for Conditional Discrete Flow Matching (CDFM)  controlling the sampling error in total variation by a so-called riskk directly linked to the training loss. The authors also provide quantitative universality bounds for Transformers in the context of CDFM."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The main body of the paper is well written.\n- The main TV bound is useful\n- The Roadmap on page 6 is a nice addition to the paper to help understand how the proof works."}, "weaknesses": {"value": "Major: the math is particularly clumsy and not to the expected level of a purely theoretical paper.\n- The hypothesis that the velocity approximator is \"factorized\" seems unnecessary\n- The whole Appendix B needs rewritting. In fact, the whole section is a combination of statement and proofs of undergraduate level written in a rather inefficient way. For instance,\n    -  Lemmas B.5 and B.8 are standard undergraduate analysis statements (and the proof of B.8 is incorrect under the assumptions used, it is a common mistake but still...). Similar remarks apply to  part of section D.\n     -  Lemma B.9 and B.6 are so standard they may probably be stated without proof.  Lemma B.10 would be highly simplified by using the Lipchitz constant of (X,Y) -> X+Y and better used of B.5. \n     -  Theorem B.17 is not original and I fail to understand why it is rewritten here or what the proofs written here brings to the discussion.\n- Appendix C has too many problems to be acceptable:\n     -  Lemma C.3 is TRUE!!!!  It is only true if the matrices $U_{t,\\theta}$ commute.  (CORRECTED I mistakenly stated in was false)\n     -  Holder inequality seems to be unknown to the authors as they repeatedly bound the L1 norm of a product by the product of the L1 norms.\n     - That being said, I do not doubt the final result, pending replacement of Lemma C.3 by slightly more sophisticated inequality one can obtain using Gronwall Lemma. \n    \nMinor\n- The chosen embedding of vocabulary is non-standard, quite restrictive and an unnecessary hypothesis.\n- The same holds for the timestep embedding.\n- Theorem 4.6 statement is unecessarily complicated, the notations of the space of transformers is not defined  - Lemma 4.4 may be most likely found in a functional analysis book, although in the context of an ML article, reproving it directly as in Appendix E is acceptable.\n- some typos\n- Theorem 4.6 is expected to hold in some form for any architectures for which one is able to prove a quantitative universality theorem. It is not specific to transformers, stating the result only for transformers is rather odd."}, "questions": {"value": "See Weaknesses."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "8VgRaOuC1D", "forum": "opc6Qy9FZH", "replyto": "opc6Qy9FZH", "signatures": ["ICLR.cc/2026/Conference/Submission552/Reviewer_ziA1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission552/Reviewer_ziA1"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission552/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761972801562, "cdate": 1761972801562, "tmdate": 1763532858985, "mdate": 1763532858985, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper provides a theoretical analysis of end‐to‐end training of DFM models. They bound the distance between the generated distribution and the true data distribution by the risk of the learned probability velocity. Then this risk is analyzed through two sources: approximation and estimation errors. The approximation error is determined by the capacity of the transformer, and the estimate error is due to the training on a finite dataset. \n\nThe paper provides theoretical justification (for the first time in discrete flow‐matching) that model error can be controlled and that convergence is guaranteed under ideal conditions."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "The paper is well written. To my knowledge this is the first formal proof of convergence for DFM. It provides a valuable theoretical contribution to the growing area of discrete generative modeling and flow‐matching methods. They decompose the errors for learning the probability velocity into the approximation error (due to model architecture) and the estimation error (due to the sample size), assuming that training is done ideally."}, "weaknesses": {"value": "The analysis is built upon a slightly different version of the loss function from the original discrete flow matching (Gat et al, 2024). Maybe it is better to elaborate a bit more on the connection between those loss functions and justify the use of squared $\\ell_2$ as the Bregman divergence. \n\nThere is a connection between discrete diffusion models and discrete flow matching. The original DFM training loss is identical to the masked diffusion training loss. There exists earlier literature on the convergence analysis of the discrete diffusion models. It’s better to include some discussions on the similarity and differences, and novelty compared to earlier works on discrete diffusion.  \n\nIn addition, since the paper only provides upper bounds on the TV distance and probability velocity risk, I feel that it needs some empirical evidence to show how tight those bounds are."}, "questions": {"value": "1. In the original discrete flow matching, the training loss uses cross-entropy terms (see Eq. (28) in Gat et al, 2024). Is it equivalent to the loss term in Eq. (2.10) by using the $\\ell_2$-norm in Bregmann divergence? \n\n2. Does using different form of Bregmann divergence affect the results? \n\n3. In Theorem 3.1, is $T = 1$? How big is $t_0$? \n\n4. Is it possible to show some empirical evidence of the scaling behavior (e.g., $M$, $n$, or $d_0$) on some toy data?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "rHXIhyZxr6", "forum": "opc6Qy9FZH", "replyto": "opc6Qy9FZH", "signatures": ["ICLR.cc/2026/Conference/Submission552/Reviewer_nwxq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission552/Reviewer_nwxq"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission552/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761974754502, "cdate": 1761974754502, "tmdate": 1762915544851, "mdate": 1762915544851, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}