{"id": "91b5jtd492", "number": 12247, "cdate": 1758206571949, "mdate": 1759897522790, "content": {"title": "PRPO: Collaborative Online Policy Learning in Personalized RLHF", "abstract": "Personalizing Large Language Models (LLMs) requires capturing user preferences without centralizing private data, prompting a multi-agent local fine-tuning setup. While on-policy algorithms, as applied to RLHF, are well-suited for preference modeling, their use remains fundamentally single-agent. We present Peer‑Referenced Policy Optimization (PRPO), an online policy‑gradient method that lets privacy‑constrained clients cooperate while keeping trajectories local. PRPO extends Proximal Policy Optimization (PPO) family and treats KL regularizer as a communication channel: each round, every client conditions its update on a composite reference policy created by peer‑to‑peer averaging of action distributions. This distribution‑level exchange preserves trust‑region stability and adds only modest overhead compatible with LoRA adapters. We provide theoretical support for PRPO through general observations and convergence guarantees under limited conditions. We evaluate PRPO on the set of ATARI and Minigrid challenges and in the standard RLHF summarization setting, where it surpasses local PPO - indicating that reference-policy sharing offers a practical path to scalable, privacy-preserving LLM personalization.", "tldr": "", "keywords": ["Reinforcement Learning", "Federated Learning", "Multi-Agent Reinforcement Learning", "Personalization", "Personalized Adaption"], "primary_area": "reinforcement learning", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/372a0e7879f8249832600031920c2f37f50d41a6.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "The paper proposes PRPO, a federated approach to online RL where agents aggregate reference policies instead of model weights. The idea is interesting—replace PPO's reference policy with a peer-averaged one—but the execution has serious problems. The theory doesn't match what's actually implemented, a critical related work (FedRLHF) is completely missing, and the \"personalization\" claims aren't backed up by the experiments. While I appreciate the scope of the experimental work, the foundational issues need substantial fixing before this can be published."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- The problem is important and timely. Privacy-preserving personalized LLM training is something people care about.\n\n- You've put together a substantial experimental evaluation spanning multiple domains. The classical RL experiments (even if I think they don't fit the narrative) and the RLHF experiments represent real work.\n\n- The implementation seems solid. Detailed hyperparameter tables with multiple random seeds. This is good practice.\n\n- The framework generalizes across TRPO/PPO/GRPO, which is nice.\n\n- I appreciate the different communicator designs you explore (uniform, reward-based, similarity-based)."}, "weaknesses": {"value": "### Major Issues\n\n**1. Theory-experiment mismatch (this is the biggest problem)**\n\nYour problem formulation (Eq. 2) optimizes a single policy $\\pi$ on different initial state distributions: $f_i(\\pi) = \\mathbb{E}[f(s_0, \\pi)]$ where $s_0 \\sim \\zeta_i$. But your algorithm (Eqs. 4, 7, 9a) optimizes different policies $\\{\\pi_{\\theta_i}\\}$ for each agent. \n\nThese seem to be contradictory. If the true goal is a single shared policy, why not just use standard federated averaging? If the goal is different personalized policies, why aggregate them at all? Aggregating personalized policies seems counterproductive to personalization. You need to pick one formulation and stick with it, and provide proper justification.\n\n**2. Missing FedRLHF baseline**\n\nFedRLHF (Fan et al., AAMAS 2025) addresses the identical problem:\n- Federated, privacy-preserving \n- Personalized RLHF \n- With convergence guarantees \n- Sample complexity showing linear speedup\n\nThe paper appeared in December 2024, well before the ICLR submission deadline. Not citing or comparing to this work is a critical oversight that immediately calls into question your novelty claims.\n\n**3. Observation 1 is impractical**:\nEquation (12) says $\\varepsilon \\le (\\delta - \\gamma\\lVert \\pi^{(k-1)} - \\pi^{(k)} \\rVert_\\infty)/2$. But to compute this bound at step $k$, you need to know $\\lVert \\pi^{(k-1)} - \\pi^{(k)} \\rVert_\\infty$, which is the quantity you're trying to control! Looking at your experiments (Table 2), you just use fixed \"communication penalty coeff\" values from a grid search. So Observation 1 doesn't actually inform your implementation at all. Why include it?\n\n\n**4. Theorem C.1 doesn't support your claims**\nThe theorem assumes:\n- Convexity (Assumption 1)\n- Uniform averaging $C = (1/n)$  \n- Bounded gradients\n\nYour experiments use:\n- Neural networks (non-convex)\n- Self-preferred averaging with $p \\in \\{0.2, 0.6, 1.0\\}$\n- No gradient bounds\n\nMore importantly, the convergence rate you prove matches standard single-agent mirror descent. You're not showing that collaboration provides any benefit—only that it doesn't break things. That's a much weaker claim than what the introduction suggests.\n\n\n**5. \"Personalization\" is claimed but not demonstrated**\n\nAll your RLHF agents use the same reward model trained on tldr-preference. The pTLDR \"heterogeneous\" setup only varies the data (different subreddits)—not the preferences or objectives.\n\nData heterogeneity ≠ preference heterogeneity.\n\nFor real personalization, you'd need different reward models. Agent 1 might prefer concise summaries, Agent 2 might prefer detailed ones, Agent 3 might want humor, etc. You never test this scenario.\n\nThe improvements in Table 1 could easily be explained by:\n- Regularization (averaging reduces overfitting)\n- Variance reduction  \n- Better hyperparameters for PR-PPO vs baselines\n- Implicit ensembling effects\n\nWithout measuring whether individual agents' policies remain distinct or serve their specific preferences, you can't claim you've demonstrated personalization.\n\n\n**6. Policy aggregation vs weight aggregation is unjustified**\n\nYour core novelty is aggregating policies ($\\sum_j c_{ij}\\,\\pi_j(\\cdot\\mid s)$) instead of weights ($\\sum_j c_{ij}\\,\\theta_j$). But you provide zero theoretical analysis of when/why this is better.\n\nFor linear policies $\\pi_\\theta(a\\mid s) = \\mathrm{softmax}(\\theta^\\top \\phi(s,a))$, aggregating distributions is approximately equivalent to aggregating parameters. For neural networks, the relationship is complex and you don't explore it.\n\nThe experimental comparison to FedAvg isn't obviously fair either. Table 2 shows different hyperparameter grids for different methods. Did you match the total search budget? How do we know FedAvg isn't just under-tuned?\n\n\n\n### Moderate Issues\n\n**7. Literature review gaps**\n\nBeyond FedRLHF, you cited various MARLHF works but don't properly discuss them.\n\nYour related work claims \"none apply RLHF techniques\" and \"no work addresses online RL in federated setting.\" This is inaccurate given the works above.\n\n**8. Classical RL experiments don't fit the narrative**\n\nIn MiniGrid and Atari, all agents solve identical tasks (same FourRooms environment, same BeamRider game). How does this relate to personalization?\n\nIf agents have the same objective, why would policy aggregation help? Maybe variance reduction? Exploration diversity? You don't analyze or explain this. The experiments are fine, but they don't support your main story about personalization.\n\n**9. Evaluation methodology concerns**\n\n- LLM-as-judge has known biases (length, verbosity, style)\n- No human evaluation baseline\n- No statistical significance testing  \n- No inter-rater reliability metrics\n- EVP aggregates over hyperparameter searches with different search spaces (Table 2), making comparison potentially unfair\n\n**10. The reward model defeats privacy claims**\n\nYou train a single reward model on centralized tldr-preference data. If you have privacy constraints preventing you from centralizing training data, wouldn't you also have constraints on centralizing preference data for the reward model?\n\nTrue federated RLHF should involve learning personalized reward models locally (See FedRLHF, Fan et al. AAMAS 2025). That's the real challenge, and you don't address it."}, "questions": {"value": "1. **Problem formulation**: Equation (2) optimizes single policy $\\pi$, but equations (4)/(7)/(9a) optimize different policies $\\{\\pi_i\\}$. Which is correct? How do you reconcile this?\n\n2. **FedRLHF**: Why isn't FedRLHF (arXiv:2412.15538) cited or compared? How does your approach differ?\n\n3. **Observation 1 implementation**: How do you implement equation (12) given its dependency on $\\lVert \\pi^{(k-1)} - \\pi^{(k)} \\rVert_\\infty$? Why do experiments use fixed penalty coefficients?\n\n4. **Personalization**: Can you provide experiments where agents have genuinely different objectives (different reward models)? How do you measure whether policies remain personalized?\n\n5. **Theorem C.1 applicability**: Your theorem assumes convexity and uniform averaging, but experiments use neural networks and self-preferred averaging. How does the theorem inform your work?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "pKpqkKVlXx", "forum": "91b5jtd492", "replyto": "91b5jtd492", "signatures": ["ICLR.cc/2026/Conference/Submission12247/Reviewer_h6As"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission12247/Reviewer_h6As"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission12247/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761583847674, "cdate": 1761583847674, "tmdate": 1762923189478, "mdate": 1762923189478, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper studies personalization for online RLHF with heterogeneous agents. It proposes Peer-Referenced Policy Optimization (PRPO), which allows each client to perform on-policy RL updates while being regularized toward a peer-aggregated reference policy constructed via policy distribution communication, instead of relying only on its own past policy. The method is evaluated in both standard RL control tasks and multi-agent RLHF summarization."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "The main advantages are: (1) the problem formulation — decentralized, privacy-constrained online RLHF with heterogeneous clients — is largely unexplored compared to prior work that treats federated alignment as offline supervised fine-tuning or simple weight sharing; and (2) the proposed peer-referenced policy optimization algorithm is itself new, in that it uses a communicated, aggregated reference policy at the distribution level to shape each client’s on-policy updatThe main advantages are: (1) the problem formulation — decentralized, privacy-constrained online RLHF with heterogeneous clients — is largely unexplored compared to prior work that treats federated alignment as offline supervised fine-tuning or simple weight sharing; and (2) the proposed peer-referenced policy optimization algorithm is itself new, in that it uses a communicated, aggregated reference policy at the distribution level to shape each client’s on-policy update.e."}, "weaknesses": {"value": "1. The problem formulation in Section 3.1 does not seem fully aligned with the stated motivation. The motivation is to train multiple users to personalize LLMs using online reinforcement learning under private communication constraints, but the formulation assumes one fixed reward for all users, whereas in practice different users would likely have different reward models.\n2. The related work section lists connections to federated LLM fine-tuning, federated RLHF, and multi-agent RL, but it does not clearly explain why these directions are directly relevant to the proposed setting before emphasizing differences.\n3. The classical RL experiments use three agents but do not clearly establish true heterogeneity between them, so it is unclear whether this setup actually reflects the “heterogeneous clients” described in the motivation."}, "questions": {"value": "1. Can the authors clarify how the single shared reward in Section 3.1 matches the goal of per-user personalized alignment? Is this addressed by the RLHF experiment design?\n2. If multi-agent RL is considered closely related, why are the experimental comparisons limited to federated RL baselines and not MARL baselines? If communication is the main link, does the proposed communication operator directly draw from any existing MARL techniques?\n3. In the GRPO-based methods, many recent GRPO-style approaches appear to downweight or remove the KL-divergence penalty in practice. If the KL term is not essential, could the authors report RLHF results for a GRPO variant without the KL penalty (e.g., “Dr. GRPO”) to isolate the effect of peer-referenced KL regularization?\n4. For the “isolated” PPO / GRPO baselines, are these models trained separately per agent on that agent’s own local data, or is there a single global model trained on all data pooled together?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "VMY2RQlPCV", "forum": "91b5jtd492", "replyto": "91b5jtd492", "signatures": ["ICLR.cc/2026/Conference/Submission12247/Reviewer_f5Mc"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission12247/Reviewer_f5Mc"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission12247/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761635740595, "cdate": 1761635740595, "tmdate": 1762923188743, "mdate": 1762923188743, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces Peer-Referenced Policy Optimization (PRPO), which turns the KL regularizer in proximal policy methods into a communication channel, where each client updates its policy against a composite reference policy formed by weighted averaging peers’ action distributions rather than the old policy of the client used by standard proximal policy algorithms. The authors applies peer-referenced KL on PPO and GRPO, and explores several non-expansive communication operator, including uniform average, self-preferred, policy similarity, and reward-weighted averaging. Empirical results show the effectiveness of PRPO over isolated training and FedAvg on both classical RL and RLHF tasks. The paper provides theoretical intuition through mirror-descent style analysis, showing that if the communication operator is non-expansive, PRPO preserves the trust-region guarantees of TRPO and thus admits convergence under restricted conditions."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. The idea of recasting the KL penalty term as a coordination mechanism is simple yet effective, and can serve as a plug-and-play generalization of PPO-type algorithms to collaborative settings.\n2. The authors provide detailed experimental settings and a reproducible codebase."}, "weaknesses": {"value": "1. The convergence proof in Appendix C assumes convex, L‑smooth objectives with bounded gradients, which generally does not hold for RLHF with neural policies. Moreover, the theorem is proved only for uniform policy averaging the communicator $C=(c_{ij}) =\\frac{1}{n}$ but neglecting the other practical adaptive communicators (e.g., similarity-based or reward-weighted) used in the experiments. It is unclear whether the guarantees extend to those practical communicators.\n2. LoRA adapters and distribution‑level policy sharing are used for privacy preserving. However, it's questionable that whether privacy can indeed by guaranteed, as the paper provides no formal privacy analysis, especially considering prior works of inversion attacks [1,2].\n3. Most plots report average performance across agents, making it unclear whether every user benefits or whether some suffer negative transfer under a weighted reference policy.\n4. The similarity-based communicator and reward‑based communicator are used in classical RL experiments, but not evaluated in the RLHF experiments, where only the self‑preferred mean aggregation is used.\n5. The RLHF evaluation is limited to TL;DR summarization with a single base model (i.e., `Mistral-7B`). Robustness would be more convincing with additional tasks (e.g., dialogue such as UltraFeedback) and alternative/larger base models.\n6. Some important related works that handle preference heterogeneity at the reward‑model level are missing [3,4].\n\n[1] Carlini, Nicholas, et al. \"Extracting training data from large language models.\" 30th USENIX security symposium (USENIX Security 21). 2021.  \n[2] Petrov, Ivo, et al. \"Dager: Exact gradient inversion for large language models.\" Advances in Neural Information Processing Systems 37 (2024): 87801-87830.  \n[3] Park, Chanwoo, et al. \"Rlhf from heterogeneous feedback via personalization and preference aggregation.\" arXiv preprint arXiv:2405.00254 (2024).  \n[4] Liu, Renpu, et al. \"A Shared Low-Rank Adaptation Approach to Personalized RLHF.\" arXiv preprint arXiv:2503.19201 (2025)."}, "questions": {"value": "Please see the weakness section. In addition, I have the following questions:\n\n1. Given multiple plausible communicators, how should practitioners select or adapt the communicator for a given task? Do you have criteria or an automated procedure for this choice?\n2. How would PRPO behave when agents have different or even conflicting reward functions (e.g., divergent user preferences over the same prompt for RLHF). As the current communicators perform linear averaging, could cross‑agent influence harm some agents’ local policies? If so, can PRPO detect or mitigate this?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "mLdnuWcztF", "forum": "91b5jtd492", "replyto": "91b5jtd492", "signatures": ["ICLR.cc/2026/Conference/Submission12247/Reviewer_Nu9K"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission12247/Reviewer_Nu9K"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission12247/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762269308682, "cdate": 1762269308682, "tmdate": 1762923188194, "mdate": 1762923188194, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes Peer-Referenced Policy Optimization (PRPO), a distributed reinforcement learning (RL) framework applied to both classical RL tasks and large language model (LLM) personalization via reinforcement learning from human feedback (RLHF). The authors introduce policy-based communication protocols, namely PR-PPO, PR-GRPO, and PR-TRPO, which enable multiple agents to update their local policies using shared peer information without directly sharing private data. The main claims are that PRPO enables effective collaboration while preserving data privacy and that the resulting policies outperform standard baselines such as PPO, even in federated RLHF settings. Experiments cover classic continuous-control benchmarks and a summarization task using LLMs, with performance gains reported under decentralized communication."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "The policy-based communication scheme appears to be an original and promising alternative to weight-based federated learning, especially for RL settings where local policy distributions can capture useful structural information. The experimental results suggest performance improvements in both control and RLHF tasks, and the availability of open-source code enhances the reproducibility of the findings. The theoretical framework is grounded in existing policy optimization methods and offers generalization across TRPO, PPO, and GRPO variants."}, "weaknesses": {"value": "Several conceptual and applied weaknesses limit the impact of this work. The privacy assumptions and models are not well-defined: while communicating policies avoids sharing raw data, it is unclear whether this is preferable to sharing low-rank weight updates, such as LoRA adapters. The experimental evaluation lacks analysis of communication overhead, scalability, and stability in larger multi-agent systems. The claims about LLM personalization are underdeveloped: the paper does not address how user-specific preference data is incorporated or whether federated RLHF aligns with personalization goals. There are multiple notational inconsistencies and typos that detract from clarity, and a lack of clear discussions in the main text (e.g., convergence) makes the work feel incomplete."}, "questions": {"value": "What is the precise privacy threat model being addressed in PRPO? How does sharing policies differ from sharing model weights in regard to data leakage or reconstruction risks, especially in the LLM case?\n\nHow is it possible for PR-PPO or PR-GRPO to outperform centralized PPO in RLHF tasks? Were the total number of training rounds or samples equivalent? Additional details would clarify whether the comparison is fair.\n\nCan the authors provide more detail on the communication cost and memory footprint of PRPO in multi-agent LLM scenarios, particularly under scaling to dozens or hundreds of agents?\n\nSince personalization is a key application claim, how does the method incorporate user-specific reward structures or feedback? Would aggregating in the policy space dilute personalization, especially in diverse preference settings?\n\nWhy do the RLHF experiments only use a single communication protocol? Would the other peer-referenced protocols satisfy the right-stochastic condition and be viable in the same scenario?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "R0bEO6MT2g", "forum": "91b5jtd492", "replyto": "91b5jtd492", "signatures": ["ICLR.cc/2026/Conference/Submission12247/Reviewer_5Gm1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission12247/Reviewer_5Gm1"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission12247/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762401101118, "cdate": 1762401101118, "tmdate": 1762923187743, "mdate": 1762923187743, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}