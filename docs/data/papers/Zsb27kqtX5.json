{"id": "Zsb27kqtX5", "number": 11251, "cdate": 1758194355837, "mdate": 1759897598422, "content": {"title": "On the Collapse of Generative Paths: A Criterion and Correction for Diffusion Steering", "abstract": "Inference-time steering is vital for adapting large-scale diffusion models to scientific and creative tasks. A powerful and widely-used steering paradigm is the ratio-of-densities, which reweights the data landscape to amplify desired attributes, such as in classifier-free guidance. However, this method harbors a critical, previously unformalized failure mode: Marginal Path Collapse. We show that even when the start and end points of the generative process are valid distributions, the path between them can break down, causing the intermediate densities to become mathematically ill-defined. This is not a rare edge case but a systematic flaw affecting most popular noise schedules, especially when composing heterogeneous models.\n    In this work, we provide a complete solution. First, we establish a rigorous path existence criterion, a simple diagnostic test that precisely predicts the onset of collapse. Second, based on this criterion, we develop Adaptive path Correction with Exponents (ACE), a principled framework that provably prevents collapse. By extending the Feynman-Kac partial differential equation for generative control to support time-varying exponents, ACE dynamically adjusts the steering weights to guarantee a valid probability path from noise to data. We validate our framework on synthetic benchmarks, where ACE eliminates collapse and reduces distributional error by over 5x compared to prior methods. We then demonstrate its practical necessity in the high-stakes application of molecular design, where ACE enables stable scaffold-based optimization that is unattainable with existing techniques. Our work transforms ratio-of-densities steering from an unstable heuristic into a robust and theoretically-grounded tool for controllable generation.", "tldr": "Ratio-of-densities steering in diffusion models breaks via Marginal Path Collapse. We introduce ACE, a provably stable correction that prevents collapse, cuts error >5×, and enables reliable molecular design.", "keywords": ["Diffusion Model", "Flow Matching", "Inference-time Steering", "Feynman-Kac", "Probability Path", "Scaffold Decoration", "Compositional Image Generation"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/6f261412c3bb121c5f3b88e23ca9d6104915fb6e.pdf", "supplementary_material": "/attachment/12c90aa72d722701cb9559afc185162f95bf5f10.pdf"}, "replies": [{"content": {"summary": {"value": "This paper identifies a phenomenon in diffusion model guidance termed \"Marginal Path Collapse\" and argues for its negative impact on generation quality. The authors theoretically propose a criterion to predict such collapse and introduce an Adaptive Path Correction with Exponents, ACE method. ACE dynamically adjusts steering weights to ensure a valid probability path, thereby eliminating marginal path collapse."}, "soundness": {"value": 2}, "presentation": {"value": 1}, "contribution": {"value": 2}, "strengths": {"value": "The theoretically inspired perspective of this work is valuable. By highlighting \"Marginal Path Collapse\", a phenomenon previously overlooked in the literature, the paper provides a complementary viewpoint for inference-time control in diffusion models."}, "weaknesses": {"value": "1. Substantial improvements to writing clarity are needed:\nBackground context for foundational concepts is insufficiently explained before introducing abstract formulations. For example:\n    - The origin of the \"ratio-of-densities\" problem (e.g., the core principles of classifier-free guidance and contrastive decoding, and how these methods lead to the ratio-of-densities form) remains unclear in the main text. The definition of \"experts\" in the context of these methods is not specified.\n    - The Feynman–Kac Correctors method, which is repeatedly compared throughout the paper, lacks explicit mathematical formulations. \n\n2. The significance of Marginal Path Collapse problem are not convincing. See specific questions below for further details.\n\n3. Experimental design is either unreasonable or inadequately described:Key aspects of the experimental setup are unclear, making it difficult to assess the validity of results. See specific questions below.\n\n4. Minor notation issues: \n    - Line 408: The conditional independence notation is better be standardized to A⫫ Y | X\n    - Lines 417 and 432: Extra \".\" is present."}, "questions": {"value": "1. Is the key cause of \"collapse\" the use of different noise schedules across experts? Would this scenario hold in practical applications? \n\n2. I also have some intuitive observations to discuss with the authors: If all experts adopt the same noise schedule, collapse seems unlikely, for the following reasons:\n    - In Classifier-Free Guidance (CFG), conditional and unconditional generative models are trained simultaneously. The support of the conditional distribution p is typically contained within the support of the unconditional distribution q—since data used for conditional training can always be reused for unconditional training, the density ratio of \\(x_0\\) (i.e., \\(p(x_0)/q(x_0)\\)) should never involve division by zero.\n    -  The conditional distribution p often exhibits sharper concentration with lighter tails than the unconditional distribution q. For example, if q is a Gaussian distribution with a large variance, p might be a Gaussian with a smaller variance. Since p has lighter tails, the density ratio \\(\\log(p(x_t)/q(x_t))\\) would still integrable. \n    - At intermediate diffusion timesteps t, the shared noise schedule ensures p still has lighter tails, having no occurrence of collapse.\n\n1. For Figure 3, could visualizations of generated results from different methods be added? Such visualizations would intuitively illustrate how Marginal Path Collapse affects generation quality.\n\n2. Even if Marginal Path Collapse occurs, the Classifier-Free Guidance (CFG) algorithm itself seems unaffected—given that CFG only relies on log-gradient information of densities. In the Gaussian example provided: even if the density is non-integrable  due to a positive coefficient in the exponent, taking the log and computing the gradient can still yields a finite gradient.  If collapse occurs over a small number of steps or with small step sizes, generation quality may still remain acceptable. Can the authors use experimental results to show how the duration of the collapse interval influences generation quality? This would help demonstrate that collapse can truly impairs CFG performance. \n\n3. Out of curiosity: Does Classifier Guidance avoid the collapse problem? Its marginal density involves multiplying (rather than dividing) probability densities, which may prevent the issues caused by division in ratio-of-densities forms.\n\n4. The experimental design of the \"Synthetic Checker Dataset\" is unclear, and its rationality needs clarification: \n    - Among the pre-trained experts, which one learns the joint distribution of x and y as a checkerboard distribution? Lines 377–408: Mathematical notations do not mention the checkerboard distribution or the introduction of the [-4, 4] region boundary. Is it assumed that these experts learn checkerboard distributions within a square region under specific conditions—e.g., the first two experts operate under the conditions $x \\geq 0$ and $x + y \\geq 0$? If this is the case, is the third expert (a 1D unconditional model for p(x)) a uniform distribution over \\([-4, 4]\\)? \n    - This setup seems counterintuitive: In typical CFG applications, experts usually model distributions of the same dimensionality. For instance, in this 2D problem, all experts should ideally model 2D distributions (e.g., checkerboard distributions within a square region, with some experts incorporating additional conditions like $x \\geq 0$ and $x + y \\geq 0$. \n\n5. For the \"Flexible-pose scaffolding decoration\" experiment, what are the specific definitions of each expert? The appendix mentions DiffSBDD, GeoDiff, and EDM—but the latter two models do not natively incorporate pocket information. How were they adapted to achieve the dual goals of \"preserving topology while adapting to the pocket\"? Additionally, citations for these methods are missing."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "5TMnJE0DIY", "forum": "Zsb27kqtX5", "replyto": "Zsb27kqtX5", "signatures": ["ICLR.cc/2026/Conference/Submission11251/Reviewer_naNy"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11251/Reviewer_naNy"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission11251/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761794664510, "cdate": 1761794664510, "tmdate": 1762922410206, "mdate": 1762922410206, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper investigates a fundamental failure mode of ratio-of-densities diffusion steering, termed Marginal Path Collapse (MPC), which occurs when intermediate densities along a steered generative path become non-normalizable. This leads to catastrophic sampling failures, particularly when composing heterogeneous pretrained models.\n\nTo address this, the authors first introduce the Path Existence Criterion (PEC), which predicts when MPC will occur, and then propose Adaptive path Correction with Exponents (ACE), which dynamically adjusts the steering exponents via a bump function to ensure the PEC holds throughout the entire trajectory, while preserving the endpoint marginals.\n\nThe method is evaluated on both a synthetic 2D Checkerboard benchmark and a flexible-pose scaffold decoration task for molecular design, demonstrating theoretical soundness and strong empirical performance."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "- The contribution is twofold and novel within diffusion steering: the paper clearly identifies MPC as a failure mode and introduces PEC and ACE as elegant, principled solutions.\n\n- The method can be applied in general ratio-of-densities steering settings.\n\n- The synthetic benchmarks convincingly demonstrate the MPC phenomenon and correction.\n\n- The molecular design experiments (Tables 2–3) show ACE enabling valid and chemically meaningful samples where FKC fails, with improved docking scores."}, "weaknesses": {"value": "- The notation and derivations are somewhat heavy; for instance, Theorem 2.3 could be presented with more clarity. A pseudo-code summary of ACE would greatly improve readability.\n\n- The paper does not clearly explain how to choose the bump coefficient B.\n\n- A few minor typos remain: \"frequently violate the ...\" (around line 239), \"Assume that the sum Assume ...\" (around line 263), beginning of 3.1."}, "questions": {"value": "- Are there any computational challenges associated with ACE? For example, does it require finer path discretization at inference time?\n\n- What are the trade-offs involved in selecting B? It seems that choosing a sufficiently large B will always satisfy the PEC, but could that introduce undesirable irregularities in the path or increased inference cost?\n\n- Is there a particular reason not to use ACE with ODE samplers?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "J6NHPM4rMR", "forum": "Zsb27kqtX5", "replyto": "Zsb27kqtX5", "signatures": ["ICLR.cc/2026/Conference/Submission11251/Reviewer_jeuE"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11251/Reviewer_jeuE"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission11251/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761844784160, "cdate": 1761844784160, "tmdate": 1762922409683, "mdate": 1762922409683, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper first identifies Marginal Mode Collapse, a failure mode of current ratio-of-densities based inference-time steering schemes for diffusion models. Then, the authors provide a diagnostic test to predict whether this problematic phenomenon will occur during the sampling path. Next, they present ACE, a framework that extends FKC with time-varying exponents dynamically scheduled to prevent such model collapse issue. Ultimately, they evaluate the method in synthetic as well as molecular design experiments."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "- The paper is very well structured and written. All sections and contributions are both well-motivated and well presented. \n\n- The problem identified and tackled seems practically relevant, especially from a conceptual standpoint.\n\n- The presented diagnostic tool as well as algorithmic solution seem principled, practical, and useful."}, "weaknesses": {"value": "- (main concern) The relevance of the entire work relies on the existence of a theoretically-identified phenomenon. Nonetheless, concrete evidence of it seems somewhat weak. At least to my understanding, this is not well investigated in the current experimental sec., while in principle this should be possible by e.g. measuring how frequently it occurs in practice with near-optimal parameters. Currently, (1) the synthetic experiments seems to be specifically designed s.t. it occurs (as mentioned in lines 409-410), for which I fail to see how this is 'a realistic testbed' (as mentioned in line 409) - especially the third scheduler within the note ($\\alpha^3$) seems particularly adversarial. Moreover, (2) in the molecular design experiments it is somewhat unclear if the gains are due to better tuning of the scheme or effective occurrence of the presented mode collapse phenomenon, as this, again, does not seem to be measured.\n\n\nAlthough it tackles a very specific problem, I believe that the overall work is relevant, presents potentially useful contributions, and well-written. Nonetheless, the entire relevance relies on the aforementioned point, which currently seems presented/argued in a seemingly very brittle fashion not sufficiently supported by experimental evidence."}, "questions": {"value": "Answers to the following points would be quite essential to better assess this work.\n\n- Could you clarify the points mentioned within the weaknesses section?\n\n- Could you evaluate experimentally the occurrence of the presented phenomenon in (1) truly realistic synthetic settings, and (2) in the molecular design task without using ACE?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "H0QhDc3z1h", "forum": "Zsb27kqtX5", "replyto": "Zsb27kqtX5", "signatures": ["ICLR.cc/2026/Conference/Submission11251/Reviewer_TtEF"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11251/Reviewer_TtEF"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission11251/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761942536321, "cdate": 1761942536321, "tmdate": 1762922409154, "mdate": 1762922409154, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper identifies the so-called path-collapse phenomenon in generative methods using stochastic interpolation $q_t \\sim \\alpha_t X_0 + \\beta_t X_1$ between a Gaussian $X_0 \\sim \\mathcal{N}(0,I)$ and a compactly supported distribution $X_1 \\sim q_1$.\nThis phenomenon appears when trying to combine multiple generative models (with different dimensions and interpolation schedules) to sample from a quotient of densities\n$h_1 = \\prod_{i=1}^M (q_1^{(i)})^{\\gamma_i}$ for $\\gamma_i \\in \\mathbb{R}$\nof the constituent models due to possible non-integrability of the ratio $h_t = \\prod_{i=1}^M (q_t^{(i)})^{\\gamma_i}\\,,$ of the interpolated densities $q_t^{(i)}$ (even if the endpoints are integrable)\ni.e. $h_t \\notin L^1$ even if $h_0, h_1 \\in L^1$.\nThe paper provides a necessary and sufficient criterion to identify when $h_t \\in L^1$ in terms of $\\gamma_i$ and $\\alpha_t$.\nFurthermore, in case $h_t \\notin L^1$, the authors show that one can always, as a remedy, add a time-varying bump function $\\tilde{\\gamma}_i(t) = \\gamma_i + B_i t(1-t)$ for some constants $B_i > 0$ to the exponents such that after this modification $\\tilde{h}_t \\in L^1$ and the endpoints are preserved: $\\tilde{h}_0 = h_0$ and $\\tilde{h}_1 = h_1$.\nMoreover, it is shown how to modify the Feynman-Kac PDE to sample from $\\tilde{h}_1$, while evolving only via the marginal\nFinally the authors provide toy and real-world examples in conditional molecule and image generation showing that preventing this path-collapse improves existing results such as No Resampling in CFG."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "Calling attention to the potential existence of degeneracies of marginal distributions when combining multiple generative models."}, "weaknesses": {"value": "The authors introduce the ratio-of-density paradigm, namely sampling from $p(x)^{\\gamma_1}/q(x)^{\\gamma_2}$, and propose remedies within this framework.\nHowever, they spend little time in explaining what generative tasks and processes fit into this framework in general, both in the main text and well as the appendix.\nOnly from the examples in Section 2.5 or 3 can the reader infer some of the concrete use cases, which are, however, difficult to parse for readers without intuition and background in molecule and image generation.\nThe authors should first provide a list of general problems (such as e.g. CFG and product of experts) and show mathematically (!) how these can be posed as ratio-of-densities steering problems that require (!) the intermediate densities $h_t$ for $t \\in [0,1]$ in the corresponding SDE/ODE flow.\nOnly then it is clear why the problem the authors solve is relevant, which is not the case of for the current version. \n\nMinor details:\n* Add reference for Proposition B.2 in the appendix\n* Fix Remark in Appendix B.2: $P_0(x) = 1_{[0,1]}(x) \\text{\\ and\\ } Q_0(x) = 2(1-x) 1_{[0,1]}(x)$\nare two probability densities with compact support, but $P_0(x)/Q_0(x)$ is not integrable. Also Lemma 4.6 is not defined.\n* More clear wording (e.g. unbounded domain instead of infinite domain)\n* Proof of Corollary B.1 shows only one direction. Mention this or add other implication as well.\n* Proof of Proposition B.5 is unfinished (see last few lines of the proof). Also not clear why one shows a lower bound, since the statement in the proof concerns with upper bound only. Lower bound should be established separately if needed later.\n* Duplicate wording in Theorem 2.2\n* Unclear symbol S(t) on page 5, did they mean C(t) ?\n* Unexplained symbols in Section 2.5 such as $\\mathcal{T}(\\mathcal{M})$ or $\\leftrightarrow$ and equation 2.1 or 2.2 undefined \n* In the proof of Theorem B.2 it is stated that $q_t^{(i)}$ is the result of the convolution of a Gaussian and a compactly supported distribution. But then the support of $q_t^{(i)}$ is unbounded, contradicting the definition of $R_t^{(i)}$"}, "questions": {"value": "* How exactly are the intermediate densities $h_t$ for $t \\in [0,1]$ required for sampling from $h_1$? \n\n\nLimitations:\nIt is assumed that the stochastic interpolation is between a Gaussian and compactly supported distribution."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "grt1XOKC3C", "forum": "Zsb27kqtX5", "replyto": "Zsb27kqtX5", "signatures": ["ICLR.cc/2026/Conference/Submission11251/Reviewer_gBQy"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission11251/Reviewer_gBQy"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission11251/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761984795568, "cdate": 1761984795568, "tmdate": 1762922408669, "mdate": 1762922408669, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}