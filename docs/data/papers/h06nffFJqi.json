{"id": "h06nffFJqi", "number": 21319, "cdate": 1758316198796, "mdate": 1759896928732, "content": {"title": "What Exactly Does Guidance Do in Masked Discrete Diffusion Models", "abstract": "Masked discrete diffusion models have been gaining popularity recently, and classifier-free guidance, just like its continuous counterpart, has been proposed to enable efficacious conditional generation by discrete diffusion. To quantify the precise effect of discrete guidance, this article considers masked discrete diffusion with arbitrary data distribution in low dimension, so that \n   the distribution that guided masked discrete diffusion samples from, as well as the sampling dynamics, can be analytically and exactly quantified and interpreted. When the full data distribution is a mixture over classes and the goal is to sample from a specific class, guidance amplifies class-specific regions while suppresses regions shared with other classes. This effect depends on the guidance strength $w$ and induces distinct covariance structures in the sampled distribution. Notably, we observe quantitatively different behaviors in $1$D and $2$D.  We also show that for large $w$, the decay rate of the total variation ($\\text{TV}$) along the reverse dynamics is double-exponential in $w$ for both $1$D and $2$D. These findings highlight the role of guidance, not just in shaping the output distribution, but also in controlling the dynamics of the sampling trajectory. Our theoretical analysis is supported by experiments that illustrate the geometric effects of guidance and its impact on convergence.", "tldr": "A theoretical analysis of the generation in masked discrete diffusion with CFG", "keywords": ["Discrete Diffusion Models; Classifier-free Guidance"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/4cb26e1854035fd8e774fc86c28678798da327d0.pdf", "supplementary_material": "/attachment/d4787ab1203861a9adb56c7fc842e157614bd090.zip"}, "replies": [{"content": {"summary": {"value": "This paper provides a theoretical analysis of classifier-free guidance (CFG) in masked discrete diffusion models. In 1D, the guided reverse process exactly recovers the tilted distribution. In 2D, deviations emerge: the final distribution is a reweighted version of the tilted distribution, with mass suppressed even in regions overlapping only in projection.\n\nThe authors derive closed-form expressions in both settings and show that convergence to the final distribution exhibits double-exponential decay in the guidance strength w. Experiments in higher dimensions (5D, MNIST) confirm that these geometric effects—amplifying private regions and suppressing ambiguous ones—persist beyond low-dimensional cases."}, "soundness": {"value": 4}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "I like this work. The paper is well-written and clear. It presents a novel theoretical insight into how classifier-free guidance (CFG) affects discrete diffusion sampling, with concrete examples and rigorous proofs. The authors also provide high-dimensional experiments to support the generality of their findings."}, "weaknesses": {"value": "It would be interesting to discuss how this effect manifests in practical applications, and how the misalignment introduced by CFG could be addressed in real-world settings."}, "questions": {"value": "See weakness."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "HYLBo4EHwO", "forum": "h06nffFJqi", "replyto": "h06nffFJqi", "signatures": ["ICLR.cc/2026/Conference/Submission21319/Reviewer_XFWx"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21319/Reviewer_XFWx"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission21319/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1760949086878, "cdate": 1760949086878, "tmdate": 1762941691937, "mdate": 1762941691937, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper develops the first rigorous quantitative theory explaining the role of classifier-free guidance (CFG) in masked discrete diffusion models.\nThe authors analyze low-dimensional cases (1D and 2D) where the reverse dynamics can be solved exactly. Their results show that:\n- Guidance amplifies class-specific regions while suppressing overlapping regions between classes, with overlap vanishing as guidance strength $w$ increases.\n- In 1D, the generated distribution exactly matches the tilted distribution $p_{z,w} \\propto p(x)p(z|x)^{1+w}$.\n- In 2D, deviations emerge but can be expressed in closed form via coupling coefficients $c_x,d_x$.\n- The convergence rate of the reverse dynamics exhibits a double-exponential dependence on w in both 1D and 2D.\nEmpirical illustrations confirm the theoretical predictions."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "- Novel theoretical framework: First rigorous analysis of discrete CFG dynamics.\n- Analytic tractability: Closed-form results for both 1D and 2D masked diffusion.\n- Clear phenomena: Demonstrates class-specific amplification and overlap suppression quantitatively.\n- Double-exponential convergence: Elegant link between guidance strength and diffusion rate.\n- Bridges gaps: Unifies discrete and continuous CFG theories.\n- Empirical alignment: Simulations verify analytical predictions."}, "weaknesses": {"value": "- Heavy reliance on exact score and continuous-time limit; numerical approximations and learned scores are not analyzed.\n- Empirical validation is illustrative rather than large-scale.\n- Some proofs deferred to appendices could benefit from intuitive discussion in the main text.\n- Limited exploration of $D \\ge 3$ behavior; higher-dimensional extension remains conjectural.\n- Minor presentation complexity (dense notation, multi-index expressions)."}, "questions": {"value": "- Could the authors extend the proof techniques to approximate scores (learned $s_\\theta$) or noisy simulations?\n- How sensitive are the observed phenomena to the choice of the forward process (absorbing vs. uniform)?\n- Is the double-exponential convergence rate provably tight, or an upper bound?\n- In 2D, does the deviation from the tilted distribution scale polynomially or exponentially in overlap size?\n- Could these results suggest a new adaptive guidance schedule where w increases dynamically?\n- How might the regional weighting structure $A^{z,w}_i$ inform geometry-aware training or regularization?\n- Are there potential connections to discrete optimal transport or entropic regularization frameworks?\n- Could the asymptotic results be empirically observed in token-level text diffusion models?\n- Are the coefficients $c_x,d_x$ interpretable as marginal reweighting factors for token dependencies?\n- How might partial overlapping supports in high dimensions influence generalization or calibration?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "wiSKBnKLw9", "forum": "h06nffFJqi", "replyto": "h06nffFJqi", "signatures": ["ICLR.cc/2026/Conference/Submission21319/Reviewer_wYwP"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21319/Reviewer_wYwP"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission21319/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761926452874, "cdate": 1761926452874, "tmdate": 1762941691682, "mdate": 1762941691682, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper extend the analysis of CFG in continuous state diffusion to the masked discrete state diffusion. It has two main results:\n\n* In 1d situation, for masked discrete state diffusion, with direct construct of \\\\(\\hat{Q}\\\\), we can reach the tilted distribution.\n* In 2d situations, it is not that simple.\n* This paper also proposes some analysis on multi-guide situation."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "* The theoretical analysis and calculations are solid, especially the ability to derive exact distribution results— outperforming continuous-state diffusion on CFG in the 1D case.\n* The inclusion of the multi-guidance setting adds depth and richness to the paper."}, "weaknesses": {"value": "* Unfortunately, the 1D setting is overly simplistic. While the proposed techniques are effective in 1D, they become increasingly complex in * 2D and are difficult to generalize to higher dimensions due to inherent limitations.\n* The experimental evaluation relies too heavily on toy examples, which weakens the practical impact of the work."}, "questions": {"value": "n/a"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "vHJE7KA9nC", "forum": "h06nffFJqi", "replyto": "h06nffFJqi", "signatures": ["ICLR.cc/2026/Conference/Submission21319/Reviewer_9vfg"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21319/Reviewer_9vfg"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission21319/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761971560891, "cdate": 1761971560891, "tmdate": 1762941691409, "mdate": 1762941691409, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper provides a rigorous analysis of classifier-free guidance (CFG) for masked discrete diffusion. Under exact scores and exact reverse dynamics, the authors derive closed-form reverse dynamics and generated distributions in 1D and 2D. In 1D, CFG precisely samples from the tilted distribution pz,w, whereas in 2D, the generated distribution deviates with explicit marginal dependent reweighting, shifting mass from overlapping to class-specific regions. For large guidance strength $w$, the total variation (TV) to the terminal distribution decays in time with a rate that is double-exponential in $w$. The paper features experiments on synthetic 1D, 2D and higher-dimensional toy setups, plus MNIST case studies, which qualitatively support the theory."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "(i) The paper provides the first rigorous treatment of CFG in discrete masked diffusion with explicit formulas in 1D and 2D\n\n(ii) The paper provides clear geometric interpretation. Guidance suppresses overlapping regions and amplifies \"private\" regions, quantified via region-wise weights in 2D\n\n(iii) The paper's simple, targeted experiments align with theory"}, "weaknesses": {"value": "(i) The paper's scope appears limited to masked absorbing diffusion and low dimensions, an extension to higher dimensionality $D > 2$ remains informal\n\n(ii) The paper poses idealized assumptions (exact scores, exact reverse simulation) with little analysis of approximation / discretization error or robustness under practical solvers\n\n(iii) While the main contribution of this work is a theoretical discussion, the scope of experiments remains thin, and the robustness and scalability of results is underexplored"}, "questions": {"value": "In addition to the weaknesses outlined in points (i-iii), I present the following questions for the authors to address:\n\n(1) Proposition 3.3 partitions the space into regions $\\mathcal{R}_1, \\ldots, \\mathcal{R}_4$. Can you provide examples of real data where such region decompositions would be meaningful?\n\n(2) The analysis assumes exact concrete scores. How would score approximation errors change the conclusions?\n\n(3) The findings are specific to masked discrete diffusion, following the absorbing forward process. Would the conclusions still hold for other discrete processes (e.g., D3PM-uniform modelling)?\n\n(4) Strong guidance suppresses shared regions and reduces sample diversity. Is this “loss of diversity” always undesirable, or can it be beneficial in certain applications?\n\n(5) What are the main obstacles to extending the exact analysis beyond 2D, and what aspects of the results are most likely to generalize?\n\n(6) In 2D you introduce marginal coefficients $\\lbrace c_x, d_x \\rbrace_{1 \\leq x \\leq N}$ that encode the steering effect of guidance on marginals, consequently influencing the sampling dynamics. What intuition can we build for how these coefficients arise and what they represent?\n\n(7) [minor concern w.r.t. to presentation] Figure 2 feels slightly out of place, can you place it at the top of page 8?\n\n(8) [minor concern w.r.t. to presentation] While Notation was shortly introduced in the preliminaries section, could you provide a simple table of notations in the appendix to further improve overall readability and accessibility of your work?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "ZgFCsrjc9x", "forum": "h06nffFJqi", "replyto": "h06nffFJqi", "signatures": ["ICLR.cc/2026/Conference/Submission21319/Reviewer_XSKv"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission21319/Reviewer_XSKv"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission21319/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761991917954, "cdate": 1761991917954, "tmdate": 1762941691025, "mdate": 1762941691025, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}