{"id": "UIHe7r47ou", "number": 20548, "cdate": 1758307306636, "mdate": 1759896971856, "content": {"title": "Multi-Sample Preference Optimization for Generative Model Alignment", "abstract": "Recent advancements in generative models, particularly large language models (LLMs) and diffusion models, have been driven by extensive pre-training on large datasets followed by post-training. However, current post-training methods such as reinforcement learning from human feedback (RLHF) and direct alignment from preference methods (DAP) primarily utilize single-sample comparisons. These approaches often fail to capture critical characteristics such as generative diversity and bias, which are more accurately assessed through multiple samples. To address these limitations, we introduce a novel approach that extends post-training to include multi-sample comparisons. To achieve this, we propose Multi-sample Direct Preference Optimization (mDPO) and Multi-sample Identity Preference Optimization (mIPO). These methods improve traditional DAP methods by focusing on group-wise characteristics. Empirically, we demonstrate that multi-sample comparison is more effective in optimizing collective characteristics~(e.g., diversity and bias) for generative models than single-sample comparison. Additionally, our findings suggest that multi-sample comparisons provide a more robust optimization framework, particularly for dataset with label noise.", "tldr": "We introduce multi-sample comparisons for generative models, improving diversity, bias, and robustness over traditional single-sample methods.", "keywords": ["Generative Models", "LLM", "Diffusion", "RLHF", "Preference Optimization"], "primary_area": "foundation or frontier models, including LLMs", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/dfed12b33414c83da47ee52389162413662e190e.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "RLHF and DPO are popular post-training methodologies for LLM alignment. The standard method uses preference pairs consisting of single samples to align LLMs. This increases the probability of generating preferred samples when the reward is computed at a per-sample level. However, in several cases like increasing the diversity of responses etc. the rewards cannot be computed at a per-sample level.\n\nThis paper extend DPO and IPO to such cases. In this work, the authors generate a set of responses for each prompt. Analogous to preferred and dis-preferred samples, the multi-sample formulation has a preferred and dis-preferred set. The authors provide an unbiased estimator for the multi-sample formulation of IPO through theoretical analysis. Through five empirical studies, they show that the multi-sample DPO and IPO performs better than DPO and IPO when the reward is computed at a distribution level."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 2}, "strengths": {"value": "1. Computing rewards at a sample level is an important limitation of DPO and IPO. The extension of standard preference optimization framework to distributional level rewards addresses this limitation\n2. The theoretical analysis which shows that the variance of the multi-sample estimator decreases with group size is novel\n3. The range of empirical studies show that the multi-sample DPO/IPO improves upon the performance of standard DPO/IPO when the rewards are formulated at a distribution level across a range of modalities."}, "weaknesses": {"value": "1. The contribution of this work seems limited. The primary difference between the standard DPO setting and the multi-sample DPO setting is in the way that the samples are separated into preferred and unpreferred groups. Instead of separating them at a sample level, they are first grouped into sets and separated at a set level. Given that the reward is computed at a distributional level, this seems like the natural application of DPO for such a problem.\n2. There seems to be a strong overlap between this paper and Li et al [2024]. The authors have not clearly stated the original contributions which differ from Lit et al [lines 118 - 124]\n3. This work could benefit from stronger baselines - extending the RLHF framework to distributional reward problems. Furthermore, I would encourage the authors to compare this results with Zhong et al [2023] and Melnky et al [2024]."}, "questions": {"value": "Please see the weaknesses"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "Z0pPI509Hi", "forum": "UIHe7r47ou", "replyto": "UIHe7r47ou", "signatures": ["ICLR.cc/2026/Conference/Submission20548/Reviewer_cvkG"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20548/Reviewer_cvkG"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission20548/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761772259374, "cdate": 1761772259374, "tmdate": 1762933964716, "mdate": 1762933964716, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces **multi-sample extensions of preference optimization methods (mDPO and mIPO)** for alignment. Whereas standard approaches such as RLHF and DPO/IPO rely on **single-sample pairwise comparisons**, this work proposes to instead optimize over distributions of responses. This allows the methods to capture distributional characteristics such as **diversity and bias**, and to better handle cases where preferences may not exist between individual samples but emerge clearly when comparing groups. The authors highlight challenges in unbiased estimation and provide empirical evidence that the proposed approaches can improve robustness against label noise and enhance diversity in generated outputs."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "- Tackles an **important and underexplored problem**: extending preference optimization from single-sample to multi-sample comparisons.  \n- Provides a **novel formulation** (mDPO, mIPO) that enables aligning distributions rather than instances.  \n- Shows **promising empirical results**, especially in improving **diversity** and reducing **bias** in outputs.  \n- Highlights the robustness of mDPO against label noise, which is valuable in real-world preference datasets.  \n- Overall **presentation** is good, with several intuitive illustrations of the advantages of multi-sample formulations."}, "weaknesses": {"value": "While I liked the paper overall and I believe it tackles an important problem, some key weaknesses should be addressed:\n1. **Insufficient experimental comparisons**:  \n  - The paper does not compare against **other multi-sample methods** such as DFT (Guo et al., 2025).  \n  - No experiments with **naive multi-sample baselines**, e.g., running DPO/IPO over all pairwise comparisons between positive and negative sets in the mini-batch, i.e. \n    $$\n    \\frac{1}{k^2}\\sum_{i=1}^k\\sum_{j=1}^k l(x, y_{w,i}, y_{l,j})\n    $$\n2. **Overstatements in claims**: page 9 line 449, “both mDPO and mIPO significantly outperform the baselines” is too strong looking at the figure for mIPO $k=5$. This should be further argued or weakened.\n3. **Experimental detail gaps**:  \n  - The paper acknowledges that obtaining an unbiased estimator of mDPO is challenging, but still reports experiments with mDPO. It is unclear whether an estimator or a biased version is used.\n  - Figure 5 and Table 3: why does mIPO with $k=3$ outperform $k=5$? One would expect larger $k$ to monotonically improve performance (even if with diminishing returns).  \n  - Figure 6: it is not clear whether $k=5$ is an outlier or performance saturates? $k=6$ would help clarify this.\n  - Iterative improvement experiments (page 9): baseline not clearly stated, should be iterative DPO/IPO for fairness.\n\nGuo et. al. \"Discriminative Finetuning of Generative Large Language Models without Reward Models and Human Preference Data.\" 2025. arXiv:2502.18679.\n\n\n**Minor issues that have not affected the rating**\n- Page 3 line 121: “foci” → “focus”.  \n- Page 7 line 341: Figure 5 caption should have more space from text."}, "questions": {"value": "- See the weakness section for suggested additional experiments; more baseline comparison would greatly benefit the paper.\n- See the weakness section for some discussion and experimental details that the paper would benefit from answering."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "JJnV3A3HlB", "forum": "UIHe7r47ou", "replyto": "UIHe7r47ou", "signatures": ["ICLR.cc/2026/Conference/Submission20548/Reviewer_1UiK"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20548/Reviewer_1UiK"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission20548/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761804526181, "cdate": 1761804526181, "tmdate": 1762933962989, "mdate": 1762933962989, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper extends the direct preference alignment frameworks DPO and IPO to deal with preferences over groups of items over binary preference over pairs of items. The authors provide intuitive modifications to the DPO/IPO objective to incorporate group-wise comparisons, derive mini-batch estimators for these objective function, and show the validity of the method with various experiments."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "The problem of needing to compare groups of items instead of individual items in some cases is natural and of practical relevance. The experiment case studies (random numbers generation, image debiasing, improving quality of creative fiction generation and training with label noise) are all quite interesting and both validates the approach and gives real-world examples where one might want to compare distributions instead of pairs of items. The paper is also well written and easy to follow."}, "weaknesses": {"value": "1. The proposed methodology is quite straight-forward and the novelty of the proposed solution is moderate.\n\n2. It seems like the objective estimates can have bias/variance and it seems like this would depend on the batch size. However, from the experiments I don't see this angle being explored sufficiently. For someone trying to deploy this method, how would they deal with the bias/variance issue, how does that change with the batch size?"}, "questions": {"value": "See weakness"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "NAXpBrlKgM", "forum": "UIHe7r47ou", "replyto": "UIHe7r47ou", "signatures": ["ICLR.cc/2026/Conference/Submission20548/Reviewer_vUdb"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20548/Reviewer_vUdb"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission20548/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762150570918, "cdate": 1762150570918, "tmdate": 1762933962406, "mdate": 1762933962406, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes multi-sample variants of direct preference optimization methods (called mDPO and mIPO) that replace single response comparisons with group-wise comparisons aimed at aligning distributional properties (e.g., diversity, bias). In particular, the authors lift DPO/IPO from singletons to sets by using the (geometric-mean) product likelihood of a response group and optimizing the same surrogate with expectations over group samples. Then, they derived an unbiased mini-batch estimator for mIPO (a squared-loss objective over mean implicit rewards) and discussed a biased but lower-variance estimator for mDPO. Finally, they added NLL as an auxiliary term to stabilize finetuning. Experiments cover LLM random number generation, creative fiction, and diffusion debiasing, plus a synthetic-label robustness study where multi-sample wins more often under label noise."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The paper argues that many properties, such as diversity, are distributional and not captured by single-sample comparisons, and the group-wise formulation is intuitive.\n- Extending DPO/IPO by averaging implicit rewards over sets keeps training compatible with existing implementations."}, "weaknesses": {"value": "- Technically, mDPO/mIPO mostly reuse the same surrogates with a group-average of implicit rewards and a straightforward mini-batch estimator. The constrained-optimization view for adding NLL is already common in practice. Relative to DPO/IPO, the step from singletons to sets reads as expected algebra rather than a new learning principle. \n- There is prior work on distributional difference/alignment that directly targets set-level objectives. The paper cites some of these, but the differences are mainly about different experiments and applications, which are vague to me."}, "questions": {"value": "- Can you provide a theoretical justification that mDPO/mIPO are proper surrogates for a target distributional objective? Can we provide any consistency under a Bradley–Terry-style group model?\n\n- How does mIPO compare to work in distributional preference alignment in principle (what objective is optimized)?\n\n- Is there any specific reason behind considering the geometric mean for the aggregation over a group?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "2LQFCVeuIK", "forum": "UIHe7r47ou", "replyto": "UIHe7r47ou", "signatures": ["ICLR.cc/2026/Conference/Submission20548/Reviewer_4owy"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20548/Reviewer_4owy"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission20548/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762180416960, "cdate": 1762180416960, "tmdate": 1762933961922, "mdate": 1762933961922, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}