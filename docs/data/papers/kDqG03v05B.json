{"id": "kDqG03v05B", "number": 5091, "cdate": 1757846936613, "mdate": 1759897994980, "content": {"title": "Revisiting Tree-Sliced Wasserstein Distance Through the Lens of the Fermat–Weber Problem", "abstract": "Tree-Sliced methods have emerged as an efficient and expressive alternative to the traditional Sliced Wasserstein distance, replacing one-dimensional projections with tree-structured metric spaces and leveraging a splitting mechanism to better capture the underlying topological structure of integration domains while maintaining low computational cost. At the core of this framework is the Tree-Sliced Wasserstein (TSW) distance, defined over probability measures in Euclidean spaces, along with several variants designed to enhance its performance. A fundamental distinction between SW and TSW lies in their sampling strategies—a component explored in the context of SW but often overlooked in comparisons. This omission is significant: whereas SW relies exclusively on directional projections, TSW incorporates both directional and positional information through its tree-based construction. This enhanced spatial sensitivity enables TSW to reflect the geometric structure of the underlying data more accurately. Building on this insight, we propose a novel variant of TSW that explicitly leverages positional information in its design. Inspired by the classical Fermat–Weber problem—which seeks a point minimizing the sum of distances to a given set of points—we introduce the Fermat–Weber Tree-Sliced Wasserstein (FW-TSW) distance. By incorporating geometric median principles into the tree construction process, FW-TSW notably further improves the performance of TSW while preserving its low computational cost. These improvements are empirically validated across diverse experiments, including diffusion model training and gradient flow.", "tldr": "We propose a new variant of Tree-Sliced Wasserstein distance that incorporates positional data more explicitly, inspired by the Fermat–Weber problem.", "keywords": ["sliced optimal transport", "tree-sliced wasserstein distance", "tree wasserstein distance", "fermat-weber problem"], "primary_area": "learning on graphs and other geometries & topologies", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/67339791230399e6934269bf1d497437c3d24f73.pdf", "supplementary_material": "/attachment/6db31ce21852b7055147c0c12f86bf6320df425d.zip"}, "replies": [{"content": {"summary": {"value": "While Optimal Transport (OT) allows to compare data in a 'meaningful' way, it is computionally costly. Slicing strategies allow for the definition of more efficient OT-based metrics.\nIn particular, this paper introduces a new variant of the Tree-Sliced Wasserstein (TSW) distance, called the Fermat-Weber Tree-Sliced Wasserstein (FW-TSW). It is presented as an efficient alternative to standard Sliced Wasserstein (SW), utilizing tree-structured metric spaces to better capture data geometry while maintaining low computational cost. The key insight leveraged is that TSW incorporates both directional and positional information distinguishing it from the purely directional SW. A key question for TSW is the generation of random trees. The authors propose FW-TSW, which explicitly integrates the geometric median (based on the Fermat-Weber problem) into the tree construction process to enhance this positional sensitivity. They claim that this leads to further performance improvements over TSW, which is empirically validated in experiments involving diffusion model training and gradient flows."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "Novelty: Sampling strategies for sliced Wasserstein and kernel distances are an active field. Beyond projections onto the line, it is valuable to study sampling strategies for TSW, as the combined use of directional and positional information has been relatively underexplored. \n \nStructural Design: The integration of the geometric median into the tree construction mechanism is an intuitive apprach for sampling meaningful tree projections.\n \nTheoretical Contribution: Since there are limited theoretical results for TSW, the bound presented in Theorem 4.5 is an interesting result that provides new theoretical insight into the properties of Tree-Sliced distances.\n \nEmpirical Validation: The experiments are targeted at typical applications of sliced OT and provide good support for the proposed FW-TSW method. There are extensive ablation studies in the supplementary material."}, "weaknesses": {"value": "Limited Impact: While the question for 'smart' tree sampling is interesting and deserves further studiy, the contribution seems rather incremental.\n \nTheoretical Complexity: Most of the theoretical results are assessed are  straightforward with the exception of  Theorem 4.5.\n \nDoubts about empirical validation: Much of the experiments focus on comparing SW and TSW for a predefined number of projections. However, SW is faster, so it might be fairer to compare the two for a predefined run time. After all, the number of projections is very important for the Monte Carlo estimates.\n \nBound Limitation: The utility of the Theorem 4.5 bound is questionable due to a potentially large additive constant, especially for a high number of splits $k$. \n \nApplicability: The practical relevance of the demonstrated applications is limited outside of a dedicated Computational Optimal Transport research area. To my knowledge, TSW is not widely used for practical application (unlike standard OT or SW).\n \nClarity and Notation: Section 2.2 suffers from inconsistent and confusing notation. Key terms like $\\mathbb T_k^d$ are undefined, and the subscript $l$ in Equation (4) is unexplained, hindering comprehension. The rather central closed-form Wasserstein formula for trees is not provided in the paper, but only in the references. It is also confusing that the supplementary material around (24) uses partly different notation.\n \nReferences: Relevant references on sampling strategies for sliced divergences, e.g. (Hertrich et al., 2025) and (Sisouk et al., 2025) are missing."}, "questions": {"value": "1. Scaling in (14): In Equation (14), why is the identity matrix $\\mathbf{I}_d$ not scaled according to the data's covariance or variance?\n \n2. Subscripts in (15): The measure dependence should be made explicit: the subscripts $\\mu, \\nu$ of $\\Sigma$ should already appear in Equation (15).\n \n3. Choice of Central Point: Why was the geometric median chosen over simply using the barycenter of the measures in the tree construction? Is it because of Wasserstein-1 instead of Wasserstein-2? Did you try using the barycenter?\n \n4. $k$-Disjoint Union: In Equation (6), what is the precise definition and calculation of the distance on the $k$-times disjoint union of $\\mathbb R$?\n \n5. Typos and Formatting: Please correct the formatting error \"Equation equation 4\" (bottom of p. 6 and elsewhere). Ensure distinct notation is used for the exact distance (6) versus its approximation (8). Also, correct Equation (28) by removing the spurious subscript $l$ on the left-hand side."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "none"}, "rating": {"value": 4}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "uZakwHEdB0", "forum": "kDqG03v05B", "replyto": "kDqG03v05B", "signatures": ["ICLR.cc/2026/Conference/Submission5091/Reviewer_jHMb"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5091/Reviewer_jHMb"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission5091/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761501734938, "cdate": 1761501734938, "tmdate": 1762917866064, "mdate": 1762917866064, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes the Fermat-Weber Tree-Sliced Wasserstein (FW-TSW) to solve a geometric inconsistency in the standard tree sliced Wasserstein (TSW) framework. While TSW is an $L_1$-based metric ($W_1$) and its tree-sampling is position-dependent, existing methods sample this position (the tree root $x$) from a Gaussian centered at the $L_2$ data mean. FW-TSW corrects this mismatch by centering its sampling distribution $\\sigma_{FW}$ at the $L_1$ geometric median ($x^*$) which is the solution to the Fermat-Weber problem. This scheme is claimed to better capture data geometry and improve performance, adding only a negligible upfront cost to compute the median."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- This paper’s proposal to center the sampling distribution at the $L_1$ geometric median (the Fermat-Weber point) is the principled solution, aligning the geometry of the sampling space with the geometry of the metric.\n\n- Experiment results, particularly in generative modeling (Table 3), are significant. The FW-TSW* variant achieves FID score (2.315) by making both the position ($x^*$) and directions ($\\theta_i$) dependent on the measures being compared. This provides strong evidence that for high-dimensional generative tasks, data-agnostic slicing (like uniform sampling) is suboptimal, and a data-dependent discrepancy is superior.\n\n- The cost of solving for the geometric median ($O(Tnd)$) is paid once per batch and does not dominate $O(Lkn \\log n + Lkdn)$ TSW computation. The paper shows that this significant performance gain (e.g., in Table 3) is achieved with a negligible increase in wall-clock time, making it a drop-in replacement."}, "weaknesses": {"value": "- FW-TSW is no longer a metric.\n\n- The paper introduces two ideas: (1) data-dependent *positional* sampling (the core FW insight) and (2) data-dependent *directional* sampling (the FW-TSW* variant, eq 17). The paper’s narrative is built around the principled Fermat-Weber contribution, but the best empirical result (FID in Table 3) relies on the FW-TSW* variant, which includes the more heuristic directional sampling. This makes it difficult to attribute the performance. It is not clear if the central insight (the geometric median) is the key driver, or if the (less-justified) directional sampling is doing most of the work."}, "questions": {"value": "- In the 25 Gaussians experiment (Table 1), TSW and FW-TSW methods achieve a better final error compared to SWGG, which converges faster initially. What properties of tree-slicing give this better final convergence, and does the Fermat-Weber centering improve the global optimization landscape beyond the standard TSW's mean-centering?\n\n- The geometric median computation adds an $O(Tnd)$ cost (with $T = 100$) per batch, compared to the baseline's $O(nd)$ mean calculation. Is this iterative cost truly negligible for large $n$ and $d$?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "085U0blKdy", "forum": "kDqG03v05B", "replyto": "kDqG03v05B", "signatures": ["ICLR.cc/2026/Conference/Submission5091/Reviewer_cvC1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5091/Reviewer_cvC1"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission5091/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761981386333, "cdate": 1761981386333, "tmdate": 1762917865484, "mdate": 1762917865484, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes Fermat–Weber Tree-Sliced Wasserstein (FW-TSW) and FW-TSW* — new variants of the Tree-Sliced Wasserstein (TSW) distance that integrate positional information via the geometric median (Fermat–Weber point).\n\nThe main idea: previous TSW approaches sample tree intersection points (roots) heuristically (typically from a Gaussian centered at the data mean). In contrast, FW-TSW replaces this with a data-adaptive distribution centered at the geometric median of the combined source–target supports, computed via Weiszfeld’s algorithm.\n\nThis modification yields:\n\nBetter alignment between positional sampling and data geometry;\n\nTheoretical guarantees: semi-metricity, Euclidean invariance, and boundedness;\n\nEmpirical gains across gradient flows, topic modeling, and diffusion model training — with comparable runtime to TSW and Db-TSW."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "### **Strengths**\n\n- **Novel conceptual link:**  \n  Clever integration of *location theory* (Fermat–Weber / geometric median) into OT sampling, yielding a clean geometric interpretation that grounds the stochastic tree construction in data geometry.\n\n- **Sound theoretical guarantees:**  \n  The paper rigorously proves semi-metricity, symmetry, Euclidean invariance, and boundedness of the proposed FW-TSW distance. These properties ensure mathematical consistency while extending classical TSW theory.\n\n- **Efficiency preserved:**  \n  Despite adding geometric-median computation via Weiszfeld’s algorithm, the complexity remains $O(Lkn\\log n + Lkdn)$, with only minor $O(Tnd)$ overhead — maintaining the practical efficiency of TSW.\n\n- **Strong empirical performance:**  \n  FW-TSW and FW-TSW consistently outperform SW, TSW, and Db-TSW baselines on gradient flow, topic modeling, and diffusion model tasks. Results show improved convergence, stability, and lower FID without sacrificing runtime."}, "weaknesses": {"value": "### **Weaknesses**\n\n- **Limited generality of the tree structure.**  \n  The proposed FW-TSW and FW-TSW* are defined only on *star-shaped* tree systems, where all branches share a single root point (Eq. 15 / 18).  \n  More general tree geometries—e.g., unions of multiple disjoint lines or hierarchical branching—cannot be represented within this framework.  \n  This limits the flexibility of the model and its ability to capture more complex spatial relationships.\n\n- **Unclear computational overhead.**  \n  The complexity of Weiszfeld’s algorithm (used to compute the geometric median) is not analyzed or included in the overall runtime discussion.  \n  While each iteration is \\(O(nd)\\), the number of iterations and convergence behavior can vary depending on data geometry, which may affect scalability in high dimensions.\n\n- **Loss of metric property.**  \n  FW-TSW and FW-TSW* do not satisfy the triangle inequality because the sampling distribution \\(\\sigma_{\\text{FW},\\mu,\\nu}\\) depends on the data pair \\((\\mu,\\nu)\\).  \n  As discussed around Eq. (20), the distance is only a *semi-metric* when the sampling distribution is fixed.  \n  This data-dependent design improves adaptivity but sacrifices the strict metric property of the original TSW.\n\n- **Minor issue:**  \n  Line 349 contains a small typo: “Equation equation 15.”"}, "questions": {"value": "1. Could you clarify whether the FW-TSW framework can be extended beyond the star-shaped tree assumption?  \n   In particular, is it possible to construct tree systems with multiple intersection points or hierarchical branches under the same theoretical formulation?\n\n2. How many iterations are typically required for the Weiszfeld algorithm in your experiments?  \n   Did you observe any stability or convergence issues for high-dimensional datasets?\n\n3. In particular, what is the benefit of \\sigma_{dir,mu,\\nu}  compared with U(S^{d-1})?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "NA"}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "LSaOu6mp66", "forum": "kDqG03v05B", "replyto": "kDqG03v05B", "signatures": ["ICLR.cc/2026/Conference/Submission5091/Reviewer_7to6"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5091/Reviewer_7to6"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission5091/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762138134484, "cdate": 1762138134484, "tmdate": 1762917865018, "mdate": 1762917865018, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}