{"id": "Zd1Rcdqj07", "number": 22970, "cdate": 1758337662016, "mdate": 1759896838107, "content": {"title": "Scaffold-Aware Generative Augmentation and Reranking for Enhanced Virtual Screening", "abstract": "Ligand-based virtual screening (VS) is an essential step in drug discovery that evaluates large chemical libraries to identify compounds that potentially bind to a therapeutic target. However, VS faces three major challenges: class imbalance due to the low active rate, structural imbalance among active molecules where certain scaffolds dominate, and the need to identify structurally diverse active compounds for novel drug development. We introduce **ScaffAug**, a scaffold-aware VS framework that addresses these challenges through three modules. The *augmentation module* first generates synthetic data conditioned on scaffolds of actual hits using generative AI, specifically a graph diffusion model. This helps mitigate the class imbalance and furthermore the structural imbalance, due to our proposed scaffold-aware sampling algorithm, designed to produce more samples for active molecules with underrepresented scaffolds. A model-agnostic *self-training module* is then used to safely integrate the generated synthetic data from our augmentation module with the original labeled data. Lastly, we introduce a *reranking module* that improves VS by enhancing scaffold diversity in the top recommended set of molecules, while still maintaining and even enhancing the overall general performance of identifying novel, active compounds. We conduct comprehensive computational experiments across five target classes, comparing ScaffAug against existing baseline methods by reporting the performance of multiple evaluation metrics and performing ablation studies on ScaffAug. Overall, this work introduces novel perspectives on effectively enhancing VS by leveraging generative augmentations, reranking, and general scaffold-awareness.", "tldr": "ScaffAug improves ligand-based virtual screening by addressing class and scaffold imbalance and boosting structural diversity through generative augmentation, self-training, and diversity-aware reranking.", "keywords": ["Virtual Screening", "Data Augmentation", "Diffusion Model", "Graph Neural Networks"], "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/eb8efc46005b2b2553cdea3f8fcc8ba8ef5bab66.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper addresses virtual screening challenges through scaffold-aware augmentation (oversampling underrepresented molecular scaffolds and extending them via graph diffusion), self-training with pseudo-labeling, and MMR-based reranking for diversity."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1.The key conceptual contribution is distinguishing structural imbalance (underrepresented scaffold families) from class imbalance, with scaffold-aware sampling as a novel solution to oversample rare scaffolds during generation. While individual components are standard techniques, their chemistry-aware integration and the specific focus on balancing scaffold diversity represents a creative domain-specific applications. \n\n2. The paper is overall well-structured with clear problem formulation, visual overview, an visualization showing improved coverage of underrepresented chemical space. Mathematical definitions, algorithms, and the distinction between evaluation splits are all clearly presented."}, "weaknesses": {"value": "1. Overall, the paper seems to be more of an application paper with good empirical results than a methods innovation paper:  combining existing techniques in a chemistry-aware way for virtual screening. It's fundamentally semi-supervised learning + importance sampling with conditional generation and diversity reranking(MMR). Is this enough for ICLR is debatable. While not completely overlapping similar concepts have been used before in different field of molecule prediction tasks (refer to Instructor-inspired Machine Learning for Robust\nMolecular Property Prediction (Neurips 2024))\n\n2. No ablation on the three modules, only for Scaffold-aware sampling (SAS) vs Uniform actives (UA) sampling. \n\n3. A clearer articulation why scaffold diversity is critical for virtual screening success can make the paper more convincing"}, "questions": {"value": "1. What if you only use augmentation without self-training? Only self-training without reranking? They claim three modules but never test them individually. Does preserving the scaffold actually matter? What if you just generate molecules without fixing scaffolds?\n\n2. How many generated molecules are actually valid/diverse? What's the generation success rate?\n\n3. Compared to Instructor-inspired Machine Learning for Robust Molecular Property Prediction (Neurips 2024), what makes this paper's method novel other than scaffold-aware sampling and mmr-based reranking which, again, is not novel?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "KE5qB8TtNd", "forum": "Zd1Rcdqj07", "replyto": "Zd1Rcdqj07", "signatures": ["ICLR.cc/2026/Conference/Submission22970/Reviewer_zpNN"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22970/Reviewer_zpNN"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission22970/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761701467190, "cdate": 1761701467190, "tmdate": 1762942458633, "mdate": 1762942458633, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents ScaffAug, a scaffold-aware generative augmentation and reranking framework for ligand-based virtual screening. It addresses three key challenges—class imbalance, structural imbalance, and low scaffold diversity—by combining (1) scaffold-aware sampling and graph diffusion–based molecule generation, (2) self-training with pseudo-labels, and (3) MMR-based reranking to enhance structural diversity. Evaluations on five WelQrate datasets show consistent improvements over existing graph augmentation baselines across multiple screening metrics."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "**Originality:** The work presents an original synthesis of scaffold-aware generative augmentation with MMR reranking, explicitly tackling class and structural imbalance in VS datasets.\n\n**Quality:** Experiments are extensive and include ablations (e.g., Figure 4 on SAS vs UA sampling) and diversity analyses. The comparison against graph augmentation baselines is fair and supports the main claims.\n\n**Clarity:** Writing is generally clear and coherent. The motivations for each module are explained in context, and figures effectively support the narrative.\n\n**Significance:** The method offers a practical route for improving VS under class-imbalanced and scaffold-biased regimes, which is a real limitation in modern drug discovery pipelines."}, "weaknesses": {"value": "**Originality:** Although combining augmentation, self-training, and reranking is novel in this context, each component is adapted from known ideas. A stronger theoretical justification for how these modules interact (e.g., information flow between SAS → GDM → self-training) would enhance originality.\n\n**Quality:**\n\n- No reported runtime efficiency or scalability results; this matters for large-scale screening campaigns.\n\n- Lack of data leakage analysis during augmentation (i.e., ensuring augmented molecules from test scaffolds are excluded).\n\n- DiGress is trained on 450 K unlabeled molecules; explaining why this subset (and not larger resources like ZINC or Enamine 100 M) was chosen would clarify generalizability.\n\n**Clarity:** Some algorithmic details (e.g., Eq. 1 and Algorithm 3 notation) could be refined to avoid ambiguity.\nMinor formula correction in Eq. 1 and  Algorithm 3 are self-referential and should likely be:\n\n$G^t = m \\odot s + (1 - m) \\odot G^{t-1}$\n\n**Significance:** Since protein structure information is ignored, the model may struggle for targets where ligand-only context is insufficient — a limitation already acknowledged by the authors in Section 5.\n\n**Adjustments:** Convert \"Table 3\" to a \"Figure 3\".\n\n**Suggestions:**\n\n- Include before/after visualization of scaffold distribution to show how augmentation affects timesplit consistency.\n- Evaluate runtime and scaling with dataset size."}, "questions": {"value": "1- Could you provide runtime and computational resource comparisons (e.g., augmentation time per 1 K molecules)?\n2- Why was the 450 K unlabeled molecule set chosen over larger public libraries (e.g., ZINC 15, Enamine 100 M as benchmarked in **[1]**)?\n\n**References:**\n\n**[1]** Graff et al., Accelerating high-throughput virtual screening through molecular pool-based active learning, 2021"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "pLcOHUzi8F", "forum": "Zd1Rcdqj07", "replyto": "Zd1Rcdqj07", "signatures": ["ICLR.cc/2026/Conference/Submission22970/Reviewer_BG6k"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22970/Reviewer_BG6k"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission22970/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761990580726, "cdate": 1761990580726, "tmdate": 1762942458058, "mdate": 1762942458058, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes an augmentation method designed to enhance virtual screening results. The method addresses issues with training data imbalance between active and inactive compounds, the overrepresentation of certain scaffolds, and the diversity of the identified hits. To augment the training dataset with more positive data, scaffolds from active compounds are extracted and sampled with replacement, using probabilities inversely proportional to their frequency in the active compounds. Next, additional examples are generated using the DiGress model, which retains the scaffold structure. To train the activity prediction model, pseudo-labeling is conducted after a warm-up phase to increase the training dataset. The ranking of molecules is performed using an MMR-based approach, which, in addition to predicted activity, considers the similarity to molecules that have already been selected. The proposed approach achieves strong results on a subset of the WelQrate dataset."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- The paper is written in a clear way, and the motivation is explained well.\n- The problem this work addresses is important, as making virtual screening more efficient would help in finding new therapeutic molecules faster.\n- The experiments are conducted across five datasets and two types of data splitting methods, repeated three times to report standard deviation values.\n- ScaffAug demonstrates strong performance across all the selected datasets, showing promise in the virtual screening setup.\n- Augmenting scaffolds is a novel strategy addressing class imbalance in biological activity prediction.\n- The impact of MMR reranking is shown in Figure 3. Although this reranking strategy results in lower enrichment factor values, the diversity of the selection is significantly improved."}, "weaknesses": {"value": "- Generating molecules with the same scaffolds does not help with the scaffold diversity of discovered molecules. Actually, it might bias the model to predict molecules with the same scaffolds more often than new active compounds with novel scaffolds. This can be a big disadvantage for drug discovery campaigns wanting to avoid patent-protected chemical spaces.\n- The indexing in line 16 of Algorithm 1 can be misleading. Now, this notation suggests that the algorithm returns the first $N$ scaffolds from the input.\n- The chemical validity or synthesizability of the molecules generated with DiGress is not reported in the paper. Providing some examples of the generated molecules would also be helpful.\n- The experiments lack simple baselines where molecules are ranked by $f_\\phi$ predictions with and without training on pseudo-labeled examples and with and without augmentation.\n- (minor) The problem definition involving binary classification does not correspond well to the hit selection by ranking problem. Perhaps VS should be defined rather as a ranking problem or finding $k$ molecules with the highest probability of being active, which can be achieved by using a classification model.\n- (minor) In line 179, there seems to be part of the text missing."}, "questions": {"value": "1. Should the sigmoid function be applied in line 7 of Algorithm 2 if $p_i$ is already a probability (presumably since $f_\\phi$ is a binary classification model)?\n2. How do you approach scaffolds that occur both in active and inactive compounds? Do you still use them to generate augmented samples?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "HOBJisyz7q", "forum": "Zd1Rcdqj07", "replyto": "Zd1Rcdqj07", "signatures": ["ICLR.cc/2026/Conference/Submission22970/Reviewer_JNBY"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22970/Reviewer_JNBY"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission22970/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762011697789, "cdate": 1762011697789, "tmdate": 1762942457480, "mdate": 1762942457480, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This work presents ScaffAug: a framework for improving ligand-based virtual screening by utilizing synthetic data for pre-training. This data comes from completion of scaffolds occurring in highly active molecules. Through quantitative experiments, authors show this approach - pre-training followed by inference-time post-processing - is effective in achieving a diverse coverage of active compounds."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "**(S1)**: Making virtual screening more robust to data and scaffold imbalance is a worthwhile pursuit, and the paper makes a good attempt at resolving these challenges. From an ML point of view the method design looks sound. \n\n**(S2)**: The paper is reasonably written and mostly easy to understand."}, "weaknesses": {"value": "**(W1)**: There are a few parts of the work that would benefit from further clarification:\n\n- **(W1a)**: I am wondering what is the rationale behind the reranking improving results. While this method would be bound to improve e.g. the internal diversity of the returned set, it is not clear to me that improved diversity would necessarily lead to better results. It does seem to be the case given Figure 3, and there is a clear sweet-spot in the middle of reranking strength $\\lambda$, which I found surprising; I expected increasing diversity will necessarily lead to deteriorating quantitative performance.\n\n- **(W1b)**: In the text, authors say that in their augmentation method they \"preserve the scaffolds of active compounds and generate new molecules with a graph diffusion model\". However, carefully reading Algorithm 1 reveals the process is more involved, as instead clusters are scored based on the proportion of actives within, and (as far as I understand) a scaffold coming from an inactive molecule can also be selected as long as it got clustered together with a lot of scaffolds coming from actives.\n\n---\n\n**Other comments**\n\n**(O1)**: It would be good to also widely refer and relate to scaffold-based and scaffold-constrained generative models [1, 2].\n\n**Nitpicks**\n\n- Typos in \"bsaeline\" (caption of Figure 1), \"generate synthesis data\" (Section 3.1).\n\n- In Section 3.1, last sentence of the first paragraph appears to be broken.\n\n- In Section 4.1, \"we utilize a subset of the comprehensive WelQrate(Wang et al., 2024) dataset is a high-quality dataset of 9 bioassays\" seems broken (also missing space before citation).\n\n- Very minor, but in my view \"generative AI\" is mostly a marketing term nowadays, it would be more typical to say \"generative models\".\n\n**References**\n\n[1] \"Learning to Extend Molecular Scaffolds with Structural Motifs\"\n\n[2] \"Scaffold-based molecular design using graph generative model\""}, "questions": {"value": "See the \"Weaknesses\" section above for specific questions."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "cut8uEpbQi", "forum": "Zd1Rcdqj07", "replyto": "Zd1Rcdqj07", "signatures": ["ICLR.cc/2026/Conference/Submission22970/Reviewer_28QU"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission22970/Reviewer_28QU"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission22970/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762042267681, "cdate": 1762042267681, "tmdate": 1762942457091, "mdate": 1762942457091, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}