{"id": "6SldMYKw98", "number": 10653, "cdate": 1758178583417, "mdate": 1759897637610, "content": {"title": "ECHO: Efficient Coarse-Grained Hybrid Optimization — Clip at Batch, Learn at Token", "abstract": "Reinforcement learning (RL) for large language models (LLMs) typically employs token-level clipping of importance sampling ratios to ensure training stability. While effective at preventing catastrophic policy shifts, such fine-grained clipping often excessively truncates learning signals, limiting optimization efficiency.\nTo address this limitation, we propose ECHO, a novel RL method that combines batch-level clipping with token-level importance sampling. Specifically, ECHO computes an average importance sampling ratio across the entire batch and uses this single clipping bound to modulate the gradient of each token. This batch-level approach preserves richer global reward information while retaining fine-grained token attribution, enabling gradients to capture more holistic reward structures and improve sample efficiency, leading to faster convergence and more stable training. Our method also provides a new perspective on how to define importance sampling ratios and reward shaping in RL for LLMs.\nExperimental results on both in-domain Math and reasoning benchmarks demonstrate that ECHO not only accelerates convergence but also achieves highly competitive performance, highlighting its efficiency and robustness for large-scale LLM alignment.", "tldr": "ECHO introduces coarse-grained optimization that stabilizes RL training in LLMs while achieving stronger final performance on reasoning tasks.", "keywords": ["Reinforcement Learning", "Large Language Models", "Policy Optimization", "Importance Sampling"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/a7736052ef66f89c82f2952d4cd8bf95fb7b88db.pdf", "supplementary_material": "/attachment/fc5f77c4b96ae7b1f8549a44c0aa7a60114dc21e.zip"}, "replies": [{"content": {"summary": {"value": "The paper proposes ECHO (Efficient Coarse-Grained Hybrid Optimization), a new reinforcement learning framework for large language model (LLM) alignment. The core idea is to apply batch-level clipping of importance sampling ratios, stabilizing global policy updates, while preserving token-level importance weighting to maintain fine-grained learning signals.  \n.  \n- The paper derives the gradient formulation of ECHO, showing that batch-level correction ensures stability while token-wise sampling enables precise credit assignment.  \n- Experiments on nine benchmarks (AIME’24/25, AMC’23, MATH, OlympiadBench, Minerva, ARC-C, GPQA, MMLU-Pro) demonstrate that ECHO achieves faster convergence, higher stability, and better generalization than GRPO, GSPO, and DAPO."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "**Novel hybrid optimization design:** Integrates batch-level clipping with token-wise learning, balancing stability and expressiveness.  \n- **Improved training stability:** Mitigates gradient explosion and avoids sequence length collapse observed in GSPO or GRPO.  \n- **Higher sample efficiency:** Reaches strong performance with significantly fewer steps compared to DAPO.  \n- **Scalable and practical:** Compatible with large-scale distributed RL training and adaptable to future MoE or multi-task setups."}, "weaknesses": {"value": "- The experimental section is relatively weak. Since the paper focuses on the effect of clipping, additional ablation studies would strengthen the analysis — for example, showing the clipping ratio dynamics or policy loss curves over training.\n\n- Minor weakness: The paper emphasizes training stability, yet Figure 2 appears to show results from a single random run. It would be more convincing to include mean curves with variance/error bars across multiple seeds."}, "questions": {"value": "- Could the authors provide the clipping ratios used for different algorithms? I believe this information is important for analyzing and comparing the optimization behavior.\n- Why does ECHO achieve faster convergence in the early training stage? In my understanding, at the beginning of training, the clipping ratios across different algorithms should be close to 0 (i.e., little divergence between policies). Therefore, I would expect the acceleration effect to appear in the mid-stage, when the clipping ratios start to diverge."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "oTKLKOcm1d", "forum": "6SldMYKw98", "replyto": "6SldMYKw98", "signatures": ["ICLR.cc/2026/Conference/Submission10653/Reviewer_AUgi"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission10653/Reviewer_AUgi"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission10653/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761854051548, "cdate": 1761854051548, "tmdate": 1762921906691, "mdate": 1762921906691, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper effectively identifies a key limitation in existing methods: GRPO's token-level clipping and GSPO's uniform sequence-level treatment. The proposed hybrid approach, ECHO, is a promising direction. However, the articulation of its core novelty—the \"batch-level clipping\" mechanism—requires further precision."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The experimental results are comprehensive, spanning multiple benchmarks, and demonstrate strong performance. The critique that GSPO suffers from \"severe sequence length collapse\" is valid and a meaningful practical drawback. \n\n2. The gradient derivation in Section 3.3 is technically sound, and the interpretation of \"coarse-to-fine\" control is insightful. That said, the paper would benefit from a more thorough discussion of computational overhead and implementation complexity."}, "weaknesses": {"value": "1. The derivation indicates that in the unclipped regime, the batch-level correction factor approaches. This suggests that the primary effect of ECHO is gradient stabilization and variance reduction via the introduced baseline $\\frac{L(\\theta)}{R_{\\text{batch}}(\\theta)}$, rather than a fundamentally new clipping paradigm. To strengthen the paper, the authors should explicitly distinguish their theoretical contribution. \n\n2. By excluding GSPO from several comparisons (e.g., Table 1), the evaluation sidesteps a direct comparison against a properly stabilized version of this baseline. To present a more compelling case for ECHO's superiority, the authors should include a comparison with a stabilized GSPO variant. This could involve techniques like length normalization or entropy regularization. Such a comparison is necessary to ensure that ECHO's performance gains are attributable to its hybrid design, and not merely to the avoidance of a known, but correctable, failure mode in a specific baseline implementation.\n\n3. Calculating the batch-level average log-probability ratio $R_{\\text{batch}}(\\theta)$ requires aggregating statistics across all tokens in the entire mini-batch. In a distributed training setup, this could introduce non-trivial synchronization and communication costs. The authors should analyze or discuss ECHO's practical training efficiency—specifically, its steps/second and memory footprint relative to GRPO and DAPO. This would assure readers that the improved convergence and performance are not achieved at a prohibitive computational cost."}, "questions": {"value": "1. To strengthen the paper, the authors should more explicitly distinguish their theoretical contribution. Is it primarily a clever synthesis and re-weighting of existing ideas (i.e., combining sequence-level statistics with token-level gradients), or does it introduce a genuinely new optimization operator? A clearer framing would help the reader accurately assess the conceptual advance."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "dTgVTNSCrN", "forum": "6SldMYKw98", "replyto": "6SldMYKw98", "signatures": ["ICLR.cc/2026/Conference/Submission10653/Reviewer_TJSF"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission10653/Reviewer_TJSF"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission10653/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762002056775, "cdate": 1762002056775, "tmdate": 1762921906331, "mdate": 1762921906331, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes a variation of GRPO that combines token-level importance sampling and batch-level clipping. The authors claim that this design leads faster convergence and more stable training."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "* Experiments demonstrate notable improvements in training efficiency, particularly during the early stages of training."}, "weaknesses": {"value": "* The main equations in section 3.2 are not clearly presented with some notation left undefined. Moreover, according to line 204-205, the authors first apply batch-level clipping to the token-level importance ratio, and then perform another token-level clipping on top. This implementation appears inconsistent with the method described in the paper. These equations make it difficult to follow the proposed method. \n* The authors claim the proposed method is superior because 1/ it preserves more learning signal comparing to token-level clipping, leading to faster convergence, and 2/ it leads to more stable training. However, the paper does not provide sufficient justification or theoretical explanation for these claims, and the two advantages can appear contradictory—preserving more learning signal can increase variance, which can reduce stability."}, "questions": {"value": "Experiments are conducted on a 7B model; however, RL training instability often becomes more pronounced at larger model scales. Since the proposed method relaxes the clipping mechanism, is it a valid concern that it may increase the risk of instability when applied to larger models?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "Ep7FJWZT0w", "forum": "6SldMYKw98", "replyto": "6SldMYKw98", "signatures": ["ICLR.cc/2026/Conference/Submission10653/Reviewer_TW5Y"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission10653/Reviewer_TW5Y"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission10653/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762157689141, "cdate": 1762157689141, "tmdate": 1762921905924, "mdate": 1762921905924, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes to augment the token-wise importance ratio with a batch-wise importance ratio for LLM alignment. The empirical evaluation on mathematics and logic reasoning datasets demonstrates the competitive performance of the proposed method."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "- Considering batch-wise information during LLM alignment is novel\n\n- The empirical evaluation on two Qwen models and 9 datasets demonstrates the competitive performance of the proposed method"}, "weaknesses": {"value": "- I appreciate that the authors provide Figure 1 to motivate the method. However, the results in Figure 1 do not well support the corresponding claim (see my questions below).\n\n- The writing about the method is redundant with repeated content:\n1) In Section 3, some notations are defined first, being used in the later equations, but are expanded again. For example, Eq. (6) defines $R_{batch}(\\theta)$. Then, $R_{batch}(\\theta)$ is used in Eq. (8), but is expanded in Eq. (9). The intention of doing this is not explained. This presentation is implicitly redundant.\n2) The ECHO objective function is introduced in 204 and is fully presented again in line 214. The gradient of the ECHO objective function is derived in line 227 and fully presented again in line 241.\n\n- The experiment mainly presents the benchmark scores. Many claims in the text (e.g., Section 6, \"highlighting its effectiveness in both preserving strong in-distribution capabilities and improving generalization\") need more evidence to support."}, "questions": {"value": "- In the caption of Figure 1, the author writes \"(a)..., showing that GRPO ... while GSPO and ECHO ...\". Figure 1 (a) has only one line for GRPO. How does this single line provide a comparison to the other two methods? Also in the corresponding text (Section 1, paragraph 2): \"token-level... in an excessive proportion of tokens being truncated\". How large is the proportion, and is it really \"excessive\"?\n\n\n# Minors\n- \"Eq. equation\" is frequently used in the paper. Use either \"Eq.\" or \"Equation\"\n- Section 1, paragraph 3, line 1. \"im po a r tan ce\"\n- page 3, line 117, \"baseline\" is not defined.\n- page 4, line 175. The definition of $\\tilde{\\rho}_{i, t} (\\theta)$ is described in Eq. 8-10, instead of Eq. 10.\n- page 4, line 192. The superscript of the denominator in Eq. 8 is not defined.\n- page 5, line 232. \"$\\rho_{i, t}$\" should be $\\rho_{i, t}(\\theta)$.\n- page 5, line 252, \"under normal circumstances\", consider avoid the word \"normal\" as it is ambiguous."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "NA"}, "rating": {"value": 2}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "nBpzoG0ZbI", "forum": "6SldMYKw98", "replyto": "6SldMYKw98", "signatures": ["ICLR.cc/2026/Conference/Submission10653/Reviewer_8syB"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission10653/Reviewer_8syB"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission10653/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762180855267, "cdate": 1762180855267, "tmdate": 1762921905134, "mdate": 1762921905134, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}