{"id": "G8GcKviwBE", "number": 5090, "cdate": 1757846903689, "mdate": 1759897994976, "content": {"title": "Direct Doubly Robust Estimation of Conditional Quantile Contrasts", "abstract": "Within heterogeneous treatment effect (HTE) analysis, various estimands have been proposed to capture the effect of a treatment conditional on covariates. Recently, the conditional quantile comparator (CQC) has emerged as a promising estimand, offering quantile-level summaries akin to the conditional quantile treatment effect (CQTE) while preserving some interpretability of the conditional average treatment effect (CATE).\nIt achieves this by summarising the treated response conditional on both the covariates and the untreated response. Despite these desirable properties, the CQC's current estimation is limited by the need to first estimate the difference in conditional cumulative distribution functions and then invert it. \nThis inversion obscures the CQC estimate, hampering our ability to both model and interpret it. To address this, we propose the first direct estimator of the CQC, allowing for explicit modelling and parameterisation.\nThis explicit parameterisation enables better interpretation of our estimate while also providing a means to constrain and inform the model. We show, both theoretically and empirically, that our estimation error depends directly on the complexity of the CQC itself, improving upon the existing estimation procedure. Furthermore, it retains the desirable double robustness property with respect to nuisance parameter estimation. We further show our method to outperform existing procedures in estimation accuracy across multiple data scenarios while varying sample size and nuisance error. Finally, we apply it to real-world data from an employment scheme, uncovering a reduced range of potential earnings improvement as participant age increases.", "tldr": "We create the first direct estimator of the Conditional Quantile Comparator, a quantile based summary of the treatment effect.", "keywords": ["Heterogeneous Treatment Effect", "Conditional Quantile Treatment Effect", "Quantile Regression", "Doubly Robust"], "primary_area": "causal reasoning", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/818a0c2bab1713693ac15131ab505212eefe5c65.pdf", "supplementary_material": "/attachment/7dff87cff5aef77e30c1ba3eb8158b1d8a0d8672.zip"}, "replies": [{"content": {"summary": {"value": "This paper provided an estimation framework for the conditional quantile comparator (CQC). The CQC estimand offers another dimension of heterogeneity compared to other HTE estimand (e.g. CATE) into it allows interpretation along the level of the untreated potential outcome. The proposed estimator reframe the Z-estimation problem into a loss minimization problem, and constructs a doubly robust pseudo-outcome for the gradient. The estimator is learned by taking a series of gradient update steps without explicitly evaluating the loss. The authors provided convergence analysis for the proposed estimator and demonstrated improved performance over existing baselines."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- Provided theoretical guarantee on the convergence rate, and show that the difference in loss is doubly robust in nuisance estimation error.\n- Provided detailed overview/comparison with prior works. \n- The authors discussed some key limitations in the paper."}, "weaknesses": {"value": "- It is more sensitive to nuisance estimation error compared to the plug-in/invert approach as the doubly robust rate is proven for the loss. \n- Since the only the gradient is calculated (the loss is never evaluated), it is hard to asses whether taking the gradient steps are sufficient. \n- Would be stronger if the paper also included experiments on hyper-parameters like step size or number of gradient update steps."}, "questions": {"value": "- $\\tilde{\\theta}$ in Theorem seems to be undefined, is it the optimal solution within the radius B?\n- Is the proposed method sensitive to hyper-parameters (especially since there is clear evaluation to guide when to stop the gradient updates) like the step size?\n- What was the main technical difficulty when proving convergence rate for the CQC it self?\n- What causal quantity does the CQC correspond to? Is it $\\mathbb{E}[Y(1)|X,Y(0)=y]$? What are the identifying assumptions?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "iAhZUmwHgN", "forum": "G8GcKviwBE", "replyto": "G8GcKviwBE", "signatures": ["ICLR.cc/2026/Conference/Submission5090/Reviewer_YMsC"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5090/Reviewer_YMsC"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission5090/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761760450494, "cdate": 1761760450494, "tmdate": 1762917865948, "mdate": 1762917865948, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes the first direct, doubly robust (DR) estimation method for the Conditional Quantile Comparator (CQC), an HTE estimand that bridges the gap between CATE and CQTE. The authors develop a novel loss function whose DR gradient can be estimated from data, allowing the CQC to be explicitly modeled and optimized, rather than being solved for indirectly via functional inversion."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1. This work provides a practical, direct, and more efficient alternative, making the CQC a much more usable tool.\n\n2. The core method is novel. The idea of framing the CQC estimation problem as an M-estimation task by defining a loss $l$ such that $\\partial_{y_1}l = h$ (with $h=F_1 - F_0$) is very interesting. Deriving the doubly-robust gradient $\\zeta_{dr}$ (Proposition 2) provides a new class of estimators.\n\n3. The method is theoretically solid. The paper provides finite sample bounds that formally demonstrate the estimator's double robustness.\n\n4. The empirical study is thorough and shows that their direct method's error is low and constant, while the indirect method's error (which depends on $F_a$) is high and unstable."}, "weaknesses": {"value": "1.  Practicality of model selection. The paper notes as a limitation that there is \"no natural definition of test loss\". The method optimizes based on an estimated gradient of the population loss, not a sample-based loss (like MSE). This makes standard validation and hyperparameter tuning very difficult. The paper suggests an approximation via quadrature (Appendix B.2), but this is complex and a significant practical barrier.\n\n2. The algorithm (Algorithm 1) requires sampling test points $Y_0$ to compute the gradient. But there are some unclear points, as shown in the Questions 2&3."}, "questions": {"value": "1. For Weakness 1, is it possible to derive any model evaluation metric, like those proposed in [1, 2], for evaluation? This is not the aim of this paper, but discussing this might bring some new insights for future research.\n\n2. For Weakness 2, the loss $L(\\theta)$ is an expectation over this $Y_0$ distribution. The paper suggests sampling from the control distribution ($Y|A=0$), but it's unclear how this choice affects the estimator's accuracy for $y_0$ values in the control group. \n\n3. For Weakness 2, what is the exact sample algorithm? Is it random or dependent on some information? How the sampling algorithm would affect the final result?\n\nOverall, I think this is a solid paper, and providing more explanations for the above questions might improve the quality.\n\n\n[1] Unveiling the Potential of Robustness in Selecting Conditional Average Treatment Effect Estimators\n[2] Empirical Analysis of Model Selection for Heterogeneous Causal Effect Estimation"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "TNcyGLRle8", "forum": "G8GcKviwBE", "replyto": "G8GcKviwBE", "signatures": ["ICLR.cc/2026/Conference/Submission5090/Reviewer_A3DT"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5090/Reviewer_A3DT"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission5090/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761998555977, "cdate": 1761998555977, "tmdate": 1762917865259, "mdate": 1762917865259, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper presents a novel approach for estimating the CQC, which removes the procedure of estimating an intermediate estimand followed by inversion, enabling the CQC estimate to be explicitly parametrized with enhanced interpretability. The authors cleverly transform the optimization scheme into a convex optimization problem by introducing\na loss function whose derivative with respect to y1 is the contrasting function. The upper bound of the loss is derived, and an estimator of the gradient is proposed. The authors illustrate that the estimated parameters obtained via gradient descent are doubly robust with respect to the loss, and demonstrate empirical results on simulated and real-world datasets."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "1. The proposed framework enables parametrization of the CQC function,\nproviding a means to enforce structural assumptions on the model and\nto represent the estimation error in terms of the complexity of the CQC\nitself.\n2. The idea of transforming the optimization scheme into a convex optimiza-\ntion problem by introducing a loss function whose derivative with respect\nto y1 is the contrasting function was fascinating.\n3. Empirical results demonstrate improved performance."}, "weaknesses": {"value": "1. The term ”direct CQC estimator” seems to be somewhat misleading, as the proposed estimator in Section 3.1 is defined with respect to the gradient rather than the estimand of interest, $g^∗$.\n\n2. Also related to the point made in 1, and as the authors acknowledged in the limitations already, the doubly robustness proposed in Theorem 3 holds with respect to the loss function rather than the CQC estimate $g_\\hat{\\theta}$. As the estimand of interest is $g^∗$, it seems imperative to demonstrate the convergence rate of  $g_\\hat{\\theta}$. Also, the derivation of the doubly robust estimator appears fairly standard, given that the loss function is smooth; in fact, it closely mirrors existing results. Personally, I do not find much technical novelty in the manuscript, though I do acknowledge the conceptual value of the proposed framework itself.\n\n3. The proposed method heavily depends on the previous work by Givens et al (2024), limiting its novelty and contribution."}, "questions": {"value": "* Related to the second comment in \\emph{Weaknesses}, does the $\\sqrt{n}$ loss-consistency of $\\hat{\\theta}$ guarantee the consistency of $\\hat{\\theta}$ at sound rates? While the authors suggest that the result can be extended for a limited class of densities that are bounded below (lines 349--353), no guarantees are presented for a general class of probability densities.\n\n Minor typos:\n\n- Line 117: $A = 0 \\Rightarrow A = a$\n- Line 142: provides an example of this by showing an example of this (redundant phrase)\n- Line 201: $\\mathcal{Y} \\times \\mathcal{X} \\to \\mathcal{X} \\Rightarrow \\mathcal{Y} \\times \\mathcal{X} \\to \\mathcal{Y}$\n- Line 234: $g^*(y_0 | x) | x \\Rightarrow g^*(y_0 | x)$\n- Line 246: $g_\\theta(g \\mid x) \\Rightarrow g_\\theta(y_0 \\mid x)$"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "Bf796CkeNs", "forum": "G8GcKviwBE", "replyto": "G8GcKviwBE", "signatures": ["ICLR.cc/2026/Conference/Submission5090/Reviewer_2ZCv"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5090/Reviewer_2ZCv"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission5090/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762001607331, "cdate": 1762001607331, "tmdate": 1762917864872, "mdate": 1762917864872, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper introduces a new direct doubly robust estimator for the Conditional Quantile Comparator (CQC). Unlike prior approaches that estimate the CQC indirectly by inverting a contrast of conditional cumulative distribution functions, the authors present a direct parameterization and gradient-based estimation procedure that preserves double robustness while improving interpretability and computational efficiency.\nTheoretical results include finite-sample bounds, convergence guarantees, and robustness proofs. Empirical validation shows improved estimation accuracy across simulated and real-world datasets (e.g., employment outcomes). The method also generalizes to both linear and neural network parameterizations."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "The paper presents the first direct doubly robust estimator for the Conditional Quantile Contrast (CQC), offering a method that effectively connects theoretical causal inference principles with practical implementation. It contributes new finite-sample and convergence bounds, extending robustness theory in heterogeneous treatment effect estimation. The proposed algorithm is clearly articulated through a gradient-based optimization procedure (Algorithm 1), making it both conceptually transparent and computationally feasible. The authors validate their approach with comprehensive experiments that vary sample size, noise level, and functional complexity, and further demonstrate interpretability through a real-world employment dataset. Overall, the work is grounded in a solid mathematical foundation and builds meaningfully on existing causal inference literature, particularly the frameworks of Kennedy (2023) and Kallus (2023)."}, "weaknesses": {"value": "1. The real-world data analysis, while effectively illustrating the interpretability of the proposed estimator, lacks quantitative comparisons to other causal inference methods. The employment dataset experiment focuses on qualitative visualization of treatment heterogeneity but does not benchmark performance against either inversion-based CQC estimators or widely used CATE-based models such as TARNet, DragonNet, or BART. Including such comparisons would provide essential empirical context, clarifying whether modeling full conditional quantile contrasts yields measurable advantages over standard mean-based causal estimators in practical applications.\n\n2. The introduction and abstract clearly present the statistical motivation behind estimating the Conditional Quantile Contrast (CQC) but do not effectively convey its practical significance. They could better highlight how CQC interpretation informs real-world decisions—such as in policy analysis, where understanding which subgroups benefit most or least from interventions is critical. Without a clear link to applied impact, the estimator’s broader relevance to practitioners and policymakers remains underemphasized.\n\n3. There are some grammar errors:\nLine 214: “AppendixA.1” → “Appendix A.1”\nLine 331-332: “Proposition 1b)” → “Proposition 1(b)”\nLine 361-362: “which their estimated equivalents” → “that uses their estimated equivalents”\nLine 398: “effected” → “affected”\nLine 409-410: “perform well” → “performs well”"}, "questions": {"value": "1. Could the authors expand the real-world analysis by including quantitative comparisons to other estimators? Specifically, how does the proposed method perform relative to both inversion-based CQC estimators and standard CATE-based models such as TARNet, DragonNet, or BART? Even though these approaches estimate different quantities, wouldn’t such comparisons help clarify whether modeling conditional quantile contrasts offers practical advantages over mean-based causal estimators? If you have reasons for not comparing those, could you explain reasons?\n\n2. I think ablation studies isolating the contributions of each model component (e.g., nuisance models, parameterization choices) would strengthen the empirical claims - are there plans to include these analyses, or are there some reasons that this kind of study is not considered?\n\n3. Are there some possible ways to formally quantify or evaluate interpretability beyond qualitative visualization?\n\n4. Could the authors provide computational complexity comparisons (runtime, memory) versus the inversion method?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "yo1H1Tqoys", "forum": "G8GcKviwBE", "replyto": "G8GcKviwBE", "signatures": ["ICLR.cc/2026/Conference/Submission5090/Reviewer_MqaP"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5090/Reviewer_MqaP"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission5090/-/Official_Review"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762952350631, "cdate": 1762952350631, "tmdate": 1762952350631, "mdate": 1762952350631, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}