{"id": "t21xf6rxqY", "number": 6559, "cdate": 1757988900687, "mdate": 1759897908073, "content": {"title": "STDDN: A Physics-Guided Deep Learning Framework for Crowd Simulation", "abstract": "Accurate crowd simulation is crucial for public safety management, emergency evacuation planning, and intelligent transportation systems. However, existing methods, which typically model crowds as a collection of independent individual trajectories, are limited in their ability to capture macroscopic physical laws. This microscopic approach often leads to error accumulation and compromises simulation stability. Furthermore, deep learning-driven methods tend to suffer from low inference efficiency and high computational overhead, making them impractical for large-scale, efficient simulations. To address these challenges, we propose the Spatio-Temporal Decoupled Differential Equation Network (STDDN), a novel framework that guides microscopic trajectory prediction with macroscopic physics. We innovatively introduce the continuity equation from fluid dynamics as a strong physical constraint. A Neural Ordinary Differential Equation (Neural ODE) is employed to model the macroscopic density evolution driven by individual movements, thereby physically regularizing the microscopic trajectory prediction model. We design a density-velocity coupled dynamic graph learning module to formulate the derivative of the density field within the Neural ODE, effectively mitigating error accumulation. We also propose a differentiable density mapping module to eliminate discontinuous gradients caused by discretization and introduce a cross-grid detection module to accurately model the impact of individual cross-grid movements on local density changes. The proposed STDDN method has demonstrated significantly superior simulation performance compared to state-of-the-art methods on long-term tasks across four real-world datasets, as well as a major reduction in inference latency.", "tldr": "", "keywords": ["spatiotemporal-learning;physics-informed;neural ODE;crowd simulation;"], "primary_area": "neurosymbolic & hybrid AI systems (physics-informed, logic & formal reasoning, etc.)", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/ae1037c4f52145f5371230c7db43f30b3c2a0dfe.pdf", "supplementary_material": "/attachment/697c5a18f0bd8be24808089ae04b1954ae6f7953.zip"}, "replies": [{"content": {"summary": {"value": "This work proposes a physics-guided deep learning framework for crowd simulation (STDNN). The authors introduce the continuity equation from fluid dynamics as a strong physical constraint and design a density-velocity coupled dynamic graph learning module. They show that STDNN is significantly superior to simulation performance compared to SOTA methods."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "1.\tThe authors propose a network of time-space decoupled differential equations combined with the continuity equation, which is helpful for predicting the physical laws of trajectories in the macroscopic world.\n2.\tIn experiments, Tables 1 and 2 clearly illustrate the trajectories and verifies main results from the paper."}, "weaknesses": {"value": "1.\tThe proposed method uses Neural ODEs to solve $\\rho$, but there are many similar ideas, and the use of Neural ODEs in trajectory prediction is also a very common approach.\n2.\tThe proposed method utilizes constraints based on continuity equations, but the specific implementation of this constraint in the Neural ODE framework requires more detailed explanation.\n3.\tThe authors conducted many experiments, but it seems that it is necessary to split each subset of the dataset and compare with newer baselines and methods. The current baseline only reaches the year 2024. Based on the trajectory dataset used by the authors, it seems that there are a large number of sota in pedestrian trajectory prediction that have not been compared."}, "questions": {"value": "1.\tHow is the continuity equation incorporated into the Neural ODE solution process? It requires a more detailed explanation.\n2.\tThe detailed parameters used when solving the Neural ODE in torchdiffeq are not disclosed.\n3.\tFigure 1 contains many typo errors.\n⦁\tFor example, $Gin$($Gout$) should actually be $G_{in}$($G_{out}$).\n⦁\tThe input to Microscopic seems to be $\\pho^0$.\n⦁\tThe DDM and CGD in the figure are also too simple.\n4.\tShould the use of the loss function in Eq 10 be more explicit? Eq 8 does not seem to be included in it.\n5.\tAre there more granular comparative tests, such as what the results were for ETH/HOTEL/ZARA1/ZARA2/UNIV, respectively?\n6.\tShould ADE and FDE also be reported for general trajectories?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "dUGAdnMExo", "forum": "t21xf6rxqY", "replyto": "t21xf6rxqY", "signatures": ["ICLR.cc/2026/Conference/Submission6559/Reviewer_aHns"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6559/Reviewer_aHns"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission6559/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761616351200, "cdate": 1761616351200, "tmdate": 1762918899314, "mdate": 1762918899314, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes STDDN (Spatio-Temporal Decoupled Differential Equation Network), a novel physics-guided deep learning framework for crowd simulation. Unlike prior microscopic or purely data-driven approaches, STDDN introduces a Neural ODE formulation guided by the continuity equation from fluid dynamics, thereby coupling macroscopic density evolution with microscopic trajectory prediction. The model integrates three modules — Differentiable Density Mapping (DDM), Continuous Cross-Grid Detection (CGD), and Node Embedding (NE) — to ensure differentiability and physical consistency. Experiments on four real-world datasets (GC, UCY, ETH, HOTEL) show that STDDN significantly improves both simulation accuracy and inference speed compared with state-of-the-art baselines such as SPDiff and PCS."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "1、Novel Integration of Physics and Deep Learning:\nThe paper introduces a principled way to integrate the continuity equation into deep models for crowd simulation. This macro–micro coupling via Neural ODE is both original and physically interpretable.\n2、Methodological Sophistication:\nThe DVCG module cleverly connects density and velocity fields through a graph structure, while the DDM and CGD modules effectively address gradient discontinuity and cross-grid flux detection. These designs are mathematically sound and technically detailed.\n3、Interpretability and Physical Consistency:\nThe approach offers clear interpretability grounded in physics, addressing a key limitation of previous purely data-driven models that violate conservation laws"}, "weaknesses": {"value": "1、The proposed model enforces strict mass conservation through the continuity equation, implying that the total population density within the target spatial domain remains constant over time. However, in realistic datasets and surveillance scenarios, the number of pedestrians in view is not fixed — new individuals may enter the scene, and others may leave. Such open-world dynamics inherently violate the closed-system assumption of the continuity equation. Without explicit treatment of source or sink terms (i.e., inflow/outflow of mass) or adaptive boundary conditions, the model may experience cumulative density drift or numerical instability, particularly when crowd density fluctuates significantly. The authors are encouraged to clarify whether boundary inflows are modeled, or to discuss potential modifications to better handle non-conserved population scenarios.\n\n2、The ablation study provides useful insights, particularly regarding the contributions of the ODE solver and the mass constraint loss. Both components appear meaningful; however, the current experimental setup only uses discrete outputs in the loss computation. As a result, the experiments do not adequately demonstrate the benefit of continuous-time modeling enabled by the ODE formulation. To strengthen this section, I suggest decomposing the “w/o ODE” setting into two variants:\n(1)Purely autoregressive training, as mentioned in the paper (“trained using purely autoregressive methods”).\n(2)Discrete neural network replacement for ODE, where the ODE solver is replaced with a discrete neural module that still leverages the combined loss function including the mass constraint term.\nSuch a refinement would better isolate the contribution of the continuous-time ODE formulation from the general modeling capacity and loss design, making the ablation analysis more convincing."}, "questions": {"value": "Can the authors explain why the fluid physics improves results in low-density datasets like ETH and HOTEL, where the fluid assumption barely holds?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "0cJlbKr5lK", "forum": "t21xf6rxqY", "replyto": "t21xf6rxqY", "signatures": ["ICLR.cc/2026/Conference/Submission6559/Reviewer_n74p"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6559/Reviewer_n74p"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission6559/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761663330534, "cdate": 1761663330534, "tmdate": 1762918898928, "mdate": 1762918898928, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes STDDN, a novel framework for crowd simulation that addresses the common issues of error accumulation and physical inconsistency in long-term predictions. Its core contribution is the unique integration of a macroscopic physical law—the continuity equation from fluid dynamics—with a microscopic deep learning model for trajectory prediction. By using a Neural ODE to model crowd density evolution, STDDN enforces a strong physical constraint during training. Experiments show that STDDN not only achieves state-of-the-art accuracy but also significantly reduces inference latency compared to leading methods."}, "soundness": {"value": 3}, "presentation": {"value": 4}, "contribution": {"value": 3}, "strengths": {"value": "The paper's primary strength is its originality in creating a macro-micro coupled framework. Using the continuity equation to regularize trajectory prediction is a conceptually novel and powerful idea for this field. The quality of the work is good, supported by rigorous and comprehensive experiments that convincingly demonstrate superior performance in both accuracy and efficiency over strong baselines. The paper is also written with exceptional clarity."}, "weaknesses": {"value": "- **Lack of Direct Physical Metrics**: The paper claims to improve physical realism by avoiding issues like congestion and collisions, but it fails to provide direct quantitative evidence. The evaluation relies on general error metrics (MAE/OT), which are insufficient proxies. The work would be much stronger if it included systematic measurements and comparisons of collision rates, obstacle penetration rates or density extremum analysis to directly support its core claims.\n- **Training Cost**: While the paper rightly emphasizes its fast inference speed, it completely neglects to discuss the training cost. The use of a Neural ODE likely makes the training process computationally expensive and slow. An additional analysis should be included in the paper.\n- **A minor issue**: the table in page 8 has a wrong caption: \"**Figure** 4\"."}, "questions": {"value": "- The fluid dynamics assumption is a strong prior. Could you clarify the intended scope of your method? In which crowd scenarios (e.g., panic, counterflow) might this assumption become a limitation?\n- Given the model's sensitivity to grid size, can you offer any practical guidelines or a more principled approach for selecting this crucial hyperparameter for new scenes?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "L5TV9TQTNF", "forum": "t21xf6rxqY", "replyto": "t21xf6rxqY", "signatures": ["ICLR.cc/2026/Conference/Submission6559/Reviewer_Fbqh"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6559/Reviewer_Fbqh"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission6559/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761899004873, "cdate": 1761899004873, "tmdate": 1762918898571, "mdate": 1762918898571, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes STDDN (Spatio-Temporal Decoupled Differential Equation Network), a novel physics-guided deep learning framework for crowd simulation.\nSTDDN explicitly combines microscopic trajectory prediction with macroscopic density evolution by embedding the continuity equation from fluid dynamics into a Neural ODE structure.\nThe model separates local trajectory dynamics from global density fields, enabling physical consistency and stable long-term simulations.\nExperiments on four real-world crowd datasets (GC, UCY, ETH, HOTEL) show that STDDN outperforms prior physics-guided baselines such as SPDiff and PCS in both accuracy and inference speed."}, "soundness": {"value": 4}, "presentation": {"value": 3}, "contribution": {"value": 4}, "strengths": {"value": "1.\tGood motivation on coupling of micro- and macro-level dynamics.\n\nThe paper’s main contribution is conceptually sound. By using the continuity equation as a bridge between trajectory prediction and density evolution, STDDN unifies local motion modeling with global flow consistency.\n\n2.\tPhysically meaningful ODE formulation.\n\nThe introduction of a Neural ODE to simulate density evolution is well justified. It provides continuous-time reasoning while enforcing conservation principles, addressing a key limitation of purely data-driven models that tend to accumulate errors over time.\n\n3.\tStrong empirical performance.\n\nAcross four datasets, STDDN shows consistent gains over all baselines, including both physics-based and deep learning methods. The improvements in both accuracy and latency demonstrate that the proposed framework is practically beneficial.\n\n4.\tInterpretability and efficiency.\n\nThe method retains interpretability through its physically grounded formulation while remaining computationally tractable, which is uncommon in physics-guided models."}, "weaknesses": {"value": "1.\tLimited experimental diversity.\n\nAlthough the method is tested on multiple datasets, all belong to similar crowd domains. It would strengthen the generality claim to include different physical systems, such as vehicle or swarm simulation.\n\n2.\tAblation breadth.\n\nThe ablation study is informative but it would be useful to show how performance changes under different ODE solvers or with alternative coupling strengths between density and trajectory modules.\n\n3.\tMinor missing citations for ODE-based trajectory forecasting.\n\nThe paper would benefit from acknowledging prior studies that have already explored ODE formulations for trajectory or crowd prediction, such as Social ODE: Multi-agent Trajectory Forecasting with Neural Ordinary Differential Equations (ECCV 2022) and Improving Transferability for Cross-Domain Trajectory Prediction via Neural Stochastic Differential Equation (AAAI 2024).\nThese works share conceptual overlap in embedding physical dynamics into continuous differential frameworks."}, "questions": {"value": "Please see the weakness section"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 8}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "NtfddkghRg", "forum": "t21xf6rxqY", "replyto": "t21xf6rxqY", "signatures": ["ICLR.cc/2026/Conference/Submission6559/Reviewer_JPbf"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission6559/Reviewer_JPbf"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission6559/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762096827854, "cdate": 1762096827854, "tmdate": 1762918898222, "mdate": 1762918898222, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}