{"id": "tl5bbHE78p", "number": 17214, "cdate": 1758273567996, "mdate": 1759897190422, "content": {"title": "FlowLet: Conditional 3D Brain MRI Synthesis using Wavelet Flow Matching", "abstract": "Brain Magnetic Resonance Imaging (MRI) plays a central role in studying neurological development, aging, and diseases. One key application is Brain Age Prediction (BAP), which estimates an individual’s biological brain age from MRI data. Effective BAP models require large, diverse, and age‑balanced datasets, whereas existing 3D MRI datasets are demographically skewed, limiting fairness and generalizability. Acquiring new data is costly and ethically constrained, motivating generative data augmentation. Current generative methods are often based on latent diffusion models, which operate in learned low dimensional latent spaces to address the memory demands of volumetric MRI data. However, these methods are typically slow at inference, may introduce artifacts due to latent compression, and are rarely conditioned on age, thereby affecting the BAP performance. In this work, we propose FlowLet, a conditional generative framework that synthesizes age‑conditioned 3D MRIs by leveraging flow matching within an invertible 3D wavelet domain, helping to avoid reconstruction artifacts and reducing computational demands. Experiments show that FlowLet generates high‑fidelity volumes with few sampling steps. Training BAP models with data generated by FlowLet improves performance for underrepresented age groups, and region‑based analysis confirms preservation of anatomical structures.", "tldr": "FlowLet generates realistic, age-specific 3D brain MRIs using flow matching in the wavelet domain, enabling accurate brain-age prediction and validated through both distributional metrics and region-level anatomical plausibility.", "keywords": ["Medical Image Generation", "Flow Matching", "Wavelet Transform", "Brain Age Prediction"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/3ddcd621792c89f4c61f372656e86df91cec99ce.pdf", "supplementary_material": "/attachment/ad61b8ef4a0dad6587f9e40ca5a5f5175ca9c803.zip"}, "replies": [{"content": {"summary": {"value": "This paper introduces FlowLet, an innovative conditional generation framework that integrates flow matching with 3D wavelet transform technology to achieve age-conditional brain MRI synthesis. The study addresses demographic imbalances present in existing datasets."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "The authors propose an innovative method that operates directly in the reversible wavelet domain, offering advantages in computational efficiency and anatomical fidelity while avoiding reconstruction artifacts common in potential space compression methods. The study demonstrates comprehensiveness, evaluating image quality metrics, region-based anatomical analysis, and downstream BAP performance—particularly focusing on underrepresented age cohorts."}, "weaknesses": {"value": "The paper currently compares only a few baseline models and lacks a comprehensive evaluation of the latest mainstream brain MRI synthesis models from 2024 and 2025. It is recommended that the authors include comparisons with more recent representative models, such as TUMSyn, BrainMRDiff, BrainSynth, InBrainSyn, etc., to enhance the depth and breadth of the study in the revised manuscript."}, "questions": {"value": "1.The paper positions \"wavelet domain\" and \"flow matching\" as core innovations, but does not explain how the synergy between the two contributes to the overall effectiveness. It is necessary to provide a specific explanation of the unique advantages of performing flow matching in the wavelet domain, compared to other approaches (such as in the original or latent space), and how this combination addresses issues that single techniques cannot solve.\n2.Regarding the baseline comparison experiments, the paper selects WDM, MD, etc., but fails to explain why more recent 3D medical image generation models were not included. The criteria for baseline selection (such as representativeness, open-source availability, and task relevance) should be clarified, and an argument should be provided as to why these baselines are sufficient to cover the current mainstream technological approaches\n3.The choice of Haar wavelet is based solely on its \"simplicity,\" but the paper does not discuss whether its poor directional selectivity, frequency band aliasing, and other issues make it suitable for brain MRI generation. A systematic comparison with other wavelet bases (such as Daubechies and Symlets) should be conducted to demonstrate the advantages of Haar wavelet in the context of brain MRI generation tasks.\n4.The paper mentions that latent diffusion models suffer from slow inference, but it does not fully explain how slow inference impacts clinical applications. MRI scans involve large volumes of data, and quick processing is needed in real-world medical scenarios. How does the inference time for FlowLet in generating synthetic data compare to existing models? Is FlowLet’s inference time sufficient to meet clinical demands? Although the paper states that FlowLet reduces computational demands, it does not clarify how these reductions manifest in actual deployment. How does FlowLet perform in resource-constrained clinical environments?\n5.The concept of age modulation is introduced as a feature of FlowLet, but the paper does not provide sufficient explanation of how this modulation works. How does FlowLet ensure that the generated data accurately reflects aging processes at different stages? Which specific mechanisms in the model allow for accurate age-conditioned synthetic MRI generation? While the paper mentions that FlowLet reduces global variability and overfitting, it does not explain how the model prevents overfitting to specific age groups or anatomical features. What measures have been taken to ensure that the model does not generate unrealistic, biased, or overfitted synthetic data?\n6.The paper uses three publicly available datasets for experiments but does not discuss any external validation beyond these datasets. How well does FlowLet generalize to datasets from different sources or in real-world clinical environments? It would be useful to understand how FlowLet performs on out-of-sample data.\n7.Although FlowLet employs wavelet transforms to reduce computational demands, it does not explain how the resolution of the generated images affects their quality. Is there a trade-off between lowering resolution to improve computational efficiency and maintaining fine anatomical detail? A clearer discussion of how resolution impacts the utility of the generated data would be valuable.\n8.The paper introduces several flow matching formulas, such as RFM, CFM, and VP, but does not provide enough information to explain why one formula might outperform others for specific tasks. What are the trade-offs of these formulas in terms of computational efficiency, image quality, and anatomical accuracy?\n9.The paper currently compares only a few baseline models and lacks a comprehensive evaluation of the latest mainstream brain MRI synthesis models from 2024 and 2025. It is recommended that the authors include comparisons with more recent representative models, such as TUMSyn, BrainMRDiff, BrainSynth, InBrainSyn, etc., to enhance the depth and breadth of the study in the revised manuscript."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 5}, "code_of_conduct": {"value": "Yes"}}, "id": "wAds4DGJ4v", "forum": "tl5bbHE78p", "replyto": "tl5bbHE78p", "signatures": ["ICLR.cc/2026/Conference/Submission17214/Reviewer_Qxy4"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17214/Reviewer_Qxy4"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission17214/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761291970995, "cdate": 1761291970995, "tmdate": 1762927181310, "mdate": 1762927181310, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces FlowLet, a conditional framework for fast 3D brain MRI synthesis that combines Flow Matching with an invertible 3D Haar Discrete Wavelet Transform. Conditioning on age is implemented via a dual mechanism, Feature-wise Linear Modulation and spatial cross-attention, to steer age-specific morphology. The method targets the quality, diversity, and speed trilemma by learning velocities in wavelet space, then integrates an Ordinary Differential Equation for sampling. Empirically, the authors report competitive global fidelity at only 10 steps, improved regional anatomical plausibility, and, most importantly, gains on a downstream Brain Age Prediction  task for an underrepresented age cohort, relative to strong diffusion baselines."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- Combining FM with an invertible 3D wavelet domain for volumetric synthesis is a neat and well-motivated design choice, avoiding learned autoencoders while retaining multi-scale control. The dual conditioning for age is thoughtfully integrated and ablated.\n - The empirical study covers global distribution metrics, region-wise anatomical metrics, and a functional BAP readout. The comparison set includes both latent and wavelet diffusion baselines, plus a recent FM variant retrained with the same conditioning. Statistical testing and step-count ablations are reported, which strengthens claims about speed versus fidelity. \n - The paper is clearly written, the FM variants are laid out, and the architectural blocks and inference loop are explained with helpful figures.\n - Demonstrating that synthetic data improves BAP for older adults addresses a practical fairness issue in neuroimaging and supports the case for conditional synthesis to mitigate demographic imbalance."}, "weaknesses": {"value": "- The paper sketches the VP connection and uses an analytically tractable conditional score to define a deterministic target velocity. However, the presentation could benefit from a concise, explicit derivation that maps the reverse-time SDE drift to the Probability Flow ODE velocity used for training, including the exact role of Tweedie-based conditioning and the factor differences in the score terms. This would make the mathematical bridge between diffusion and FM airtight for the reader.\n - Wavelet basis choice is argued from reconstruction error, not from generative stability: Haar minimizes round-trip MAE, yet it is piecewise constant. Learning smooth vector fields for ODE integration in a discontinuous basis may be suboptimal. A small generative ablation that swaps Haar for a smoother near-lossless basis, for example Coiflet-2 or Daubechies-4, and reports BAP, DICE, and solver stability would directly test whether slightly higher reconstruction error trades for better flow smoothness in practice. \n - The trigonometric path attains strong FID at low steps, then degrades at higher steps. This suggests that velocity approximation error interacts with curvature and the simple Euler integrator. A brief study with a higher order fixed-step solver or an adaptive integrator, together with curvature-aware regularization, would clarify whether the instability is from the path geometry, the network capacity, or the integrator. \n - The paper compares to latent diffusion and wavelet diffusion, and to a medical FM baseline. To strengthen the positioning, discuss or, if feasible, add results for recent conditional FM or rectified-flow variants tuned for fast sampling in high-resolution synthesis, and for very high-resolution latent diffusion scheduling strategies. Referencing recent overviews of Conditional Flow Matching and recent ultra-high-resolution latent diffusion schedulers would help calibrate novelty in efficiency-driven conditional synthesis [1, 2, 3].\n - The text claims that FlowLet trains in 24 GB while baselines need 48 GB. A short table with peak VRAM, wall-clock per iteration, samples per second, and total training time for RFM-10 versus MLDM and WDM would make the efficiency claim fully auditable. \n - Nonparametric testing and Bonferroni correction are strengths, however, reporting exact p-values and effect sizes for key pairwise differences, plus region-wise breakdowns for a small set of clinically salient structures, would improve rigor and interpretability for the regional analysis. \n\nReferences:\n\n[1] Gagneux A, Martin ST, Emonet R, Bertrand Q, Massias M. A visual dive into conditional flow matching. InThe Fourth Blogpost Track at ICLR 2025 2025.\n\n[2] Zhang J, Huang Q, Liu J, Guo X, Huang D. Diffusion-4k: Ultra-high-resolution image synthesis with latent diffusion models. InProceedings of the Computer Vision and Pattern Recognition Conference 2025 (pp. 23464-23473).\n\n[3] Yazdani M, Medghalchi Y, Ashrafian P, Hacihaliloglu I, Shahriari D. Flow matching for medical image synthesis: Bridging the gap between speed and quality. InInternational Conference on Medical Image Computing and Computer-Assisted Intervention 2025 Sep 20 (pp. 216-226). Cham: Springer Nature Switzerland."}, "questions": {"value": "- Could the authors provide a compact derivation that starts from the VP reverse-time SDE, writes the corresponding Probability Flow ODE, then shows the exact conditional velocity that is implemented for training, with assumptions made explicit and the conditioning distribution spelled out?\n - What breaks first in the trigonometric variant at high step counts, the integrator or the velocity approximation, and does a second-order or adaptive solver recover stability without losing speed at 10 to 20 steps?\n - How does FlowLet scale with resolution and volume size, for example 128³ or higher? A short scaling plot for FID, DICE, and sampling time would be informative.\n - Can the authors report peak VRAM and tokens per second style throughput for training and sampling, side-by-side with MLDM and WDM, to substantiate the efficiency statement?\n - Would adding weak anatomical priors at training time, for example mask-based channels or morphometric covariates already computed for evaluation, further improve regional DICE and BAP without harming diversity?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "n/a"}, "rating": {"value": 4}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "jsVvZDb5Wr", "forum": "tl5bbHE78p", "replyto": "tl5bbHE78p", "signatures": ["ICLR.cc/2026/Conference/Submission17214/Reviewer_Qqnb"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17214/Reviewer_Qqnb"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission17214/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761412047778, "cdate": 1761412047778, "tmdate": 1762927180269, "mdate": 1762927180269, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The presented work proposes to combine wavelet transforms and flow matching to efficiently synthesize volumetric brain MR images. Specifically, the entire flow matching generative process is conducted on images that have been encoded via Haar wavelet functions, reducing the size of all feature maps by a factor of eight. The proposed method is compared to four relevant baselines, including diffusion models incorporating wavelet transforms as well as flow matching algorithms. In addition to classical image fidelity and diversity metrics, the authors introduce three different region-based anatomical plausibility metrics that aim to measure an image's fine-grained anatomical detail. Finally, the authors evaluate the utility of generated images to train a brain age classification model. The proposed method is shown to perform on par or slightly better than the baselines while requiring fewer sampling steps."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 2}, "strengths": {"value": "- The combination of wavelet transforms and flow matching for efficient image synthesis is somewhat interesting and appears to be novel.\n\n- The authors provide many details about their experimental setup. Beyond the description of the main results, they conduct extensive ablation experiments, which investigate the effect of many hyperparameters, including the used wavelet function, specific flow matching implementation, number of sampling steps, and conditioning mechanism.\n\n- The manuscript is clearly structured, illustrated, and well written, making it easy to understand and follow."}, "weaknesses": {"value": "- The authors motivate their work by stating that flow matching in wavelet domain increases computational efficiency. However, I do not believe that this of high importance if the ultimate goal is to generate training data for brain age prediction. Most likely, the training dataset would have to be generated only once, making slower model inference essentially irrelevant.\n\n- Despite some concerns regarding the fairness of the experimental setup (see questions below), the proposed method only barely outperforms some of the included baselines, in particular the wavelet diffusion model. \n\n - I do not believe that the newly introduced region-based anatomical plausibility metrics are suited to evaluate generative models (see questions below for specific concerns)."}, "questions": {"value": "- Previous work has already combined wavelet filters with normalizing flows (Yu, Jason J., Konstantinos G. Derpanis, and Marcus A. Brubaker. \"Wavelet flow: Fast training of high resolution normalizing flows.\" Advances in Neural Information Processing Systems 33 (2020): 6184-6196). I believe the authors should briefly discuss this work considering the conceptual similarities between normalizing flows and flow matching.\n\n- Conditioning has long been known to improve the performance of generative models (e.g. Ho, Jonathan, and Tim Salimans. \"Classifier-free diffusion guidance.\" arXiv preprint arXiv:2207.12598 (2022)). As such, it is noteworthy that only two of the baselines include conditioning. In order to ensure a fair comparison with the proposed method, I believe that the remaining baselines – in particular the wavelet diffusion model – should be enhanced with a conditioning mechanism similar to the authors’ MOTFMa variant of the MOTFM baseline.\n\n- I struggle to understand the rationale behind the proposed region-based anatomical plausibility metrics. In my understanding a good generative model should yield diverse samples even for a fixed age conditioning, reflecting the anatomical variance across humans. As such, I would not expect anatomical structures to perfectly align and appear with similar intensities across samples. However, the proposed iMAE and DICE metric measure may penalize this behavior by rewarding high similarity between generated and an arbitrarily selected age-matched reference sample. Specifically, a generative model, which experiences severe mode collapse and only produces a single sample, may outperform a well-behaved model, dependent on the selected reference sample.\n\n- On a lesser note, I presume the newly introduced anatomical plausibility metrics are reported and calculated as average across all 95 regions of interest. However, the associated variables $r$ and $\\mathcal{R}$ are not properly introduced."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "iOxYyMsFn0", "forum": "tl5bbHE78p", "replyto": "tl5bbHE78p", "signatures": ["ICLR.cc/2026/Conference/Submission17214/Reviewer_Bkem"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17214/Reviewer_Bkem"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission17214/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761577250497, "cdate": 1761577250497, "tmdate": 1762927179964, "mdate": 1762927179964, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper introduces FlowLe for synthesizing age-conditioned 3D brain MRIs. The motivation is that existing MRI datasets exhibit demographic imbalances (e.g., skewed age distributions), which limit the fairness and generalizability of downstream models, such as Brain Age Prediction (BAP). \nThe problem definition addresses the limitations of current generative models, which are often slow (e.g., diffusion models) or introduce artifacts via latent space compression. The main novelty is the integration of Flow Matching (FM) with an invertible 3D Haar wavelet transform. \nThis approach operates in the wavelet domain to reduce computational demands and avoids learned compression, thereby mitigating associated artifacts."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "The potential impact enables the fast synthesis (e.g., 10 steps vs. 1000 for diffusion baselines) of anatomically consistent, age-specific data, which improves BAP model performance for underrepresented age groups.\n\nThe writing quality contains objective errors, including typographical errors (e.g., \"v_targot\", \"governed oise governed\"), stray formatting characters, and data misalignment in tables (Table 2).\n\nThe evaluation amount is quantitative, comparing four variants of the proposed method (RFM, CFM, VP, Trigonometric) against five baselines using data from three datasets."}, "weaknesses": {"value": "The paper states that \"expert clinical evaluation is essential for diagnostic relevance,\" but this evaluation is not included.\n\nThe paper claims the architecture can \"extend to multiple conditioning variables,\" such as disease status or cognitive scores, but this is not demonstrated. The claim of \"avoiding reconstruction artifacts\" is justified by avoiding latent compression; however, artifacts originating from the generative process itself are not separately quantified.\n\nThe authors identify other age-conditional models (Litrico et al., Pombo et al.) but explicitly exclude them as baselines, as they define their task differently (i.e., aging a specific MRI rather than synthesis from noise)."}, "questions": {"value": "Have you considered works like:\nYeganeh, Y., Farshad, A., Charisiadis, I., Hasny, M., Hartenberger, M., Ommer, B., Navab, N. and Adeli, E., 2025. Latent Drifting in Diffusion Models for Counterfactual Medical Image Synthesis. In Proceedings of the Computer Vision and Pattern Recognition Conference (pp. 7685-7695)."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "nlDCuTHz3q", "forum": "tl5bbHE78p", "replyto": "tl5bbHE78p", "signatures": ["ICLR.cc/2026/Conference/Submission17214/Reviewer_Uwea"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission17214/Reviewer_Uwea"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission17214/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762082118438, "cdate": 1762082118438, "tmdate": 1762927179054, "mdate": 1762927179054, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}