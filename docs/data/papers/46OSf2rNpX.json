{"id": "46OSf2rNpX", "number": 20865, "cdate": 1758311128850, "mdate": 1759896954604, "content": {"title": "CONFLO: Conformal Prediction with Conditional Coverage via Normalizing Flow", "abstract": "Beyond point predictions, conformal prediction provides prediction sets that enjoy finite-sample probability coverage guarantees, but only at the population level. In practice, prediction sets can under- or over-cover in subpopulations, limiting their usability for individual predictions. To address this issue, we propose \\CONFLO, a conformal prediction framework that integrates conditional normalizing flows (CNF) with a novel form of regularization. The anchoring idea is to transform raw nonconformity scores through a feature-dependent bijection into new scores that are (nearly) independent of the inputs. Since independence cannot be perfectly achieved in practice, we add a quantile-aligning penalty to the loss function as an additional tactic to enforce common conditional coverage across user-specified groups. Experiments on diverse datasets demonstrate that CONFLO improves conditional coverage across subpopulations and sizes of prediction sets compared to baseline methods and competitors like APS and RAPS. Theoretical results are provided demonstrating that our algorithm achieves conditional coverage asymptotically.", "tldr": "", "keywords": ["Quantile", "Regularization", "Classification"], "primary_area": "generative models", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/a412a6d1a79d087be7a736ecabb2734e8a7a2d56.pdf", "supplementary_material": ""}, "replies": [{"content": {"summary": {"value": "This paper introduces CONFLO to achieve improved conditional coverage across subpopulations by integrating Conditional Normalizing Flows (CNF) with a quantile alignment (QA) regularization strategy.\nCONFLO consists of two key steps: Score Transformation and Quantile Alignment Regularization. \nCONFLO also introduces an adaptive dual-ascent tuning to automatically balance likelihood fitting and quantile alignment, improving stability and coverage control."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "1. Applying conditional normalizing flows into CP is interesting. By transforming nonconformity scores rather than residuals or outputs, CONFLO generalizes beyond regression to both categorical and multidimensional outcomes. \n\n2. CONFLO unifies multiple previous ideas, such as multicalibration, flow-based reparametrization, and conformal calibration, to a framework. \n\n3. The training process (the algorithmic presentation in Algorithms 1 and 2) is clear."}, "weaknesses": {"value": "1. Although the paper conjectures asymptotic conditional coverage under certain regularity conditions, it does not provide any formal proof or theoretical bounds. Given the paper’s title and motivation, the lack of further theoretical discussion weakens the rigorness, especially for an ICLR main-track submission.\n\n2. Can you formalize or empirically demonstrate the conditions under which the transformed score $B = t_\\theta(A, X)$ becomes asymptotically independent of X? \n\n3. The method involves training CNFs and computing groupwise quantiles at every iteration, which introduces extra computation compared to standard CP methods. The paper lacks emprical and theoretical analysis of computational cost (comparison to APS/RAPS or other baselines). \n\n4. The quantile alignment regularizer depends on k-means and $\\lambda$, both of which may introduce sensitivity. However, there is no ablation study or sensitivity analysis exploring how they affect coverage and efficiency. The effects of (a) CNF transformation alone vs. (b) CNF + QA regularization are also missed. Besides, does $\\lambda$ converge to a stable value across runs?\n\n\n5. CONFLO behind baselines on CIFAR-100 and 20 Newsgroups, whose number of classes is larger than other datasets. Its SSCV is wrose than RAPS. Does it means that the CONFLO’s benefits may diminish as data complexity increases?\n\n6. The baselines and related work miss more recent CP methods, where the only baselines are APS and RAPS. \n\n7. Concerning writing and presentation: \n\n7a. The big picture (how the **subpopulation** issue is addressed by **CONFLO**) is not clear.\n\n7b. Some sections (especially 2.2–2.3) are dense and could be better motivated with intuition or figures illustrating the effect of CNF transformations and quantile alignment. \n\n7c. Key information in Figure 1 is hard to distinguish, such as legned and texts."}, "questions": {"value": "See above."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 2}, "code_of_conduct": {"value": "Yes"}}, "id": "aEs7j5yP2J", "forum": "46OSf2rNpX", "replyto": "46OSf2rNpX", "signatures": ["ICLR.cc/2026/Conference/Submission20865/Reviewer_haGN"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20865/Reviewer_haGN"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission20865/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761529748060, "cdate": 1761529748060, "tmdate": 1763000005090, "mdate": 1763000005090, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes CONFLO, a conformal prediction framework that aims to achieve conditional coverage by using conditional normalizing flows (CNF) to transform non-conformity scores into new scores that are nearly independent of input features."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 1}, "strengths": {"value": "Systematic evaluation across ten diverse datasets spanning tabular (CoverType, SATImage), image (MNIST, CIFAR-10/100, SVHN), and text domains (AG News, Banking77)."}, "weaknesses": {"value": "Marginal coverage guarantee (Proposition 1) is standard and doesn't address the main conditional coverage claim.\n\nNo theoretical analysis of when/why the QA regularization should work or under what conditions near-independence can be achieved.\n\nBuilds incrementally on existing flow-based conformal methods. It is unclear how their CNF application to scores differs from existing works.\n\nOnly compares against APS and RAPS; missing comparisons to other conditional conformal prediction variants.\n\nAPS and RAPS overcover in many datasets, indicating potential implementation issues or unfair baseline setup.\n\nQA regularization appears ad-hoc without strong theoretical justification for why minimizing quantile differences should improve conditional coverage. The number of groups is not justified or validated.\n\nComputational overhead of training CNF not discussed or compared against baselines.\n\nHyperparameter sensitivity (number of groups G, clustering method) not thoroughly analyzed."}, "questions": {"value": "The authors should address the concerns raised in the weakness section above."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "HnkwQtsnv0", "forum": "46OSf2rNpX", "replyto": "46OSf2rNpX", "signatures": ["ICLR.cc/2026/Conference/Submission20865/Reviewer_54DC"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20865/Reviewer_54DC"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission20865/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761844443415, "cdate": 1761844443415, "tmdate": 1762937220002, "mdate": 1762937220002, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "This paper proposes to address the conditional validity of conformal prediction by using conditional normalizing flows to transform the scores, such that the transformed conformity score is independent of the feature. There are two novel aspects compared to Colombo et al. First, CONFLO is applicable to any outcome structure including continuous and discrete outcomes. This is achieved by transforming non-conformity scores instead of raw residuals. Second, the conditional normalizing flow is trained with a regularizer to explicitly enforce quantile alignment of transformed scores across feature groups. The resulting method is validated on tabular, image and language datasets, which show improved conditional coverage and reduces set size compared to APS and RAPS."}, "soundness": {"value": 2}, "presentation": {"value": 3}, "contribution": {"value": 1}, "strengths": {"value": "1. This paper studies the core challenge for the conditional validity of conformal prediction, which limits the application of conformal prediction in OOD cases. \n2. The proposed method has demonstrated significant improvement in conditional validity in 6 of 10 tasks, compared to APS and RAPS."}, "weaknesses": {"value": "1. Regression tasks are not involved in experiments, though the proposed method is theoretically compatible with regression tasks.\n\n2. The method is benchmarked against basic conformal prediction algorithms such as APS, which does not guarantee conditional validity. There is a branch of research that provides conditional validity guarantee [1,2,3]. Some of these methods are discussed as related work but none of them are shown in experiments.\n\n3. It is unclear what technical challenge arises considering transformation of conformity scores instead of residuals.\n\n4. It is unclear what degree of improvement can be attributed to the quantile alignment regularizer. An ablation study will be relevant.\n\n5. A conditional coverage guarantee is not theoretically provided, in contrast to related research [1,2,3].\n\n[1] Isaac Gibbs, John J. Cherian, and Emmanuel J. Cand`es. Conformal prediction with conditional guarantees, 2024. URL https://arxiv.org/abs/2305.12616.\n[2] Jung, C., Noarov, G., Ramalingam, R., & Roth, A. (2022). Batch multivalid conformal prediction. arXiv preprint arXiv:2209.15145.\n[3] Bairaktari, K., Wu, J., & Wu, Z. S. (2025). Kandinsky Conformal Prediction: Beyond Class-and Covariate-Conditional Coverage. arXiv preprint arXiv:2502.17264."}, "questions": {"value": "Please refer to the weaknesses."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 2}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "CjFvTVPtzN", "forum": "46OSf2rNpX", "replyto": "46OSf2rNpX", "signatures": ["ICLR.cc/2026/Conference/Submission20865/Reviewer_Gnzi"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20865/Reviewer_Gnzi"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission20865/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761989076027, "cdate": 1761989076027, "tmdate": 1762937127620, "mdate": 1762937127620, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "The paper proposes a novel conformal prediction method based on conditional normalized flows, CONFLO. This method aims to obtain smaller prediction set sizes and better conditional coverage than standard methods, by virtue of the normalizing flow insight. Thereby, the set of original nonconformity scores are mapped via a special trainable set of mappings to “approximately feature-independent” nonconformity scores; the principle is that on the transformed scores, it is possible to use the marginal quantile for the cutoff directly (as in vanilla marginal conformal prediction), instead of applying adaptive conformal methods, while still ensuring adaptively changing prediction sets as a result of the inverse flow map. In addition, the further quantile correction component is added to the algorithm, which regularizes by enforcing the rough equality of group quantiles (as should happen under true independence) on some heuristically derived groups. Empirical results demonstrate improvements over APS and RAPS in terms of vanilla coverage, stratified conditional coverage, and prediction set size, on a suite of experimental tasks."}, "soundness": {"value": 2}, "presentation": {"value": 2}, "contribution": {"value": 2}, "strengths": {"value": "For the strengths of the paper, several aspects stand out. First of all, the improved performance in terms of adaptivity (prediction set size and stratified conditional coverage), while keeping the tight marginal coverage guarantees, are important. \n\nSecond, the new angle on the use of normalizing flows in conformal prediction (namely, applying them directly on the nonconformity scores) is quite clean and useful, and leads to a broader applicability of the method (as it can thus be used both for regression and for classification problems without modification).\n\nThird, the quantile regularization technique is a quick but useful idea; in a sense, it brings back the group-wise quantile conditions idea in this simplified, CNF-adjusted form."}, "weaknesses": {"value": "First, the paper does a bit of a restricted job in terms of conditional coverage guarantees. On the theoretical front, we only have a conjecture of asymptotically conditional coverage, which appears plausible from a general perspective but the (likely slow, as suggested by results concerning the impossibility of exact conditional coverage) quantitative rates would be key to have.\n\nBut more immediately, in the context of the manuscript, even the empirical evaluation of conditional coverage is not fully convincing, For SSCV, the strata must be selected heuristically, and in this case 20 such strata were created — but no ablation was performed against other granularity or other strata construction methods (such as actual meaningful, possibly intersecting, groups); as such, the obtained empirical conditional coverage rates are suggestive but not conclusive or thorough enough. \n\nFurther, for the current results, while SSCV was in fact much better for CONFLOW on several settings, but on other settings it was quite close of a gap, so given the “simple baseline” status of APS and RAPS, the results may not be very impressive just yet.\n\nSecond, developing the above point, there are only comparisons to APS/RAPS nonconformity scores. As such, it’s not clear to me why the method was not compared to conditional coverage conformal methods. And, importantly, why no comparison was made to other normalized flow-based conformal methods; these methods were discussed in the intro and related work sections, but very briefly — this needs to be addressed, both in terms of a longer qualitative discussion of these other 2 methods, and in terms of finding a way to include them as baselines.\n\nFurthermore, the text doesn’t elaborate on any ablation with respect to the quantile-fixing regularization procedure. Indeed, it’s not clear whether the weight is pulled mainly by the CNF, or if the main role of the CNF is to transform the nonconformity scores such that the quantile equating regularization term can become meaningful and pull the weight? As such, I believe empirical evaluation on this ablation front is needed."}, "questions": {"value": "Please see above in the weaknesses section; many of my questions concern conditional coverage, a better comparison to related work, and more careful ablations."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 4}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "YDgszKo1a2", "forum": "46OSf2rNpX", "replyto": "46OSf2rNpX", "signatures": ["ICLR.cc/2026/Conference/Submission20865/Reviewer_yVMa"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission20865/Reviewer_yVMa"], "number": 4, "invitations": ["ICLR.cc/2026/Conference/Submission20865/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761995500058, "cdate": 1761995500058, "tmdate": 1762937086390, "mdate": 1762937086390, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}