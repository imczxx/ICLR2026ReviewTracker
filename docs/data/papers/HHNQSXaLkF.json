{"id": "HHNQSXaLkF", "number": 5088, "cdate": 1757846780565, "mdate": 1759897995238, "content": {"title": "Tree-sliced Sobolev IPM", "abstract": "Recent work shows Tree-Sliced Optimal Transport to be an efficient and more expressive alternative to Sliced Wasserstein (SW), improving downstream performance. Tree-sliced metrics compare probability distributions by projecting measures onto tree metric spaces; a central example is the Tree-Sliced Wasserstein (TSW) distance, which applies the $1$-Wasserstein metric after projection. However, computing tree-based $p$-Wasserstein for general $p$ is costly, largely confining practical use to $p=1$. In this work, we revisit Sobolev integral probability metrics (IPM) on trees to obtain a practical generalization of TSW. Building on the insight that a suitably regularized Sobolev IPM admits a closed-form expression, we introduce TS-Sobolev, a tree-sliced metric that aggregates regularized Sobolev IPMs over random tree systems and remains tractable for all $p\\ge1$; for $p>1$, TS-Sobolev has the same computational complexity as TSW at $p=1$. Notably, at $p=1$ it recovers TSW exactly. Consequently, TS-Sobolev serves as a drop-in replacement for TSW in practical applications, with an additional flexibility in changing $p$. Furthermore, we extend this framework to define a corresponding metric for probability measures on hyperspheres. Experiments on Euclidean and spherical datasets show that TS-Sobolev and its spherical variant improve downstream performance in gradient flows, self-supervised learning, generative modeling, and text topic modeling over recent SW and TSW variants.", "tldr": "We introduce TS-Sobolev, a tree-sliced metric derived from a closed-form regularized Sobolev IPM, broadening the practical use of Wasserstein distance on tree-metric spaces.", "keywords": ["sliced optimal transport", "sobolev ipm", "tree-sliced wasserstein distance", "tree wasserstein distance"], "primary_area": "learning on graphs and other geometries & topologies", "venue": "ICLR 2026 Conference Submission", "pdf": "/pdf/d1596200ca35eca4d2ea44c7a514af9476d7cdc5.pdf", "supplementary_material": "/attachment/a74bbb48ae4db6a1f78cff2393b87e2553488cce.zip"}, "replies": [{"content": {"summary": {"value": "In this work, the authors proposed a new type of tree-sliced metric to capture the $p$ -Wasserstein distance between two probability measures defined either in $\\mathbb{R}^d$ or on a hypersphere. The main motivation is that recent advances in tree-sliced Wasserstein (TSW) [1,2] only provide closed-form expressions for $p = 1$, which is quite limited. On the other hand, the regularized Sobolev Integral Probability Metric -- Sobolev IPM -- (for any order $p \\geq 1$) between two distributions on trees is known in closed form [3]. The idea is as follows: one randomly samples a tree structure (a slice) based on a procedure in [2], then computes the closed-form regularized Sobolev IPM (of order $p$) between two distributions within that tree structure. This process is repeated multiple times to obtain a Monte Carlo estimation of the proposed metric which is defined as the expectation of this MC estimator.\n\nThe authors showed that the proposed metric is indeed a valid metric (e.g., symmetric and satisfying the triangle inequality). When $p = 1$, it reduces to the tree-sliced Wasserstein metric, and for $p > 1$, it serves as a lower bound of TSW.  \n\nIn the experiments, the proposed metric was applied in several contexts: gradient flows in either Euclidean space or on a hypersphere, as part of the objective function in training diffusion models, and in topic modeling. In most cases, the proposed metric outperforms other Wasserstein-based metrics and demonstrates improvements in downstream tasks.  \n\n**References**\n\n[1] Tran, V. H., Pham, T., Tran, T., Le, T., & Nguyen, T. M. (2024). Tree-sliced Wasserstein distance on a system of lines. arXiv e-prints, arXiv-2406. \n\n[2] Tran, H. V., Nguyen, K. N., Pham, T., Chu, T. T., Le, T., & Nguyen, T. M. (2025). Distance-based tree-sliced Wasserstein distance. arXiv preprint arXiv:2503.11050. \n\n[3] Le, T., Nguyen, T., Hino, H., & Fukumizu, K. (2025). Scalable Sobolev IPM for Probability Measures on a Graph. arXiv preprint arXiv:2502.00737."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "- The idea of combining tree-sliced Wasserstein with the Sobolev IPM to handle the general p-Wasserstein distance is novel and provides a practical way to approximate the $p$-Wasserstein distance in practice.  \n\n- The proposed approach introduces minimal computational overhead compared to existing Sliced or Tree-Sliced Wasserstein methods.  \n\n- The experiments are extensive and consistently demonstrate improved performance over previous works."}, "weaknesses": {"value": "- The necessity of approximating the p-Wasserstein distance is not clearly motivated. It would be helpful to clarify what specific advantages the p-Wasserstein distance offers over the 1-Wasserstein distance, which the existing tree-sliced Wasserstein approach is already able to capture.  \n\n- Some experimental comparisons may favor the proposed method. For example, in the gradient flow experiment on the sphere (and possibly also in the Euclidean space), using the 2-Wasserstein distance as the evaluation criterion could naturally benefit the proposed method over Tree-Sliced Wasserstein [2], which is inherently based on the 1-Wasserstein distance. I wonder what the results look like if you used 1-Wasserstein distance as the criterion instead.\n\n- The writing could be improved for clarity and structure. For instance, the definition of the regularized Sobolev IPM should be presented in the main text, as it is a central component of the proposed method. Additionally, the transition from “Tree Metric Spaces” to “Tree-Sliced Wasserstein Distance” is somewhat abrupt and may confuse readers. For example, the paragraph on “Tree Metric Spaces” might lead one to believe that the space consists solely of nodes, while in “Tree-Sliced Wasserstein Distance,” the entire tree structure (including edges) is considered. Improving the connection between these sections and providing a smoother introduction would enhance readability.  \n\n**Reference**\n\n[2] Tran, H. V., Nguyen, K. N., Pham, T., Chu, T. T., Le, T., & Nguyen, T. M. (2025). *Distance-based tree-sliced Wasserstein distance.* arXiv preprint arXiv:2503.11050."}, "questions": {"value": "- In 2D, when generating a system of lines, they inevitably intersect, allowing one to remove some intersection points to construct a tree. I wonder how this idea extends to higher dimensions ($d > 2$), where such lines generally do not intersect.  \n\n- Is the method applicable to more general Riemannian manifolds beyond the hypersphere? In principle, one could sample geodesics in those manifolds, so it would be interesting to see whether the approach can be generalized.\n\n- As mentioned before, it would be helpful to clarify why we really need the p-Wasserstein distance, and in what ways the 1-Wasserstein distance falls short."}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "NA"}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "2FEZSr1hPT", "forum": "HHNQSXaLkF", "replyto": "HHNQSXaLkF", "signatures": ["ICLR.cc/2026/Conference/Submission5088/Reviewer_yezB"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5088/Reviewer_yezB"], "number": 1, "invitations": ["ICLR.cc/2026/Conference/Submission5088/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761540467016, "cdate": 1761540467016, "tmdate": 1762917864154, "mdate": 1762917864154, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "Tree-Sliced Wasserstein (TSW) practical use is constrained to the 1-Wasserstein because $W_p$ ($p>1$) for tree is costly. This paper proposes using regularized Sobolev IPM which has a computationally efficient closed-form solution on trees. THis recovers TSW exactly at $p = 1$ and is upper-bounded by TSW for $p > 1$, while maintaining the same $\\mathcal{O} (L k n log n)$ complexity."}, "soundness": {"value": 3}, "presentation": {"value": 3}, "contribution": {"value": 3}, "strengths": {"value": "- A key achievement is generalizing to $p > 1$ without sacrificing computational efficiency. The closed-form expression for $\\hat{\\mathcal{S}}_p$ on discrete measures (Theorem B.6, Eq. 28) relies on edge coefficients $\\beta_e$ that depend on $p$ but are efficiently pre-computable, adding negligible $\\mathcal{O}(Lkn)$ overhead. Thus TS-Sobolev retains the dominant $O(Lkn \\log n)$ complexity of TSW for \\textit{any} $p \\ge 1$. This claim is validated by the empirical runtime analysis (Appendix F.1, Figs 4-6), showing near-identical wall-clock times regardless of $p$.\n- Good experimental results. For example,\n    - Achieves faster convergence and lower final $W_2$ error compared to TSW ($p=1$) and SW variants in Euclidean settings (Table 1). Similarly outperforms spherical TSW (STSW) in spherical gradient flows (Table 4).\n    - with DDGAN training gives sota FID scores on CIFAR-10, significantly improving upon TSW-based DDGANs with identical training time per epoch\n    - Strong performance in spherical SSL (Table 3) and achieves the highest topic coherence ($C_V$) in both Euclidean and Spherical topic modeling benchmarks (Table 5)."}, "weaknesses": {"value": "- The main justification for using $\\hat{\\mathcal{S}}_p$ is its tractability. However, the paper offers limited intuition on the gain or loss by using this specific Sobolev-based IPM instead of $W_p$ on trees for $p>1$. $\\hat{\\mathcal{S}}_p$ relates to the weighted $L^{p'}$ norm of the critic function's derivative on the tree. How does minimizing this discrepancy differ fundamentally from minimizing transport cost ($d(x,y)^p$)? Does $\\hat{\\mathcal{S}}_p$ emphasize smoothness or local variations differently than $W_p$? \n\n- The closed-form tractability of $\\hat{\\mathcal{S}}_p$ comes from a specific weighting function $\\hat{w}(x) = 1 + \\omega(\\Lambda(x))$ inherent in the underlying Sobolev norm equivalence on trees (Theorem B.3). This weight depends on the measure (length) of the subtree $\\Lambda(x)$ below point $x$ relative to the root (Eq. 22). It is not clear to the reviewer the geometric implications of this structural weighting. For example, does this make $\\hat{\\mathcal{S}}_p$ (and thus TS-Sobolev) inherently more sensitive to distributional differences occurring deeper in the tree projection (larger $\\omega(\\Lambda(x))$) versus closer to the root? \n\n- The experiments consistently use the concurrent-line tree structure [cite: lines 1097-1102] and softmax splitting map, following configurations from recent TSW paper. While sensible for direct comparison, this limits the exploration of how TS-Sobolev performs under different structural assumptions. Appendix F.6 analyzes the $L$ vs. $k$ trade-off but doesn't compare tree topologies (e.g., concurrent vs chain or splitting maps within the TS-Sobolev context. The observed benefit of $p>1$ might interact with these choices."}, "questions": {"value": "- Can the authors give more insight, perhaps related to the Sobolev IPM formulation involving derivatives, on why $p>1$ might lead to better optimization dynamics (e.g., smoother gradients, better conditioning) compared to $p=1$ (TSW), as suggested by the gradient flow results?\n- Could the authors please comment on the practical effect of the structural weighting $\\hat{w}(x) = 1 + \\omega(\\Lambda(x))$? Does this induce spatial sensitivity bias on the tree slices and how would it interact with the choice of $p$ for example?\n- How robust are the benefits of $p>1$ expected to be under different tree generation schemes (e.g., chain structures) or alternative splitting maps?\n- Appendix F.7 provides valuable empirical analysis showing $p \\in [1.0, 2.0]$ is effective and higher $p$ can be unstable . Can the authors offer any further heuristic or theoretical guidance? For instance, does the optimal $p$ appear correlated with data dimensionality or the nature of the task (e.g., generation vs. optimization)? Why might $p=2$ perform particularly well across several diverse tasks (Tables 2, 4, 5)?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "rating": {"value": 6}, "confidence": {"value": 4}, "code_of_conduct": {"value": "Yes"}}, "id": "hJI3BIlOXX", "forum": "HHNQSXaLkF", "replyto": "HHNQSXaLkF", "signatures": ["ICLR.cc/2026/Conference/Submission5088/Reviewer_ZHaq"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5088/Reviewer_ZHaq"], "number": 2, "invitations": ["ICLR.cc/2026/Conference/Submission5088/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1761964682648, "cdate": 1761964682648, "tmdate": 1762917863932, "mdate": 1762917863932, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}, {"content": {"summary": {"value": "### **Summary**\n\nThis paper introduces the **Tree-Sliced Sobolev Integral Probability Metric (TS-Sobolev)** and its **spherical variant (STS-Sobolev)** — new metrics for comparing probability distributions that generalize the Tree-Sliced Wasserstein (TSW) distance to any order $p \\ge 1$.  \n\nThe main idea is to replace the 1-Wasserstein distance on tree metric spaces (used in TSW) with a **regularized Sobolev Integral Probability Metric (IPM)** that admits a **closed-form solution**. This substitution retains the computational efficiency of TSW (≈ $O(Lkn \\log n)$) while enabling higher-order Sobolev metrics.  \n\nThe authors establish key **theoretical guarantees**, including:\n- Metricity and $E(d)$-invariance,\n- A formal connection showing $\\text{TS-Sobolev}_{p=1} = \\text{TSW}$,\n- Monte Carlo convergence rate $O(L^{-1/2})$.\n\nThe proposed methods are evaluated on a wide range of **Euclidean and spherical tasks**, including gradient flows, diffusion-based generative modeling (DDGAN on CIFAR-10), self-supervised learning on the sphere, and topic modeling on BBC and M10 datasets.  \n\nAcross all benchmarks, TS-Sobolev and STS-Sobolev consistently **outperform Sliced and Tree-Sliced Wasserstein baselines** in accuracy or convergence rate, while maintaining similar runtime. The paper concludes that Sobolev-based slicing provides a scalable and flexible alternative to classical TSW for both Euclidean and non-Euclidean domains."}, "soundness": {"value": 3}, "presentation": {"value": 2}, "contribution": {"value": 3}, "strengths": {"value": "### **Strengths**\n\n#### **Novel Theoretical Contribution**\n- Introduces a closed-form **Sobolev IPM** on trees that generalizes **1-Wasserstein** while retaining efficiency.  \n- Provides formal proofs of **metricity**, **$E(d)$-invariance**, and **Monte Carlo convergence rate**.  \n- Connects **Sobolev IPM** and **tree-sliced methods** in a clean, unified framework.\n\n#### **Scalability**\n- Maintains the computational complexity $O(Lkn \\log n)$ of existing TSW methods, enabling practical scalability to large datasets.  \n- Extensible to **spherical manifolds** via the **spherical Radon transform**.\n\n#### **Strong Empirical Results**\n- Consistently improves over both **SW** and **TSW** baselines across diverse domains.  \n- Demonstrates flexibility across geometries (**Euclidean** / **spherical**) and applications (gradient flows, SSL, generative modeling, topic modeling).\n\n#### **Clarity of Exposition**\n- Well-structured presentation: clear flow from background → formulation → theoretical properties → experiments.  \n- Figures and equations are informative, and notation aligns with prior **TSW literature**."}, "weaknesses": {"value": "1. In the computation section, the authors claim a total complexity of $O(Lkn \\log n + LKd n)$, but it seems that the tree construction cost is not explicitly included. \n1.1 Moreover, the parameter $k$ (the number of lines per tree) controls a trade-off between computational efficiency and information preservation in $\\mathbb{R}^d$. A detailed discussion of this trade-off would strengthen the paper. In particular, it would be useful to know how large $k$ can grow before the overall method becomes slower than classical OT solvers such as Sinkhorn, whose complexity is $O(n^2 / \\epsilon)$. \n1.2 Clarifying whether $k$ depends on $n$ would also help to assess the true scalability of the approach.\n\n2. In the spherical setting, I suggest including additional sliced OT baselines for a more complete comparison — for example, “Spherical Sliced Optimal Transport” (arXiv:2411.06055) and “Stereographic Spherical Sliced Wasserstein Distances” (arXiv:2402.02345). These would provide a stronger empirical context and highlight the advantages of the proposed method under spherical geometry.\n\n3. The Sobolev IPM involves gradient norms $|\\nabla f|$, which are central to the metric’s definition. However, estimating $\\nabla f$ on discrete samples and through non-smooth tree-sliced projections may introduce numerical instability or high-variance gradients. Prior work on Sobolev-based metrics (Mroueh et al., ICLR 2018; Deshpande et al., NeurIPS 2019; Korotin et al., ICML 2021) has highlighted that $\\nabla f$ estimation can become unstable without smoothing or gradient regularization. The paper would benefit from analyzing or mitigating such potential instability in the proposed tree-sliced formulation."}, "questions": {"value": "**Q1.**  \nSuppose the tree $\\mathbb{T} \\subset \\mathbb{R}$, i.e., all nodes lie on a straight line. In this case, the tree-sliced construction should coincide with the original sliced OT construction. Under this 1D setting, can we claim that the regularized Sobolev IPM (Eq. (4)) or the Sobolev IPM (Eq. (3)) is equivalent to $W_p(\\mu,\\nu)$?  \nMy understanding is that in 1D Eq. (4) reduces to  \n$$\n\\int_{\\mathbb{R}} \\big|\\mu((-\\infty,x]) - \\nu((-\\infty,x])\\big|^p \\, dx,\n$$  \nwhich differs from the standard 1D OT definition  \n$$\nW_p^p(\\mu,\\nu) = \\int_0^1 |F_\\mu^{-1}(t) - F_\\nu^{-1}(t)|^p \\, dt.\n$$  \nIf this understanding is correct, then the proposed Tree-Sliced Sobolev IPM (Def. 3.1) cannot recover the classical sliced OT formulation  \n$$\n\\int_{\\mathbb{S}^{d-1}} W_p^p((P_\\theta)_\\# \\mu, (P_\\theta)_\\# \\nu) \\, d\\sigma(\\theta),\n$$  \nsince $S_p^p(\\mu,\\nu)$ and $W_p^p(\\mu,\\nu)$ are not equivalent in 1D. Could the authors clarify this or specify under what conditions the two coincide?  \n\n**Q2.**  \nThe paper motivates Sobolev IPM as more “frequency-aware” and capable of mitigating spectral bias, but the experiments mainly show performance improvements without spectral evidence. Could the authors include a more direct spectral analysis (e.g., using synthetic 1D or 2D signals with known low/high-frequency components) to verify that the proposed tree-sliced Sobolev formulation indeed captures or preserves high-frequency modes better than standard sliced OT?"}, "flag_for_ethics_review": {"value": ["No ethics review needed."]}, "details_of_ethics_concerns": {"value": "NA"}, "rating": {"value": 6}, "confidence": {"value": 3}, "code_of_conduct": {"value": "Yes"}}, "id": "8zHPPok5DF", "forum": "HHNQSXaLkF", "replyto": "HHNQSXaLkF", "signatures": ["ICLR.cc/2026/Conference/Submission5088/Reviewer_UFk1"], "nonreaders": [], "readers": ["everyone"], "writers": ["ICLR.cc/2026/Conference", "ICLR.cc/2026/Conference/Submission5088/Reviewer_UFk1"], "number": 3, "invitations": ["ICLR.cc/2026/Conference/Submission5088/-/Official_Review", "ICLR.cc/2026/Conference/-/Edit"], "domain": "ICLR.cc/2026/Conference", "tcdate": 1762115454145, "cdate": 1762115454145, "tmdate": 1762917863681, "mdate": 1762917863681, "parentInvitations": "ICLR.cc/2026/Conference/-/Official_Review", "license": "CC BY 4.0", "version": 2}], "withdrawn": false}